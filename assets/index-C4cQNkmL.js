(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var k1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function H3(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function W3(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}var Ny={exports:{}},pd={},Cy={exports:{}},Ft={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Pf=Symbol.for("react.element"),q3=Symbol.for("react.portal"),$3=Symbol.for("react.fragment"),V3=Symbol.for("react.strict_mode"),G3=Symbol.for("react.profiler"),K3=Symbol.for("react.provider"),Y3=Symbol.for("react.context"),X3=Symbol.for("react.forward_ref"),J3=Symbol.for("react.suspense"),Q3=Symbol.for("react.memo"),Z3=Symbol.for("react.lazy"),Bm=Symbol.iterator;function eS(e){return e===null||typeof e!="object"?null:(e=Bm&&e[Bm]||e["@@iterator"],typeof e=="function"?e:null)}var Ly={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Py=Object.assign,Oy={};function Nu(e,t,r){this.props=e,this.context=t,this.refs=Oy,this.updater=r||Ly}Nu.prototype.isReactComponent={};Nu.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Nu.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Fy(){}Fy.prototype=Nu.prototype;function $g(e,t,r){this.props=e,this.context=t,this.refs=Oy,this.updater=r||Ly}var Vg=$g.prototype=new Fy;Vg.constructor=$g;Py(Vg,Nu.prototype);Vg.isPureReactComponent=!0;var Um=Array.isArray,Ry=Object.prototype.hasOwnProperty,Gg={current:null},Iy={key:!0,ref:!0,__self:!0,__source:!0};function Dy(e,t,r){var n,i={},a=null,s=null;if(t!=null)for(n in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(a=""+t.key),t)Ry.call(t,n)&&!Iy.hasOwnProperty(n)&&(i[n]=t[n]);var o=arguments.length-2;if(o===1)i.children=r;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];i.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)i[n]===void 0&&(i[n]=o[n]);return{$$typeof:Pf,type:e,key:a,ref:s,props:i,_owner:Gg.current}}function tS(e,t){return{$$typeof:Pf,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Kg(e){return typeof e=="object"&&e!==null&&e.$$typeof===Pf}function rS(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var zm=/\/+/g;function N1(e,t){return typeof e=="object"&&e!==null&&e.key!=null?rS(""+e.key):t.toString(36)}function d0(e,t,r,n,i){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(a){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case Pf:case q3:s=!0}}if(s)return s=e,i=i(s),e=n===""?"."+N1(s,0):n,Um(i)?(r="",e!=null&&(r=e.replace(zm,"$&/")+"/"),d0(i,t,r,"",function(u){return u})):i!=null&&(Kg(i)&&(i=tS(i,r+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(zm,"$&/")+"/")+e)),t.push(i)),1;if(s=0,n=n===""?".":n+":",Um(e))for(var o=0;o<e.length;o++){a=e[o];var l=n+N1(a,o);s+=d0(a,t,r,l,i)}else if(l=eS(e),typeof l=="function")for(e=l.call(e),o=0;!(a=e.next()).done;)a=a.value,l=n+N1(a,o++),s+=d0(a,t,r,l,i);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function Lh(e,t,r){if(e==null)return e;var n=[],i=0;return d0(e,n,"","",function(a){return t.call(r,a,i++)}),n}function nS(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Vn={current:null},p0={transition:null},iS={ReactCurrentDispatcher:Vn,ReactCurrentBatchConfig:p0,ReactCurrentOwner:Gg};function jy(){throw Error("act(...) is not supported in production builds of React.")}Ft.Children={map:Lh,forEach:function(e,t,r){Lh(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return Lh(e,function(){t++}),t},toArray:function(e){return Lh(e,function(t){return t})||[]},only:function(e){if(!Kg(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Ft.Component=Nu;Ft.Fragment=$3;Ft.Profiler=G3;Ft.PureComponent=$g;Ft.StrictMode=V3;Ft.Suspense=J3;Ft.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=iS;Ft.act=jy;Ft.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=Py({},e.props),i=e.key,a=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,s=Gg.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)Ry.call(t,l)&&!Iy.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];n.children=o}return{$$typeof:Pf,type:e.type,key:i,ref:a,props:n,_owner:s}};Ft.createContext=function(e){return e={$$typeof:Y3,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:K3,_context:e},e.Consumer=e};Ft.createElement=Dy;Ft.createFactory=function(e){var t=Dy.bind(null,e);return t.type=e,t};Ft.createRef=function(){return{current:null}};Ft.forwardRef=function(e){return{$$typeof:X3,render:e}};Ft.isValidElement=Kg;Ft.lazy=function(e){return{$$typeof:Z3,_payload:{_status:-1,_result:e},_init:nS}};Ft.memo=function(e,t){return{$$typeof:Q3,type:e,compare:t===void 0?null:t}};Ft.startTransition=function(e){var t=p0.transition;p0.transition={};try{e()}finally{p0.transition=t}};Ft.unstable_act=jy;Ft.useCallback=function(e,t){return Vn.current.useCallback(e,t)};Ft.useContext=function(e){return Vn.current.useContext(e)};Ft.useDebugValue=function(){};Ft.useDeferredValue=function(e){return Vn.current.useDeferredValue(e)};Ft.useEffect=function(e,t){return Vn.current.useEffect(e,t)};Ft.useId=function(){return Vn.current.useId()};Ft.useImperativeHandle=function(e,t,r){return Vn.current.useImperativeHandle(e,t,r)};Ft.useInsertionEffect=function(e,t){return Vn.current.useInsertionEffect(e,t)};Ft.useLayoutEffect=function(e,t){return Vn.current.useLayoutEffect(e,t)};Ft.useMemo=function(e,t){return Vn.current.useMemo(e,t)};Ft.useReducer=function(e,t,r){return Vn.current.useReducer(e,t,r)};Ft.useRef=function(e){return Vn.current.useRef(e)};Ft.useState=function(e){return Vn.current.useState(e)};Ft.useSyncExternalStore=function(e,t,r){return Vn.current.useSyncExternalStore(e,t,r)};Ft.useTransition=function(){return Vn.current.useTransition()};Ft.version="18.3.1";Cy.exports=Ft;var ut=Cy.exports;const aS=H3(ut);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sS=ut,oS=Symbol.for("react.element"),lS=Symbol.for("react.fragment"),uS=Object.prototype.hasOwnProperty,cS=sS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,fS={key:!0,ref:!0,__self:!0,__source:!0};function My(e,t,r){var n,i={},a=null,s=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(s=t.ref);for(n in t)uS.call(t,n)&&!fS.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:oS,type:e,key:a,ref:s,props:i,_owner:cS.current}}pd.Fragment=lS;pd.jsx=My;pd.jsxs=My;Ny.exports=pd;var Z=Ny.exports,Tp={},By={exports:{}},Ci={},Uy={exports:{}},zy={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(X,z){var ae=X.length;X.push(z);e:for(;0<ae;){var me=ae-1>>>1,E=X[me];if(0<i(E,z))X[me]=z,X[ae]=E,ae=me;else break e}}function r(X){return X.length===0?null:X[0]}function n(X){if(X.length===0)return null;var z=X[0],ae=X.pop();if(ae!==z){X[0]=ae;e:for(var me=0,E=X.length,O=E>>>1;me<O;){var F=2*(me+1)-1,I=X[F],V=F+1,ue=X[V];if(0>i(I,ae))V<E&&0>i(ue,I)?(X[me]=ue,X[V]=ae,me=V):(X[me]=I,X[F]=ae,me=F);else if(V<E&&0>i(ue,ae))X[me]=ue,X[V]=ae,me=V;else break e}}return z}function i(X,z){var ae=X.sortIndex-z.sortIndex;return ae!==0?ae:X.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var s=Date,o=s.now();e.unstable_now=function(){return s.now()-o}}var l=[],u=[],f=1,d=null,p=3,h=!1,v=!1,m=!1,S=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(X){for(var z=r(u);z!==null;){if(z.callback===null)n(u);else if(z.startTime<=X)n(u),z.sortIndex=z.expirationTime,t(l,z);else break;z=r(u)}}function A(X){if(m=!1,x(X),!v)if(r(l)!==null)v=!0,ee(R);else{var z=r(u);z!==null&&Q(A,z.startTime-X)}}function R(X,z){v=!1,m&&(m=!1,y(L),L=-1),h=!0;var ae=p;try{for(x(z),d=r(l);d!==null&&(!(d.expirationTime>z)||X&&!N());){var me=d.callback;if(typeof me=="function"){d.callback=null,p=d.priorityLevel;var E=me(d.expirationTime<=z);z=e.unstable_now(),typeof E=="function"?d.callback=E:d===r(l)&&n(l),x(z)}else n(l);d=r(l)}if(d!==null)var O=!0;else{var F=r(u);F!==null&&Q(A,F.startTime-z),O=!1}return O}finally{d=null,p=ae,h=!1}}var B=!1,T=null,L=-1,P=5,M=-1;function N(){return!(e.unstable_now()-M<P)}function C(){if(T!==null){var X=e.unstable_now();M=X;var z=!0;try{z=T(!0,X)}finally{z?U():(B=!1,T=null)}}else B=!1}var U;if(typeof w=="function")U=function(){w(C)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,ce=Y.port2;Y.port1.onmessage=C,U=function(){ce.postMessage(null)}}else U=function(){S(C,0)};function ee(X){T=X,B||(B=!0,U())}function Q(X,z){L=S(function(){X(e.unstable_now())},z)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(X){X.callback=null},e.unstable_continueExecution=function(){v||h||(v=!0,ee(R))},e.unstable_forceFrameRate=function(X){0>X||125<X?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<X?Math.floor(1e3/X):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(X){switch(p){case 1:case 2:case 3:var z=3;break;default:z=p}var ae=p;p=z;try{return X()}finally{p=ae}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(X,z){switch(X){case 1:case 2:case 3:case 4:case 5:break;default:X=3}var ae=p;p=X;try{return z()}finally{p=ae}},e.unstable_scheduleCallback=function(X,z,ae){var me=e.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?me+ae:me):ae=me,X){case 1:var E=-1;break;case 2:E=250;break;case 5:E=1073741823;break;case 4:E=1e4;break;default:E=5e3}return E=ae+E,X={id:f++,callback:z,priorityLevel:X,startTime:ae,expirationTime:E,sortIndex:-1},ae>me?(X.sortIndex=ae,t(u,X),r(l)===null&&X===r(u)&&(m?(y(L),L=-1):m=!0,Q(A,ae-me))):(X.sortIndex=E,t(l,X),v||h||(v=!0,ee(R))),X},e.unstable_shouldYield=N,e.unstable_wrapCallback=function(X){var z=p;return function(){var ae=p;p=z;try{return X.apply(this,arguments)}finally{p=ae}}}})(zy);Uy.exports=zy;var hS=Uy.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dS=ut,ki=hS;function We(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Hy=new Set,Jc={};function tl(e,t){xu(e,t),xu(e+"Capture",t)}function xu(e,t){for(Jc[e]=t,e=0;e<t.length;e++)Hy.add(t[e])}var cs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),kp=Object.prototype.hasOwnProperty,pS=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Hm={},Wm={};function gS(e){return kp.call(Wm,e)?!0:kp.call(Hm,e)?!1:pS.test(e)?Wm[e]=!0:(Hm[e]=!0,!1)}function mS(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function vS(e,t,r,n){if(t===null||typeof t>"u"||mS(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Gn(e,t,r,n,i,a,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=s}var Sn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Sn[e]=new Gn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Sn[t]=new Gn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Sn[e]=new Gn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Sn[e]=new Gn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Sn[e]=new Gn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Sn[e]=new Gn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Sn[e]=new Gn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Sn[e]=new Gn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Sn[e]=new Gn(e,5,!1,e.toLowerCase(),null,!1,!1)});var Yg=/[\-:]([a-z])/g;function Xg(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Yg,Xg);Sn[t]=new Gn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Yg,Xg);Sn[t]=new Gn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Yg,Xg);Sn[t]=new Gn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Sn[e]=new Gn(e,1,!1,e.toLowerCase(),null,!1,!1)});Sn.xlinkHref=new Gn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Sn[e]=new Gn(e,1,!1,e.toLowerCase(),null,!0,!0)});function Jg(e,t,r,n){var i=Sn.hasOwnProperty(t)?Sn[t]:null;(i!==null?i.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(vS(t,r,i,n)&&(r=null),n||i===null?gS(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=r===null?i.type===3?!1:"":r:(t=i.attributeName,n=i.attributeNamespace,r===null?e.removeAttribute(t):(i=i.type,r=i===3||i===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var ms=dS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ph=Symbol.for("react.element"),Yl=Symbol.for("react.portal"),Xl=Symbol.for("react.fragment"),Qg=Symbol.for("react.strict_mode"),Np=Symbol.for("react.profiler"),Wy=Symbol.for("react.provider"),qy=Symbol.for("react.context"),Zg=Symbol.for("react.forward_ref"),Cp=Symbol.for("react.suspense"),Lp=Symbol.for("react.suspense_list"),e2=Symbol.for("react.memo"),js=Symbol.for("react.lazy"),$y=Symbol.for("react.offscreen"),qm=Symbol.iterator;function fc(e){return e===null||typeof e!="object"?null:(e=qm&&e[qm]||e["@@iterator"],typeof e=="function"?e:null)}var _r=Object.assign,C1;function bc(e){if(C1===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);C1=t&&t[1]||""}return`
`+C1+e}var L1=!1;function P1(e,t){if(!e||L1)return"";L1=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var n=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){n=u}e.call(t.prototype)}else{try{throw Error()}catch(u){n=u}e()}}catch(u){if(u&&n&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),a=n.stack.split(`
`),s=i.length-1,o=a.length-1;1<=s&&0<=o&&i[s]!==a[o];)o--;for(;1<=s&&0<=o;s--,o--)if(i[s]!==a[o]){if(s!==1||o!==1)do if(s--,o--,0>o||i[s]!==a[o]){var l=`
`+i[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=s&&0<=o);break}}}finally{L1=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?bc(e):""}function yS(e){switch(e.tag){case 5:return bc(e.type);case 16:return bc("Lazy");case 13:return bc("Suspense");case 19:return bc("SuspenseList");case 0:case 2:case 15:return e=P1(e.type,!1),e;case 11:return e=P1(e.type.render,!1),e;case 1:return e=P1(e.type,!0),e;default:return""}}function Pp(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Xl:return"Fragment";case Yl:return"Portal";case Np:return"Profiler";case Qg:return"StrictMode";case Cp:return"Suspense";case Lp:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case qy:return(e.displayName||"Context")+".Consumer";case Wy:return(e._context.displayName||"Context")+".Provider";case Zg:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case e2:return t=e.displayName||null,t!==null?t:Pp(e.type)||"Memo";case js:t=e._payload,e=e._init;try{return Pp(e(t))}catch{}}return null}function wS(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Pp(t);case 8:return t===Qg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function io(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Vy(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function xS(e){var t=Vy(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var i=r.get,a=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(s){n=""+s,a.call(this,s)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(s){n=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Oh(e){e._valueTracker||(e._valueTracker=xS(e))}function Gy(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=Vy(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function A0(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Op(e,t){var r=t.checked;return _r({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function $m(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=io(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Ky(e,t){t=t.checked,t!=null&&Jg(e,"checked",t,!1)}function Fp(e,t){Ky(e,t);var r=io(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Rp(e,t.type,r):t.hasOwnProperty("defaultValue")&&Rp(e,t.type,io(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Vm(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Rp(e,t,r){(t!=="number"||A0(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var Ec=Array.isArray;function uu(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+io(r),t=null,i=0;i<e.length;i++){if(e[i].value===r){e[i].selected=!0,n&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function Ip(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(We(91));return _r({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Gm(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(We(92));if(Ec(r)){if(1<r.length)throw Error(We(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:io(r)}}function Yy(e,t){var r=io(t.value),n=io(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Km(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Xy(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Dp(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Xy(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Fh,Jy=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,i){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Fh=Fh||document.createElement("div"),Fh.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Fh.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Qc(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Cc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},_S=["Webkit","ms","Moz","O"];Object.keys(Cc).forEach(function(e){_S.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Cc[t]=Cc[e]})});function Qy(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Cc.hasOwnProperty(e)&&Cc[e]?(""+t).trim():t+"px"}function Zy(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,i=Qy(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}var SS=_r({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function jp(e,t){if(t){if(SS[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(We(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(We(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(We(61))}if(t.style!=null&&typeof t.style!="object")throw Error(We(62))}}function Mp(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Bp=null;function t2(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Up=null,cu=null,fu=null;function Ym(e){if(e=Rf(e)){if(typeof Up!="function")throw Error(We(280));var t=e.stateNode;t&&(t=wd(t),Up(e.stateNode,e.type,t))}}function ew(e){cu?fu?fu.push(e):fu=[e]:cu=e}function tw(){if(cu){var e=cu,t=fu;if(fu=cu=null,Ym(e),t)for(e=0;e<t.length;e++)Ym(t[e])}}function rw(e,t){return e(t)}function nw(){}var O1=!1;function iw(e,t,r){if(O1)return e(t,r);O1=!0;try{return rw(e,t,r)}finally{O1=!1,(cu!==null||fu!==null)&&(nw(),tw())}}function Zc(e,t){var r=e.stateNode;if(r===null)return null;var n=wd(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(We(231,t,typeof r));return r}var zp=!1;if(cs)try{var hc={};Object.defineProperty(hc,"passive",{get:function(){zp=!0}}),window.addEventListener("test",hc,hc),window.removeEventListener("test",hc,hc)}catch{zp=!1}function bS(e,t,r,n,i,a,s,o,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(r,u)}catch(f){this.onError(f)}}var Lc=!1,T0=null,k0=!1,Hp=null,ES={onError:function(e){Lc=!0,T0=e}};function AS(e,t,r,n,i,a,s,o,l){Lc=!1,T0=null,bS.apply(ES,arguments)}function TS(e,t,r,n,i,a,s,o,l){if(AS.apply(this,arguments),Lc){if(Lc){var u=T0;Lc=!1,T0=null}else throw Error(We(198));k0||(k0=!0,Hp=u)}}function rl(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function aw(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Xm(e){if(rl(e)!==e)throw Error(We(188))}function kS(e){var t=e.alternate;if(!t){if(t=rl(e),t===null)throw Error(We(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(i===null)break;var a=i.alternate;if(a===null){if(n=i.return,n!==null){r=n;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===r)return Xm(i),e;if(a===n)return Xm(i),t;a=a.sibling}throw Error(We(188))}if(r.return!==n.return)r=i,n=a;else{for(var s=!1,o=i.child;o;){if(o===r){s=!0,r=i,n=a;break}if(o===n){s=!0,n=i,r=a;break}o=o.sibling}if(!s){for(o=a.child;o;){if(o===r){s=!0,r=a,n=i;break}if(o===n){s=!0,n=a,r=i;break}o=o.sibling}if(!s)throw Error(We(189))}}if(r.alternate!==n)throw Error(We(190))}if(r.tag!==3)throw Error(We(188));return r.stateNode.current===r?e:t}function sw(e){return e=kS(e),e!==null?ow(e):null}function ow(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=ow(e);if(t!==null)return t;e=e.sibling}return null}var lw=ki.unstable_scheduleCallback,Jm=ki.unstable_cancelCallback,NS=ki.unstable_shouldYield,CS=ki.unstable_requestPaint,Rr=ki.unstable_now,LS=ki.unstable_getCurrentPriorityLevel,r2=ki.unstable_ImmediatePriority,uw=ki.unstable_UserBlockingPriority,N0=ki.unstable_NormalPriority,PS=ki.unstable_LowPriority,cw=ki.unstable_IdlePriority,gd=null,Ma=null;function OS(e){if(Ma&&typeof Ma.onCommitFiberRoot=="function")try{Ma.onCommitFiberRoot(gd,e,void 0,(e.current.flags&128)===128)}catch{}}var ya=Math.clz32?Math.clz32:IS,FS=Math.log,RS=Math.LN2;function IS(e){return e>>>=0,e===0?32:31-(FS(e)/RS|0)|0}var Rh=64,Ih=4194304;function Ac(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function C0(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,i=e.suspendedLanes,a=e.pingedLanes,s=r&268435455;if(s!==0){var o=s&~i;o!==0?n=Ac(o):(a&=s,a!==0&&(n=Ac(a)))}else s=r&~i,s!==0?n=Ac(s):a!==0&&(n=Ac(a));if(n===0)return 0;if(t!==0&&t!==n&&!(t&i)&&(i=n&-n,a=t&-t,i>=a||i===16&&(a&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-ya(t),i=1<<r,n|=e[r],t&=~i;return n}function DS(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function jS(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,a=e.pendingLanes;0<a;){var s=31-ya(a),o=1<<s,l=i[s];l===-1?(!(o&r)||o&n)&&(i[s]=DS(o,t)):l<=t&&(e.expiredLanes|=o),a&=~o}}function Wp(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function fw(){var e=Rh;return Rh<<=1,!(Rh&4194240)&&(Rh=64),e}function F1(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function Of(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-ya(t),e[t]=r}function MS(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-ya(r),a=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~a}}function n2(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-ya(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var Zt=0;function hw(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var dw,i2,pw,gw,mw,qp=!1,Dh=[],Ys=null,Xs=null,Js=null,ef=new Map,tf=new Map,Us=[],BS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Qm(e,t){switch(e){case"focusin":case"focusout":Ys=null;break;case"dragenter":case"dragleave":Xs=null;break;case"mouseover":case"mouseout":Js=null;break;case"pointerover":case"pointerout":ef.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":tf.delete(t.pointerId)}}function dc(e,t,r,n,i,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:a,targetContainers:[i]},t!==null&&(t=Rf(t),t!==null&&i2(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function US(e,t,r,n,i){switch(t){case"focusin":return Ys=dc(Ys,e,t,r,n,i),!0;case"dragenter":return Xs=dc(Xs,e,t,r,n,i),!0;case"mouseover":return Js=dc(Js,e,t,r,n,i),!0;case"pointerover":var a=i.pointerId;return ef.set(a,dc(ef.get(a)||null,e,t,r,n,i)),!0;case"gotpointercapture":return a=i.pointerId,tf.set(a,dc(tf.get(a)||null,e,t,r,n,i)),!0}return!1}function vw(e){var t=Io(e.target);if(t!==null){var r=rl(t);if(r!==null){if(t=r.tag,t===13){if(t=aw(r),t!==null){e.blockedOn=t,mw(e.priority,function(){pw(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function g0(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=$p(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Bp=n,r.target.dispatchEvent(n),Bp=null}else return t=Rf(r),t!==null&&i2(t),e.blockedOn=r,!1;t.shift()}return!0}function Zm(e,t,r){g0(e)&&r.delete(t)}function zS(){qp=!1,Ys!==null&&g0(Ys)&&(Ys=null),Xs!==null&&g0(Xs)&&(Xs=null),Js!==null&&g0(Js)&&(Js=null),ef.forEach(Zm),tf.forEach(Zm)}function pc(e,t){e.blockedOn===t&&(e.blockedOn=null,qp||(qp=!0,ki.unstable_scheduleCallback(ki.unstable_NormalPriority,zS)))}function rf(e){function t(i){return pc(i,e)}if(0<Dh.length){pc(Dh[0],e);for(var r=1;r<Dh.length;r++){var n=Dh[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Ys!==null&&pc(Ys,e),Xs!==null&&pc(Xs,e),Js!==null&&pc(Js,e),ef.forEach(t),tf.forEach(t),r=0;r<Us.length;r++)n=Us[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Us.length&&(r=Us[0],r.blockedOn===null);)vw(r),r.blockedOn===null&&Us.shift()}var hu=ms.ReactCurrentBatchConfig,L0=!0;function HS(e,t,r,n){var i=Zt,a=hu.transition;hu.transition=null;try{Zt=1,a2(e,t,r,n)}finally{Zt=i,hu.transition=a}}function WS(e,t,r,n){var i=Zt,a=hu.transition;hu.transition=null;try{Zt=4,a2(e,t,r,n)}finally{Zt=i,hu.transition=a}}function a2(e,t,r,n){if(L0){var i=$p(e,t,r,n);if(i===null)W1(e,t,n,P0,r),Qm(e,n);else if(US(i,e,t,r,n))n.stopPropagation();else if(Qm(e,n),t&4&&-1<BS.indexOf(e)){for(;i!==null;){var a=Rf(i);if(a!==null&&dw(a),a=$p(e,t,r,n),a===null&&W1(e,t,n,P0,r),a===i)break;i=a}i!==null&&n.stopPropagation()}else W1(e,t,n,null,r)}}var P0=null;function $p(e,t,r,n){if(P0=null,e=t2(n),e=Io(e),e!==null)if(t=rl(e),t===null)e=null;else if(r=t.tag,r===13){if(e=aw(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return P0=e,null}function yw(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(LS()){case r2:return 1;case uw:return 4;case N0:case PS:return 16;case cw:return 536870912;default:return 16}default:return 16}}var qs=null,s2=null,m0=null;function ww(){if(m0)return m0;var e,t=s2,r=t.length,n,i="value"in qs?qs.value:qs.textContent,a=i.length;for(e=0;e<r&&t[e]===i[e];e++);var s=r-e;for(n=1;n<=s&&t[r-n]===i[a-n];n++);return m0=i.slice(e,1<n?1-n:void 0)}function v0(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function jh(){return!0}function ev(){return!1}function Li(e){function t(r,n,i,a,s){this._reactName=r,this._targetInst=i,this.type=n,this.nativeEvent=a,this.target=s,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?jh:ev,this.isPropagationStopped=ev,this}return _r(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=jh)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=jh)},persist:function(){},isPersistent:jh}),t}var Cu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},o2=Li(Cu),Ff=_r({},Cu,{view:0,detail:0}),qS=Li(Ff),R1,I1,gc,md=_r({},Ff,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:l2,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==gc&&(gc&&e.type==="mousemove"?(R1=e.screenX-gc.screenX,I1=e.screenY-gc.screenY):I1=R1=0,gc=e),R1)},movementY:function(e){return"movementY"in e?e.movementY:I1}}),tv=Li(md),$S=_r({},md,{dataTransfer:0}),VS=Li($S),GS=_r({},Ff,{relatedTarget:0}),D1=Li(GS),KS=_r({},Cu,{animationName:0,elapsedTime:0,pseudoElement:0}),YS=Li(KS),XS=_r({},Cu,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),JS=Li(XS),QS=_r({},Cu,{data:0}),rv=Li(QS),ZS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},eb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},tb={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rb(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=tb[e])?!!t[e]:!1}function l2(){return rb}var nb=_r({},Ff,{key:function(e){if(e.key){var t=ZS[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=v0(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?eb[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:l2,charCode:function(e){return e.type==="keypress"?v0(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?v0(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),ib=Li(nb),ab=_r({},md,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),nv=Li(ab),sb=_r({},Ff,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:l2}),ob=Li(sb),lb=_r({},Cu,{propertyName:0,elapsedTime:0,pseudoElement:0}),ub=Li(lb),cb=_r({},md,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),fb=Li(cb),hb=[9,13,27,32],u2=cs&&"CompositionEvent"in window,Pc=null;cs&&"documentMode"in document&&(Pc=document.documentMode);var db=cs&&"TextEvent"in window&&!Pc,xw=cs&&(!u2||Pc&&8<Pc&&11>=Pc),iv=" ",av=!1;function _w(e,t){switch(e){case"keyup":return hb.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Sw(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Jl=!1;function pb(e,t){switch(e){case"compositionend":return Sw(t);case"keypress":return t.which!==32?null:(av=!0,iv);case"textInput":return e=t.data,e===iv&&av?null:e;default:return null}}function gb(e,t){if(Jl)return e==="compositionend"||!u2&&_w(e,t)?(e=ww(),m0=s2=qs=null,Jl=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return xw&&t.locale!=="ko"?null:t.data;default:return null}}var mb={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sv(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!mb[e.type]:t==="textarea"}function bw(e,t,r,n){ew(n),t=O0(t,"onChange"),0<t.length&&(r=new o2("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Oc=null,nf=null;function vb(e){Rw(e,0)}function vd(e){var t=eu(e);if(Gy(t))return e}function yb(e,t){if(e==="change")return t}var Ew=!1;if(cs){var j1;if(cs){var M1="oninput"in document;if(!M1){var ov=document.createElement("div");ov.setAttribute("oninput","return;"),M1=typeof ov.oninput=="function"}j1=M1}else j1=!1;Ew=j1&&(!document.documentMode||9<document.documentMode)}function lv(){Oc&&(Oc.detachEvent("onpropertychange",Aw),nf=Oc=null)}function Aw(e){if(e.propertyName==="value"&&vd(nf)){var t=[];bw(t,nf,e,t2(e)),iw(vb,t)}}function wb(e,t,r){e==="focusin"?(lv(),Oc=t,nf=r,Oc.attachEvent("onpropertychange",Aw)):e==="focusout"&&lv()}function xb(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return vd(nf)}function _b(e,t){if(e==="click")return vd(t)}function Sb(e,t){if(e==="input"||e==="change")return vd(t)}function bb(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var _a=typeof Object.is=="function"?Object.is:bb;function af(e,t){if(_a(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!kp.call(t,i)||!_a(e[i],t[i]))return!1}return!0}function uv(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function cv(e,t){var r=uv(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=uv(r)}}function Tw(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Tw(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function kw(){for(var e=window,t=A0();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=A0(e.document)}return t}function c2(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Eb(e){var t=kw(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&Tw(r.ownerDocument.documentElement,r)){if(n!==null&&c2(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=r.textContent.length,a=Math.min(n.start,i);n=n.end===void 0?a:Math.min(n.end,i),!e.extend&&a>n&&(i=n,n=a,a=i),i=cv(r,a);var s=cv(r,n);i&&s&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),a>n?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Ab=cs&&"documentMode"in document&&11>=document.documentMode,Ql=null,Vp=null,Fc=null,Gp=!1;function fv(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;Gp||Ql==null||Ql!==A0(n)||(n=Ql,"selectionStart"in n&&c2(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Fc&&af(Fc,n)||(Fc=n,n=O0(Vp,"onSelect"),0<n.length&&(t=new o2("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Ql)))}function Mh(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Zl={animationend:Mh("Animation","AnimationEnd"),animationiteration:Mh("Animation","AnimationIteration"),animationstart:Mh("Animation","AnimationStart"),transitionend:Mh("Transition","TransitionEnd")},B1={},Nw={};cs&&(Nw=document.createElement("div").style,"AnimationEvent"in window||(delete Zl.animationend.animation,delete Zl.animationiteration.animation,delete Zl.animationstart.animation),"TransitionEvent"in window||delete Zl.transitionend.transition);function yd(e){if(B1[e])return B1[e];if(!Zl[e])return e;var t=Zl[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in Nw)return B1[e]=t[r];return e}var Cw=yd("animationend"),Lw=yd("animationiteration"),Pw=yd("animationstart"),Ow=yd("transitionend"),Fw=new Map,hv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function fo(e,t){Fw.set(e,t),tl(t,[e])}for(var U1=0;U1<hv.length;U1++){var z1=hv[U1],Tb=z1.toLowerCase(),kb=z1[0].toUpperCase()+z1.slice(1);fo(Tb,"on"+kb)}fo(Cw,"onAnimationEnd");fo(Lw,"onAnimationIteration");fo(Pw,"onAnimationStart");fo("dblclick","onDoubleClick");fo("focusin","onFocus");fo("focusout","onBlur");fo(Ow,"onTransitionEnd");xu("onMouseEnter",["mouseout","mouseover"]);xu("onMouseLeave",["mouseout","mouseover"]);xu("onPointerEnter",["pointerout","pointerover"]);xu("onPointerLeave",["pointerout","pointerover"]);tl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));tl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));tl("onBeforeInput",["compositionend","keypress","textInput","paste"]);tl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));tl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));tl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Tc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Nb=new Set("cancel close invalid load scroll toggle".split(" ").concat(Tc));function dv(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,TS(n,t,void 0,e),e.currentTarget=null}function Rw(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var a=void 0;if(t)for(var s=n.length-1;0<=s;s--){var o=n[s],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==a&&i.isPropagationStopped())break e;dv(i,o,u),a=l}else for(s=0;s<n.length;s++){if(o=n[s],l=o.instance,u=o.currentTarget,o=o.listener,l!==a&&i.isPropagationStopped())break e;dv(i,o,u),a=l}}}if(k0)throw e=Hp,k0=!1,Hp=null,e}function dr(e,t){var r=t[Qp];r===void 0&&(r=t[Qp]=new Set);var n=e+"__bubble";r.has(n)||(Iw(t,e,2,!1),r.add(n))}function H1(e,t,r){var n=0;t&&(n|=4),Iw(r,e,n,t)}var Bh="_reactListening"+Math.random().toString(36).slice(2);function sf(e){if(!e[Bh]){e[Bh]=!0,Hy.forEach(function(r){r!=="selectionchange"&&(Nb.has(r)||H1(r,!1,e),H1(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Bh]||(t[Bh]=!0,H1("selectionchange",!1,t))}}function Iw(e,t,r,n){switch(yw(t)){case 1:var i=HS;break;case 4:i=WS;break;default:i=a2}r=i.bind(null,t,r,e),i=void 0,!zp||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),n?i!==void 0?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):i!==void 0?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function W1(e,t,r,n,i){var a=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var s=n.tag;if(s===3||s===4){var o=n.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(s===4)for(s=n.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;s=s.return}for(;o!==null;){if(s=Io(o),s===null)return;if(l=s.tag,l===5||l===6){n=a=s;continue e}o=o.parentNode}}n=n.return}iw(function(){var u=a,f=t2(r),d=[];e:{var p=Fw.get(e);if(p!==void 0){var h=o2,v=e;switch(e){case"keypress":if(v0(r)===0)break e;case"keydown":case"keyup":h=ib;break;case"focusin":v="focus",h=D1;break;case"focusout":v="blur",h=D1;break;case"beforeblur":case"afterblur":h=D1;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=tv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=VS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=ob;break;case Cw:case Lw:case Pw:h=YS;break;case Ow:h=ub;break;case"scroll":h=qS;break;case"wheel":h=fb;break;case"copy":case"cut":case"paste":h=JS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=nv}var m=(t&4)!==0,S=!m&&e==="scroll",y=m?p!==null?p+"Capture":null:p;m=[];for(var w=u,x;w!==null;){x=w;var A=x.stateNode;if(x.tag===5&&A!==null&&(x=A,y!==null&&(A=Zc(w,y),A!=null&&m.push(of(w,A,x)))),S)break;w=w.return}0<m.length&&(p=new h(p,v,null,r,f),d.push({event:p,listeners:m}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",h=e==="mouseout"||e==="pointerout",p&&r!==Bp&&(v=r.relatedTarget||r.fromElement)&&(Io(v)||v[fs]))break e;if((h||p)&&(p=f.window===f?f:(p=f.ownerDocument)?p.defaultView||p.parentWindow:window,h?(v=r.relatedTarget||r.toElement,h=u,v=v?Io(v):null,v!==null&&(S=rl(v),v!==S||v.tag!==5&&v.tag!==6)&&(v=null)):(h=null,v=u),h!==v)){if(m=tv,A="onMouseLeave",y="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(m=nv,A="onPointerLeave",y="onPointerEnter",w="pointer"),S=h==null?p:eu(h),x=v==null?p:eu(v),p=new m(A,w+"leave",h,r,f),p.target=S,p.relatedTarget=x,A=null,Io(f)===u&&(m=new m(y,w+"enter",v,r,f),m.target=x,m.relatedTarget=S,A=m),S=A,h&&v)t:{for(m=h,y=v,w=0,x=m;x;x=Pl(x))w++;for(x=0,A=y;A;A=Pl(A))x++;for(;0<w-x;)m=Pl(m),w--;for(;0<x-w;)y=Pl(y),x--;for(;w--;){if(m===y||y!==null&&m===y.alternate)break t;m=Pl(m),y=Pl(y)}m=null}else m=null;h!==null&&pv(d,p,h,m,!1),v!==null&&S!==null&&pv(d,S,v,m,!0)}}e:{if(p=u?eu(u):window,h=p.nodeName&&p.nodeName.toLowerCase(),h==="select"||h==="input"&&p.type==="file")var R=yb;else if(sv(p))if(Ew)R=Sb;else{R=xb;var B=wb}else(h=p.nodeName)&&h.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(R=_b);if(R&&(R=R(e,u))){bw(d,R,r,f);break e}B&&B(e,p,u),e==="focusout"&&(B=p._wrapperState)&&B.controlled&&p.type==="number"&&Rp(p,"number",p.value)}switch(B=u?eu(u):window,e){case"focusin":(sv(B)||B.contentEditable==="true")&&(Ql=B,Vp=u,Fc=null);break;case"focusout":Fc=Vp=Ql=null;break;case"mousedown":Gp=!0;break;case"contextmenu":case"mouseup":case"dragend":Gp=!1,fv(d,r,f);break;case"selectionchange":if(Ab)break;case"keydown":case"keyup":fv(d,r,f)}var T;if(u2)e:{switch(e){case"compositionstart":var L="onCompositionStart";break e;case"compositionend":L="onCompositionEnd";break e;case"compositionupdate":L="onCompositionUpdate";break e}L=void 0}else Jl?_w(e,r)&&(L="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(L="onCompositionStart");L&&(xw&&r.locale!=="ko"&&(Jl||L!=="onCompositionStart"?L==="onCompositionEnd"&&Jl&&(T=ww()):(qs=f,s2="value"in qs?qs.value:qs.textContent,Jl=!0)),B=O0(u,L),0<B.length&&(L=new rv(L,e,null,r,f),d.push({event:L,listeners:B}),T?L.data=T:(T=Sw(r),T!==null&&(L.data=T)))),(T=db?pb(e,r):gb(e,r))&&(u=O0(u,"onBeforeInput"),0<u.length&&(f=new rv("onBeforeInput","beforeinput",null,r,f),d.push({event:f,listeners:u}),f.data=T))}Rw(d,t)})}function of(e,t,r){return{instance:e,listener:t,currentTarget:r}}function O0(e,t){for(var r=t+"Capture",n=[];e!==null;){var i=e,a=i.stateNode;i.tag===5&&a!==null&&(i=a,a=Zc(e,r),a!=null&&n.unshift(of(e,a,i)),a=Zc(e,t),a!=null&&n.push(of(e,a,i))),e=e.return}return n}function Pl(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function pv(e,t,r,n,i){for(var a=t._reactName,s=[];r!==null&&r!==n;){var o=r,l=o.alternate,u=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&u!==null&&(o=u,i?(l=Zc(r,a),l!=null&&s.unshift(of(r,l,o))):i||(l=Zc(r,a),l!=null&&s.push(of(r,l,o)))),r=r.return}s.length!==0&&e.push({event:t,listeners:s})}var Cb=/\r\n?/g,Lb=/\u0000|\uFFFD/g;function gv(e){return(typeof e=="string"?e:""+e).replace(Cb,`
`).replace(Lb,"")}function Uh(e,t,r){if(t=gv(t),gv(e)!==t&&r)throw Error(We(425))}function F0(){}var Kp=null,Yp=null;function Xp(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Jp=typeof setTimeout=="function"?setTimeout:void 0,Pb=typeof clearTimeout=="function"?clearTimeout:void 0,mv=typeof Promise=="function"?Promise:void 0,Ob=typeof queueMicrotask=="function"?queueMicrotask:typeof mv<"u"?function(e){return mv.resolve(null).then(e).catch(Fb)}:Jp;function Fb(e){setTimeout(function(){throw e})}function q1(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&i.nodeType===8)if(r=i.data,r==="/$"){if(n===0){e.removeChild(i),rf(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=i}while(r);rf(t)}function Qs(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function vv(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var Lu=Math.random().toString(36).slice(2),Da="__reactFiber$"+Lu,lf="__reactProps$"+Lu,fs="__reactContainer$"+Lu,Qp="__reactEvents$"+Lu,Rb="__reactListeners$"+Lu,Ib="__reactHandles$"+Lu;function Io(e){var t=e[Da];if(t)return t;for(var r=e.parentNode;r;){if(t=r[fs]||r[Da]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=vv(e);e!==null;){if(r=e[Da])return r;e=vv(e)}return t}e=r,r=e.parentNode}return null}function Rf(e){return e=e[Da]||e[fs],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function eu(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(We(33))}function wd(e){return e[lf]||null}var Zp=[],tu=-1;function ho(e){return{current:e}}function gr(e){0>tu||(e.current=Zp[tu],Zp[tu]=null,tu--)}function fr(e,t){tu++,Zp[tu]=e.current,e.current=t}var ao={},jn=ho(ao),ni=ho(!1),Go=ao;function _u(e,t){var r=e.type.contextTypes;if(!r)return ao;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i={},a;for(a in r)i[a]=t[a];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function ii(e){return e=e.childContextTypes,e!=null}function R0(){gr(ni),gr(jn)}function yv(e,t,r){if(jn.current!==ao)throw Error(We(168));fr(jn,t),fr(ni,r)}function Dw(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var i in n)if(!(i in t))throw Error(We(108,wS(e)||"Unknown",i));return _r({},r,n)}function I0(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ao,Go=jn.current,fr(jn,e),fr(ni,ni.current),!0}function wv(e,t,r){var n=e.stateNode;if(!n)throw Error(We(169));r?(e=Dw(e,t,Go),n.__reactInternalMemoizedMergedChildContext=e,gr(ni),gr(jn),fr(jn,e)):gr(ni),fr(ni,r)}var ns=null,xd=!1,$1=!1;function jw(e){ns===null?ns=[e]:ns.push(e)}function Db(e){xd=!0,jw(e)}function po(){if(!$1&&ns!==null){$1=!0;var e=0,t=Zt;try{var r=ns;for(Zt=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}ns=null,xd=!1}catch(i){throw ns!==null&&(ns=ns.slice(e+1)),lw(r2,po),i}finally{Zt=t,$1=!1}}return null}var ru=[],nu=0,D0=null,j0=0,Wi=[],qi=0,Ko=null,is=1,as="";function No(e,t){ru[nu++]=j0,ru[nu++]=D0,D0=e,j0=t}function Mw(e,t,r){Wi[qi++]=is,Wi[qi++]=as,Wi[qi++]=Ko,Ko=e;var n=is;e=as;var i=32-ya(n)-1;n&=~(1<<i),r+=1;var a=32-ya(t)+i;if(30<a){var s=i-i%5;a=(n&(1<<s)-1).toString(32),n>>=s,i-=s,is=1<<32-ya(t)+i|r<<i|n,as=a+e}else is=1<<a|r<<i|n,as=e}function f2(e){e.return!==null&&(No(e,1),Mw(e,1,0))}function h2(e){for(;e===D0;)D0=ru[--nu],ru[nu]=null,j0=ru[--nu],ru[nu]=null;for(;e===Ko;)Ko=Wi[--qi],Wi[qi]=null,as=Wi[--qi],Wi[qi]=null,is=Wi[--qi],Wi[qi]=null}var Ti=null,Ei=null,vr=!1,ga=null;function Bw(e,t){var r=$i(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function xv(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Ti=e,Ei=Qs(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Ti=e,Ei=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Ko!==null?{id:is,overflow:as}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=$i(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,Ti=e,Ei=null,!0):!1;default:return!1}}function eg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function tg(e){if(vr){var t=Ei;if(t){var r=t;if(!xv(e,t)){if(eg(e))throw Error(We(418));t=Qs(r.nextSibling);var n=Ti;t&&xv(e,t)?Bw(n,r):(e.flags=e.flags&-4097|2,vr=!1,Ti=e)}}else{if(eg(e))throw Error(We(418));e.flags=e.flags&-4097|2,vr=!1,Ti=e}}}function _v(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ti=e}function zh(e){if(e!==Ti)return!1;if(!vr)return _v(e),vr=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Xp(e.type,e.memoizedProps)),t&&(t=Ei)){if(eg(e))throw Uw(),Error(We(418));for(;t;)Bw(e,t),t=Qs(t.nextSibling)}if(_v(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(We(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){Ei=Qs(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}Ei=null}}else Ei=Ti?Qs(e.stateNode.nextSibling):null;return!0}function Uw(){for(var e=Ei;e;)e=Qs(e.nextSibling)}function Su(){Ei=Ti=null,vr=!1}function d2(e){ga===null?ga=[e]:ga.push(e)}var jb=ms.ReactCurrentBatchConfig;function mc(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(We(309));var n=r.stateNode}if(!n)throw Error(We(147,e));var i=n,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(s){var o=i.refs;s===null?delete o[a]:o[a]=s},t._stringRef=a,t)}if(typeof e!="string")throw Error(We(284));if(!r._owner)throw Error(We(290,e))}return e}function Hh(e,t){throw e=Object.prototype.toString.call(t),Error(We(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Sv(e){var t=e._init;return t(e._payload)}function zw(e){function t(y,w){if(e){var x=y.deletions;x===null?(y.deletions=[w],y.flags|=16):x.push(w)}}function r(y,w){if(!e)return null;for(;w!==null;)t(y,w),w=w.sibling;return null}function n(y,w){for(y=new Map;w!==null;)w.key!==null?y.set(w.key,w):y.set(w.index,w),w=w.sibling;return y}function i(y,w){return y=ro(y,w),y.index=0,y.sibling=null,y}function a(y,w,x){return y.index=x,e?(x=y.alternate,x!==null?(x=x.index,x<w?(y.flags|=2,w):x):(y.flags|=2,w)):(y.flags|=1048576,w)}function s(y){return e&&y.alternate===null&&(y.flags|=2),y}function o(y,w,x,A){return w===null||w.tag!==6?(w=Q1(x,y.mode,A),w.return=y,w):(w=i(w,x),w.return=y,w)}function l(y,w,x,A){var R=x.type;return R===Xl?f(y,w,x.props.children,A,x.key):w!==null&&(w.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===js&&Sv(R)===w.type)?(A=i(w,x.props),A.ref=mc(y,w,x),A.return=y,A):(A=E0(x.type,x.key,x.props,null,y.mode,A),A.ref=mc(y,w,x),A.return=y,A)}function u(y,w,x,A){return w===null||w.tag!==4||w.stateNode.containerInfo!==x.containerInfo||w.stateNode.implementation!==x.implementation?(w=Z1(x,y.mode,A),w.return=y,w):(w=i(w,x.children||[]),w.return=y,w)}function f(y,w,x,A,R){return w===null||w.tag!==7?(w=zo(x,y.mode,A,R),w.return=y,w):(w=i(w,x),w.return=y,w)}function d(y,w,x){if(typeof w=="string"&&w!==""||typeof w=="number")return w=Q1(""+w,y.mode,x),w.return=y,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Ph:return x=E0(w.type,w.key,w.props,null,y.mode,x),x.ref=mc(y,null,w),x.return=y,x;case Yl:return w=Z1(w,y.mode,x),w.return=y,w;case js:var A=w._init;return d(y,A(w._payload),x)}if(Ec(w)||fc(w))return w=zo(w,y.mode,x,null),w.return=y,w;Hh(y,w)}return null}function p(y,w,x,A){var R=w!==null?w.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return R!==null?null:o(y,w,""+x,A);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Ph:return x.key===R?l(y,w,x,A):null;case Yl:return x.key===R?u(y,w,x,A):null;case js:return R=x._init,p(y,w,R(x._payload),A)}if(Ec(x)||fc(x))return R!==null?null:f(y,w,x,A,null);Hh(y,x)}return null}function h(y,w,x,A,R){if(typeof A=="string"&&A!==""||typeof A=="number")return y=y.get(x)||null,o(w,y,""+A,R);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case Ph:return y=y.get(A.key===null?x:A.key)||null,l(w,y,A,R);case Yl:return y=y.get(A.key===null?x:A.key)||null,u(w,y,A,R);case js:var B=A._init;return h(y,w,x,B(A._payload),R)}if(Ec(A)||fc(A))return y=y.get(x)||null,f(w,y,A,R,null);Hh(w,A)}return null}function v(y,w,x,A){for(var R=null,B=null,T=w,L=w=0,P=null;T!==null&&L<x.length;L++){T.index>L?(P=T,T=null):P=T.sibling;var M=p(y,T,x[L],A);if(M===null){T===null&&(T=P);break}e&&T&&M.alternate===null&&t(y,T),w=a(M,w,L),B===null?R=M:B.sibling=M,B=M,T=P}if(L===x.length)return r(y,T),vr&&No(y,L),R;if(T===null){for(;L<x.length;L++)T=d(y,x[L],A),T!==null&&(w=a(T,w,L),B===null?R=T:B.sibling=T,B=T);return vr&&No(y,L),R}for(T=n(y,T);L<x.length;L++)P=h(T,y,L,x[L],A),P!==null&&(e&&P.alternate!==null&&T.delete(P.key===null?L:P.key),w=a(P,w,L),B===null?R=P:B.sibling=P,B=P);return e&&T.forEach(function(N){return t(y,N)}),vr&&No(y,L),R}function m(y,w,x,A){var R=fc(x);if(typeof R!="function")throw Error(We(150));if(x=R.call(x),x==null)throw Error(We(151));for(var B=R=null,T=w,L=w=0,P=null,M=x.next();T!==null&&!M.done;L++,M=x.next()){T.index>L?(P=T,T=null):P=T.sibling;var N=p(y,T,M.value,A);if(N===null){T===null&&(T=P);break}e&&T&&N.alternate===null&&t(y,T),w=a(N,w,L),B===null?R=N:B.sibling=N,B=N,T=P}if(M.done)return r(y,T),vr&&No(y,L),R;if(T===null){for(;!M.done;L++,M=x.next())M=d(y,M.value,A),M!==null&&(w=a(M,w,L),B===null?R=M:B.sibling=M,B=M);return vr&&No(y,L),R}for(T=n(y,T);!M.done;L++,M=x.next())M=h(T,y,L,M.value,A),M!==null&&(e&&M.alternate!==null&&T.delete(M.key===null?L:M.key),w=a(M,w,L),B===null?R=M:B.sibling=M,B=M);return e&&T.forEach(function(C){return t(y,C)}),vr&&No(y,L),R}function S(y,w,x,A){if(typeof x=="object"&&x!==null&&x.type===Xl&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Ph:e:{for(var R=x.key,B=w;B!==null;){if(B.key===R){if(R=x.type,R===Xl){if(B.tag===7){r(y,B.sibling),w=i(B,x.props.children),w.return=y,y=w;break e}}else if(B.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===js&&Sv(R)===B.type){r(y,B.sibling),w=i(B,x.props),w.ref=mc(y,B,x),w.return=y,y=w;break e}r(y,B);break}else t(y,B);B=B.sibling}x.type===Xl?(w=zo(x.props.children,y.mode,A,x.key),w.return=y,y=w):(A=E0(x.type,x.key,x.props,null,y.mode,A),A.ref=mc(y,w,x),A.return=y,y=A)}return s(y);case Yl:e:{for(B=x.key;w!==null;){if(w.key===B)if(w.tag===4&&w.stateNode.containerInfo===x.containerInfo&&w.stateNode.implementation===x.implementation){r(y,w.sibling),w=i(w,x.children||[]),w.return=y,y=w;break e}else{r(y,w);break}else t(y,w);w=w.sibling}w=Z1(x,y.mode,A),w.return=y,y=w}return s(y);case js:return B=x._init,S(y,w,B(x._payload),A)}if(Ec(x))return v(y,w,x,A);if(fc(x))return m(y,w,x,A);Hh(y,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,w!==null&&w.tag===6?(r(y,w.sibling),w=i(w,x),w.return=y,y=w):(r(y,w),w=Q1(x,y.mode,A),w.return=y,y=w),s(y)):r(y,w)}return S}var bu=zw(!0),Hw=zw(!1),M0=ho(null),B0=null,iu=null,p2=null;function g2(){p2=iu=B0=null}function m2(e){var t=M0.current;gr(M0),e._currentValue=t}function rg(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function du(e,t){B0=e,p2=iu=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(ri=!0),e.firstContext=null)}function Gi(e){var t=e._currentValue;if(p2!==e)if(e={context:e,memoizedValue:t,next:null},iu===null){if(B0===null)throw Error(We(308));iu=e,B0.dependencies={lanes:0,firstContext:e}}else iu=iu.next=e;return t}var Do=null;function v2(e){Do===null?Do=[e]:Do.push(e)}function Ww(e,t,r,n){var i=t.interleaved;return i===null?(r.next=r,v2(t)):(r.next=i.next,i.next=r),t.interleaved=r,hs(e,n)}function hs(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var Ms=!1;function y2(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function qw(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ss(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Zs(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,Ut&2){var i=n.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),n.pending=t,hs(e,r)}return i=n.interleaved,i===null?(t.next=t,v2(n)):(t.next=i.next,i.next=t),n.interleaved=t,hs(e,r)}function y0(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,n2(e,r)}}function bv(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var i=null,a=null;if(r=r.firstBaseUpdate,r!==null){do{var s={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};a===null?i=a=s:a=a.next=s,r=r.next}while(r!==null);a===null?i=a=t:a=a.next=t}else i=a=t;r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:a,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function U0(e,t,r,n){var i=e.updateQueue;Ms=!1;var a=i.firstBaseUpdate,s=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,u=l.next;l.next=null,s===null?a=u:s.next=u,s=l;var f=e.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==s&&(o===null?f.firstBaseUpdate=u:o.next=u,f.lastBaseUpdate=l))}if(a!==null){var d=i.baseState;s=0,f=u=l=null,o=a;do{var p=o.lane,h=o.eventTime;if((n&p)===p){f!==null&&(f=f.next={eventTime:h,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var v=e,m=o;switch(p=t,h=r,m.tag){case 1:if(v=m.payload,typeof v=="function"){d=v.call(h,d,p);break e}d=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=m.payload,p=typeof v=="function"?v.call(h,d,p):v,p==null)break e;d=_r({},d,p);break e;case 2:Ms=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,p=i.effects,p===null?i.effects=[o]:p.push(o))}else h={eventTime:h,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(u=f=h,l=d):f=f.next=h,s|=p;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;p=o,o=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(!0);if(f===null&&(l=d),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=f,t=i.shared.interleaved,t!==null){i=t;do s|=i.lane,i=i.next;while(i!==t)}else a===null&&(i.shared.lanes=0);Xo|=s,e.lanes=s,e.memoizedState=d}}function Ev(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(i!==null){if(n.callback=null,n=r,typeof i!="function")throw Error(We(191,i));i.call(n)}}}var If={},Ba=ho(If),uf=ho(If),cf=ho(If);function jo(e){if(e===If)throw Error(We(174));return e}function w2(e,t){switch(fr(cf,t),fr(uf,e),fr(Ba,If),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Dp(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Dp(t,e)}gr(Ba),fr(Ba,t)}function Eu(){gr(Ba),gr(uf),gr(cf)}function $w(e){jo(cf.current);var t=jo(Ba.current),r=Dp(t,e.type);t!==r&&(fr(uf,e),fr(Ba,r))}function x2(e){uf.current===e&&(gr(Ba),gr(uf))}var wr=ho(0);function z0(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var V1=[];function _2(){for(var e=0;e<V1.length;e++)V1[e]._workInProgressVersionPrimary=null;V1.length=0}var w0=ms.ReactCurrentDispatcher,G1=ms.ReactCurrentBatchConfig,Yo=0,xr=null,Qr=null,an=null,H0=!1,Rc=!1,ff=0,Mb=0;function kn(){throw Error(We(321))}function S2(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!_a(e[r],t[r]))return!1;return!0}function b2(e,t,r,n,i,a){if(Yo=a,xr=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,w0.current=e===null||e.memoizedState===null?Hb:Wb,e=r(n,i),Rc){a=0;do{if(Rc=!1,ff=0,25<=a)throw Error(We(301));a+=1,an=Qr=null,t.updateQueue=null,w0.current=qb,e=r(n,i)}while(Rc)}if(w0.current=W0,t=Qr!==null&&Qr.next!==null,Yo=0,an=Qr=xr=null,H0=!1,t)throw Error(We(300));return e}function E2(){var e=ff!==0;return ff=0,e}function Ia(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return an===null?xr.memoizedState=an=e:an=an.next=e,an}function Ki(){if(Qr===null){var e=xr.alternate;e=e!==null?e.memoizedState:null}else e=Qr.next;var t=an===null?xr.memoizedState:an.next;if(t!==null)an=t,Qr=e;else{if(e===null)throw Error(We(310));Qr=e,e={memoizedState:Qr.memoizedState,baseState:Qr.baseState,baseQueue:Qr.baseQueue,queue:Qr.queue,next:null},an===null?xr.memoizedState=an=e:an=an.next=e}return an}function hf(e,t){return typeof t=="function"?t(e):t}function K1(e){var t=Ki(),r=t.queue;if(r===null)throw Error(We(311));r.lastRenderedReducer=e;var n=Qr,i=n.baseQueue,a=r.pending;if(a!==null){if(i!==null){var s=i.next;i.next=a.next,a.next=s}n.baseQueue=i=a,r.pending=null}if(i!==null){a=i.next,n=n.baseState;var o=s=null,l=null,u=a;do{var f=u.lane;if((Yo&f)===f)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),n=u.hasEagerState?u.eagerState:e(n,u.action);else{var d={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=d,s=n):l=l.next=d,xr.lanes|=f,Xo|=f}u=u.next}while(u!==null&&u!==a);l===null?s=n:l.next=o,_a(n,t.memoizedState)||(ri=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){i=e;do a=i.lane,xr.lanes|=a,Xo|=a,i=i.next;while(i!==e)}else i===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Y1(e){var t=Ki(),r=t.queue;if(r===null)throw Error(We(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,a=t.memoizedState;if(i!==null){r.pending=null;var s=i=i.next;do a=e(a,s.action),s=s.next;while(s!==i);_a(a,t.memoizedState)||(ri=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function Vw(){}function Gw(e,t){var r=xr,n=Ki(),i=t(),a=!_a(n.memoizedState,i);if(a&&(n.memoizedState=i,ri=!0),n=n.queue,A2(Xw.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||an!==null&&an.memoizedState.tag&1){if(r.flags|=2048,df(9,Yw.bind(null,r,n,i,t),void 0,null),un===null)throw Error(We(349));Yo&30||Kw(r,t,i)}return i}function Kw(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=xr.updateQueue,t===null?(t={lastEffect:null,stores:null},xr.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function Yw(e,t,r,n){t.value=r,t.getSnapshot=n,Jw(t)&&Qw(e)}function Xw(e,t,r){return r(function(){Jw(t)&&Qw(e)})}function Jw(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!_a(e,r)}catch{return!0}}function Qw(e){var t=hs(e,1);t!==null&&wa(t,e,1,-1)}function Av(e){var t=Ia();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:hf,lastRenderedState:e},t.queue=e,e=e.dispatch=zb.bind(null,xr,e),[t.memoizedState,e]}function df(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=xr.updateQueue,t===null?(t={lastEffect:null,stores:null},xr.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function Zw(){return Ki().memoizedState}function x0(e,t,r,n){var i=Ia();xr.flags|=e,i.memoizedState=df(1|t,r,void 0,n===void 0?null:n)}function _d(e,t,r,n){var i=Ki();n=n===void 0?null:n;var a=void 0;if(Qr!==null){var s=Qr.memoizedState;if(a=s.destroy,n!==null&&S2(n,s.deps)){i.memoizedState=df(t,r,a,n);return}}xr.flags|=e,i.memoizedState=df(1|t,r,a,n)}function Tv(e,t){return x0(8390656,8,e,t)}function A2(e,t){return _d(2048,8,e,t)}function ex(e,t){return _d(4,2,e,t)}function tx(e,t){return _d(4,4,e,t)}function rx(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function nx(e,t,r){return r=r!=null?r.concat([e]):null,_d(4,4,rx.bind(null,t,e),r)}function T2(){}function ix(e,t){var r=Ki();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&S2(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function ax(e,t){var r=Ki();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&S2(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function sx(e,t,r){return Yo&21?(_a(r,t)||(r=fw(),xr.lanes|=r,Xo|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,ri=!0),e.memoizedState=r)}function Bb(e,t){var r=Zt;Zt=r!==0&&4>r?r:4,e(!0);var n=G1.transition;G1.transition={};try{e(!1),t()}finally{Zt=r,G1.transition=n}}function ox(){return Ki().memoizedState}function Ub(e,t,r){var n=to(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},lx(e))ux(t,r);else if(r=Ww(e,t,r,n),r!==null){var i=qn();wa(r,e,n,i),cx(r,t,n)}}function zb(e,t,r){var n=to(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(lx(e))ux(t,i);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var s=t.lastRenderedState,o=a(s,r);if(i.hasEagerState=!0,i.eagerState=o,_a(o,s)){var l=t.interleaved;l===null?(i.next=i,v2(t)):(i.next=l.next,l.next=i),t.interleaved=i;return}}catch{}finally{}r=Ww(e,t,i,n),r!==null&&(i=qn(),wa(r,e,n,i),cx(r,t,n))}}function lx(e){var t=e.alternate;return e===xr||t!==null&&t===xr}function ux(e,t){Rc=H0=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function cx(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,n2(e,r)}}var W0={readContext:Gi,useCallback:kn,useContext:kn,useEffect:kn,useImperativeHandle:kn,useInsertionEffect:kn,useLayoutEffect:kn,useMemo:kn,useReducer:kn,useRef:kn,useState:kn,useDebugValue:kn,useDeferredValue:kn,useTransition:kn,useMutableSource:kn,useSyncExternalStore:kn,useId:kn,unstable_isNewReconciler:!1},Hb={readContext:Gi,useCallback:function(e,t){return Ia().memoizedState=[e,t===void 0?null:t],e},useContext:Gi,useEffect:Tv,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,x0(4194308,4,rx.bind(null,t,e),r)},useLayoutEffect:function(e,t){return x0(4194308,4,e,t)},useInsertionEffect:function(e,t){return x0(4,2,e,t)},useMemo:function(e,t){var r=Ia();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Ia();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Ub.bind(null,xr,e),[n.memoizedState,e]},useRef:function(e){var t=Ia();return e={current:e},t.memoizedState=e},useState:Av,useDebugValue:T2,useDeferredValue:function(e){return Ia().memoizedState=e},useTransition:function(){var e=Av(!1),t=e[0];return e=Bb.bind(null,e[1]),Ia().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=xr,i=Ia();if(vr){if(r===void 0)throw Error(We(407));r=r()}else{if(r=t(),un===null)throw Error(We(349));Yo&30||Kw(n,t,r)}i.memoizedState=r;var a={value:r,getSnapshot:t};return i.queue=a,Tv(Xw.bind(null,n,a,e),[e]),n.flags|=2048,df(9,Yw.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=Ia(),t=un.identifierPrefix;if(vr){var r=as,n=is;r=(n&~(1<<32-ya(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=ff++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Mb++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Wb={readContext:Gi,useCallback:ix,useContext:Gi,useEffect:A2,useImperativeHandle:nx,useInsertionEffect:ex,useLayoutEffect:tx,useMemo:ax,useReducer:K1,useRef:Zw,useState:function(){return K1(hf)},useDebugValue:T2,useDeferredValue:function(e){var t=Ki();return sx(t,Qr.memoizedState,e)},useTransition:function(){var e=K1(hf)[0],t=Ki().memoizedState;return[e,t]},useMutableSource:Vw,useSyncExternalStore:Gw,useId:ox,unstable_isNewReconciler:!1},qb={readContext:Gi,useCallback:ix,useContext:Gi,useEffect:A2,useImperativeHandle:nx,useInsertionEffect:ex,useLayoutEffect:tx,useMemo:ax,useReducer:Y1,useRef:Zw,useState:function(){return Y1(hf)},useDebugValue:T2,useDeferredValue:function(e){var t=Ki();return Qr===null?t.memoizedState=e:sx(t,Qr.memoizedState,e)},useTransition:function(){var e=Y1(hf)[0],t=Ki().memoizedState;return[e,t]},useMutableSource:Vw,useSyncExternalStore:Gw,useId:ox,unstable_isNewReconciler:!1};function ca(e,t){if(e&&e.defaultProps){t=_r({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function ng(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:_r({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var Sd={isMounted:function(e){return(e=e._reactInternals)?rl(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=qn(),i=to(e),a=ss(n,i);a.payload=t,r!=null&&(a.callback=r),t=Zs(e,a,i),t!==null&&(wa(t,e,i,n),y0(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=qn(),i=to(e),a=ss(n,i);a.tag=1,a.payload=t,r!=null&&(a.callback=r),t=Zs(e,a,i),t!==null&&(wa(t,e,i,n),y0(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=qn(),n=to(e),i=ss(r,n);i.tag=2,t!=null&&(i.callback=t),t=Zs(e,i,n),t!==null&&(wa(t,e,n,r),y0(t,e,n))}};function kv(e,t,r,n,i,a,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,a,s):t.prototype&&t.prototype.isPureReactComponent?!af(r,n)||!af(i,a):!0}function fx(e,t,r){var n=!1,i=ao,a=t.contextType;return typeof a=="object"&&a!==null?a=Gi(a):(i=ii(t)?Go:jn.current,n=t.contextTypes,a=(n=n!=null)?_u(e,i):ao),t=new t(r,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Sd,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=a),t}function Nv(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&Sd.enqueueReplaceState(t,t.state,null)}function ig(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs={},y2(e);var a=t.contextType;typeof a=="object"&&a!==null?i.context=Gi(a):(a=ii(t)?Go:jn.current,i.context=_u(e,a)),i.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(ng(e,t,a,r),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&Sd.enqueueReplaceState(i,i.state,null),U0(e,r,i,n),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Au(e,t){try{var r="",n=t;do r+=yS(n),n=n.return;while(n);var i=r}catch(a){i=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:i,digest:null}}function X1(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function ag(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var $b=typeof WeakMap=="function"?WeakMap:Map;function hx(e,t,r){r=ss(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){$0||($0=!0,gg=n),ag(e,t)},r}function dx(e,t,r){r=ss(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){ag(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(r.callback=function(){ag(e,t),typeof n!="function"&&(eo===null?eo=new Set([this]):eo.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),r}function Cv(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new $b;var i=new Set;n.set(t,i)}else i=n.get(t),i===void 0&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=a6.bind(null,e,t,r),t.then(e,e))}function Lv(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Pv(e,t,r,n,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=ss(-1,1),t.tag=2,Zs(r,t,1))),r.lanes|=1),e)}var Vb=ms.ReactCurrentOwner,ri=!1;function zn(e,t,r,n){t.child=e===null?Hw(t,null,r,n):bu(t,e.child,r,n)}function Ov(e,t,r,n,i){r=r.render;var a=t.ref;return du(t,i),n=b2(e,t,r,n,a,i),r=E2(),e!==null&&!ri?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,ds(e,t,i)):(vr&&r&&f2(t),t.flags|=1,zn(e,t,n,i),t.child)}function Fv(e,t,r,n,i){if(e===null){var a=r.type;return typeof a=="function"&&!R2(a)&&a.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=a,px(e,t,a,n,i)):(e=E0(r.type,null,n,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&i)){var s=a.memoizedProps;if(r=r.compare,r=r!==null?r:af,r(s,n)&&e.ref===t.ref)return ds(e,t,i)}return t.flags|=1,e=ro(a,n),e.ref=t.ref,e.return=t,t.child=e}function px(e,t,r,n,i){if(e!==null){var a=e.memoizedProps;if(af(a,n)&&e.ref===t.ref)if(ri=!1,t.pendingProps=n=a,(e.lanes&i)!==0)e.flags&131072&&(ri=!0);else return t.lanes=e.lanes,ds(e,t,i)}return sg(e,t,r,n,i)}function gx(e,t,r){var n=t.pendingProps,i=n.children,a=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},fr(su,wi),wi|=r;else{if(!(r&1073741824))return e=a!==null?a.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,fr(su,wi),wi|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=a!==null?a.baseLanes:r,fr(su,wi),wi|=n}else a!==null?(n=a.baseLanes|r,t.memoizedState=null):n=r,fr(su,wi),wi|=n;return zn(e,t,i,r),t.child}function mx(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function sg(e,t,r,n,i){var a=ii(r)?Go:jn.current;return a=_u(t,a),du(t,i),r=b2(e,t,r,n,a,i),n=E2(),e!==null&&!ri?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,ds(e,t,i)):(vr&&n&&f2(t),t.flags|=1,zn(e,t,r,i),t.child)}function Rv(e,t,r,n,i){if(ii(r)){var a=!0;I0(t)}else a=!1;if(du(t,i),t.stateNode===null)_0(e,t),fx(t,r,n),ig(t,r,n,i),n=!0;else if(e===null){var s=t.stateNode,o=t.memoizedProps;s.props=o;var l=s.context,u=r.contextType;typeof u=="object"&&u!==null?u=Gi(u):(u=ii(r)?Go:jn.current,u=_u(t,u));var f=r.getDerivedStateFromProps,d=typeof f=="function"||typeof s.getSnapshotBeforeUpdate=="function";d||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==n||l!==u)&&Nv(t,s,n,u),Ms=!1;var p=t.memoizedState;s.state=p,U0(t,n,s,i),l=t.memoizedState,o!==n||p!==l||ni.current||Ms?(typeof f=="function"&&(ng(t,r,f,n),l=t.memoizedState),(o=Ms||kv(t,r,o,n,p,l,u))?(d||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),s.props=n,s.state=l,s.context=u,n=o):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{s=t.stateNode,qw(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:ca(t.type,o),s.props=u,d=t.pendingProps,p=s.context,l=r.contextType,typeof l=="object"&&l!==null?l=Gi(l):(l=ii(r)?Go:jn.current,l=_u(t,l));var h=r.getDerivedStateFromProps;(f=typeof h=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(o!==d||p!==l)&&Nv(t,s,n,l),Ms=!1,p=t.memoizedState,s.state=p,U0(t,n,s,i);var v=t.memoizedState;o!==d||p!==v||ni.current||Ms?(typeof h=="function"&&(ng(t,r,h,n),v=t.memoizedState),(u=Ms||kv(t,r,u,n,p,v,l)||!1)?(f||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(n,v,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(n,v,l)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=v),s.props=n,s.state=v,s.context=l,n=u):(typeof s.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),n=!1)}return og(e,t,r,n,a,i)}function og(e,t,r,n,i,a){mx(e,t);var s=(t.flags&128)!==0;if(!n&&!s)return i&&wv(t,r,!1),ds(e,t,a);n=t.stateNode,Vb.current=t;var o=s&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&s?(t.child=bu(t,e.child,null,a),t.child=bu(t,null,o,a)):zn(e,t,o,a),t.memoizedState=n.state,i&&wv(t,r,!0),t.child}function vx(e){var t=e.stateNode;t.pendingContext?yv(e,t.pendingContext,t.pendingContext!==t.context):t.context&&yv(e,t.context,!1),w2(e,t.containerInfo)}function Iv(e,t,r,n,i){return Su(),d2(i),t.flags|=256,zn(e,t,r,n),t.child}var lg={dehydrated:null,treeContext:null,retryLane:0};function ug(e){return{baseLanes:e,cachePool:null,transitions:null}}function yx(e,t,r){var n=t.pendingProps,i=wr.current,a=!1,s=(t.flags&128)!==0,o;if((o=s)||(o=e!==null&&e.memoizedState===null?!1:(i&2)!==0),o?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),fr(wr,i&1),e===null)return tg(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=n.children,e=n.fallback,a?(n=t.mode,a=t.child,s={mode:"hidden",children:s},!(n&1)&&a!==null?(a.childLanes=0,a.pendingProps=s):a=Ad(s,n,0,null),e=zo(e,n,r,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=ug(r),t.memoizedState=lg,e):k2(t,s));if(i=e.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return Gb(e,t,s,n,o,i,r);if(a){a=n.fallback,s=t.mode,i=e.child,o=i.sibling;var l={mode:"hidden",children:n.children};return!(s&1)&&t.child!==i?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=ro(i,l),n.subtreeFlags=i.subtreeFlags&14680064),o!==null?a=ro(o,a):(a=zo(a,s,r,null),a.flags|=2),a.return=t,n.return=t,n.sibling=a,t.child=n,n=a,a=t.child,s=e.child.memoizedState,s=s===null?ug(r):{baseLanes:s.baseLanes|r,cachePool:null,transitions:s.transitions},a.memoizedState=s,a.childLanes=e.childLanes&~r,t.memoizedState=lg,n}return a=e.child,e=a.sibling,n=ro(a,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function k2(e,t){return t=Ad({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Wh(e,t,r,n){return n!==null&&d2(n),bu(t,e.child,null,r),e=k2(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Gb(e,t,r,n,i,a,s){if(r)return t.flags&256?(t.flags&=-257,n=X1(Error(We(422))),Wh(e,t,s,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=n.fallback,i=t.mode,n=Ad({mode:"visible",children:n.children},i,0,null),a=zo(a,i,s,null),a.flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,t.mode&1&&bu(t,e.child,null,s),t.child.memoizedState=ug(s),t.memoizedState=lg,a);if(!(t.mode&1))return Wh(e,t,s,null);if(i.data==="$!"){if(n=i.nextSibling&&i.nextSibling.dataset,n)var o=n.dgst;return n=o,a=Error(We(419)),n=X1(a,n,void 0),Wh(e,t,s,n)}if(o=(s&e.childLanes)!==0,ri||o){if(n=un,n!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(n.suspendedLanes|s)?0:i,i!==0&&i!==a.retryLane&&(a.retryLane=i,hs(e,i),wa(n,e,i,-1))}return F2(),n=X1(Error(We(421))),Wh(e,t,s,n)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=s6.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,Ei=Qs(i.nextSibling),Ti=t,vr=!0,ga=null,e!==null&&(Wi[qi++]=is,Wi[qi++]=as,Wi[qi++]=Ko,is=e.id,as=e.overflow,Ko=t),t=k2(t,n.children),t.flags|=4096,t)}function Dv(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),rg(e.return,t,r)}function J1(e,t,r,n,i){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=n,a.tail=r,a.tailMode=i)}function wx(e,t,r){var n=t.pendingProps,i=n.revealOrder,a=n.tail;if(zn(e,t,n.children,r),n=wr.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Dv(e,r,t);else if(e.tag===19)Dv(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(fr(wr,n),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;r!==null;)e=r.alternate,e!==null&&z0(e)===null&&(i=r),r=r.sibling;r=i,r===null?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),J1(t,!1,i,r,a);break;case"backwards":for(r=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&z0(e)===null){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}J1(t,!0,r,null,a);break;case"together":J1(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function _0(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ds(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Xo|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(We(153));if(t.child!==null){for(e=t.child,r=ro(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=ro(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function Kb(e,t,r){switch(t.tag){case 3:vx(t),Su();break;case 5:$w(t);break;case 1:ii(t.type)&&I0(t);break;case 4:w2(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;fr(M0,n._currentValue),n._currentValue=i;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(fr(wr,wr.current&1),t.flags|=128,null):r&t.child.childLanes?yx(e,t,r):(fr(wr,wr.current&1),e=ds(e,t,r),e!==null?e.sibling:null);fr(wr,wr.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return wx(e,t,r);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),fr(wr,wr.current),n)break;return null;case 22:case 23:return t.lanes=0,gx(e,t,r)}return ds(e,t,r)}var xx,cg,_x,Sx;xx=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};cg=function(){};_x=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,jo(Ba.current);var a=null;switch(r){case"input":i=Op(e,i),n=Op(e,n),a=[];break;case"select":i=_r({},i,{value:void 0}),n=_r({},n,{value:void 0}),a=[];break;case"textarea":i=Ip(e,i),n=Ip(e,n),a=[];break;default:typeof i.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=F0)}jp(r,n);var s;r=null;for(u in i)if(!n.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var o=i[u];for(s in o)o.hasOwnProperty(s)&&(r||(r={}),r[s]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Jc.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in n){var l=n[u];if(o=i!=null?i[u]:void 0,n.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(s in o)!o.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(r||(r={}),r[s]="");for(s in l)l.hasOwnProperty(s)&&o[s]!==l[s]&&(r||(r={}),r[s]=l[s])}else r||(a||(a=[]),a.push(u,r)),r=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(a=a||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(a=a||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Jc.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&dr("scroll",e),a||o===l||(a=[])):(a=a||[]).push(u,l))}r&&(a=a||[]).push("style",r);var u=a;(t.updateQueue=u)&&(t.flags|=4)}};Sx=function(e,t,r,n){r!==n&&(t.flags|=4)};function vc(e,t){if(!vr)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Nn(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags&14680064,n|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function Yb(e,t,r){var n=t.pendingProps;switch(h2(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nn(t),null;case 1:return ii(t.type)&&R0(),Nn(t),null;case 3:return n=t.stateNode,Eu(),gr(ni),gr(jn),_2(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(zh(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ga!==null&&(yg(ga),ga=null))),cg(e,t),Nn(t),null;case 5:x2(t);var i=jo(cf.current);if(r=t.type,e!==null&&t.stateNode!=null)_x(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(We(166));return Nn(t),null}if(e=jo(Ba.current),zh(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[Da]=t,n[lf]=a,e=(t.mode&1)!==0,r){case"dialog":dr("cancel",n),dr("close",n);break;case"iframe":case"object":case"embed":dr("load",n);break;case"video":case"audio":for(i=0;i<Tc.length;i++)dr(Tc[i],n);break;case"source":dr("error",n);break;case"img":case"image":case"link":dr("error",n),dr("load",n);break;case"details":dr("toggle",n);break;case"input":$m(n,a),dr("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},dr("invalid",n);break;case"textarea":Gm(n,a),dr("invalid",n)}jp(r,a),i=null;for(var s in a)if(a.hasOwnProperty(s)){var o=a[s];s==="children"?typeof o=="string"?n.textContent!==o&&(a.suppressHydrationWarning!==!0&&Uh(n.textContent,o,e),i=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&Uh(n.textContent,o,e),i=["children",""+o]):Jc.hasOwnProperty(s)&&o!=null&&s==="onScroll"&&dr("scroll",n)}switch(r){case"input":Oh(n),Vm(n,a,!0);break;case"textarea":Oh(n),Km(n);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(n.onclick=F0)}n=i,t.updateQueue=n,n!==null&&(t.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Xy(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=s.createElement(r,{is:n.is}):(e=s.createElement(r),r==="select"&&(s=e,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):e=s.createElementNS(e,r),e[Da]=t,e[lf]=n,xx(e,t,!1,!1),t.stateNode=e;e:{switch(s=Mp(r,n),r){case"dialog":dr("cancel",e),dr("close",e),i=n;break;case"iframe":case"object":case"embed":dr("load",e),i=n;break;case"video":case"audio":for(i=0;i<Tc.length;i++)dr(Tc[i],e);i=n;break;case"source":dr("error",e),i=n;break;case"img":case"image":case"link":dr("error",e),dr("load",e),i=n;break;case"details":dr("toggle",e),i=n;break;case"input":$m(e,n),i=Op(e,n),dr("invalid",e);break;case"option":i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=_r({},n,{value:void 0}),dr("invalid",e);break;case"textarea":Gm(e,n),i=Ip(e,n),dr("invalid",e);break;default:i=n}jp(r,i),o=i;for(a in o)if(o.hasOwnProperty(a)){var l=o[a];a==="style"?Zy(e,l):a==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Jy(e,l)):a==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&Qc(e,l):typeof l=="number"&&Qc(e,""+l):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Jc.hasOwnProperty(a)?l!=null&&a==="onScroll"&&dr("scroll",e):l!=null&&Jg(e,a,l,s))}switch(r){case"input":Oh(e),Vm(e,n,!1);break;case"textarea":Oh(e),Km(e);break;case"option":n.value!=null&&e.setAttribute("value",""+io(n.value));break;case"select":e.multiple=!!n.multiple,a=n.value,a!=null?uu(e,!!n.multiple,a,!1):n.defaultValue!=null&&uu(e,!!n.multiple,n.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=F0)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Nn(t),null;case 6:if(e&&t.stateNode!=null)Sx(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(We(166));if(r=jo(cf.current),jo(Ba.current),zh(t)){if(n=t.stateNode,r=t.memoizedProps,n[Da]=t,(a=n.nodeValue!==r)&&(e=Ti,e!==null))switch(e.tag){case 3:Uh(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Uh(n.nodeValue,r,(e.mode&1)!==0)}a&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[Da]=t,t.stateNode=n}return Nn(t),null;case 13:if(gr(wr),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(vr&&Ei!==null&&t.mode&1&&!(t.flags&128))Uw(),Su(),t.flags|=98560,a=!1;else if(a=zh(t),n!==null&&n.dehydrated!==null){if(e===null){if(!a)throw Error(We(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(We(317));a[Da]=t}else Su(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Nn(t),a=!1}else ga!==null&&(yg(ga),ga=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||wr.current&1?en===0&&(en=3):F2())),t.updateQueue!==null&&(t.flags|=4),Nn(t),null);case 4:return Eu(),cg(e,t),e===null&&sf(t.stateNode.containerInfo),Nn(t),null;case 10:return m2(t.type._context),Nn(t),null;case 17:return ii(t.type)&&R0(),Nn(t),null;case 19:if(gr(wr),a=t.memoizedState,a===null)return Nn(t),null;if(n=(t.flags&128)!==0,s=a.rendering,s===null)if(n)vc(a,!1);else{if(en!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=z0(e),s!==null){for(t.flags|=128,vc(a,!1),n=s.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)a=r,e=n,a.flags&=14680066,s=a.alternate,s===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=s.childLanes,a.lanes=s.lanes,a.child=s.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=s.memoizedProps,a.memoizedState=s.memoizedState,a.updateQueue=s.updateQueue,a.type=s.type,e=s.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return fr(wr,wr.current&1|2),t.child}e=e.sibling}a.tail!==null&&Rr()>Tu&&(t.flags|=128,n=!0,vc(a,!1),t.lanes=4194304)}else{if(!n)if(e=z0(s),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),vc(a,!0),a.tail===null&&a.tailMode==="hidden"&&!s.alternate&&!vr)return Nn(t),null}else 2*Rr()-a.renderingStartTime>Tu&&r!==1073741824&&(t.flags|=128,n=!0,vc(a,!1),t.lanes=4194304);a.isBackwards?(s.sibling=t.child,t.child=s):(r=a.last,r!==null?r.sibling=s:t.child=s,a.last=s)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Rr(),t.sibling=null,r=wr.current,fr(wr,n?r&1|2:r&1),t):(Nn(t),null);case 22:case 23:return O2(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?wi&1073741824&&(Nn(t),t.subtreeFlags&6&&(t.flags|=8192)):Nn(t),null;case 24:return null;case 25:return null}throw Error(We(156,t.tag))}function Xb(e,t){switch(h2(t),t.tag){case 1:return ii(t.type)&&R0(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Eu(),gr(ni),gr(jn),_2(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return x2(t),null;case 13:if(gr(wr),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(We(340));Su()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return gr(wr),null;case 4:return Eu(),null;case 10:return m2(t.type._context),null;case 22:case 23:return O2(),null;case 24:return null;default:return null}}var qh=!1,Fn=!1,Jb=typeof WeakSet=="function"?WeakSet:Set,ot=null;function au(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){kr(e,t,n)}else r.current=null}function fg(e,t,r){try{r()}catch(n){kr(e,t,n)}}var jv=!1;function Qb(e,t){if(Kp=L0,e=kw(),c2(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var i=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch{r=null;break e}var s=0,o=-1,l=-1,u=0,f=0,d=e,p=null;t:for(;;){for(var h;d!==r||i!==0&&d.nodeType!==3||(o=s+i),d!==a||n!==0&&d.nodeType!==3||(l=s+n),d.nodeType===3&&(s+=d.nodeValue.length),(h=d.firstChild)!==null;)p=d,d=h;for(;;){if(d===e)break t;if(p===r&&++u===i&&(o=s),p===a&&++f===n&&(l=s),(h=d.nextSibling)!==null)break;d=p,p=d.parentNode}d=h}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(Yp={focusedElem:e,selectionRange:r},L0=!1,ot=t;ot!==null;)if(t=ot,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ot=e;else for(;ot!==null;){t=ot;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var m=v.memoizedProps,S=v.memoizedState,y=t.stateNode,w=y.getSnapshotBeforeUpdate(t.elementType===t.type?m:ca(t.type,m),S);y.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var x=t.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(We(163))}}catch(A){kr(t,t.return,A)}if(e=t.sibling,e!==null){e.return=t.return,ot=e;break}ot=t.return}return v=jv,jv=!1,v}function Ic(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var i=n=n.next;do{if((i.tag&e)===e){var a=i.destroy;i.destroy=void 0,a!==void 0&&fg(t,r,a)}i=i.next}while(i!==n)}}function bd(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function hg(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function bx(e){var t=e.alternate;t!==null&&(e.alternate=null,bx(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Da],delete t[lf],delete t[Qp],delete t[Rb],delete t[Ib])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Ex(e){return e.tag===5||e.tag===3||e.tag===4}function Mv(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Ex(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function dg(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=F0));else if(n!==4&&(e=e.child,e!==null))for(dg(e,t,r),e=e.sibling;e!==null;)dg(e,t,r),e=e.sibling}function pg(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(pg(e,t,r),e=e.sibling;e!==null;)pg(e,t,r),e=e.sibling}var gn=null,da=!1;function Fs(e,t,r){for(r=r.child;r!==null;)Ax(e,t,r),r=r.sibling}function Ax(e,t,r){if(Ma&&typeof Ma.onCommitFiberUnmount=="function")try{Ma.onCommitFiberUnmount(gd,r)}catch{}switch(r.tag){case 5:Fn||au(r,t);case 6:var n=gn,i=da;gn=null,Fs(e,t,r),gn=n,da=i,gn!==null&&(da?(e=gn,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):gn.removeChild(r.stateNode));break;case 18:gn!==null&&(da?(e=gn,r=r.stateNode,e.nodeType===8?q1(e.parentNode,r):e.nodeType===1&&q1(e,r),rf(e)):q1(gn,r.stateNode));break;case 4:n=gn,i=da,gn=r.stateNode.containerInfo,da=!0,Fs(e,t,r),gn=n,da=i;break;case 0:case 11:case 14:case 15:if(!Fn&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){i=n=n.next;do{var a=i,s=a.destroy;a=a.tag,s!==void 0&&(a&2||a&4)&&fg(r,t,s),i=i.next}while(i!==n)}Fs(e,t,r);break;case 1:if(!Fn&&(au(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){kr(r,t,o)}Fs(e,t,r);break;case 21:Fs(e,t,r);break;case 22:r.mode&1?(Fn=(n=Fn)||r.memoizedState!==null,Fs(e,t,r),Fn=n):Fs(e,t,r);break;default:Fs(e,t,r)}}function Bv(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new Jb),t.forEach(function(n){var i=o6.bind(null,e,n);r.has(n)||(r.add(n),n.then(i,i))})}}function ia(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var i=r[n];try{var a=e,s=t,o=s;e:for(;o!==null;){switch(o.tag){case 5:gn=o.stateNode,da=!1;break e;case 3:gn=o.stateNode.containerInfo,da=!0;break e;case 4:gn=o.stateNode.containerInfo,da=!0;break e}o=o.return}if(gn===null)throw Error(We(160));Ax(a,s,i),gn=null,da=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){kr(i,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Tx(t,e),t=t.sibling}function Tx(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ia(t,e),Pa(e),n&4){try{Ic(3,e,e.return),bd(3,e)}catch(m){kr(e,e.return,m)}try{Ic(5,e,e.return)}catch(m){kr(e,e.return,m)}}break;case 1:ia(t,e),Pa(e),n&512&&r!==null&&au(r,r.return);break;case 5:if(ia(t,e),Pa(e),n&512&&r!==null&&au(r,r.return),e.flags&32){var i=e.stateNode;try{Qc(i,"")}catch(m){kr(e,e.return,m)}}if(n&4&&(i=e.stateNode,i!=null)){var a=e.memoizedProps,s=r!==null?r.memoizedProps:a,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&Ky(i,a),Mp(o,s);var u=Mp(o,a);for(s=0;s<l.length;s+=2){var f=l[s],d=l[s+1];f==="style"?Zy(i,d):f==="dangerouslySetInnerHTML"?Jy(i,d):f==="children"?Qc(i,d):Jg(i,f,d,u)}switch(o){case"input":Fp(i,a);break;case"textarea":Yy(i,a);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var h=a.value;h!=null?uu(i,!!a.multiple,h,!1):p!==!!a.multiple&&(a.defaultValue!=null?uu(i,!!a.multiple,a.defaultValue,!0):uu(i,!!a.multiple,a.multiple?[]:"",!1))}i[lf]=a}catch(m){kr(e,e.return,m)}}break;case 6:if(ia(t,e),Pa(e),n&4){if(e.stateNode===null)throw Error(We(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(m){kr(e,e.return,m)}}break;case 3:if(ia(t,e),Pa(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{rf(t.containerInfo)}catch(m){kr(e,e.return,m)}break;case 4:ia(t,e),Pa(e);break;case 13:ia(t,e),Pa(e),i=e.child,i.flags&8192&&(a=i.memoizedState!==null,i.stateNode.isHidden=a,!a||i.alternate!==null&&i.alternate.memoizedState!==null||(L2=Rr())),n&4&&Bv(e);break;case 22:if(f=r!==null&&r.memoizedState!==null,e.mode&1?(Fn=(u=Fn)||f,ia(t,e),Fn=u):ia(t,e),Pa(e),n&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!f&&e.mode&1)for(ot=e,f=e.child;f!==null;){for(d=ot=f;ot!==null;){switch(p=ot,h=p.child,p.tag){case 0:case 11:case 14:case 15:Ic(4,p,p.return);break;case 1:au(p,p.return);var v=p.stateNode;if(typeof v.componentWillUnmount=="function"){n=p,r=p.return;try{t=n,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(m){kr(n,r,m)}}break;case 5:au(p,p.return);break;case 22:if(p.memoizedState!==null){zv(d);continue}}h!==null?(h.return=p,ot=h):zv(d)}f=f.sibling}e:for(f=null,d=e;;){if(d.tag===5){if(f===null){f=d;try{i=d.stateNode,u?(a=i.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=d.stateNode,l=d.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=Qy("display",s))}catch(m){kr(e,e.return,m)}}}else if(d.tag===6){if(f===null)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(m){kr(e,e.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;f===d&&(f=null),d=d.return}f===d&&(f=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ia(t,e),Pa(e),n&4&&Bv(e);break;case 21:break;default:ia(t,e),Pa(e)}}function Pa(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(Ex(r)){var n=r;break e}r=r.return}throw Error(We(160))}switch(n.tag){case 5:var i=n.stateNode;n.flags&32&&(Qc(i,""),n.flags&=-33);var a=Mv(e);pg(e,a,i);break;case 3:case 4:var s=n.stateNode.containerInfo,o=Mv(e);dg(e,o,s);break;default:throw Error(We(161))}}catch(l){kr(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Zb(e,t,r){ot=e,kx(e)}function kx(e,t,r){for(var n=(e.mode&1)!==0;ot!==null;){var i=ot,a=i.child;if(i.tag===22&&n){var s=i.memoizedState!==null||qh;if(!s){var o=i.alternate,l=o!==null&&o.memoizedState!==null||Fn;o=qh;var u=Fn;if(qh=s,(Fn=l)&&!u)for(ot=i;ot!==null;)s=ot,l=s.child,s.tag===22&&s.memoizedState!==null?Hv(i):l!==null?(l.return=s,ot=l):Hv(i);for(;a!==null;)ot=a,kx(a),a=a.sibling;ot=i,qh=o,Fn=u}Uv(e)}else i.subtreeFlags&8772&&a!==null?(a.return=i,ot=a):Uv(e)}}function Uv(e){for(;ot!==null;){var t=ot;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Fn||bd(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!Fn)if(r===null)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:ca(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&Ev(t,a,n);break;case 3:var s=t.updateQueue;if(s!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}Ev(t,s,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var d=f.dehydrated;d!==null&&rf(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(We(163))}Fn||t.flags&512&&hg(t)}catch(p){kr(t,t.return,p)}}if(t===e){ot=null;break}if(r=t.sibling,r!==null){r.return=t.return,ot=r;break}ot=t.return}}function zv(e){for(;ot!==null;){var t=ot;if(t===e){ot=null;break}var r=t.sibling;if(r!==null){r.return=t.return,ot=r;break}ot=t.return}}function Hv(e){for(;ot!==null;){var t=ot;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{bd(4,t)}catch(l){kr(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var i=t.return;try{n.componentDidMount()}catch(l){kr(t,i,l)}}var a=t.return;try{hg(t)}catch(l){kr(t,a,l)}break;case 5:var s=t.return;try{hg(t)}catch(l){kr(t,s,l)}}}catch(l){kr(t,t.return,l)}if(t===e){ot=null;break}var o=t.sibling;if(o!==null){o.return=t.return,ot=o;break}ot=t.return}}var e6=Math.ceil,q0=ms.ReactCurrentDispatcher,N2=ms.ReactCurrentOwner,Vi=ms.ReactCurrentBatchConfig,Ut=0,un=null,qr=null,xn=0,wi=0,su=ho(0),en=0,pf=null,Xo=0,Ed=0,C2=0,Dc=null,ti=null,L2=0,Tu=1/0,ts=null,$0=!1,gg=null,eo=null,$h=!1,$s=null,V0=0,jc=0,mg=null,S0=-1,b0=0;function qn(){return Ut&6?Rr():S0!==-1?S0:S0=Rr()}function to(e){return e.mode&1?Ut&2&&xn!==0?xn&-xn:jb.transition!==null?(b0===0&&(b0=fw()),b0):(e=Zt,e!==0||(e=window.event,e=e===void 0?16:yw(e.type)),e):1}function wa(e,t,r,n){if(50<jc)throw jc=0,mg=null,Error(We(185));Of(e,r,n),(!(Ut&2)||e!==un)&&(e===un&&(!(Ut&2)&&(Ed|=r),en===4&&zs(e,xn)),ai(e,n),r===1&&Ut===0&&!(t.mode&1)&&(Tu=Rr()+500,xd&&po()))}function ai(e,t){var r=e.callbackNode;jS(e,t);var n=C0(e,e===un?xn:0);if(n===0)r!==null&&Jm(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Jm(r),t===1)e.tag===0?Db(Wv.bind(null,e)):jw(Wv.bind(null,e)),Ob(function(){!(Ut&6)&&po()}),r=null;else{switch(hw(n)){case 1:r=r2;break;case 4:r=uw;break;case 16:r=N0;break;case 536870912:r=cw;break;default:r=N0}r=Ix(r,Nx.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Nx(e,t){if(S0=-1,b0=0,Ut&6)throw Error(We(327));var r=e.callbackNode;if(pu()&&e.callbackNode!==r)return null;var n=C0(e,e===un?xn:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=G0(e,n);else{t=n;var i=Ut;Ut|=2;var a=Lx();(un!==e||xn!==t)&&(ts=null,Tu=Rr()+500,Uo(e,t));do try{n6();break}catch(o){Cx(e,o)}while(!0);g2(),q0.current=a,Ut=i,qr!==null?t=0:(un=null,xn=0,t=en)}if(t!==0){if(t===2&&(i=Wp(e),i!==0&&(n=i,t=vg(e,i))),t===1)throw r=pf,Uo(e,0),zs(e,n),ai(e,Rr()),r;if(t===6)zs(e,n);else{if(i=e.current.alternate,!(n&30)&&!t6(i)&&(t=G0(e,n),t===2&&(a=Wp(e),a!==0&&(n=a,t=vg(e,a))),t===1))throw r=pf,Uo(e,0),zs(e,n),ai(e,Rr()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(We(345));case 2:Co(e,ti,ts);break;case 3:if(zs(e,n),(n&130023424)===n&&(t=L2+500-Rr(),10<t)){if(C0(e,0)!==0)break;if(i=e.suspendedLanes,(i&n)!==n){qn(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Jp(Co.bind(null,e,ti,ts),t);break}Co(e,ti,ts);break;case 4:if(zs(e,n),(n&4194240)===n)break;for(t=e.eventTimes,i=-1;0<n;){var s=31-ya(n);a=1<<s,s=t[s],s>i&&(i=s),n&=~a}if(n=i,n=Rr()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*e6(n/1960))-n,10<n){e.timeoutHandle=Jp(Co.bind(null,e,ti,ts),n);break}Co(e,ti,ts);break;case 5:Co(e,ti,ts);break;default:throw Error(We(329))}}}return ai(e,Rr()),e.callbackNode===r?Nx.bind(null,e):null}function vg(e,t){var r=Dc;return e.current.memoizedState.isDehydrated&&(Uo(e,t).flags|=256),e=G0(e,t),e!==2&&(t=ti,ti=r,t!==null&&yg(t)),e}function yg(e){ti===null?ti=e:ti.push.apply(ti,e)}function t6(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var i=r[n],a=i.getSnapshot;i=i.value;try{if(!_a(a(),i))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function zs(e,t){for(t&=~C2,t&=~Ed,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-ya(t),n=1<<r;e[r]=-1,t&=~n}}function Wv(e){if(Ut&6)throw Error(We(327));pu();var t=C0(e,0);if(!(t&1))return ai(e,Rr()),null;var r=G0(e,t);if(e.tag!==0&&r===2){var n=Wp(e);n!==0&&(t=n,r=vg(e,n))}if(r===1)throw r=pf,Uo(e,0),zs(e,t),ai(e,Rr()),r;if(r===6)throw Error(We(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Co(e,ti,ts),ai(e,Rr()),null}function P2(e,t){var r=Ut;Ut|=1;try{return e(t)}finally{Ut=r,Ut===0&&(Tu=Rr()+500,xd&&po())}}function Jo(e){$s!==null&&$s.tag===0&&!(Ut&6)&&pu();var t=Ut;Ut|=1;var r=Vi.transition,n=Zt;try{if(Vi.transition=null,Zt=1,e)return e()}finally{Zt=n,Vi.transition=r,Ut=t,!(Ut&6)&&po()}}function O2(){wi=su.current,gr(su)}function Uo(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,Pb(r)),qr!==null)for(r=qr.return;r!==null;){var n=r;switch(h2(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&R0();break;case 3:Eu(),gr(ni),gr(jn),_2();break;case 5:x2(n);break;case 4:Eu();break;case 13:gr(wr);break;case 19:gr(wr);break;case 10:m2(n.type._context);break;case 22:case 23:O2()}r=r.return}if(un=e,qr=e=ro(e.current,null),xn=wi=t,en=0,pf=null,C2=Ed=Xo=0,ti=Dc=null,Do!==null){for(t=0;t<Do.length;t++)if(r=Do[t],n=r.interleaved,n!==null){r.interleaved=null;var i=n.next,a=r.pending;if(a!==null){var s=a.next;a.next=i,n.next=s}r.pending=n}Do=null}return e}function Cx(e,t){do{var r=qr;try{if(g2(),w0.current=W0,H0){for(var n=xr.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}H0=!1}if(Yo=0,an=Qr=xr=null,Rc=!1,ff=0,N2.current=null,r===null||r.return===null){en=1,pf=t,qr=null;break}e:{var a=e,s=r.return,o=r,l=t;if(t=xn,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,f=o,d=f.tag;if(!(f.mode&1)&&(d===0||d===11||d===15)){var p=f.alternate;p?(f.updateQueue=p.updateQueue,f.memoizedState=p.memoizedState,f.lanes=p.lanes):(f.updateQueue=null,f.memoizedState=null)}var h=Lv(s);if(h!==null){h.flags&=-257,Pv(h,s,o,a,t),h.mode&1&&Cv(a,u,t),t=h,l=u;var v=t.updateQueue;if(v===null){var m=new Set;m.add(l),t.updateQueue=m}else v.add(l);break e}else{if(!(t&1)){Cv(a,u,t),F2();break e}l=Error(We(426))}}else if(vr&&o.mode&1){var S=Lv(s);if(S!==null){!(S.flags&65536)&&(S.flags|=256),Pv(S,s,o,a,t),d2(Au(l,o));break e}}a=l=Au(l,o),en!==4&&(en=2),Dc===null?Dc=[a]:Dc.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var y=hx(a,l,t);bv(a,y);break e;case 1:o=l;var w=a.type,x=a.stateNode;if(!(a.flags&128)&&(typeof w.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(eo===null||!eo.has(x)))){a.flags|=65536,t&=-t,a.lanes|=t;var A=dx(a,o,t);bv(a,A);break e}}a=a.return}while(a!==null)}Ox(r)}catch(R){t=R,qr===r&&r!==null&&(qr=r=r.return);continue}break}while(!0)}function Lx(){var e=q0.current;return q0.current=W0,e===null?W0:e}function F2(){(en===0||en===3||en===2)&&(en=4),un===null||!(Xo&268435455)&&!(Ed&268435455)||zs(un,xn)}function G0(e,t){var r=Ut;Ut|=2;var n=Lx();(un!==e||xn!==t)&&(ts=null,Uo(e,t));do try{r6();break}catch(i){Cx(e,i)}while(!0);if(g2(),Ut=r,q0.current=n,qr!==null)throw Error(We(261));return un=null,xn=0,en}function r6(){for(;qr!==null;)Px(qr)}function n6(){for(;qr!==null&&!NS();)Px(qr)}function Px(e){var t=Rx(e.alternate,e,wi);e.memoizedProps=e.pendingProps,t===null?Ox(e):qr=t,N2.current=null}function Ox(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=Xb(r,t),r!==null){r.flags&=32767,qr=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{en=6,qr=null;return}}else if(r=Yb(r,t,wi),r!==null){qr=r;return}if(t=t.sibling,t!==null){qr=t;return}qr=t=e}while(t!==null);en===0&&(en=5)}function Co(e,t,r){var n=Zt,i=Vi.transition;try{Vi.transition=null,Zt=1,i6(e,t,r,n)}finally{Vi.transition=i,Zt=n}return null}function i6(e,t,r,n){do pu();while($s!==null);if(Ut&6)throw Error(We(327));r=e.finishedWork;var i=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(We(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(MS(e,a),e===un&&(qr=un=null,xn=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||$h||($h=!0,Ix(N0,function(){return pu(),null})),a=(r.flags&15990)!==0,r.subtreeFlags&15990||a){a=Vi.transition,Vi.transition=null;var s=Zt;Zt=1;var o=Ut;Ut|=4,N2.current=null,Qb(e,r),Tx(r,e),Eb(Yp),L0=!!Kp,Yp=Kp=null,e.current=r,Zb(r),CS(),Ut=o,Zt=s,Vi.transition=a}else e.current=r;if($h&&($h=!1,$s=e,V0=i),a=e.pendingLanes,a===0&&(eo=null),OS(r.stateNode),ai(e,Rr()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if($0)throw $0=!1,e=gg,gg=null,e;return V0&1&&e.tag!==0&&pu(),a=e.pendingLanes,a&1?e===mg?jc++:(jc=0,mg=e):jc=0,po(),null}function pu(){if($s!==null){var e=hw(V0),t=Vi.transition,r=Zt;try{if(Vi.transition=null,Zt=16>e?16:e,$s===null)var n=!1;else{if(e=$s,$s=null,V0=0,Ut&6)throw Error(We(331));var i=Ut;for(Ut|=4,ot=e.current;ot!==null;){var a=ot,s=a.child;if(ot.flags&16){var o=a.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(ot=u;ot!==null;){var f=ot;switch(f.tag){case 0:case 11:case 15:Ic(8,f,a)}var d=f.child;if(d!==null)d.return=f,ot=d;else for(;ot!==null;){f=ot;var p=f.sibling,h=f.return;if(bx(f),f===u){ot=null;break}if(p!==null){p.return=h,ot=p;break}ot=h}}}var v=a.alternate;if(v!==null){var m=v.child;if(m!==null){v.child=null;do{var S=m.sibling;m.sibling=null,m=S}while(m!==null)}}ot=a}}if(a.subtreeFlags&2064&&s!==null)s.return=a,ot=s;else e:for(;ot!==null;){if(a=ot,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Ic(9,a,a.return)}var y=a.sibling;if(y!==null){y.return=a.return,ot=y;break e}ot=a.return}}var w=e.current;for(ot=w;ot!==null;){s=ot;var x=s.child;if(s.subtreeFlags&2064&&x!==null)x.return=s,ot=x;else e:for(s=w;ot!==null;){if(o=ot,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:bd(9,o)}}catch(R){kr(o,o.return,R)}if(o===s){ot=null;break e}var A=o.sibling;if(A!==null){A.return=o.return,ot=A;break e}ot=o.return}}if(Ut=i,po(),Ma&&typeof Ma.onPostCommitFiberRoot=="function")try{Ma.onPostCommitFiberRoot(gd,e)}catch{}n=!0}return n}finally{Zt=r,Vi.transition=t}}return!1}function qv(e,t,r){t=Au(r,t),t=hx(e,t,1),e=Zs(e,t,1),t=qn(),e!==null&&(Of(e,1,t),ai(e,t))}function kr(e,t,r){if(e.tag===3)qv(e,e,r);else for(;t!==null;){if(t.tag===3){qv(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(eo===null||!eo.has(n))){e=Au(r,e),e=dx(t,e,1),t=Zs(t,e,1),e=qn(),t!==null&&(Of(t,1,e),ai(t,e));break}}t=t.return}}function a6(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=qn(),e.pingedLanes|=e.suspendedLanes&r,un===e&&(xn&r)===r&&(en===4||en===3&&(xn&130023424)===xn&&500>Rr()-L2?Uo(e,0):C2|=r),ai(e,t)}function Fx(e,t){t===0&&(e.mode&1?(t=Ih,Ih<<=1,!(Ih&130023424)&&(Ih=4194304)):t=1);var r=qn();e=hs(e,t),e!==null&&(Of(e,t,r),ai(e,r))}function s6(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Fx(e,r)}function o6(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;i!==null&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(We(314))}n!==null&&n.delete(t),Fx(e,r)}var Rx;Rx=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||ni.current)ri=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return ri=!1,Kb(e,t,r);ri=!!(e.flags&131072)}else ri=!1,vr&&t.flags&1048576&&Mw(t,j0,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;_0(e,t),e=t.pendingProps;var i=_u(t,jn.current);du(t,r),i=b2(null,t,n,e,i,r);var a=E2();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ii(n)?(a=!0,I0(t)):a=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,y2(t),i.updater=Sd,t.stateNode=i,i._reactInternals=t,ig(t,n,e,r),t=og(null,t,n,!0,a,r)):(t.tag=0,vr&&a&&f2(t),zn(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(_0(e,t),e=t.pendingProps,i=n._init,n=i(n._payload),t.type=n,i=t.tag=u6(n),e=ca(n,e),i){case 0:t=sg(null,t,n,e,r);break e;case 1:t=Rv(null,t,n,e,r);break e;case 11:t=Ov(null,t,n,e,r);break e;case 14:t=Fv(null,t,n,ca(n.type,e),r);break e}throw Error(We(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ca(n,i),sg(e,t,n,i,r);case 1:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ca(n,i),Rv(e,t,n,i,r);case 3:e:{if(vx(t),e===null)throw Error(We(387));n=t.pendingProps,a=t.memoizedState,i=a.element,qw(e,t),U0(t,n,null,r);var s=t.memoizedState;if(n=s.element,a.isDehydrated)if(a={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){i=Au(Error(We(423)),t),t=Iv(e,t,n,r,i);break e}else if(n!==i){i=Au(Error(We(424)),t),t=Iv(e,t,n,r,i);break e}else for(Ei=Qs(t.stateNode.containerInfo.firstChild),Ti=t,vr=!0,ga=null,r=Hw(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(Su(),n===i){t=ds(e,t,r);break e}zn(e,t,n,r)}t=t.child}return t;case 5:return $w(t),e===null&&tg(t),n=t.type,i=t.pendingProps,a=e!==null?e.memoizedProps:null,s=i.children,Xp(n,i)?s=null:a!==null&&Xp(n,a)&&(t.flags|=32),mx(e,t),zn(e,t,s,r),t.child;case 6:return e===null&&tg(t),null;case 13:return yx(e,t,r);case 4:return w2(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=bu(t,null,n,r):zn(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ca(n,i),Ov(e,t,n,i,r);case 7:return zn(e,t,t.pendingProps,r),t.child;case 8:return zn(e,t,t.pendingProps.children,r),t.child;case 12:return zn(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,a=t.memoizedProps,s=i.value,fr(M0,n._currentValue),n._currentValue=s,a!==null)if(_a(a.value,s)){if(a.children===i.children&&!ni.current){t=ds(e,t,r);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var o=a.dependencies;if(o!==null){s=a.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(a.tag===1){l=ss(-1,r&-r),l.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?l.next=l:(l.next=f.next,f.next=l),u.pending=l}}a.lanes|=r,l=a.alternate,l!==null&&(l.lanes|=r),rg(a.return,r,t),o.lanes|=r;break}l=l.next}}else if(a.tag===10)s=a.type===t.type?null:a.child;else if(a.tag===18){if(s=a.return,s===null)throw Error(We(341));s.lanes|=r,o=s.alternate,o!==null&&(o.lanes|=r),rg(s,r,t),s=a.sibling}else s=a.child;if(s!==null)s.return=a;else for(s=a;s!==null;){if(s===t){s=null;break}if(a=s.sibling,a!==null){a.return=s.return,s=a;break}s=s.return}a=s}zn(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,du(t,r),i=Gi(i),n=n(i),t.flags|=1,zn(e,t,n,r),t.child;case 14:return n=t.type,i=ca(n,t.pendingProps),i=ca(n.type,i),Fv(e,t,n,i,r);case 15:return px(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:ca(n,i),_0(e,t),t.tag=1,ii(n)?(e=!0,I0(t)):e=!1,du(t,r),fx(t,n,i),ig(t,n,i,r),og(null,t,n,!0,e,r);case 19:return wx(e,t,r);case 22:return gx(e,t,r)}throw Error(We(156,t.tag))};function Ix(e,t){return lw(e,t)}function l6(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function $i(e,t,r,n){return new l6(e,t,r,n)}function R2(e){return e=e.prototype,!(!e||!e.isReactComponent)}function u6(e){if(typeof e=="function")return R2(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Zg)return 11;if(e===e2)return 14}return 2}function ro(e,t){var r=e.alternate;return r===null?(r=$i(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function E0(e,t,r,n,i,a){var s=2;if(n=e,typeof e=="function")R2(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case Xl:return zo(r.children,i,a,t);case Qg:s=8,i|=8;break;case Np:return e=$i(12,r,t,i|2),e.elementType=Np,e.lanes=a,e;case Cp:return e=$i(13,r,t,i),e.elementType=Cp,e.lanes=a,e;case Lp:return e=$i(19,r,t,i),e.elementType=Lp,e.lanes=a,e;case $y:return Ad(r,i,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Wy:s=10;break e;case qy:s=9;break e;case Zg:s=11;break e;case e2:s=14;break e;case js:s=16,n=null;break e}throw Error(We(130,e==null?e:typeof e,""))}return t=$i(s,r,t,i),t.elementType=e,t.type=n,t.lanes=a,t}function zo(e,t,r,n){return e=$i(7,e,n,t),e.lanes=r,e}function Ad(e,t,r,n){return e=$i(22,e,n,t),e.elementType=$y,e.lanes=r,e.stateNode={isHidden:!1},e}function Q1(e,t,r){return e=$i(6,e,null,t),e.lanes=r,e}function Z1(e,t,r){return t=$i(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function c6(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=F1(0),this.expirationTimes=F1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=F1(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function I2(e,t,r,n,i,a,s,o,l){return e=new c6(e,t,r,o,l),t===1?(t=1,a===!0&&(t|=8)):t=0,a=$i(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},y2(a),e}function f6(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Yl,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function Dx(e){if(!e)return ao;e=e._reactInternals;e:{if(rl(e)!==e||e.tag!==1)throw Error(We(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ii(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(We(171))}if(e.tag===1){var r=e.type;if(ii(r))return Dw(e,r,t)}return t}function jx(e,t,r,n,i,a,s,o,l){return e=I2(r,n,!0,e,i,a,s,o,l),e.context=Dx(null),r=e.current,n=qn(),i=to(r),a=ss(n,i),a.callback=t??null,Zs(r,a,i),e.current.lanes=i,Of(e,i,n),ai(e,n),e}function Td(e,t,r,n){var i=t.current,a=qn(),s=to(i);return r=Dx(r),t.context===null?t.context=r:t.pendingContext=r,t=ss(a,s),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Zs(i,t,s),e!==null&&(wa(e,i,s,a),y0(e,i,s)),s}function K0(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function $v(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function D2(e,t){$v(e,t),(e=e.alternate)&&$v(e,t)}function h6(){return null}var Mx=typeof reportError=="function"?reportError:function(e){console.error(e)};function j2(e){this._internalRoot=e}kd.prototype.render=j2.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(We(409));Td(e,t,null,null)};kd.prototype.unmount=j2.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Jo(function(){Td(null,e,null,null)}),t[fs]=null}};function kd(e){this._internalRoot=e}kd.prototype.unstable_scheduleHydration=function(e){if(e){var t=gw();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Us.length&&t!==0&&t<Us[r].priority;r++);Us.splice(r,0,e),r===0&&vw(e)}};function M2(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Nd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Vv(){}function d6(e,t,r,n,i){if(i){if(typeof n=="function"){var a=n;n=function(){var u=K0(s);a.call(u)}}var s=jx(t,n,e,0,null,!1,!1,"",Vv);return e._reactRootContainer=s,e[fs]=s.current,sf(e.nodeType===8?e.parentNode:e),Jo(),s}for(;i=e.lastChild;)e.removeChild(i);if(typeof n=="function"){var o=n;n=function(){var u=K0(l);o.call(u)}}var l=I2(e,0,!1,null,null,!1,!1,"",Vv);return e._reactRootContainer=l,e[fs]=l.current,sf(e.nodeType===8?e.parentNode:e),Jo(function(){Td(t,l,r,n)}),l}function Cd(e,t,r,n,i){var a=r._reactRootContainer;if(a){var s=a;if(typeof i=="function"){var o=i;i=function(){var l=K0(s);o.call(l)}}Td(t,s,e,i)}else s=d6(r,t,e,i,n);return K0(s)}dw=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Ac(t.pendingLanes);r!==0&&(n2(t,r|1),ai(t,Rr()),!(Ut&6)&&(Tu=Rr()+500,po()))}break;case 13:Jo(function(){var n=hs(e,1);if(n!==null){var i=qn();wa(n,e,1,i)}}),D2(e,1)}};i2=function(e){if(e.tag===13){var t=hs(e,134217728);if(t!==null){var r=qn();wa(t,e,134217728,r)}D2(e,134217728)}};pw=function(e){if(e.tag===13){var t=to(e),r=hs(e,t);if(r!==null){var n=qn();wa(r,e,t,n)}D2(e,t)}};gw=function(){return Zt};mw=function(e,t){var r=Zt;try{return Zt=e,t()}finally{Zt=r}};Up=function(e,t,r){switch(t){case"input":if(Fp(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=wd(n);if(!i)throw Error(We(90));Gy(n),Fp(n,i)}}}break;case"textarea":Yy(e,r);break;case"select":t=r.value,t!=null&&uu(e,!!r.multiple,t,!1)}};rw=P2;nw=Jo;var p6={usingClientEntryPoint:!1,Events:[Rf,eu,wd,ew,tw,P2]},yc={findFiberByHostInstance:Io,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},g6={bundleType:yc.bundleType,version:yc.version,rendererPackageName:yc.rendererPackageName,rendererConfig:yc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ms.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=sw(e),e===null?null:e.stateNode},findFiberByHostInstance:yc.findFiberByHostInstance||h6,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Vh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Vh.isDisabled&&Vh.supportsFiber)try{gd=Vh.inject(g6),Ma=Vh}catch{}}Ci.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=p6;Ci.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!M2(t))throw Error(We(200));return f6(e,t,null,r)};Ci.createRoot=function(e,t){if(!M2(e))throw Error(We(299));var r=!1,n="",i=Mx;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=I2(e,1,!1,null,null,r,!1,n,i),e[fs]=t.current,sf(e.nodeType===8?e.parentNode:e),new j2(t)};Ci.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(We(188)):(e=Object.keys(e).join(","),Error(We(268,e)));return e=sw(t),e=e===null?null:e.stateNode,e};Ci.flushSync=function(e){return Jo(e)};Ci.hydrate=function(e,t,r){if(!Nd(t))throw Error(We(200));return Cd(null,e,t,!0,r)};Ci.hydrateRoot=function(e,t,r){if(!M2(e))throw Error(We(405));var n=r!=null&&r.hydratedSources||null,i=!1,a="",s=Mx;if(r!=null&&(r.unstable_strictMode===!0&&(i=!0),r.identifierPrefix!==void 0&&(a=r.identifierPrefix),r.onRecoverableError!==void 0&&(s=r.onRecoverableError)),t=jx(t,null,e,1,r??null,i,!1,a,s),e[fs]=t.current,sf(e),n)for(e=0;e<n.length;e++)r=n[e],i=r._getVersion,i=i(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new kd(t)};Ci.render=function(e,t,r){if(!Nd(t))throw Error(We(200));return Cd(null,e,t,!1,r)};Ci.unmountComponentAtNode=function(e){if(!Nd(e))throw Error(We(40));return e._reactRootContainer?(Jo(function(){Cd(null,null,e,!1,function(){e._reactRootContainer=null,e[fs]=null})}),!0):!1};Ci.unstable_batchedUpdates=P2;Ci.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!Nd(r))throw Error(We(200));if(e==null||e._reactInternals===void 0)throw Error(We(38));return Cd(e,t,r,!1,n)};Ci.version="18.3.1-next-f1338f8080-20240426";function Bx(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Bx)}catch(e){console.error(e)}}Bx(),By.exports=Ci;var m6=By.exports,Gv=m6;Tp.createRoot=Gv.createRoot,Tp.hydrateRoot=Gv.hydrateRoot;function v6(e){switch(e){case"admin":return{text:"Administrador",color:"bg-red-100 text-red-800 border-red-300",emoji:""};case"responsible":return{text:"Responsable",color:"bg-yellow-100 text-yellow-800 border-yellow-300",emoji:""};default:return{text:"Empleado",color:"bg-green-100 text-green-800 border-green-300",emoji:""}}}function y6({children:e,user:t,onLogout:r}){const[n,i]=ut.useState(!1),a=t?v6(t.role):null;return Z.jsxs("div",{className:"min-h-screen bg-gray-50",children:[Z.jsxs("header",{className:"bg-blue-800 text-white p-4 shadow-lg",children:[Z.jsxs("div",{className:"flex justify-between items-center",children:[Z.jsx("h1",{className:"text-xl font-bold",children:"CTC - Registro Horas"}),Z.jsx("button",{onClick:()=>i(!n),className:"p-2 rounded-lg hover:bg-blue-700",children:Z.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:Z.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]}),n&&t&&Z.jsxs("div",{className:"mt-4 pb-2",children:[Z.jsxs("div",{className:"mb-3",children:[Z.jsx("div",{className:"text-sm font-medium mb-2",children:t.name}),Z.jsxs("span",{className:`inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs font-semibold border ${a.color}`,children:[Z.jsx("span",{children:a.emoji}),Z.jsx("span",{children:a.text})]})]}),Z.jsx("button",{onClick:r,className:"bg-red-600 px-4 py-2 rounded-lg text-sm hover:bg-red-700",children:"Cerrar Sesin"})]})]}),Z.jsx("main",{className:"p-4 pb-20",children:e})]})}const Kv=[{id:1,name:"Clasificacin Frricos"},{id:2,name:"Carga de Camin"},{id:3,name:"Limpieza"},{id:4,name:"Mantenimiento"}],w6=["Juan","Mara","Jos","Ana","Antonio","Carmen","Francisco","Dolores","David","Rosa","Manuel","Isabel","Javier","Elena","Carlos","Lucia","Miguel","Patricia","Rafael","Mercedes","Fernando","Andrea","Alejandro","Sandra","Jorge","Natalia","Ral","Margarita","Luis","Sonia","Andrs","Esther","Diego","Vernica","Adrin","Cristina","scar","Laura","Ivn","Silvia","Sergio","Raquel","lvaro","Noelia","Pablo","Mnica","Rubn","Beatriz","Vctor","Diana"],Yv=["Garca","Rodrguez"," Martnez","Snchez","Lpez","Gonzlez","Prez","Fernndez","Gmez","Martn","Jimnez","Ruiz","Hernndez","Daz","Morales","lvarez","Torres","Serrano","Blanco","Muoz","Castro","Ortega","Romero","Nez"];function x6(){const e=[],t=[{id:1,name:"Pedro Snchez",role:"responsible",password:"pedro123"},{id:2,name:"Laura Garca",role:"responsible",password:"laura123"},{id:3,name:"Miguel Torres",role:"responsible",password:"miguel123"},{id:4,name:"Carmen Ruiz",role:"responsible",password:"carmen123"},{id:5,name:"Antonio Lpez",role:"responsible",password:"antonio123"},{id:6,name:"Mara Jos Fernndez",role:"responsible",password:"maria123"},{id:7,name:"Francisco Gmez",role:"responsible",password:"francisco123"}];e.push(...t);for(let r=8;r<=57;r++){const n=w6[r-8]||`Empleado${r-7}`,i=Yv[Math.floor(Math.random()*Yv.length)],a=`${n} ${i}`,s=n.toLowerCase()+"123";e.push({id:r,name:a,role:"employee",password:s,active:!0})}return e}const _6=x6(),S6=[.5,1,1.5,2,2.5,3,3.5,4,4.5,5,5.5,6,6.5,7,7.5,8];function Ld(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function b6(e,t,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function o(f){try{u(n.next(f))}catch(d){s(d)}}function l(f){try{u(n.throw(f))}catch(d){s(d)}}function u(f){f.done?a(f.value):i(f.value).then(o,l)}u((n=n.apply(e,t||[])).next())})}const E6=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class B2 extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class A6 extends B2{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Xv extends B2{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Jv extends B2{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var wg;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(wg||(wg={}));class T6{constructor(t,{headers:r={},customFetch:n,region:i=wg.Any}={}){this.url=t,this.headers=r,this.region=i,this.fetch=E6(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return b6(this,arguments,void 0,function*(r,n={}){var i;let a,s;try{const{headers:o,method:l,body:u,signal:f,timeout:d}=n;let p={},{region:h}=n;h||(h=this.region);const v=new URL(`${this.url}/${r}`);h&&h!=="any"&&(p["x-region"]=h,v.searchParams.set("forceFunctionRegion",h));let m;u&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(p["Content-Type"]="application/octet-stream",m=u):typeof u=="string"?(p["Content-Type"]="text/plain",m=u):typeof FormData<"u"&&u instanceof FormData?m=u:(p["Content-Type"]="application/json",m=JSON.stringify(u)):u&&typeof u!="string"&&!(typeof Blob<"u"&&u instanceof Blob)&&!(u instanceof ArrayBuffer)&&!(typeof FormData<"u"&&u instanceof FormData)?m=JSON.stringify(u):m=u;let S=f;d&&(s=new AbortController,a=setTimeout(()=>s.abort(),d),f?(S=s.signal,f.addEventListener("abort",()=>s.abort())):S=s.signal);const y=yield this.fetch(v.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},p),this.headers),o),body:m,signal:S}).catch(R=>{throw new A6(R)}),w=y.headers.get("x-relay-error");if(w&&w==="true")throw new Xv(y);if(!y.ok)throw new Jv(y);let x=((i=y.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),A;return x==="application/json"?A=yield y.json():x==="application/octet-stream"||x==="application/pdf"?A=yield y.blob():x==="text/event-stream"?A=y:x==="multipart/form-data"?A=yield y.formData():A=yield y.text(),{data:A,error:null,response:y}}catch(o){return{data:null,error:o,response:o instanceof Jv||o instanceof Xv?o.context:void 0}}finally{a&&clearTimeout(a)}})}}var k6=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},N6=class{constructor(e){var t,r,n;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,this.urlLengthLimit=(n=e.urlLengthLimit)!==null&&n!==void 0?n:8e3,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let i=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{let s=null,o=null,l=null,u=a.status,f=a.statusText;if(a.ok){var d,p;if(r.method!=="HEAD"){var h;const y=await a.text();y===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((h=r.headers.get("Accept"))===null||h===void 0)&&h.includes("application/vnd.pgrst.plan+text"))?o=y:o=JSON.parse(y))}const m=(d=r.headers.get("Prefer"))===null||d===void 0?void 0:d.match(/count=(exact|planned|estimated)/),S=(p=a.headers.get("content-range"))===null||p===void 0?void 0:p.split("/");m&&S&&S.length>1&&(l=parseInt(S[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(o)&&(o.length>1?(s={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,l=null,u=406,f="Not Acceptable"):o.length===1?o=o[0]:o=null)}else{var v;const m=await a.text();try{s=JSON.parse(m),Array.isArray(s)&&a.status===404&&(o=[],s=null,u=200,f="OK")}catch{a.status===404&&m===""?(u=204,f="No Content"):s={message:m}}if(s&&r.isMaybeSingle&&(!(s==null||(v=s.details)===null||v===void 0)&&v.includes("0 rows"))&&(s=null,u=200,f="OK"),s&&r.shouldThrowOnError)throw new k6(s)}return{error:s,data:o,count:l,status:u,statusText:f}});return this.shouldThrowOnError||(i=i.catch(a=>{var s;let o="",l="",u="";const f=a==null?void 0:a.cause;if(f){var d,p,h,v;const y=(d=f==null?void 0:f.message)!==null&&d!==void 0?d:"",w=(p=f==null?void 0:f.code)!==null&&p!==void 0?p:"";o=`${(h=a==null?void 0:a.name)!==null&&h!==void 0?h:"FetchError"}: ${a==null?void 0:a.message}`,o+=`

Caused by: ${(v=f==null?void 0:f.name)!==null&&v!==void 0?v:"Error"}: ${y}`,w&&(o+=` (${w})`),f!=null&&f.stack&&(o+=`
${f.stack}`)}else{var m;o=(m=a==null?void 0:a.stack)!==null&&m!==void 0?m:""}const S=this.url.toString().length;return(a==null?void 0:a.name)==="AbortError"||(a==null?void 0:a.code)==="ABORT_ERR"?(u="",l="Request was aborted (timeout or manual cancellation)",S>this.urlLengthLimit&&(l+=`. Note: Your request URL is ${S} characters, which may exceed server limits. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [many IDs])), consider using an RPC function to pass values server-side.`)):((f==null?void 0:f.name)==="HeadersOverflowError"||(f==null?void 0:f.code)==="UND_ERR_HEADERS_OVERFLOW")&&(u="",l="HTTP headers exceeded server limits (typically 16KB)",S>this.urlLengthLimit&&(l+=`. Your request URL is ${S} characters. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [200+ IDs])), consider using an RPC function instead.`)),{error:{message:`${(s=a==null?void 0:a.name)!==null&&s!==void 0?s:"FetchError"}: ${a==null?void 0:a.message}`,details:o,hint:l,code:u},data:null,count:null,status:0,statusText:""}})),i.then(e,t)}returns(){return this}overrideTypes(){return this}},C6=class extends N6{select(e){let t=!1;const r=(e??"*").split("").map(n=>/\s/.test(n)&&!t?"":(n==='"'&&(t=!t),n)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:i=n}={}){const a=i?`${i}.order`:"order",s=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${s?`${s},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){const i=typeof n>"u"?"offset":`${n}.offset`,a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(a,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:i=!1,format:a="text"}={}){var s;const o=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,i?"wal":null].filter(Boolean).join("|"),l=(s=this.headers.get("Accept"))!==null&&s!==void 0?s:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${a}; for="${l}"; options=${o};`),a==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const Qv=new RegExp("[,()]");var Wl=class extends C6{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&Qv.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&Qv.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let i="";n==="plain"?i="pl":n==="phrase"?i="ph":n==="websearch"&&(i="w");const a=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${a}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},L6=class{constructor(e,{headers:t={},schema:r,fetch:n,urlLengthLimit:i=8e3}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=n,this.urlLengthLimit=i}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){const{head:r=!1,count:n}=t??{},i=r?"HEAD":"GET";let a=!1;const s=(e??"*").split("").map(u=>/\s/.test(u)&&!a?"":(u==='"'&&(a=!a),u)).join(""),{url:o,headers:l}=this.cloneRequestState();return o.searchParams.set("select",s),n&&l.append("Prefer",`count=${n}`),new Wl({method:i,url:o,headers:l,schema:this.schema,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}insert(e,{count:t,defaultToNull:r=!0}={}){var n;const i="POST",{url:a,headers:s}=this.cloneRequestState();if(t&&s.append("Prefer",`count=${t}`),r||s.append("Prefer","missing=default"),Array.isArray(e)){const o=e.reduce((l,u)=>l.concat(Object.keys(u)),[]);if(o.length>0){const l=[...new Set(o)].map(u=>`"${u}"`);a.searchParams.set("columns",l.join(","))}}return new Wl({method:i,url:a,headers:s,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch,urlLengthLimit:this.urlLengthLimit})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:i=!0}={}){var a;const s="POST",{url:o,headers:l}=this.cloneRequestState();if(l.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&o.searchParams.set("on_conflict",t),n&&l.append("Prefer",`count=${n}`),i||l.append("Prefer","missing=default"),Array.isArray(e)){const u=e.reduce((f,d)=>f.concat(Object.keys(d)),[]);if(u.length>0){const f=[...new Set(u)].map(d=>`"${d}"`);o.searchParams.set("columns",f.join(","))}}return new Wl({method:s,url:o,headers:l,schema:this.schema,body:e,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch,urlLengthLimit:this.urlLengthLimit})}update(e,{count:t}={}){var r;const n="PATCH",{url:i,headers:a}=this.cloneRequestState();return t&&a.append("Prefer",`count=${t}`),new Wl({method:n,url:i,headers:a,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch,urlLengthLimit:this.urlLengthLimit})}delete({count:e}={}){var t;const r="DELETE",{url:n,headers:i}=this.cloneRequestState();return e&&i.append("Prefer",`count=${e}`),new Wl({method:r,url:n,headers:i,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch,urlLengthLimit:this.urlLengthLimit})}};function gf(e){"@babel/helpers - typeof";return gf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gf(e)}function P6(e,t){if(gf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(gf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function O6(e){var t=P6(e,"string");return gf(t)=="symbol"?t:t+""}function F6(e,t,r){return(t=O6(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Zv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Gh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Zv(Object(r),!0).forEach(function(n){F6(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zv(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var R6=class Ux{constructor(t,{headers:r={},schema:n,fetch:i,timeout:a,urlLengthLimit:s=8e3}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.urlLengthLimit=s;const o=i??globalThis.fetch;a!==void 0&&a>0?this.fetch=(l,u)=>{const f=new AbortController,d=setTimeout(()=>f.abort(),a),p=u==null?void 0:u.signal;if(p){if(p.aborted)return clearTimeout(d),o(l,u);const h=()=>{clearTimeout(d),f.abort()};return p.addEventListener("abort",h,{once:!0}),o(l,Gh(Gh({},u),{},{signal:f.signal})).finally(()=>{clearTimeout(d),p.removeEventListener("abort",h)})}return o(l,Gh(Gh({},u),{},{signal:f.signal})).finally(()=>clearTimeout(d))}:this.fetch=o}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new L6(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}schema(t){return new Ux(this.url,{headers:this.headers,schema:t,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}rpc(t,r={},{head:n=!1,get:i=!1,count:a}={}){var s;let o;const l=new URL(`${this.url}/rpc/${t}`);let u;const f=h=>h!==null&&typeof h=="object"&&(!Array.isArray(h)||h.some(f)),d=n&&Object.values(r).some(f);d?(o="POST",u=r):n||i?(o=n?"HEAD":"GET",Object.entries(r).filter(([h,v])=>v!==void 0).map(([h,v])=>[h,Array.isArray(v)?`{${v.join(",")}}`:`${v}`]).forEach(([h,v])=>{l.searchParams.append(h,v)})):(o="POST",u=r);const p=new Headers(this.headers);return d?p.set("Prefer",a?`count=${a},return=minimal`:"return=minimal"):a&&p.set("Prefer",`count=${a}`),new Wl({method:o,url:l,headers:p,schema:this.schemaName,body:u,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch,urlLengthLimit:this.urlLengthLimit})}};class I6{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const n=r.versions;if(n&&n.node){const i=n.node,a=parseInt(i.replace(/^v/,"").split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const D6="2.97.0",j6=`realtime-js/${D6}`,M6="1.0.0",zx="2.0.0",e5=zx,xg=1e4,B6=1e3,U6=100;var Bs;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Bs||(Bs={}));var Xr;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Xr||(Xr={}));var pa;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(pa||(pa={}));var _g;(function(e){e.websocket="websocket"})(_g||(_g={}));var Oo;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Oo||(Oo={}));class z6{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,n;const i=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,i)}_encodeJsonUserBroadcastPush(t){var r,n;const i=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:{},s=new TextEncoder().encode(JSON.stringify(i)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,s)}_encodeUserBroadcastPush(t,r,n){var i,a;const s=t.topic,o=(i=t.ref)!==null&&i!==void 0?i:"",l=(a=t.join_ref)!==null&&a!==void 0?a:"",u=t.payload.event,f=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},d=Object.keys(f).length===0?"":JSON.stringify(f);if(l.length>255)throw new Error(`joinRef length ${l.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`ref length ${o.length} exceeds maximum of 255`);if(s.length>255)throw new Error(`topic length ${s.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`userEvent length ${u.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`metadata length ${d.length} exceeds maximum of 255`);const p=this.USER_BROADCAST_PUSH_META_LENGTH+l.length+o.length+s.length+u.length+d.length,h=new ArrayBuffer(this.HEADER_LENGTH+p);let v=new DataView(h),m=0;v.setUint8(m++,this.KINDS.userBroadcastPush),v.setUint8(m++,l.length),v.setUint8(m++,o.length),v.setUint8(m++,s.length),v.setUint8(m++,u.length),v.setUint8(m++,d.length),v.setUint8(m++,r),Array.from(l,y=>v.setUint8(m++,y.charCodeAt(0))),Array.from(o,y=>v.setUint8(m++,y.charCodeAt(0))),Array.from(s,y=>v.setUint8(m++,y.charCodeAt(0))),Array.from(u,y=>v.setUint8(m++,y.charCodeAt(0))),Array.from(d,y=>v.setUint8(m++,y.charCodeAt(0)));var S=new Uint8Array(h.byteLength+n.byteLength);return S.set(new Uint8Array(h),0),S.set(new Uint8Array(n),h.byteLength),S.buffer}decode(t,r){if(this._isArrayBuffer(t)){let n=this._binaryDecode(t);return r(n)}if(typeof t=="string"){const n=JSON.parse(t),[i,a,s,o,l]=n;return r({join_ref:i,ref:a,topic:s,event:o,payload:l})}return r({})}_binaryDecode(t){const r=new DataView(t),n=r.getUint8(0),i=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,i)}}_decodeUserBroadcast(t,r,n){const i=r.getUint8(1),a=r.getUint8(2),s=r.getUint8(3),o=r.getUint8(4);let l=this.HEADER_LENGTH+4;const u=n.decode(t.slice(l,l+i));l=l+i;const f=n.decode(t.slice(l,l+a));l=l+a;const d=n.decode(t.slice(l,l+s));l=l+s;const p=t.slice(l,t.byteLength),h=o===this.JSON_ENCODING?JSON.parse(n.decode(p)):p,v={type:this.BROADCAST_EVENT,event:f,payload:h};return s>0&&(v.meta=JSON.parse(d)),{join_ref:null,ref:null,topic:u,event:this.BROADCAST_EVENT,payload:v}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([n])=>r.includes(n)))}}class Hx{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var cr;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(cr||(cr={}));const t5=(e,t,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((a,s)=>(a[s]=H6(s,e,t,i),a),{}):{}},H6=(e,t,r,n)=>{const i=t.find(o=>o.name===e),a=i==null?void 0:i.type,s=r[e];return a&&!n.includes(a)?Wx(a,s):Sg(s)},Wx=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return V6(t,r)}switch(e){case cr.bool:return W6(t);case cr.float4:case cr.float8:case cr.int2:case cr.int4:case cr.int8:case cr.numeric:case cr.oid:return q6(t);case cr.json:case cr.jsonb:return $6(t);case cr.timestamp:return G6(t);case cr.abstime:case cr.date:case cr.daterange:case cr.int4range:case cr.int8range:case cr.money:case cr.reltime:case cr.text:case cr.time:case cr.timestamptz:case cr.timetz:case cr.tsrange:case cr.tstzrange:return Sg(t);default:return Sg(t)}},Sg=e=>e,W6=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},q6=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},$6=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},V6=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let a;const s=e.slice(1,r);try{a=JSON.parse("["+s+"]")}catch{a=s?s.split(","):[]}return a.map(o=>Wx(t,o))}return e},G6=e=>typeof e=="string"?e.replace(" ","T"):e,qx=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class ep{constructor(t,r,n={},i=xg){this.channel=t,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var r5;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(r5||(r5={}));class Mc{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:a,onLeave:s,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Mc.syncState(this.state,i,a,s),this.pendingDiffs.forEach(l=>{this.state=Mc.syncDiff(this.state,l,a,s)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},i=>{const{onJoin:a,onLeave:s,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=Mc.syncDiff(this.state,i,a,s),o())}),this.onJoin((i,a,s)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:a,newPresences:s})}),this.onLeave((i,a,s)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:a,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,i){const a=this.cloneDeep(t),s=this.transformState(r),o={},l={};return this.map(a,(u,f)=>{s[u]||(l[u]=f)}),this.map(s,(u,f)=>{const d=a[u];if(d){const p=f.map(S=>S.presence_ref),h=d.map(S=>S.presence_ref),v=f.filter(S=>h.indexOf(S.presence_ref)<0),m=d.filter(S=>p.indexOf(S.presence_ref)<0);v.length>0&&(o[u]=v),m.length>0&&(l[u]=m)}else o[u]=f}),this.syncDiff(a,{joins:o,leaves:l},n,i)}static syncDiff(t,r,n,i){const{joins:a,leaves:s}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(a,(o,l)=>{var u;const f=(u=t[o])!==null&&u!==void 0?u:[];if(t[o]=this.cloneDeep(l),f.length>0){const d=t[o].map(h=>h.presence_ref),p=f.filter(h=>d.indexOf(h.presence_ref)<0);t[o].unshift(...p)}n(o,f,l)}),this.map(s,(o,l)=>{let u=t[o];if(!u)return;const f=l.map(d=>d.presence_ref);u=u.filter(d=>f.indexOf(d.presence_ref)<0),t[o]=u,i(o,u,l),u.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const i=t[n];return"metas"in i?r[n]=i.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):r[n]=i,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var n5;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(n5||(n5={}));var Bc;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Bc||(Bc={}));var rs;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(rs||(rs={}));class ou{constructor(t,r={config:{}},n){var i,a;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Xr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new ep(this,pa.join,this.params,this.timeout),this.rejoinTimer=new Hx(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Xr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Xr.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Xr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Xr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Xr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(pa.reply,{},(s,o)=>{this._trigger(this._replyEventName(o),s)}),this.presence=new Mc(this),this.broadcastEndpointURL=qx(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((a=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||a===void 0)&&a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,i,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Xr.closed){const{config:{broadcast:s,presence:o,private:l}}=this.params,u=(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(h=>h.filter))!==null&&i!==void 0?i:[],f=!!this.bindings[Bc.PRESENCE]&&this.bindings[Bc.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,d={},p={broadcast:s,presence:Object.assign(Object.assign({},o),{enabled:f}),postgres_changes:u,private:l};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(h=>t==null?void 0:t(rs.CHANNEL_ERROR,h)),this._onClose(()=>t==null?void 0:t(rs.CLOSED)),this.updateJoinPayload(Object.assign({config:p},d)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:h})=>{var v;if(this.socket._isManualToken()||this.socket.setAuth(),h===void 0){t==null||t(rs.SUBSCRIBED);return}else{const m=this.bindings.postgres_changes,S=(v=m==null?void 0:m.length)!==null&&v!==void 0?v:0,y=[];for(let w=0;w<S;w++){const x=m[w],{filter:{event:A,schema:R,table:B,filter:T}}=x,L=h&&h[w];if(L&&L.event===A&&ou.isFilterValueEqual(L.schema,R)&&ou.isFilterValueEqual(L.table,B)&&ou.isFilterValueEqual(L.filter,T))y.push(Object.assign(Object.assign({},x),{id:L.id}));else{this.unsubscribe(),this.state=Xr.errored,t==null||t(rs.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,t&&t(rs.SUBSCRIBED);return}}).receive("error",h=>{this.state=Xr.errored,t==null||t(rs.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(h).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(rs.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===Xr.joined&&t===Bc.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var i;if(r==null)return Promise.reject("Payload is required for httpSend()");const a={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(a.Authorization=`Bearer ${this.socket.accessTokenValue}`);const s={method:"POST",headers:a,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},o=await this._fetchWithTimeout(this.broadcastEndpointURL,s,(i=n.timeout)!==null&&i!==void 0?i:this.timeout);if(o.status===202)return{success:!0};let l=o.statusText;try{const u=await o.json();l=u.error||u.message||l}catch{}return Promise.reject(new Error(l))}async send(t,r={}){var n,i;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:a,payload:s}=t,o={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(o.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:o,body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:s,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=u.body)===null||i===void 0?void 0:i.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var s,o,l;const u=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(o=(s=this.params)===null||s===void 0?void 0:s.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&a("ok"),u.receive("ok",()=>a("ok")),u.receive("error",()=>a("error")),u.receive("timeout",()=>a("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Xr.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(pa.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new ep(this,pa.leave,{},t),n.receive("ok",()=>{r(),i("ok")}).receive("timeout",()=>{r(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Xr.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const i=new AbortController,a=setTimeout(()=>i.abort(),n),s=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(a),s}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new ep(this,t,r,n);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>U6){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var i,a;const s=t.toLocaleLowerCase(),{close:o,error:l,leave:u,join:f}=pa;if(n&&[o,l,u,f].indexOf(s)>=0&&n!==this._joinRef())return;let p=this._onMessage(s,r,n);if(r&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(h=>{var v,m,S;return((v=h.filter)===null||v===void 0?void 0:v.event)==="*"||((S=(m=h.filter)===null||m===void 0?void 0:m.event)===null||S===void 0?void 0:S.toLocaleLowerCase())===s}).map(h=>h.callback(p,n)):(a=this.bindings[s])===null||a===void 0||a.filter(h=>{var v,m,S,y,w,x;if(["broadcast","presence","postgres_changes"].includes(s))if("id"in h){const A=h.id,R=(v=h.filter)===null||v===void 0?void 0:v.event;return A&&((m=r.ids)===null||m===void 0?void 0:m.includes(A))&&(R==="*"||(R==null?void 0:R.toLocaleLowerCase())===((S=r.data)===null||S===void 0?void 0:S.type.toLocaleLowerCase()))}else{const A=(w=(y=h==null?void 0:h.filter)===null||y===void 0?void 0:y.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return A==="*"||A===((x=r==null?void 0:r.event)===null||x===void 0?void 0:x.toLocaleLowerCase())}else return h.type.toLocaleLowerCase()===s}).map(h=>{if(typeof p=="object"&&"ids"in p){const v=p.data,{schema:m,table:S,commit_timestamp:y,type:w,errors:x}=v;p=Object.assign(Object.assign({},{schema:m,table:S,commit_timestamp:y,eventType:w,new:{},old:{},errors:x}),this._getPayloadRecords(v))}h.callback(p,n)})}_isClosed(){return this.state===Xr.closed}_isJoined(){return this.state===Xr.joined}_isJoining(){return this.state===Xr.joining}_isLeaving(){return this.state===Xr.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const i=t.toLocaleLowerCase(),a={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(a):this.bindings[i]=[a],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(i=>{var a;return!(((a=i.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===n&&ou.isEqual(i.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(pa.close,{},t)}_onError(t){this._on(pa.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Xr.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=t5(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=t5(t.columns,t.old_record)),r}}const tp=()=>{},Kh={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},K6=[1e3,2e3,5e3,1e4],Y6=1e4,X6=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class J6{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=xg,this.transport=null,this.heartbeatIntervalMs=Kh.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=tp,this.ref=0,this.reconnectTimer=null,this.vsn=e5,this.logger=tp,this.conn=null,this.sendBuffer=[],this.serializer=new z6,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=i=>i?(...a)=>i(...a):(...a)=>fetch(...a),!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${_g.websocket}`,this.httpEndpoint=qx(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=I6.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Bs.connecting:return Oo.Connecting;case Bs.open:return Oo.Open;case Bs.closing:return Oo.Closing;default:return Oo.Closed}}isConnected(){return this.connectionState()===Oo.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,i=this.getChannels().find(a=>a.topic===n);if(i)return i;{const a=new ou(`realtime:${t}`,r,this);return this.channels.push(a),a}}push(t){const{topic:r,event:n,payload:i,ref:a}=t,s=()=>{this.encode(t,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${a})`,i),this.isConnected()?s():this.sendBuffer.push(s)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(B6,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Kh.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const u=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",u)}catch(f){this.log("error","error in heartbeat callback",f)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:n,event:i,payload:a,ref:s}=r,o=s?`(${s})`:"",l=a.status||"";this.log("receive",`${l} ${n} ${i} ${o}`.trim(),a),this.channels.filter(u=>u._isMember(n)).forEach(u=>u._trigger(i,a,s)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===Bs.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Bs.open||this.conn.readyState===Bs.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t);try{this.heartbeatCallback("error")}catch(r){this.log("error","error in heartbeat callback",r)}}_triggerChanError(){this.channels.forEach(t=>t._trigger(pa.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${t}${n}${i}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([X6],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,n=!1;if(t)r=t,n=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(i){this.log("error","Error fetching access token from callback",i),r=this.accessTokenValue}else r=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(i=>{const a={access_token:r,version:j6};r&&i.updateJoinPayload(a),i.joinedOnce&&i._isJoined()&&i._push(pa.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(i){this.log("error",`error in ${t} callback`,i)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new Hx(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Kh.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,i,a,s,o,l,u,f,d,p,h;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:xg,this.heartbeatIntervalMs=(i=t==null?void 0:t.heartbeatIntervalMs)!==null&&i!==void 0?i:Kh.HEARTBEAT_INTERVAL,this.worker=(a=t==null?void 0:t.worker)!==null&&a!==void 0?a:!1,this.accessToken=(s=t==null?void 0:t.accessToken)!==null&&s!==void 0?s:null,this.heartbeatCallback=(o=t==null?void 0:t.heartbeatCallback)!==null&&o!==void 0?o:tp,this.vsn=(l=t==null?void 0:t.vsn)!==null&&l!==void 0?l:e5,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=t==null?void 0:t.reconnectAfterMs)!==null&&u!==void 0?u:v=>K6[v-1]||Y6,this.vsn){case M6:this.encode=(f=t==null?void 0:t.encode)!==null&&f!==void 0?f:(v,m)=>m(JSON.stringify(v)),this.decode=(d=t==null?void 0:t.decode)!==null&&d!==void 0?d:(v,m)=>m(JSON.parse(v));break;case zx:this.encode=(p=t==null?void 0:t.encode)!==null&&p!==void 0?p:this.serializer.encode.bind(this.serializer),this.decode=(h=t==null?void 0:t.decode)!==null&&h!==void 0?h:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}var mf=class extends Error{constructor(e,t){var r;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&((r=t.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function Q6(e,t,r){const n=new URL(t,e);if(r)for(const[i,a]of Object.entries(r))a!==void 0&&n.searchParams.set(i,a);return n.toString()}async function Z6(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function eE(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:n,query:i,body:a,headers:s}){const o=Q6(e.baseUrl,n,i),l=await Z6(e.auth),u=await t(o,{method:r,headers:{...a?{"Content-Type":"application/json"}:{},...l,...s},body:a?JSON.stringify(a):void 0}),f=await u.text(),d=(u.headers.get("content-type")||"").includes("application/json"),p=d&&f?JSON.parse(f):f;if(!u.ok){const h=d?p:void 0,v=h==null?void 0:h.error;throw new mf((v==null?void 0:v.message)??`Request failed with status ${u.status}`,{status:u.status,icebergType:v==null?void 0:v.type,icebergCode:v==null?void 0:v.code,details:h})}return{status:u.status,headers:u.headers,data:p}}}}function Yh(e){return e.join("")}var tE=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:Yh(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t==null?void 0:t.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Yh(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Yh(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Yh(e.namespace)}`}),!0}catch(t){if(t instanceof mf&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof mf&&r.status===409)return;throw r}}};function Ol(e){return e.join("")}var rE=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ol(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ol(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${Ol(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Ol(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String((t==null?void 0:t.purge)??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ol(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Ol(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof mf&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof mf&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},nE=class{constructor(e){var n;let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=eE({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=(n=e.accessDelegation)==null?void 0:n.join(","),this.namespaceOps=new tE(this.client,t),this.tableOps=new rE(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},Pd=class extends Error{constructor(e,t="storage",r,n){super(e),this.__isStorageError=!0,this.namespace=t,this.name=t==="vectors"?"StorageVectorsError":"StorageError",this.status=r,this.statusCode=n}};function Od(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var Xh=class extends Pd{constructor(e,t,r,n="storage"){super(e,n,t,r),this.name=n==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},$x=class extends Pd{constructor(e,t,r="storage"){super(e,r),this.name=r==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=t}};const iE=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),aE=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},bg=e=>{if(Array.isArray(e))return e.map(r=>bg(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));t[i]=bg(n)}),t},sE=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function vf(e){"@babel/helpers - typeof";return vf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vf(e)}function oE(e,t){if(vf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(vf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lE(e){var t=oE(e,"string");return vf(t)=="symbol"?t:t+""}function uE(e,t,r){return(t=lE(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function vt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?i5(Object(r),!0).forEach(function(n){uE(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const a5=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},cE=async(e,t,r,n)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const i=e,a=i.status||500;if(typeof i.json=="function")i.json().then(s=>{const o=(s==null?void 0:s.statusCode)||(s==null?void 0:s.code)||a+"";t(new Xh(a5(s),a,o,n))}).catch(()=>{if(n==="vectors"){const s=a+"";t(new Xh(i.statusText||`HTTP ${a} error`,a,s,n))}else{const s=a+"";t(new Xh(i.statusText||`HTTP ${a} error`,a,s,n))}});else{const s=a+"";t(new Xh(i.statusText||`HTTP ${a} error`,a,s,n))}}else t(new $x(a5(e),e,n))},fE=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||e==="HEAD"||!n?vt(vt({},i),r):(aE(n)?(i.headers=vt({"Content-Type":"application/json"},t==null?void 0:t.headers),i.body=JSON.stringify(n)):i.body=n,t!=null&&t.duplex&&(i.duplex=t.duplex),vt(vt({},i),r))};async function wc(e,t,r,n,i,a,s){return new Promise((o,l)=>{e(r,fE(t,n,i,a)).then(u=>{if(!u.ok)throw u;if(n!=null&&n.noResolveJson)return u;if(s==="vectors"){const f=u.headers.get("content-type");if(u.headers.get("content-length")==="0"||u.status===204)return{};if(!f||!f.includes("application/json"))return{}}return u.json()}).then(u=>o(u)).catch(u=>cE(u,l,n,s))})}function Vx(e="storage"){return{get:async(t,r,n,i)=>wc(t,"GET",r,n,i,void 0,e),post:async(t,r,n,i,a)=>wc(t,"POST",r,i,a,n,e),put:async(t,r,n,i,a)=>wc(t,"PUT",r,i,a,n,e),head:async(t,r,n,i)=>wc(t,"HEAD",r,vt(vt({},n),{},{noResolveJson:!0}),i,void 0,e),remove:async(t,r,n,i,a)=>wc(t,"DELETE",r,i,a,n,e)}}const hE=Vx("storage"),{get:yf,post:fa,put:Eg,head:dE,remove:U2}=hE,bi=Vx("vectors");var Pu=class{constructor(e,t={},r,n="storage"){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.fetch=iE(r),this.namespace=n}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=vt(vt({},this.headers),{},{[e]:t}),this}async handleOperation(e){var t=this;try{return{data:await e(),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Od(r))return{data:null,error:r};throw r}}},pE=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Od(t))return{data:null,error:t};throw t}}};let Gx;Gx=Symbol.toStringTag;var gE=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[Gx]="BlobDownloadBuilder",this.promise=null}asStream(){return new pE(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Od(t))return{data:null,error:t};throw t}}};const mE={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},s5={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var vE=class extends Pu{constructor(e,t={},r,n){super(e,t,n,"storage"),this.bucketId=r}async uploadOrUpdate(e,t,r,n){var i=this;return i.handleOperation(async()=>{let a;const s=vt(vt({},s5),n);let o=vt(vt({},i.headers),e==="POST"&&{"x-upsert":String(s.upsert)});const l=s.metadata;typeof Blob<"u"&&r instanceof Blob?(a=new FormData,a.append("cacheControl",s.cacheControl),l&&a.append("metadata",i.encodeMetadata(l)),a.append("",r)):typeof FormData<"u"&&r instanceof FormData?(a=r,a.has("cacheControl")||a.append("cacheControl",s.cacheControl),l&&!a.has("metadata")&&a.append("metadata",i.encodeMetadata(l))):(a=r,o["cache-control"]=`max-age=${s.cacheControl}`,o["content-type"]=s.contentType,l&&(o["x-metadata"]=i.toBase64(i.encodeMetadata(l))),(typeof ReadableStream<"u"&&a instanceof ReadableStream||a&&typeof a=="object"&&"pipe"in a&&typeof a.pipe=="function")&&!s.duplex&&(s.duplex="half")),n!=null&&n.headers&&(o=vt(vt({},o),n.headers));const u=i._removeEmptyFolders(t),f=i._getFinalPath(u),d=await(e=="PUT"?Eg:fa)(i.fetch,`${i.url}/object/${f}`,a,vt({headers:o},s!=null&&s.duplex?{duplex:s.duplex}:{}));return{path:u,id:d.Id,fullPath:d.Key}})}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,n){var i=this;const a=i._removeEmptyFolders(e),s=i._getFinalPath(a),o=new URL(i.url+`/object/upload/sign/${s}`);return o.searchParams.set("token",t),i.handleOperation(async()=>{let l;const u=vt({upsert:s5.upsert},n),f=vt(vt({},i.headers),{"x-upsert":String(u.upsert)});return typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",u.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",u.cacheControl)):(l=r,f["cache-control"]=`max-age=${u.cacheControl}`,f["content-type"]=u.contentType),{path:a,fullPath:(await Eg(i.fetch,o.toString(),l,{headers:f})).Key}})}async createSignedUploadUrl(e,t){var r=this;return r.handleOperation(async()=>{let n=r._getFinalPath(e);const i=vt({},r.headers);t!=null&&t.upsert&&(i["x-upsert"]="true");const a=await fa(r.fetch,`${r.url}/object/upload/sign/${n}`,{},{headers:i}),s=new URL(r.url+a.url),o=s.searchParams.get("token");if(!o)throw new Pd("No token returned by API");return{signedUrl:s.toString(),path:e,token:o}})}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var n=this;return n.handleOperation(async()=>await fa(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers}))}async copy(e,t,r){var n=this;return n.handleOperation(async()=>({path:(await fa(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers})).Key}))}async createSignedUrl(e,t,r){var n=this;return n.handleOperation(async()=>{let i=n._getFinalPath(e),a=await fa(n.fetch,`${n.url}/object/sign/${i}`,vt({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:n.headers});const s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{signedUrl:encodeURI(`${n.url}${a.signedURL}${s}`)}})}async createSignedUrls(e,t,r){var n=this;return n.handleOperation(async()=>{const i=await fa(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:t,paths:e},{headers:n.headers}),a=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i.map(s=>vt(vt({},s),{},{signedUrl:s.signedURL?encodeURI(`${n.url}${s.signedURL}${a}`):null}))})}download(e,t,r){const n=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),a=i?`?${i}`:"",s=this._getFinalPath(e),o=()=>yf(this.fetch,`${this.url}/${n}/${s}${a}`,{headers:this.headers,noResolveJson:!0},r);return new gE(o,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);return t.handleOperation(async()=>bg(await yf(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})))}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await dE(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Od(n)&&n instanceof $x){const i=n.originalError;if([400,404].includes(i==null?void 0:i.status))return{data:!1,error:n}}throw n}}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&n.push(i);const a=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",s=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});s!==""&&n.push(s);let o=n.join("&");return o!==""&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${r}${o}`)}}}async remove(e){var t=this;return t.handleOperation(async()=>await U2(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}))}async list(e,t,r){var n=this;return n.handleOperation(async()=>{const i=vt(vt(vt({},mE),t),{},{prefix:e||""});return await fa(n.fetch,`${n.url}/object/list/${n.bucketId}`,i,{headers:n.headers},r)})}async listV2(e,t){var r=this;return r.handleOperation(async()=>{const n=vt({},e);return await fa(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,n,{headers:r.headers},t)})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const yE="2.97.0",Df={"X-Client-Info":`storage-js/${yE}`};var wE=class extends Pu{constructor(e,t={},r,n){const i=new URL(e);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase."));const a=i.href.replace(/\/$/,""),s=vt(vt({},Df),t);super(a,s,r,"storage")}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const r=t.listBucketOptionsToQueryString(e);return await yf(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers})})}async getBucket(e){var t=this;return t.handleOperation(async()=>await yf(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}))}async createBucket(e,t={public:!1}){var r=this;return r.handleOperation(async()=>await fa(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async updateBucket(e,t){var r=this;return r.handleOperation(async()=>await Eg(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async emptyBucket(e){var t=this;return t.handleOperation(async()=>await fa(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await U2(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},xE=class extends Pu{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=vt(vt({},Df),t);super(n,i,r,"storage")}async createBucket(e){var t=this;return t.handleOperation(async()=>await fa(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}))}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const r=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&r.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&r.set("sortOrder",e.sortOrder),e!=null&&e.search&&r.set("search",e.search);const n=r.toString(),i=n?`${t.url}/bucket?${n}`:`${t.url}/bucket`;return await yf(t.fetch,i,{headers:t.headers})})}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await U2(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}from(e){var t=this;if(!sE(e))throw new Pd("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new nE({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(r,{get(i,a){const s=i[a];return typeof s!="function"?s:async(...o)=>{try{return{data:await s.apply(i,o),error:null}}catch(l){if(n)throw l;return{data:null,error:l}}}}})}},_E=class extends Pu{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=vt(vt({},Df),{},{"Content-Type":"application/json"},t);super(n,i,r,"vectors")}async createIndex(e){var t=this;return t.handleOperation(async()=>await bi.post(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{})}async getIndex(e,t){var r=this;return r.handleOperation(async()=>await bi.post(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}))}async listIndexes(e){var t=this;return t.handleOperation(async()=>await bi.post(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}))}async deleteIndex(e,t){var r=this;return r.handleOperation(async()=>await bi.post(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{})}},SE=class extends Pu{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=vt(vt({},Df),{},{"Content-Type":"application/json"},t);super(n,i,r,"vectors")}async putVectors(e){var t=this;if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return t.handleOperation(async()=>await bi.post(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{})}async getVectors(e){var t=this;return t.handleOperation(async()=>await bi.post(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}))}async listVectors(e){var t=this;if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return t.handleOperation(async()=>await bi.post(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}))}async queryVectors(e){var t=this;return t.handleOperation(async()=>await bi.post(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}))}async deleteVectors(e){var t=this;if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return t.handleOperation(async()=>await bi.post(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{})}},bE=class extends Pu{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=vt(vt({},Df),{},{"Content-Type":"application/json"},t);super(n,i,r,"vectors")}async createBucket(e){var t=this;return t.handleOperation(async()=>await bi.post(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}async getBucket(e){var t=this;return t.handleOperation(async()=>await bi.post(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}))}async listBuckets(e={}){var t=this;return t.handleOperation(async()=>await bi.post(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await bi.post(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}},EE=class extends bE{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new AE(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},AE=class extends _E{constructor(e,t,r,n){super(e,t,n),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,vt(vt({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,vt(vt({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new TE(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},TE=class extends SE{constructor(e,t,r,n,i){super(e,t,i),this.vectorBucketName=r,this.indexName=n}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,vt(vt({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,vt(vt({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,vt(vt({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,vt(vt({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,vt(vt({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},kE=class extends wE{constructor(e,t={},r,n){super(e,t,r,n)}from(e){return new vE(this.url,this.headers,e,this.fetch)}get vectors(){return new EE(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new xE(this.url+"/iceberg",this.headers,this.fetch)}};const Kx="2.97.0",ql=30*1e3,Ag=3,rp=Ag*ql,NE="http://localhost:9999",CE="supabase.auth.token",LE={"X-Client-Info":`gotrue-js/${Kx}`},Tg="X-Supabase-Api-Version",Yx={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},PE=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,OE=10*60*1e3;class wf extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function ft(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class FE extends wf{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function RE(e){return ft(e)&&e.name==="AuthApiError"}class Fo extends wf{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class vs extends wf{constructor(t,r,n,i){super(t,n,i),this.name=r,this.status=n}}class vi extends vs{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function np(e){return ft(e)&&e.name==="AuthSessionMissingError"}class Fl extends vs{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Jh extends vs{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Qh extends vs{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function IE(e){return ft(e)&&e.name==="AuthImplicitGrantRedirectError"}class o5 extends vs{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class DE extends vs{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class kg extends vs{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function ip(e){return ft(e)&&e.name==="AuthRetryableFetchError"}class l5 extends vs{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Ng extends vs{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Y0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),u5=` 	
\r=`.split(""),jE=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<u5.length;t+=1)e[u5[t].charCodeAt(0)]=-2;for(let t=0;t<Y0.length;t+=1)e[Y0[t].charCodeAt(0)]=t;return e})();function c5(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Y0[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Y0[n]),t.queuedBits-=6}}function Xx(e,t,r){const n=jE[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function f5(e){const t=[],r=s=>{t.push(String.fromCodePoint(s))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},a=s=>{UE(s,n,r)};for(let s=0;s<e.length;s+=1)Xx(e.charCodeAt(s),i,a);return t.join("")}function ME(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function BE(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}ME(n,t)}}function UE(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function gu(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};for(let i=0;i<e.length;i+=1)Xx(e.charCodeAt(i),r,n);return new Uint8Array(t)}function zE(e){const t=[];return BE(e,r=>t.push(r)),new Uint8Array(t)}function Mo(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};return e.forEach(i=>c5(i,r,n)),c5(null,r,n),t.join("")}function HE(e){return Math.round(Date.now()/1e3)+e}function WE(){return Symbol("auth-callback")}const dn=()=>typeof window<"u"&&typeof document<"u",To={tested:!1,writable:!1},Jx=()=>{if(!dn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(To.tested)return To.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),To.tested=!0,To.writable=!0}catch{To.tested=!0,To.writable=!1}return To.writable};function qE(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,a)=>{t[a]=i})}catch{}return r.searchParams.forEach((n,i)=>{t[i]=n}),t}const Qx=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),$E=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",$l=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},ko=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},hn=async(e,t)=>{await e.removeItem(t)};class Fd{constructor(){this.promise=new Fd.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Fd.promiseConstructor=Promise;function Zh(e){const t=e.split(".");if(t.length!==3)throw new Ng("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!PE.test(t[n]))throw new Ng("JWT not in base64url format");return{header:JSON.parse(f5(t[0])),payload:JSON.parse(f5(t[1])),signature:gu(t[2]),raw:{header:t[0],payload:t[1]}}}async function VE(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function GE(e,t){return new Promise((n,i)=>{(async()=>{for(let a=0;a<1/0;a++)try{const s=await e(a);if(!t(a,null,s)){n(s);return}}catch(s){if(!t(a,s)){i(s);return}}})()})}function KE(e){return("0"+e.toString(16)).substr(-2)}function YE(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let a=0;a<56;a++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(t),Array.from(t,KE).join("")}async function XE(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(a=>String.fromCharCode(a)).join("")}async function JE(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await XE(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Rl(e,t,r=!1){const n=YE();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await $l(e,`${t}-code-verifier`,i);const a=await JE(n);return[a,n===a?"plain":"s256"]}const QE=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function ZE(e){const t=e.headers.get(Tg);if(!t||!t.match(QE))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function eA(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function tA(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const rA=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Il(e){if(!rA.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function ap(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function nA(e,t){return new Proxy(e,{get:(r,n,i)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const a=n.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)"||a==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,i)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,i)}})}function h5(e){return JSON.parse(JSON.stringify(e))}const Lo=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),iA=[502,503,504];async function d5(e){var t;if(!$E(e))throw new kg(Lo(e),0);if(iA.includes(e.status))throw new kg(Lo(e),e.status);let r;try{r=await e.json()}catch(a){throw new Fo(Lo(a),a)}let n;const i=ZE(e);if(i&&i.getTime()>=Yx["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new l5(Lo(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new vi}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((a,s)=>a&&typeof s=="string",!0))throw new l5(Lo(r),e.status,r.weak_password.reasons);throw new FE(Lo(r),e.status||500,n)}const aA=(e,t,r,n)=>{const i={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function yt(e,t,r,n){var i;const a=Object.assign({},n==null?void 0:n.headers);a[Tg]||(a[Tg]=Yx["2024-01-01"].name),n!=null&&n.jwt&&(a.Authorization=`Bearer ${n.jwt}`);const s=(i=n==null?void 0:n.query)!==null&&i!==void 0?i:{};n!=null&&n.redirectTo&&(s.redirect_to=n.redirectTo);const o=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",l=await sA(e,t,r+o,{headers:a,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function sA(e,t,r,n,i,a){const s=aA(t,n,i,a);let o;try{o=await e(r,Object.assign({},s))}catch(l){throw console.error(l),new kg(Lo(l),0)}if(o.ok||await d5(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await d5(l)}}function ua(e){var t;let r=null;uA(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=HE(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function p5(e){const t=ua(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Hs(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function oA(e){return{data:e,error:null}}function lA(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:a}=e,s=Ld(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:a},l=Object.assign({},s);return{data:{properties:o,user:l},error:null}}function g5(e){return e}function uA(e){return e.access_token&&e.refresh_token&&e.expires_in}const sp=["global","local","others"];class cA{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=Qx(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=sp[0]){if(sp.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${sp.join(", ")}`);try{return await yt(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(ft(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await yt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Hs})}catch(n){if(ft(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=Ld(t,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n==null?void 0:n.newEmail,delete i.newEmail),await yt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:lA,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(ft(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await yt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Hs})}catch(r){if(ft(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,i,a,s,o,l;try{const u={nextPage:null,lastPage:0,total:0},f=await yt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(a=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&a!==void 0?a:""},xform:g5});if(f.error)throw f.error;const d=await f.json(),p=(s=f.headers.get("x-total-count"))!==null&&s!==void 0?s:0,h=(l=(o=f.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return h.length>0&&(h.forEach(v=>{const m=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(v.split(";")[1].split("=")[1]);u[`${S}Page`]=m}),u.total=parseInt(p)),{data:Object.assign(Object.assign({},d),u),error:null}}catch(u){if(ft(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){Il(t);try{return await yt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Hs})}catch(r){if(ft(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Il(t);try{return await yt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Hs})}catch(n){if(ft(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){Il(t);try{return await yt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Hs})}catch(n){if(ft(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Il(t.userId);try{const{data:r,error:n}=await yt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(ft(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Il(t.userId),Il(t.id);try{return{data:await yt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(ft(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,i,a,s,o,l;try{const u={nextPage:null,lastPage:0,total:0},f=await yt(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(a=(i=t==null?void 0:t.perPage)===null||i===void 0?void 0:i.toString())!==null&&a!==void 0?a:""},xform:g5});if(f.error)throw f.error;const d=await f.json(),p=(s=f.headers.get("x-total-count"))!==null&&s!==void 0?s:0,h=(l=(o=f.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return h.length>0&&(h.forEach(v=>{const m=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),S=JSON.parse(v.split(";")[1].split("=")[1]);u[`${S}Page`]=m}),u.total=parseInt(p)),{data:Object.assign(Object.assign({},d),u),error:null}}catch(u){if(ft(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(t){try{return await yt(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(ft(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await yt(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(ft(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await yt(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(ft(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await yt(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(ft(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await yt(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(ft(r))return{data:null,error:r};throw r}}}function m5(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const Dl={debug:!!(globalThis&&Jx()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class Zx extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class v5 extends Zx{}async function fA(e,t,r){Dl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;t>0&&setTimeout(()=>{n.abort(),Dl.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve();try{return await globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){Dl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await r()}finally{Dl.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(t===0)throw Dl.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new v5(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Dl.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}})}catch(i){throw(i==null?void 0:i.name)==="AbortError"?new v5(`Acquiring an exclusive Navigator LockManager lock "${e}" timed out waiting ${t}ms`):i}}function hA(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function e_(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function dA(e){return parseInt(e,16)}function pA(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function gA(e){var t;const{chainId:r,domain:n,expirationTime:i,issuedAt:a=new Date,nonce:s,notBefore:o,requestId:l,resources:u,scheme:f,uri:d,version:p}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(s&&s.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${s}`);if(!d)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(p!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${p}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const h=e_(e.address),v=f?`${f}://${n}`:n,m=e.statement?`${e.statement}
`:"",S=`${v} wants you to sign in with your Ethereum account:
${h}

${m}`;let y=`URI: ${d}
Version: ${p}
Chain ID: ${r}${s?`
Nonce: ${s}`:""}
Issued At: ${a.toISOString()}`;if(i&&(y+=`
Expiration Time: ${i.toISOString()}`),o&&(y+=`
Not Before: ${o.toISOString()}`),l&&(y+=`
Request ID: ${l}`),u){let w=`
Resources:`;for(const x of u){if(!x||typeof x!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${x}`);w+=`
- ${x}`}y+=w}return`${S}
${y}`}class Wr extends Error{constructor({message:t,code:r,cause:n,name:i}){var a;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(a=i??(n instanceof Error?n.name:void 0))!==null&&a!==void 0?a:"Unknown Error",this.code=r}}class X0 extends Wr{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function mA({error:e,options:t}){var r,n,i;const{publicKey:a}=t;if(!a)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Wr({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=a.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Wr({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=a.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Wr({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((i=a.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new Wr({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Wr({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Wr({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return a.pubKeyCredParams.filter(o=>o.type==="public-key").length===0?new Wr({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Wr({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const s=window.location.hostname;if(t_(s)){if(a.rp.id!==s)return new Wr({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Wr({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new Wr({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Wr({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Wr({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function vA({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Wr({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Wr({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(t_(n)){if(r.rpId!==n)return new Wr({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Wr({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Wr({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Wr({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class yA{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const wA=new yA;function xA(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,i=Ld(e,["challenge","user","excludeCredentials"]),a=gu(t).buffer,s=Object.assign(Object.assign({},r),{id:gu(r.id).buffer}),o=Object.assign(Object.assign({},i),{challenge:a,user:s});if(n&&n.length>0){o.excludeCredentials=new Array(n.length);for(let l=0;l<n.length;l++){const u=n[l];o.excludeCredentials[l]=Object.assign(Object.assign({},u),{id:gu(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return o}function _A(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=Ld(e,["challenge","allowCredentials"]),i=gu(t).buffer,a=Object.assign(Object.assign({},n),{challenge:i});if(r&&r.length>0){a.allowCredentials=new Array(r.length);for(let s=0;s<r.length;s++){const o=r[s];a.allowCredentials[s]=Object.assign(Object.assign({},o),{id:gu(o.id).buffer,type:o.type||"public-key",transports:o.transports})}}return a}function SA(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:Mo(new Uint8Array(e.response.attestationObject)),clientDataJSON:Mo(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function bA(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),i=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:Mo(new Uint8Array(i.authenticatorData)),clientDataJSON:Mo(new Uint8Array(i.clientDataJSON)),signature:Mo(new Uint8Array(i.signature)),userHandle:i.userHandle?Mo(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function t_(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function y5(){var e,t;return!!(dn()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function EA(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new X0("Browser returned unexpected credential type",t)}:{data:null,error:new X0("Empty credential response",t)}}catch(t){return{data:null,error:mA({error:t,options:e})}}}async function AA(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new X0("Browser returned unexpected credential type",t)}:{data:null,error:new X0("Empty credential response",t)}}catch(t){return{data:null,error:vA({error:t,options:e})}}}const TA={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},kA={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function J0(...e){const t=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),r=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),n={};for(const i of e)if(i)for(const a in i){const s=i[a];if(s!==void 0)if(Array.isArray(s))n[a]=s;else if(r(s))n[a]=s;else if(t(s)){const o=n[a];t(o)?n[a]=J0(o,s):n[a]=J0(s)}else n[a]=s}return n}function NA(e,t){return J0(TA,e,t||{})}function CA(e,t){return J0(kA,e,t||{})}class LA{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:i},a){var s;try{const{data:o,error:l}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!o)return{data:null,error:l};const u=i??wA.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:f}=o.webauthn.credential_options.publicKey;if(!f.name){const d=n;if(d)f.name=`${f.id}:${d}`;else{const h=(await this.client.getUser()).data.user,v=((s=h==null?void 0:h.user_metadata)===null||s===void 0?void 0:s.name)||(h==null?void 0:h.email)||(h==null?void 0:h.id)||"User";f.name=`${f.id}:${v}`}}f.displayName||(f.displayName=f.name)}switch(o.webauthn.type){case"create":{const f=NA(o.webauthn.credential_options.publicKey,a==null?void 0:a.create),{data:d,error:p}=await EA({publicKey:f,signal:u});return d?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:d}},error:null}:{data:null,error:p}}case"request":{const f=CA(o.webauthn.credential_options.publicKey,a==null?void 0:a.request),{data:d,error:p}=await AA(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:f,signal:u}));return d?{data:{factorId:t,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:d}},error:null}:{data:null,error:p}}}}catch(o){return ft(o)?{data:null,error:o}:{data:null,error:new Fo("Unexpected error in challenge",o)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},a){if(!r)return{data:null,error:new wf("rpId is required for WebAuthn authentication")};try{if(!y5())return{data:null,error:new Fo("Browser does not support WebAuthn",null)};const{data:s,error:o}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:i},{request:a});if(!s)return{data:null,error:o};const{webauthn:l}=s;return this._verify({factorId:t,challengeId:s.challengeId,webauthn:{type:l.type,rpId:r,rpOrigins:n,credential_response:l.credential_response}})}catch(s){return ft(s)?{data:null,error:s}:{data:null,error:new Fo("Unexpected error in authenticate",s)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},a){if(!r)return{data:null,error:new wf("rpId is required for WebAuthn registration")};try{if(!y5())return{data:null,error:new Fo("Browser does not support WebAuthn",null)};const{data:s,error:o}=await this._enroll({friendlyName:t});if(!s)return await this.client.mfa.listFactors().then(f=>{var d;return(d=f.data)===null||d===void 0?void 0:d.all.find(p=>p.factor_type==="webauthn"&&p.friendly_name===t&&p.status!=="unverified")}).then(f=>f?this.client.mfa.unenroll({factorId:f==null?void 0:f.id}):void 0),{data:null,error:o};const{data:l,error:u}=await this._challenge({factorId:s.id,friendlyName:s.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:i},{create:a});return l?this._verify({factorId:s.id,challengeId:l.challengeId,webauthn:{rpId:r,rpOrigins:n,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:u}}catch(s){return ft(s)?{data:null,error:s}:{data:null,error:new Fo("Unexpected error in register",s)}}}}hA();const PA={url:NE,storageKey:CE,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:LE,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4,skipAutoInitialize:!1};async function w5(e,t,r){return await r()}const jl={};class xf{get jwks(){var t,r;return(r=(t=jl[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){jl[this.storageKey]=Object.assign(Object.assign({},jl[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=jl[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){jl[this.storageKey]=Object.assign(Object.assign({},jl[this.storageKey]),{cachedAt:t})}constructor(t){var r,n,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const a=Object.assign(Object.assign({},PA),t);if(this.storageKey=a.storageKey,this.instanceID=(r=xf.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,xf.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.instanceID>0&&dn()){const s=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(s),this.logDebugMessages&&console.trace(s)}if(this.persistSession=a.persistSession,this.autoRefreshToken=a.autoRefreshToken,this.admin=new cA({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=Qx(a.fetch),this.lock=a.lock||w5,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,this.lockAcquireTimeout=a.lockAcquireTimeout,a.lock?this.lock=a.lock:this.persistSession&&dn()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=fA:this.lock=w5,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new LA(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:Jx()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=m5(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=m5(this.memoryStorage)),dn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s);try{await this._notifyAllSubscribers(s.data.event,s.data.session,!1)}catch(o){this._debug("#broadcastChannel","error",o)}})}a.skipAutoInitialize||this.initialize().catch(s=>{this._debug("#initialize()","error",s)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${Kx}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(dn()&&(r=qE(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),dn()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:a}=await this._getSessionFromURL(r,n);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),IE(a)){const l=(t=a.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:a}}return{error:a}}const{session:s,redirectType:o}=i;return this._debug("#_initialize()","detected session in URL",s,"redirect type",o),await this._saveSession(s),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return ft(r)?this._returnResult({error:r}):this._returnResult({error:new Fo("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,i;try{const a=await yt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=t==null?void 0:t.options)===null||i===void 0?void 0:i.captchaToken}},xform:ua}),{data:s,error:o}=a;if(o||!s)return this._returnResult({data:{user:null,session:null},error:o});const l=s.session,u=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(a){if(ft(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(t){var r,n,i;try{let a;if("email"in t){const{email:f,password:d,options:p}=t;let h=null,v=null;this.flowType==="pkce"&&([h,v]=await Rl(this.storage,this.storageKey)),a=await yt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:f,password:d,data:(r=p==null?void 0:p.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:h,code_challenge_method:v},xform:ua})}else if("phone"in t){const{phone:f,password:d,options:p}=t;a=await yt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:f,password:d,data:(n=p==null?void 0:p.data)!==null&&n!==void 0?n:{},channel:(i=p==null?void 0:p.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:ua})}else throw new Jh("You must provide either an email or phone number and a password");const{data:s,error:o}=a;if(o||!s)return await hn(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:o});const l=s.session,u=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(a){if(await hn(this.storage,`${this.storageKey}-code-verifier`),ft(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(t){try{let r;if("email"in t){const{email:a,password:s,options:o}=t;r=await yt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:p5})}else if("phone"in t){const{phone:a,password:s,options:o}=t;r=await yt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:s,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:p5})}else throw new Jh("You must provide either an email or phone number and a password");const{data:n,error:i}=r;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!n||!n.session||!n.user){const a=new Fl;return this._returnResult({data:{user:null,session:null},error:a})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(ft(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,i,a;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(a=t.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,i,a,s,o,l,u,f,d,p;let h,v;if("message"in t)h=t.message,v=t.signature;else{const{chain:m,wallet:S,statement:y,options:w}=t;let x;if(dn())if(typeof S=="object")x=S;else{const P=window;if("ethereum"in P&&typeof P.ethereum=="object"&&"request"in P.ethereum&&typeof P.ethereum.request=="function")x=P.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof S!="object"||!(w!=null&&w.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");x=S}const A=new URL((r=w==null?void 0:w.url)!==null&&r!==void 0?r:window.location.href),R=await x.request({method:"eth_requestAccounts"}).then(P=>P).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!R||R.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const B=e_(R[0]);let T=(n=w==null?void 0:w.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!T){const P=await x.request({method:"eth_chainId"});T=dA(P)}const L={domain:A.host,address:B,statement:y,uri:A.href,version:"1",chainId:T,nonce:(i=w==null?void 0:w.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(s=(a=w==null?void 0:w.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&s!==void 0?s:new Date,expirationTime:(o=w==null?void 0:w.signInWithEthereum)===null||o===void 0?void 0:o.expirationTime,notBefore:(l=w==null?void 0:w.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(u=w==null?void 0:w.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(f=w==null?void 0:w.signInWithEthereum)===null||f===void 0?void 0:f.resources};h=gA(L),v=await x.request({method:"personal_sign",params:[pA(h),B]})}try{const{data:m,error:S}=await yt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:h,signature:v},!((d=t.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(p=t.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:ua});if(S)throw S;if(!m||!m.session||!m.user){const y=new Fl;return this._returnResult({data:{user:null,session:null},error:y})}return m.session&&(await this._saveSession(m.session),await this._notifyAllSubscribers("SIGNED_IN",m.session)),this._returnResult({data:Object.assign({},m),error:S})}catch(m){if(ft(m))return this._returnResult({data:{user:null,session:null},error:m});throw m}}async signInWithSolana(t){var r,n,i,a,s,o,l,u,f,d,p,h;let v,m;if("message"in t)v=t.message,m=t.signature;else{const{chain:S,wallet:y,statement:w,options:x}=t;let A;if(dn())if(typeof y=="object")A=y;else{const B=window;if("solana"in B&&typeof B.solana=="object"&&("signIn"in B.solana&&typeof B.solana.signIn=="function"||"signMessage"in B.solana&&typeof B.solana.signMessage=="function"))A=B.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof y!="object"||!(x!=null&&x.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");A=y}const R=new URL((r=x==null?void 0:x.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in A&&A.signIn){const B=await A.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},x==null?void 0:x.signInWithSolana),{version:"1",domain:R.host,uri:R.href}),w?{statement:w}:null));let T;if(Array.isArray(B)&&B[0]&&typeof B[0]=="object")T=B[0];else if(B&&typeof B=="object"&&"signedMessage"in B&&"signature"in B)T=B;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in T&&"signature"in T&&(typeof T.signedMessage=="string"||T.signedMessage instanceof Uint8Array)&&T.signature instanceof Uint8Array)v=typeof T.signedMessage=="string"?T.signedMessage:new TextDecoder().decode(T.signedMessage),m=T.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in A)||typeof A.signMessage!="function"||!("publicKey"in A)||typeof A!="object"||!A.publicKey||!("toBase58"in A.publicKey)||typeof A.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");v=[`${R.host} wants you to sign in with your Solana account:`,A.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${R.href}`,`Issued At: ${(i=(n=x==null?void 0:x.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((a=x==null?void 0:x.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${x.signInWithSolana.notBefore}`]:[],...!((s=x==null?void 0:x.signInWithSolana)===null||s===void 0)&&s.expirationTime?[`Expiration Time: ${x.signInWithSolana.expirationTime}`]:[],...!((o=x==null?void 0:x.signInWithSolana)===null||o===void 0)&&o.chainId?[`Chain ID: ${x.signInWithSolana.chainId}`]:[],...!((l=x==null?void 0:x.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${x.signInWithSolana.nonce}`]:[],...!((u=x==null?void 0:x.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${x.signInWithSolana.requestId}`]:[],...!((d=(f=x==null?void 0:x.signInWithSolana)===null||f===void 0?void 0:f.resources)===null||d===void 0)&&d.length?["Resources",...x.signInWithSolana.resources.map(T=>`- ${T}`)]:[]].join(`
`);const B=await A.signMessage(new TextEncoder().encode(v),"utf8");if(!B||!(B instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");m=B}}try{const{data:S,error:y}=await yt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:v,signature:Mo(m)},!((p=t.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(h=t.options)===null||h===void 0?void 0:h.captchaToken}}:null),xform:ua});if(y)throw y;if(!S||!S.session||!S.user){const w=new Fl;return this._returnResult({data:{user:null,session:null},error:w})}return S.session&&(await this._saveSession(S.session),await this._notifyAllSubscribers("SIGNED_IN",S.session)),this._returnResult({data:Object.assign({},S),error:y})}catch(S){if(ft(S))return this._returnResult({data:{user:null,session:null},error:S});throw S}}async _exchangeCodeForSession(t){const r=await ko(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{if(!n&&this.flowType==="pkce")throw new DE;const{data:a,error:s}=await yt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:ua});if(await hn(this.storage,`${this.storageKey}-code-verifier`),s)throw s;if(!a||!a.session||!a.user){const o=new Fl;return this._returnResult({data:{user:null,session:null,redirectType:null},error:o})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign(Object.assign({},a),{redirectType:i??null}),error:s})}catch(a){if(await hn(this.storage,`${this.storageKey}-code-verifier`),ft(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(t){try{const{options:r,provider:n,token:i,access_token:a,nonce:s}=t,o=await yt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:a,nonce:s,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:ua}),{data:l,error:u}=o;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!l||!l.session||!l.user){const f=new Fl;return this._returnResult({data:{user:null,session:null},error:f})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:l,error:u})}catch(r){if(ft(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,i,a,s;try{if("email"in t){const{email:o,options:l}=t;let u=null,f=null;this.flowType==="pkce"&&([u,f]=await Rl(this.storage,this.storageKey));const{error:d}=await yt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:u,code_challenge_method:f},redirectTo:l==null?void 0:l.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:d})}if("phone"in t){const{phone:o,options:l}=t,{data:u,error:f}=await yt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(i=l==null?void 0:l.data)!==null&&i!==void 0?i:{},create_user:(a=l==null?void 0:l.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(s=l==null?void 0:l.channel)!==null&&s!==void 0?s:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:f})}throw new Jh("You must provide either an email or phone number.")}catch(o){if(await hn(this.storage,`${this.storageKey}-code-verifier`),ft(o))return this._returnResult({data:{user:null,session:null},error:o});throw o}}async verifyOtp(t){var r,n;try{let i,a;"options"in t&&(i=(r=t.options)===null||r===void 0?void 0:r.redirectTo,a=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:s,error:o}=await yt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:a}}),redirectTo:i,xform:ua});if(o)throw o;if(!s)throw new Error("An error occurred on token verification.");const l=s.session,u=s.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),this._returnResult({data:{user:u,session:l},error:null})}catch(i){if(ft(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithSSO(t){var r,n,i,a,s;try{let o=null,l=null;this.flowType==="pkce"&&([o,l]=await Rl(this.storage,this.storageKey));const u=await yt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=t==null?void 0:t.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:o,code_challenge_method:l}),headers:this.headers,xform:oA});return!((a=u.data)===null||a===void 0)&&a.url&&dn()&&!(!((s=t.options)===null||s===void 0)&&s.skipBrowserRedirect)&&window.location.assign(u.data.url),this._returnResult(u)}catch(o){if(await hn(this.storage,`${this.storageKey}-code-verifier`),ft(o))return this._returnResult({data:null,error:o});throw o}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new vi;const{error:i}=await yt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:i})})}catch(t){if(ft(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:i,options:a}=t,{error:s}=await yt(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:s})}else if("phone"in t){const{phone:n,type:i,options:a}=t,{data:s,error:o}=await yt(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:s==null?void 0:s.message_id},error:o})}throw new Jh("You must provide either an email or phone number and a type")}catch(r){if(ft(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await ko(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<rp:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const s=await ko(this.userStorage,this.storageKey+"-user");s!=null&&s.user?t.user=s.user:t.user=ap()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const s={value:this.suppressGetSessionWarning};t.user=nA(t.user,s),s.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:i,error:a}=await this._callRefreshToken(t.refresh_token);return a?this._returnResult({data:{session:null},error:a}):this._returnResult({data:{session:i},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await yt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Hs}):await this._useSession(async r=>{var n,i,a;const{data:s,error:o}=r;if(o)throw o;return!(!((n=s.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new vi}:await yt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(i=s.session)===null||i===void 0?void 0:i.access_token)!==null&&a!==void 0?a:void 0,xform:Hs})})}catch(r){if(ft(r))return np(r)&&(await this._removeSession(),await hn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:i,error:a}=n;if(a)throw a;if(!i.session)throw new vi;const s=i.session;let o=null,l=null;this.flowType==="pkce"&&t.email!=null&&([o,l]=await Rl(this.storage,this.storageKey));const{data:u,error:f}=await yt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:l}),jwt:s.access_token,xform:Hs});if(f)throw f;return s.user=u.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),this._returnResult({data:{user:s.user},error:null})})}catch(n){if(await hn(this.storage,`${this.storageKey}-code-verifier`),ft(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new vi;const r=Date.now()/1e3;let n=r,i=!0,a=null;const{payload:s}=Zh(t.access_token);if(s.exp&&(n=s.exp,i=n<=r),i){const{data:o,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!o)return{data:{user:null,session:null},error:null};a=o}else{const{data:o,error:l}=await this._getUser(t.access_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});a={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return this._returnResult({data:{user:a.user,session:a},error:null})}catch(r){if(ft(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:s,error:o}=r;if(o)throw o;t=(n=s.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new vi;const{data:i,error:a}=await this._callRefreshToken(t.refresh_token);return a?this._returnResult({data:{user:null,session:null},error:a}):i?this._returnResult({data:{user:i.user,session:i},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(ft(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!dn())throw new Qh("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Qh(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new o5("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Qh("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new o5("No code detected.");const{data:w,error:x}=await this._exchangeCodeForSession(t.code);if(x)throw x;const A=new URL(window.location.href);return A.searchParams.delete("code"),window.history.replaceState(window.history.state,"",A.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:a,refresh_token:s,expires_in:o,expires_at:l,token_type:u}=t;if(!a||!o||!s||!u)throw new Qh("No session defined in URL");const f=Math.round(Date.now()/1e3),d=parseInt(o);let p=f+d;l&&(p=parseInt(l));const h=p-f;h*1e3<=ql&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${d}s`);const v=p-d;f-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,p,f):f-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,p,f);const{data:m,error:S}=await this._getUser(a);if(S)throw S;const y={provider_token:n,provider_refresh_token:i,access_token:a,expires_in:d,expires_at:p,refresh_token:s,token_type:u,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:y,redirectType:t.type},error:null})}catch(n){if(ft(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await ko(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:a}=r;if(a&&!np(a))return this._returnResult({error:a});const s=(n=i.session)===null||n===void 0?void 0:n.access_token;if(s){const{error:o}=await this.admin.signOut(s,t);if(o&&!(RE(o)&&(o.status===404||o.status===401||o.status===403)||np(o)))return this._returnResult({error:o})}return t!=="others"&&(await this._removeSession(),await hn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=WE(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,i;try{const{data:{session:a},error:s}=r;if(s)throw s;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",t,"session",a)}catch(a){await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",a),console.error(a)}})}async resetPasswordForEmail(t,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await Rl(this.storage,this.storageKey,!0));try{return await yt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(a){if(await hn(this.storage,`${this.storageKey}-code-verifier`),ft(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(ft(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:i}=await this._useSession(async a=>{var s,o,l,u,f;const{data:d,error:p}=a;if(p)throw p;const h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(s=t.options)===null||s===void 0?void 0:s.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await yt(this.fetch,"GET",h,{headers:this.headers,jwt:(f=(u=d.session)===null||u===void 0?void 0:u.access_token)!==null&&f!==void 0?f:void 0})});if(i)throw i;return dn()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:t.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(ft(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:i,data:{session:a}}=r;if(i)throw i;const{options:s,provider:o,token:l,access_token:u,nonce:f}=t,d=await yt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=a==null?void 0:a.access_token)!==null&&n!==void 0?n:void 0,body:{provider:o,id_token:l,access_token:u,nonce:f,link_identity:!0,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},xform:ua}),{data:p,error:h}=d;return h?this._returnResult({data:{user:null,session:null},error:h}):!p||!p.session||!p.user?this._returnResult({data:{user:null,session:null},error:new Fl}):(p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("USER_UPDATED",p.session)),this._returnResult({data:p,error:h}))}catch(i){if(await hn(this.storage,`${this.storageKey}-code-verifier`),ft(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,i;const{data:a,error:s}=r;if(s)throw s;return await yt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(i=(n=a.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(ft(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await GE(async i=>(i>0&&await VE(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await yt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:ua})),(i,a)=>{const s=200*Math.pow(2,i);return a&&ip(a)&&Date.now()+s-n<ql})}catch(n){if(this._debug(r,"error",n),ft(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),dn()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await ko(this.storage,this.storageKey);if(i&&this.userStorage){let s=await ko(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!s&&(s={user:i.user},await $l(this.userStorage,this.storageKey+"-user",s)),i.user=(t=s==null?void 0:s.user)!==null&&t!==void 0?t:ap()}else if(i&&!i.user&&!i.user){const s=await ko(this.storage,this.storageKey+"-user");s&&(s!=null&&s.user)?(i.user=s.user,await hn(this.storage,this.storageKey+"-user"),await $l(this.storage,this.storageKey,i)):i.user=ap()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const a=((r=i.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<rp;if(this._debug(n,`session has${a?"":" not"} expired with margin of ${rp}s`),a){if(this.autoRefreshToken&&i.refresh_token){const{error:s}=await this._callRefreshToken(i.refresh_token);s&&(console.error(s),ip(s)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:s,error:o}=await this._getUser(i.access_token);!o&&(s!=null&&s.user)?(i.user=s.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(s){console.error("Error getting user data:",s),this._debug(n,"error getting user data, skipping SIGNED_IN notification",s)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new vi;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Fd;const{data:a,error:s}=await this._refreshAccessToken(t);if(s)throw s;if(!a.session)throw new vi;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const o={data:a.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(a){if(this._debug(i,"error",a),ft(a)){const s={data:null,error:a};return ip(a)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(s),s}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(a),a}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(t,r,n=!0){const i=`#_notifyAllSubscribers(${t})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const a=[],s=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(l){a.push(l)}});if(await Promise.all(s),a.length>0){for(let o=0;o<a.length;o+=1)console.error(a[o]);throw a[0]}}finally{this._debug(i,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await hn(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await $l(this.userStorage,this.storageKey+"-user",{user:r.user});const i=Object.assign({},r);delete i.user;const a=h5(i);await $l(this.storage,this.storageKey,a)}else{const i=h5(r);await $l(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await hn(this.storage,this.storageKey),await hn(this.storage,this.storageKey+"-code-verifier"),await hn(this.storage,this.storageKey+"-user"),this.userStorage&&await hn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&dn()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),ql);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-t)/ql);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${ql}ms, refresh threshold is ${Ag} ticks`),i<=Ag&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof Zx)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!dn()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(t){this._debug("#visibilityChangedCallback","error",t)}},window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[a,s]=await Rl(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(s)}`});i.push(o.toString())}if(n!=null&&n.queryParams){const a=new URLSearchParams(n.queryParams);i.push(a.toString())}return n!=null&&n.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${i.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:i,error:a}=r;return a?this._returnResult({data:null,error:a}):await yt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(ft(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,i;const{data:a,error:s}=r;if(s)return this._returnResult({data:null,error:s});const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:l,error:u}=await yt(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return u?this._returnResult({data:null,error:u}):(t.factorType==="totp"&&l.type==="totp"&&(!((i=l==null?void 0:l.totp)===null||i===void 0)&&i.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),this._returnResult({data:l,error:null}))})}catch(r){if(ft(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:a}=r;if(a)return this._returnResult({data:null,error:a});const s=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?SA(t.webauthn.credential_response):bA(t.webauthn.credential_response)})}:{code:t.code}),{data:o,error:l}=await yt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:s,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return l?this._returnResult({data:null,error:l}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),this._returnResult({data:o,error:l}))})}catch(r){if(ft(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:a}=r;if(a)return this._returnResult({data:null,error:a});const s=await yt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});if(s.error)return s;const{data:o}=s;if(o.type!=="webauthn")return{data:o,error:null};switch(o.webauthn.type){case"create":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:xA(o.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},o),{webauthn:Object.assign(Object.assign({},o.webauthn),{credential_options:Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:_A(o.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(ft(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const i={all:[],phone:[],totp:[],webauthn:[]};for(const a of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])i.all.push(a),a.status==="verified"&&i[a.factor_type].push(a);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(t){var r,n,i,a;if(t)try{const{payload:h}=Zh(t);let v=null;h.aal&&(v=h.aal);let m=v;const{data:{user:S},error:y}=await this.getUser(t);if(y)return this._returnResult({data:null,error:y});((n=(r=S==null?void 0:S.factors)===null||r===void 0?void 0:r.filter(A=>A.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(m="aal2");const x=h.amr||[];return{data:{currentLevel:v,nextLevel:m,currentAuthenticationMethods:x},error:null}}catch(h){if(ft(h))return this._returnResult({data:null,error:h});throw h}const{data:{session:s},error:o}=await this.getSession();if(o)return this._returnResult({data:null,error:o});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=Zh(s.access_token);let u=null;l.aal&&(u=l.aal);let f=u;((a=(i=s.user.factors)===null||i===void 0?void 0:i.filter(h=>h.status==="verified"))!==null&&a!==void 0?a:[]).length>0&&(f="aal2");const p=l.amr||[];return{data:{currentLevel:u,nextLevel:f,currentAuthenticationMethods:p},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?await yt(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new vi})})}catch(r){if(ft(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:a}=n;if(a)return this._returnResult({data:null,error:a});if(!i)return this._returnResult({data:null,error:new vi});const s=await yt(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"approve"},xform:o=>({data:o,error:null})});return s.data&&s.data.redirect_url&&dn()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(s.data.redirect_url),s})}catch(n){if(ft(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:a}=n;if(a)return this._returnResult({data:null,error:a});if(!i)return this._returnResult({data:null,error:new vi});const s=await yt(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"deny"},xform:o=>({data:o,error:null})});return s.data&&s.data.redirect_url&&dn()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(s.data.redirect_url),s})}catch(n){if(ft(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;return n?this._returnResult({data:null,error:n}):r?await yt(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new vi})})}catch(t){if(ft(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?(await yt(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new vi})})}catch(r){if(ft(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(o=>o.kid===t);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(o=>o.kid===t),n&&this.jwks_cached_at+OE>i)return n;const{data:a,error:s}=await yt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=i,n=a.keys.find(o=>o.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:h,error:v}=await this.getSession();if(v||!h.session)return this._returnResult({data:null,error:v});n=h.session.access_token}const{header:i,payload:a,signature:s,raw:{header:o,payload:l}}=Zh(n);r!=null&&r.allowExpired||eA(a.exp);const u=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!u){const{error:h}=await this.getUser(n);if(h)throw h;return{data:{claims:a,header:i,signature:s},error:null}}const f=tA(i.alg),d=await crypto.subtle.importKey("jwk",u,f,!0,["verify"]);if(!await crypto.subtle.verify(f,d,s,zE(`${o}.${l}`)))throw new Ng("Invalid JWT signature");return{data:{claims:a,header:i,signature:s},error:null}}catch(n){if(ft(n))return this._returnResult({data:null,error:n});throw n}}}xf.nextInstanceID={};const OA=xf,FA="2.97.0";let kc="";typeof Deno<"u"?kc="deno":typeof document<"u"?kc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?kc="react-native":kc="node";const RA={"X-Client-Info":`supabase-js-${kc}/${FA}`},IA={headers:RA},DA={schema:"public"},jA={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},MA={};function _f(e){"@babel/helpers - typeof";return _f=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_f(e)}function BA(e,t){if(_f(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(_f(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function UA(e){var t=BA(e,"string");return _f(t)=="symbol"?t:t+""}function zA(e,t,r){return(t=UA(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function x5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Tr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?x5(Object(r),!0).forEach(function(n){zA(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):x5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const HA=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),WA=()=>Headers,qA=(e,t,r)=>{const n=HA(r),i=WA();return async(a,s)=>{var o;const l=(o=await t())!==null&&o!==void 0?o:e;let u=new i(s==null?void 0:s.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${l}`),n(a,Tr(Tr({},s),{},{headers:u}))}};function $A(e){return e.endsWith("/")?e:e+"/"}function VA(e,t){var r,n;const{db:i,auth:a,realtime:s,global:o}=e,{db:l,auth:u,realtime:f,global:d}=t,p={db:Tr(Tr({},l),i),auth:Tr(Tr({},u),a),realtime:Tr(Tr({},f),s),storage:{},global:Tr(Tr(Tr({},d),o),{},{headers:Tr(Tr({},(r=d==null?void 0:d.headers)!==null&&r!==void 0?r:{}),(n=o==null?void 0:o.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?p.accessToken=e.accessToken:delete p.accessToken,p}function GA(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL($A(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var KA=class extends OA{constructor(e){super(e)}},YA=class{constructor(e,t,r){var n,i;this.supabaseUrl=e,this.supabaseKey=t;const a=GA(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);const s=`sb-${a.hostname.split(".")[0]}-auth-token`,o={db:DA,realtime:MA,auth:Tr(Tr({},jA),{},{storageKey:s}),global:IA},l=VA(r??{},o);if(this.storageKey=(n=l.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=l.global.headers)!==null&&i!==void 0?i:{},l.accessToken)this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(f,d)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(d)} is not possible`)}});else{var u;this.auth=this._initSupabaseAuthClient((u=l.auth)!==null&&u!==void 0?u:{},this.headers,l.global.fetch)}this.fetch=qA(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Tr({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(f=>this.realtime.setAuth(f)).catch(f=>console.warn("Failed to set initial Realtime auth token:",f)),this.rest=new R6(new URL("rest/v1",a).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch,timeout:l.db.timeout,urlLengthLimit:l.db.urlLengthLimit}),this.storage=new kE(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),l.accessToken||this._listenForAuthEvents()}get functions(){return new T6(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:n}=await e.auth.getSession();return(t=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:i,storageKey:a,flowType:s,lock:o,debug:l,throwOnError:u},f,d){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new KA({url:this.authUrl.href,headers:Tr(Tr({},p),f),storageKey:a,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:i,flowType:s,lock:o,debug:l,throwOnError:u,fetch:d,hasCustomAuthorizationHeader:Object.keys(this.headers).some(h=>h.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new J6(this.realtimeUrl.href,Tr(Tr({},e),{},{params:Tr(Tr({},{apikey:this.supabaseKey}),e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const XA=(e,t,r)=>new YA(e,t,r);function JA(){if(typeof window<"u")return!1;const e=globalThis.process;if(!e)return!1;const t=e.version;if(t==null)return!1;const r=t.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}JA()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const QA="https://ipbvulbzxrnbiipberxh.supabase.co",ZA="sb_publishable_CFRyVd9rCpVIERPyhtN0Bg_N_cjfyRC",mn=XA(QA,ZA);async function eT(){const{data:e,error:t}=await mn.from("employees").select("*").eq("active",!0).order("name");if(t)throw t;return e}async function tT(e=null,t=null){let r=mn.from("time_entries").select(`
      *,
      employee:employees(name, role),
      task:tasks(name)
    `).order("created_at",{ascending:!1});e&&(r=r.eq("date",e)),t&&(r=r.eq("employee_id",t));const{data:n,error:i}=await r;if(i)throw i;return n}async function rT(e){const{data:t,error:r}=await mn.from("time_entries").insert([e]).select();if(r)throw r;return t}const nT=!1;function z2(){const[e,t]=ut.useState([]),[r,n]=ut.useState(!0),[i,a]=ut.useState(null);return ut.useEffect(()=>{async function s(){try{if(!nT){const o=await eT();t(o)}}catch(o){a(o.message),t(_6)}finally{n(!1)}}s()},[]),{employees:e,loading:r,error:i}}function iT({onLogin:e}){const{employees:t,loading:r}=z2(),[n,i]=ut.useState(""),[a,s]=ut.useState(""),[o,l]=ut.useState(""),u=f=>{if(f.preventDefault(),l(""),!n||!a){l("Selecciona usuario e introduce contrasea");return}const d=t.find(p=>p.id===parseInt(n));if(!d){l("Usuario no encontrado");return}if(d.password!==a){l("Contrasea incorrecta");return}e(d)};return r?Z.jsx("div",{className:"flex justify-center items-center h-64",children:Z.jsx("div",{className:"text-xl text-gray-600",children:"Cargando..."})}):Z.jsx("div",{className:"max-w-md mx-auto",children:Z.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-6",children:[Z.jsxs("div",{className:"text-center mb-6",children:[Z.jsx("div",{className:"text-4xl mb-2",children:""}),Z.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"CTC Daily Hours"}),Z.jsx("p",{className:"text-gray-600",children:"Patio de Materiales"})]}),o&&Z.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded-lg mb-4 text-center",children:o}),Z.jsxs("form",{onSubmit:u,className:"space-y-4",children:[Z.jsxs("div",{children:[Z.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Usuario"}),Z.jsxs("select",{value:n,onChange:f=>i(f.target.value),className:"w-full p-3 border-2 border-gray-300 rounded-xl focus:border-blue-600 focus:outline-none bg-white",children:[Z.jsx("option",{value:"",children:"-- Seleccionar --"}),t.map(f=>{let d="";return f.role==="admin"?d="  (Admin)":f.role==="responsible"&&(d="  (Responsable)"),Z.jsxs("option",{value:f.id,children:[f.name,d]},f.id)})]})]}),Z.jsxs("div",{children:[Z.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contrasea"}),Z.jsx("input",{type:"password",value:a,onChange:f=>s(f.target.value),placeholder:"Introduce tu contrasea",className:"w-full p-3 border-2 border-gray-300 rounded-xl focus:border-blue-600 focus:outline-none"})]}),Z.jsx("button",{type:"submit",className:"w-full py-4 bg-blue-600 text-white text-xl font-bold rounded-xl hover:bg-blue-700 active:scale-95 transition-transform",children:"Iniciar Sesin"})]}),Z.jsxs("div",{className:"mt-6 p-4 bg-gray-100 rounded-lg text-sm text-gray-600",children:[Z.jsx("p",{className:"font-semibold mb-2",children:"Usuarios de prueba:"}),Z.jsx("p",{children:" Admin: admin123 (Administrador del sistema)"}),Z.jsx("p",{children:" Responsables: nombre123 (ej: pedro123)"}),Z.jsx("p",{children:" Empleados: nombre123 (ej: juan123)"})]})]})})}const op=["Lunes","Martes","Mircoles","Jueves","Viernes","Sbado","Domingo"];function aT({entries:e=[],onAdd:t,onUpdate:r,onDelete:n,user:i,isResponsible:a}){const{employees:s}=z2(),[o,l]=ut.useState(()=>{const z=new Date,ae=z.getDay(),me=z.getDate()-ae+(ae===0?-6:1);return new Date(z.setDate(me))}),[u,f]=ut.useState(a?"":i==null?void 0:i.id),[d,p]=ut.useState(!1),[h,v]=ut.useState(null),[m,S]=ut.useState(""),[y,w]=ut.useState(""),x=ut.useMemo(()=>{const z=[];for(let ae=0;ae<7;ae++){const me=new Date(o);me.setDate(me.getDate()+ae),z.push(me)}return z},[o]),A=z=>z.toISOString().split("T")[0],R=ut.useMemo(()=>{let z=e;return!a&&i?z=e.filter(ae=>ae.employee_id===i.id):u&&(z=e.filter(ae=>ae.employee_id===parseInt(u))),z},[e,a,i,u]),B=ut.useMemo(()=>{const z={};return x.forEach(ae=>{const me=A(ae);z[me]=R.filter(E=>E.date===me)}),z},[R,x]),T=z=>{const ae=Kv.find(me=>me.id===z);return(ae==null?void 0:ae.name)||"Desconocida"},L=z=>({1:"bg-blue-100 border-blue-400 text-blue-800",2:"bg-green-100 border-green-400 text-green-800",3:"bg-yellow-100 border-yellow-400 text-yellow-800",4:"bg-purple-100 border-purple-400 text-purple-800"})[z]||"bg-gray-100 border-gray-400",P=()=>{const z=new Date(o);z.setDate(z.getDate()-7),l(z)},M=()=>{const z=new Date(o);z.setDate(z.getDate()+7),l(z)},N=()=>{const z=new Date,ae=z.getDay(),me=z.getDate()-ae+(ae===0?-6:1);l(new Date(z.setDate(me)))},C=z=>{v({date:A(z),type:"add"}),S(""),w(""),p(!0)},U=(z,ae)=>{ae.stopPropagation(),v({...z,type:"edit"}),S(z.task_id.toString()),w(z.hours.toString()),p(!0)},Y=()=>{!m||!y||(h.type==="add"?t({employee_id:a?parseInt(u):i.id,task_id:parseInt(m),hours:parseFloat(y),date:h.date}):r(h.id,{task_id:parseInt(m),hours:parseFloat(y)}),p(!1))},ce=()=>{h.type==="edit"&&(n(h.id),p(!1))},ee=()=>R.reduce((z,ae)=>z+(ae.hours||0),0),Q=z=>`${z.getDate()}`,X=z=>{const ae=new Date;return z.toDateString()===ae.toDateString()};return Z.jsxs("div",{className:"max-w-full",children:[Z.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-4 mb-4",children:[Z.jsxs("div",{className:"flex justify-between items-center mb-4",children:[Z.jsx("button",{onClick:P,className:"p-2 rounded-lg hover:bg-gray-100 text-xl font-bold",children:""}),Z.jsxs("div",{className:"text-center",children:[Z.jsxs("h2",{className:"text-xl font-bold text-gray-800",children:[op[x[0].getDay()===0?6:x[0].getDay()-1]," ",Q(x[0])," - ",op[x[6].getDay()===0?6:x[6].getDay()-1]," ",Q(x[6])]}),Z.jsx("button",{onClick:N,className:"text-sm text-blue-600 hover:underline",children:"Hoy"})]}),Z.jsx("button",{onClick:M,className:"p-2 rounded-lg hover:bg-gray-100 text-xl font-bold",children:""})]}),a&&Z.jsx("div",{className:"mb-4",children:Z.jsxs("select",{value:u,onChange:z=>f(z.target.value),className:"w-full p-3 border-2 border-gray-300 rounded-lg bg-white",children:[Z.jsx("option",{value:"",children:"-- Seleccionar empleado --"}),s.filter(z=>z.role==="employee").map(z=>Z.jsx("option",{value:z.id,children:z.name},z.id))]})}),Z.jsx("div",{className:"overflow-x-auto",children:Z.jsxs("div",{className:"min-w-[700px]",children:[Z.jsx("div",{className:"grid grid-cols-7 gap-1 mb-2",children:x.map((z,ae)=>Z.jsxs("div",{className:`
                    text-center p-2 rounded-lg font-semibold
                    ${X(z)?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"}
                  `,children:[Z.jsx("div",{className:"text-xs",children:op[ae]}),Z.jsx("div",{className:"text-lg",children:Q(z)})]},ae))}),Z.jsx("div",{className:"grid grid-cols-7 gap-1",children:x.map((z,ae)=>{const me=A(z),E=B[me]||[];return Z.jsxs("div",{onClick:()=>C(z),className:`
                      min-h-[200px] p-2 border-2 border-dashed rounded-lg cursor-pointer transition-colors
                      ${X(z)?"border-blue-300 bg-blue-50":"border-gray-200 hover:border-gray-400"}
                    `,children:[E.map(O=>Z.jsxs("div",{onClick:F=>U(O,F),className:`
                          mb-1 p-2 rounded-lg border-l-4 text-sm cursor-pointer hover:opacity-80
                          ${L(O.task_id)}
                        `,children:[Z.jsxs("div",{className:"font-bold",children:[O.hours,"h"]}),Z.jsx("div",{className:"text-xs truncate",children:T(O.task_id)})]},O.id)),E.length===0&&Z.jsx("div",{className:"text-center text-gray-400 text-sm mt-8",children:"+ Aadir"})]},ae)})})]})}),Z.jsxs("div",{className:"mt-4 p-3 bg-gray-100 rounded-lg flex justify-between items-center",children:[Z.jsx("span",{className:"text-gray-600",children:"Total semana:"}),Z.jsxs("span",{className:"text-xl font-bold text-blue-600",children:[ee()," horas"]})]})]}),d&&Z.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:Z.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-md",children:[Z.jsx("h3",{className:"text-xl font-bold mb-4",children:h.type==="add"?" Aadir Horas":" Editar Horas"}),Z.jsxs("div",{className:"space-y-4",children:[Z.jsxs("div",{children:[Z.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha"}),Z.jsx("input",{type:"date",value:h.date,disabled:!0,className:"w-full p-3 border rounded-lg bg-gray-100"})]}),Z.jsxs("div",{children:[Z.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tarea"}),Z.jsxs("select",{value:m,onChange:z=>S(z.target.value),className:"w-full p-3 border-2 border-gray-300 rounded-lg",children:[Z.jsx("option",{value:"",children:"-- Seleccionar --"}),Kv.map(z=>Z.jsx("option",{value:z.id,children:z.name},z.id))]})]}),Z.jsxs("div",{children:[Z.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Horas"}),Z.jsxs("select",{value:y,onChange:z=>w(z.target.value),className:"w-full p-3 border-2 border-gray-300 rounded-lg",children:[Z.jsx("option",{value:"",children:"-- Seleccionar --"}),S6.map(z=>Z.jsxs("option",{value:z,children:[z," hora",z>1?"s":""]},z))]})]})]}),Z.jsxs("div",{className:"flex gap-2 mt-6",children:[Z.jsx("button",{onClick:Y,disabled:!m||!y,className:"flex-1 bg-green-600 text-white py-3 rounded-lg font-semibold disabled:bg-gray-300",children:"Guardar"}),h.type==="edit"&&Z.jsx("button",{onClick:ce,className:"px-4 bg-red-600 text-white py-3 rounded-lg font-semibold",children:""}),Z.jsx("button",{onClick:()=>p(!1),className:"px-4 bg-gray-300 text-gray-700 py-3 rounded-lg font-semibold",children:"Cancelar"})]})]})})]})}const e0=!1;function r_(e=null,t=null){const[r,n]=ut.useState([]),[i,a]=ut.useState(!0),[s,o]=ut.useState(null),l=ut.useCallback(async()=>{a(!0);try{if(!e0){const h=(t==null?void 0:t.role)==="employee"?t.id:null,v=await tT(e,h);n(v)}}catch(h){o(h.message)}finally{a(!1)}},[e,t==null?void 0:t.id,t==null?void 0:t.role]);ut.useEffect(()=>{l()},[l]);const u=async h=>{try{if(!e0){const v=await rT(h);return await l(),v}}catch(v){throw o(v.message),v}},f=async(h,v)=>{try{if(!e0){const{error:m}=await supabase.from("time_entries").update(v).eq("id",h);if(m)throw m;await l()}}catch(m){throw o(m.message),m}},d=async h=>{try{if(!e0){const{error:v}=await supabase.from("time_entries").delete().eq("id",h);if(v)throw v;await l()}}catch(v){throw o(v.message),v}},p=ut.useCallback(h=>r.filter(v=>v.date===h),[r]);return{entries:r,loading:i,error:s,addEntry:u,updateEntry:f,deleteEntry:d,refresh:l,getEntriesByDate:p}}function n_(){const[e,t]=ut.useState([]),[r,n]=ut.useState(!0),[i,a]=ut.useState(null),s=ut.useCallback(async(h=!1)=>{n(!0),a(null);try{let v=mn.from("tasks").select("*").order("name");h||(v=v.eq("active",!0));const{data:m,error:S}=await v;if(S)throw S;t(m||[])}catch(v){console.error("Error al cargar tareas:",v),a(v.message)}finally{n(!1)}},[]);ut.useEffect(()=>{s()},[s]);const o=async h=>{a(null);try{const{data:v,error:m}=await mn.from("tasks").insert([{name:h,active:!0}]).select();if(m)throw m;return v&&v.length>0&&t(S=>[...S,v[0]].sort((y,w)=>y.name.localeCompare(w.name))),{success:!0,data:v[0]}}catch(v){return console.error("Error al agregar tarea:",v),a(v.message),{success:!1,error:v.message}}},l=async(h,v)=>{a(null);try{const{data:m,error:S}=await mn.from("tasks").update(v).eq("id",h).select();if(S)throw S;return m&&m.length>0&&t(y=>y.map(w=>w.id===h?m[0]:w).sort((w,x)=>w.name.localeCompare(x.name))),{success:!0,data:m[0]}}catch(m){return console.error("Error al actualizar tarea:",m),a(m.message),{success:!1,error:m.message}}},u=async h=>{a(null);try{const v=e.find(y=>y.id===h);if(!v)throw new Error("Tarea no encontrada");const{data:m,error:S}=await mn.from("tasks").update({active:!v.active}).eq("id",h).select();if(S)throw S;return m&&m.length>0&&t(y=>y.map(w=>w.id===h?m[0]:w)),{success:!0,data:m[0]}}catch(v){return console.error("Error al cambiar estado de tarea:",v),a(v.message),{success:!1,error:v.message}}};return{tasks:e,loading:r,error:i,fetchTasks:s,addTask:o,updateTask:l,toggleTaskActive:u,deleteTask:async h=>await u(h),hardDeleteTask:async h=>{a(null);try{const{error:v}=await mn.from("tasks").delete().eq("id",h);if(v)throw v;return t(m=>m.filter(S=>S.id!==h)),{success:!0}}catch(v){return console.error("Error al eliminar tarea:",v),a(v.message),{success:!1,error:v.message}}},refresh:()=>{s()}}}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Q0={};Q0.version="0.18.5";var i_=1252,sT=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],a_=function(e){sT.indexOf(e)!=-1&&(i_=e)};function oT(){a_(1252)}var Sf=function(e){a_(e)};function lT(){Sf(1200),oT()}var t0=function(t){return String.fromCharCode(t)},_5=function(t){return String.fromCharCode(t)},Z0,Vs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function bf(e){for(var t="",r=0,n=0,i=0,a=0,s=0,o=0,l=0,u=0;u<e.length;)r=e.charCodeAt(u++),a=r>>2,n=e.charCodeAt(u++),s=(r&3)<<4|n>>4,i=e.charCodeAt(u++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),t+=Vs.charAt(a)+Vs.charAt(s)+Vs.charAt(o)+Vs.charAt(l);return t}function ps(e){var t="",r=0,n=0,i=0,a=0,s=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)a=Vs.indexOf(e.charAt(u++)),s=Vs.indexOf(e.charAt(u++)),r=a<<2|s>>4,t+=String.fromCharCode(r),o=Vs.indexOf(e.charAt(u++)),n=(s&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=Vs.indexOf(e.charAt(u++)),i=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(i));return t}var qt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ys=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Qo(e){return qt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function S5(e){return qt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ma=function(t){return qt?ys(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Rd(e){if(typeof ArrayBuffer>"u")return ma(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function jf(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function uT(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var yn=qt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ys(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function cT(e){for(var t=[],r=0,n=e.length+250,i=Qo(e.length+255),a=0;a<e.length;++a){var s=e.charCodeAt(a);if(s<128)i[r++]=s;else if(s<2048)i[r++]=192|s>>6&31,i[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++a)&1023;i[r++]=240|s>>8&7,i[r++]=128|s>>2&63,i[r++]=128|o>>6&15|(s&3)<<4,i[r++]=128|o&63}else i[r++]=224|s>>12&15,i[r++]=128|s>>6&63,i[r++]=128|s&63;r>n&&(t.push(i.slice(0,r)),r=0,i=Qo(65535),n=65530)}return t.push(i.slice(0,r)),yn(t)}var Uc=/\u0000/g,r0=/[\u0001-\u0006]/g;function mu(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function va(e,t){var r=""+e;return r.length>=t?r:Nr("0",t-r.length)+r}function H2(e,t){var r=""+e;return r.length>=t?r:Nr(" ",t-r.length)+r}function ed(e,t){var r=""+e;return r.length>=t?r:r+Nr(" ",t-r.length)}function fT(e,t){var r=""+Math.round(e);return r.length>=t?r:Nr("0",t-r.length)+r}function hT(e,t){var r=""+e;return r.length>=t?r:Nr("0",t-r.length)+r}var b5=Math.pow(2,32);function Ml(e,t){if(e>b5||e<-b5)return fT(e,t);var r=Math.round(e);return hT(r,t)}function td(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var E5=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],lp=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function dT(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Cr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},A5={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},pT={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function rd(e,t,r){for(var n=e<0?-1:1,i=e*n,a=0,s=1,o=0,l=1,u=0,f=0,d=Math.floor(i);u<t&&(d=Math.floor(i),o=d*s+a,f=d*u+l,!(i-d<5e-8));)i=1/(i-d),a=s,s=o,l=u,u=f;if(f>t&&(u>t?(f=l,o=a):(f=u,o=s)),!r)return[0,n*o,f];var p=Math.floor(n*o/f);return[p,n*o-p*f,f]}function n0(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),a=0,s=[],o={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)s=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),n<60&&(a=(a+6)%7),r&&(a=_T(l,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=a,o}var s_=new Date(1899,11,31,0,0,0),gT=s_.getTime(),mT=new Date(1900,2,1,0,0,0);function o_(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=mT&&(r+=24*60*60*1e3),(r-(gT+(e.getTimezoneOffset()-s_.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function W2(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function vT(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function yT(e){var t=e<0?12:11,r=W2(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function wT(e){var t=W2(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function xT(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=yT(e):t===10?r=e.toFixed(10).substr(0,12):r=wT(e),W2(vT(r.toUpperCase()))}function Cg(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):xT(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return so(14,o_(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function _T(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function ST(e,t,r,n){var i="",a=0,s=0,o=r.y,l,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,u=t.length;break;case 3:return lp[r.m-1][1];case 5:return lp[r.m-1][0];default:return lp[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,u=t.length;break;case 3:return E5[r.q][0];default:return E5[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?va(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,a=Math.round(s*(r.S+r.u)),a>=60*s&&(a=0),t==="s"?a===0?"0":""+a/s:(i=va(a,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:l=o,u=1;break}var f=u>0?va(l,u):"";return f}function Gs(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var l_=/%/g;function bT(e,t,r){var n=t.replace(l_,""),i=t.length-n.length;return os(e,n,r*Math.pow(10,2*i))+Nr("%",i)}function ET(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return os(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function u_(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+u_(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+a):r+="E+"+(s-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,f){return l+u+f.substr(0,(i+a)%i)+"."+f.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var c_=/# (\?+)( ?)\/( ?)(\d+)/;function AT(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),a=Math.floor(i/n),s=i-a*n,o=n;return r+(a===0?"":""+a)+" "+(s===0?Nr(" ",e[1].length+1+e[4].length):H2(s,e[1].length)+e[2]+"/"+e[3]+va(o,e[4].length))}function TT(e,t,r){return r+(t===0?"":""+t)+Nr(" ",e[1].length+2+e[4].length)}var f_=/^#*0*\.([0#]+)/,h_=/\).*[0#]/,d_=/\(###\) ###\\?-####/;function Hn(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function T5(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function k5(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function kT(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function NT(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function zi(e,t,r){if(e.charCodeAt(0)===40&&!t.match(h_)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?zi("n",n,r):"("+zi("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return ET(e,t,r);if(t.indexOf("%")!==-1)return bT(e,t,r);if(t.indexOf("E")!==-1)return u_(t,r);if(t.charCodeAt(0)===36)return"$"+zi(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,s,o,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Ml(l,t.length);if(t.match(/^[#?]+$/))return i=Ml(r,0),i==="0"&&(i=""),i.length>t.length?i:Hn(t.substr(0,t.length-i.length))+i;if(a=t.match(c_))return AT(a,l,u);if(t.match(/^#+0+$/))return u+Ml(l,t.length-t.indexOf("0"));if(a=t.match(f_))return i=T5(r,a[1].length).replace(/^([^\.]+)$/,"$1."+Hn(a[1])).replace(/\.$/,"."+Hn(a[1])).replace(/\.(\d*)$/,function(v,m){return"."+m+Nr("0",Hn(a[1]).length-m.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+T5(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+Gs(Ml(l,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+zi(e,t,-r):Gs(""+(Math.floor(r)+kT(r,a[1].length)))+"."+va(k5(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return zi(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=mu(zi(e,t.replace(/[\\-]/g,""),r)),s=0,mu(mu(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return s<i.length?i.charAt(s++):v==="0"?"0":""}));if(t.match(d_))return i=zi(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=rd(l,Math.pow(10,s)-1,!1),i=""+u,f=os("n",a[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+a[2]+"/"+a[3],f=ed(o[2],s),f.length<a[4].length&&(f=Hn(a[4].substr(a[4].length-f.length))+f),i+=f,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),o=rd(l,Math.pow(10,s)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?H2(o[1],s)+a[2]+"/"+a[3]+ed(o[2],s):Nr(" ",2*s+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=Ml(r,0),t.length<=i.length?i:Hn(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var d=t.indexOf(".")-s,p=t.length-i.length-d;return Hn(t.substr(0,d)+i+t.substr(t.length-p))}if(a=t.match(/^00,000\.([#0]*0)$/))return s=k5(r,a[1].length),r<0?"-"+zi(e,t,-r):Gs(NT(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?va(0,3-v.length):"")+v})+"."+va(s,a[1].length);switch(t){case"###,##0.00":return zi(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=Gs(Ml(l,0));return h!=="0"?u+h:"";case"###,###.00":return zi(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return zi(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function CT(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return os(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function LT(e,t,r){var n=t.replace(l_,""),i=t.length-n.length;return os(e,n,r*Math.pow(10,2*i))+Nr("%",i)}function p_(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+p_(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+a):r+="E+"+(s-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,f){return l+u+f.substr(0,(i+a)%i)+"."+f.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Oa(e,t,r){if(e.charCodeAt(0)===40&&!t.match(h_)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Oa("n",n,r):"("+Oa("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return CT(e,t,r);if(t.indexOf("%")!==-1)return LT(e,t,r);if(t.indexOf("E")!==-1)return p_(t,r);if(t.charCodeAt(0)===36)return"$"+Oa(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,s,o,l=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+va(l,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:Hn(t.substr(0,t.length-i.length))+i;if(a=t.match(c_))return TT(a,l,u);if(t.match(/^#+0+$/))return u+va(l,t.length-t.indexOf("0"));if(a=t.match(f_))return i=(""+r).replace(/^([^\.]+)$/,"$1."+Hn(a[1])).replace(/\.$/,"."+Hn(a[1])),i=i.replace(/\.(\d*)$/,function(v,m){return"."+m+Nr("0",Hn(a[1]).length-m.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return u+Gs(""+l);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Oa(e,t,-r):Gs(""+r)+"."+Nr("0",a[1].length);if(a=t.match(/^#,#*,#0/))return Oa(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=mu(Oa(e,t.replace(/[\\-]/g,""),r)),s=0,mu(mu(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return s<i.length?i.charAt(s++):v==="0"?"0":""}));if(t.match(d_))return i=Oa(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var f="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=rd(l,Math.pow(10,s)-1,!1),i=""+u,f=os("n",a[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),i+=f+a[2]+"/"+a[3],f=ed(o[2],s),f.length<a[4].length&&(f=Hn(a[4].substr(a[4].length-f.length))+f),i+=f,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),o=rd(l,Math.pow(10,s)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?H2(o[1],s)+a[2]+"/"+a[3]+ed(o[2],s):Nr(" ",2*s+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:Hn(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var d=t.indexOf(".")-s,p=t.length-i.length-d;return Hn(t.substr(0,d)+i+t.substr(t.length-p))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Oa(e,t,-r):Gs(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?va(0,3-v.length):"")+v})+"."+va(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=Gs(""+l);return h!=="0"?u+h:"";default:if(t.match(/\.[0#?]*$/))return Oa(e,t.slice(0,t.lastIndexOf(".")),r)+Hn(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function os(e,t,r){return(r|0)===r?Oa(e,t,r):zi(e,t,r)}function PT(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var g_=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function m_(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":td(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(g_))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function OT(e,t,r,n){for(var i=[],a="",s=0,o="",l="t",u,f,d,p="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!td(e,s))throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"G",v:"General"},s+=7;break;case'"':for(a="";(d=e.charCodeAt(++s))!==34&&s<e.length;)a+=String.fromCharCode(d);i[i.length]={t:"t",v:a},++s;break;case"\\":var h=e.charAt(++s),v=h==="("||h===")"?h:"t";i[i.length]={t:v,v:h},++s;break;case"_":i[i.length]={t:"t",v:" "},s+=2;break;case"@":i[i.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(u==null&&(u=n0(t,r,e.charAt(s+1)==="2"),u==null))return"";i[i.length]={t:"X",v:e.substr(s,2)},l=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=n0(t,r),u==null))return"";for(a=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)a+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=p),i[i.length]={t:o,v:a},l=o;break;case"A":case"a":case"":var m={t:o,v:o};if(u==null&&(u=n0(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(u!=null&&(m.v=u.H>=12?"P":"A"),m.t="T",p="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(u!=null&&(m.v=u.H>=12?"PM":"AM"),m.t="T",s+=5,p="h"):e.substr(s,5).toUpperCase()==="/"?(u!=null&&(m.v=u.H>=12?"":""),m.t="T",s+=5,p="h"):(m.t="t",++s),u==null&&m.t==="T")return"";i[i.length]=m,l=o;break;case"[":for(a=o;e.charAt(s++)!=="]"&&s<e.length;)a+=e.charAt(s);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(g_)){if(u==null&&(u=n0(t,r),u==null))return"";i[i.length]={t:"Z",v:a.toLowerCase()},l=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",m_(e)||(i[i.length]={t:"t",v:a}));break;case".":if(u!=null){for(a=o;++s<e.length&&(o=e.charAt(s))==="0";)a+=o;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)a+=o;i[i.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++s)===o;)a+=o;i[i.length]={t:o,v:a},l=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)a+=e.charAt(s);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:o,v:o},++s;break;case"$":i[i.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"t",v:o},++s;break}var S=0,y=0,w;for(s=i.length-1,l="t";s>=0;--s)switch(i[s].t){case"h":case"H":i[s].t=p,l="h",S<1&&(S=1);break;case"s":(w=i[s].v.match(/\.0+$/))&&(y=Math.max(y,w[0].length-1)),S<3&&(S=3);case"d":case"y":case"M":case"e":l=i[s].t;break;case"m":l==="s"&&(i[s].t="M",S<2&&(S=2));break;case"X":break;case"Z":S<1&&i[s].v.match(/[Hh]/)&&(S=1),S<2&&i[s].v.match(/[Mm]/)&&(S=2),S<3&&i[s].v.match(/[Ss]/)&&(S=3)}switch(S){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var x="",A;for(s=0;s<i.length;++s)switch(i[s].t){case"t":case"T":case" ":case"D":break;case"X":i[s].v="",i[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[s].v=ST(i[s].t.charCodeAt(0),i[s].v,u,y),i[s].t="t";break;case"n":case"?":for(A=s+1;i[A]!=null&&((o=i[A].t)==="?"||o==="D"||(o===" "||o==="t")&&i[A+1]!=null&&(i[A+1].t==="?"||i[A+1].t==="t"&&i[A+1].v==="/")||i[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[A].v==="/"||i[A].v===" "&&i[A+1]!=null&&i[A+1].t=="?"));)i[s].v+=i[A].v,i[A]={v:"",t:";"},++A;x+=i[s].v,s=A-1;break;case"G":i[s].t="t",i[s].v=Cg(t,r);break}var R="",B,T;if(x.length>0){x.charCodeAt(0)==40?(B=t<0&&x.charCodeAt(0)===45?-t:t,T=os("n",x,B)):(B=t<0&&n>1?-t:t,T=os("n",x,B),B<0&&i[0]&&i[0].t=="t"&&(T=T.substr(1),i[0].v="-"+i[0].v)),A=T.length-1;var L=i.length;for(s=0;s<i.length;++s)if(i[s]!=null&&i[s].t!="t"&&i[s].v.indexOf(".")>-1){L=s;break}var P=i.length;if(L===i.length&&T.indexOf("E")===-1){for(s=i.length-1;s>=0;--s)i[s]==null||"n?".indexOf(i[s].t)===-1||(A>=i[s].v.length-1?(A-=i[s].v.length,i[s].v=T.substr(A+1,i[s].v.length)):A<0?i[s].v="":(i[s].v=T.substr(0,A+1),A=-1),i[s].t="t",P=s);A>=0&&P<i.length&&(i[P].v=T.substr(0,A+1)+i[P].v)}else if(L!==i.length&&T.indexOf("E")===-1){for(A=T.indexOf(".")-1,s=L;s>=0;--s)if(!(i[s]==null||"n?".indexOf(i[s].t)===-1)){for(f=i[s].v.indexOf(".")>-1&&s===L?i[s].v.indexOf(".")-1:i[s].v.length-1,R=i[s].v.substr(f+1);f>=0;--f)A>=0&&(i[s].v.charAt(f)==="0"||i[s].v.charAt(f)==="#")&&(R=T.charAt(A--)+R);i[s].v=R,i[s].t="t",P=s}for(A>=0&&P<i.length&&(i[P].v=T.substr(0,A+1)+i[P].v),A=T.indexOf(".")+1,s=L;s<i.length;++s)if(!(i[s]==null||"n?(".indexOf(i[s].t)===-1&&s!==L)){for(f=i[s].v.indexOf(".")>-1&&s===L?i[s].v.indexOf(".")+1:0,R=i[s].v.substr(0,f);f<i[s].v.length;++f)A<T.length&&(R+=T.charAt(A++));i[s].v=R,i[s].t="t",P=s}}}for(s=0;s<i.length;++s)i[s]!=null&&"n?".indexOf(i[s].t)>-1&&(B=n>1&&t<0&&s>0&&i[s-1].v==="-"?-t:t,i[s].v=os(i[s].t,i[s].v,B),i[s].t="t");var M="";for(s=0;s!==i.length;++s)i[s]!=null&&(M+=i[s].v);return M}var N5=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function C5(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function FT(e,t){var r=PT(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(N5),o=r[1].match(N5);return C5(t,s)?[n,r[0]]:C5(t,o)?[n,r[1]]:[n,r[s!=null&&o!=null?2:1]]}return[n,a]}function so(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Cr)[e],n==null&&(n=r.table&&r.table[A5[e]]||Cr[A5[e]]),n==null&&(n=pT[e]||"General");break}if(td(n,0))return Cg(t,r);t instanceof Date&&(t=o_(t,r.date1904));var i=FT(n,t);if(td(i[1]))return Cg(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return OT(i[1],t,r,i[0])}function v_(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Cr[r]==null){t<0&&(t=r);continue}if(Cr[r]==e){t=r;break}}t<0&&(t=391)}return Cr[t]=e,t}function Id(e){for(var t=0;t!=392;++t)e[t]!==void 0&&v_(e[t],t)}function Dd(){Cr=dT()}var y_=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function RT(e){var t=typeof e=="number"?Cr[e]:e;return t=t.replace(y_,"(\\d+)"),new RegExp("^"+t+"$")}function IT(e,t,r){var n=-1,i=-1,a=-1,s=-1,o=-1,l=-1;(t.match(y_)||[]).forEach(function(d,p){var h=parseInt(r[p+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=h;break;case"d":a=h;break;case"h":s=h;break;case"s":l=h;break;case"m":s>=0?o=h:i=h;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var f=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return s==-1&&o==-1&&l==-1?u:n==-1&&i==-1&&a==-1?f:u+"T"+f}var DT=function(){var e={};e.version="1.2.0";function t(){for(var T=0,L=new Array(256),P=0;P!=256;++P)T=P,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,T=T&1?-306674912^T>>>1:T>>>1,L[P]=T;return typeof Int32Array<"u"?new Int32Array(L):L}var r=t();function n(T){var L=0,P=0,M=0,N=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(M=0;M!=256;++M)N[M]=T[M];for(M=0;M!=256;++M)for(P=T[M],L=256+M;L<4096;L+=256)P=N[L]=P>>>8^T[P&255];var C=[];for(M=1;M!=16;++M)C[M-1]=typeof Int32Array<"u"?N.subarray(M*256,M*256+256):N.slice(M*256,M*256+256);return C}var i=n(r),a=i[0],s=i[1],o=i[2],l=i[3],u=i[4],f=i[5],d=i[6],p=i[7],h=i[8],v=i[9],m=i[10],S=i[11],y=i[12],w=i[13],x=i[14];function A(T,L){for(var P=L^-1,M=0,N=T.length;M<N;)P=P>>>8^r[(P^T.charCodeAt(M++))&255];return~P}function R(T,L){for(var P=L^-1,M=T.length-15,N=0;N<M;)P=x[T[N++]^P&255]^w[T[N++]^P>>8&255]^y[T[N++]^P>>16&255]^S[T[N++]^P>>>24]^m[T[N++]]^v[T[N++]]^h[T[N++]]^p[T[N++]]^d[T[N++]]^f[T[N++]]^u[T[N++]]^l[T[N++]]^o[T[N++]]^s[T[N++]]^a[T[N++]]^r[T[N++]];for(M+=15;N<M;)P=P>>>8^r[(P^T[N++])&255];return~P}function B(T,L){for(var P=L^-1,M=0,N=T.length,C=0,U=0;M<N;)C=T.charCodeAt(M++),C<128?P=P>>>8^r[(P^C)&255]:C<2048?(P=P>>>8^r[(P^(192|C>>6&31))&255],P=P>>>8^r[(P^(128|C&63))&255]):C>=55296&&C<57344?(C=(C&1023)+64,U=T.charCodeAt(M++)&1023,P=P>>>8^r[(P^(240|C>>8&7))&255],P=P>>>8^r[(P^(128|C>>2&63))&255],P=P>>>8^r[(P^(128|U>>6&15|(C&3)<<4))&255],P=P>>>8^r[(P^(128|U&63))&255]):(P=P>>>8^r[(P^(224|C>>12&15))&255],P=P>>>8^r[(P^(128|C>>6&63))&255],P=P>>>8^r[(P^(128|C&63))&255]);return~P}return e.table=r,e.bstr=A,e.buf=R,e.str=B,e}(),nr=function(){var t={};t.version="1.2.1";function r(W,ie){for(var J=W.split("/"),te=ie.split("/"),ne=0,se=0,Se=Math.min(J.length,te.length);ne<Se;++ne){if(se=J[ne].length-te[ne].length)return se;if(J[ne]!=te[ne])return J[ne]<te[ne]?-1:1}return J.length-te.length}function n(W){if(W.charAt(W.length-1)=="/")return W.slice(0,-1).indexOf("/")===-1?W:n(W.slice(0,-1));var ie=W.lastIndexOf("/");return ie===-1?W:W.slice(0,ie+1)}function i(W){if(W.charAt(W.length-1)=="/")return i(W.slice(0,-1));var ie=W.lastIndexOf("/");return ie===-1?W:W.slice(ie+1)}function a(W,ie){typeof ie=="string"&&(ie=new Date(ie));var J=ie.getHours();J=J<<6|ie.getMinutes(),J=J<<5|ie.getSeconds()>>>1,W.write_shift(2,J);var te=ie.getFullYear()-1980;te=te<<4|ie.getMonth()+1,te=te<<5|ie.getDate(),W.write_shift(2,te)}function s(W){var ie=W.read_shift(2)&65535,J=W.read_shift(2)&65535,te=new Date,ne=J&31;J>>>=5;var se=J&15;J>>>=4,te.setMilliseconds(0),te.setFullYear(J+1980),te.setMonth(se-1),te.setDate(ne);var Se=ie&31;ie>>>=5;var Ne=ie&63;return ie>>>=6,te.setHours(ie),te.setMinutes(Ne),te.setSeconds(Se<<1),te}function o(W){xi(W,0);for(var ie={},J=0;W.l<=W.length-4;){var te=W.read_shift(2),ne=W.read_shift(2),se=W.l+ne,Se={};switch(te){case 21589:J=W.read_shift(1),J&1&&(Se.mtime=W.read_shift(4)),ne>5&&(J&2&&(Se.atime=W.read_shift(4)),J&4&&(Se.ctime=W.read_shift(4))),Se.mtime&&(Se.mt=new Date(Se.mtime*1e3));break}W.l=se,ie[te]=Se}return ie}var l;function u(){return l||(l={})}function f(W,ie){if(W[0]==80&&W[1]==75)return hr(W,ie);if((W[0]|32)==109&&(W[1]|32)==105)return Fi(W,ie);if(W.length<512)throw new Error("CFB file size "+W.length+" < 512");var J=3,te=512,ne=0,se=0,Se=0,Ne=0,_e=0,Ae=[],Te=W.slice(0,512);xi(Te,0);var He=d(Te);switch(J=He[0],J){case 3:te=512;break;case 4:te=4096;break;case 0:if(He[1]==0)return hr(W,ie);default:throw new Error("Major Version: Expected 3 or 4 saw "+J)}te!==512&&(Te=W.slice(0,te),xi(Te,28));var Ge=W.slice(0,te);p(Te,J);var nt=Te.read_shift(4,"i");if(J===3&&nt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+nt);Te.l+=4,Se=Te.read_shift(4,"i"),Te.l+=4,Te.chk("00100000","Mini Stream Cutoff Size: "),Ne=Te.read_shift(4,"i"),ne=Te.read_shift(4,"i"),_e=Te.read_shift(4,"i"),se=Te.read_shift(4,"i");for(var $e=-1,rt=0;rt<109&&($e=Te.read_shift(4,"i"),!($e<0));++rt)Ae[rt]=$e;var _t=h(W,te);S(_e,se,_t,te,Ae);var Vt=w(_t,Se,Ae,te);Vt[Se].name="!Directory",ne>0&&Ne!==U&&(Vt[Ne].name="!MiniFAT"),Vt[Ae[0]].name="!FAT",Vt.fat_addrs=Ae,Vt.ssz=te;var tr={},Mr=[],Ji=[],qa=[];x(Se,Vt,_t,Mr,ne,tr,Ji,Ne),v(Ji,qa,Mr),Mr.shift();var Aa={FileIndex:Ji,FullPaths:qa};return ie&&ie.raw&&(Aa.raw={header:Ge,sectors:_t}),Aa}function d(W){if(W[W.l]==80&&W[W.l+1]==75)return[0,0];W.chk(Y,"Header Signature: "),W.l+=16;var ie=W.read_shift(2,"u");return[W.read_shift(2,"u"),ie]}function p(W,ie){var J=9;switch(W.l+=2,J=W.read_shift(2)){case 9:if(ie!=3)throw new Error("Sector Shift: Expected 9 saw "+J);break;case 12:if(ie!=4)throw new Error("Sector Shift: Expected 12 saw "+J);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+J)}W.chk("0600","Mini Sector Shift: "),W.chk("000000000000","Reserved: ")}function h(W,ie){for(var J=Math.ceil(W.length/ie)-1,te=[],ne=1;ne<J;++ne)te[ne-1]=W.slice(ne*ie,(ne+1)*ie);return te[J-1]=W.slice(J*ie),te}function v(W,ie,J){for(var te=0,ne=0,se=0,Se=0,Ne=0,_e=J.length,Ae=[],Te=[];te<_e;++te)Ae[te]=Te[te]=te,ie[te]=J[te];for(;Ne<Te.length;++Ne)te=Te[Ne],ne=W[te].L,se=W[te].R,Se=W[te].C,Ae[te]===te&&(ne!==-1&&Ae[ne]!==ne&&(Ae[te]=Ae[ne]),se!==-1&&Ae[se]!==se&&(Ae[te]=Ae[se])),Se!==-1&&(Ae[Se]=te),ne!==-1&&te!=Ae[te]&&(Ae[ne]=Ae[te],Te.lastIndexOf(ne)<Ne&&Te.push(ne)),se!==-1&&te!=Ae[te]&&(Ae[se]=Ae[te],Te.lastIndexOf(se)<Ne&&Te.push(se));for(te=1;te<_e;++te)Ae[te]===te&&(se!==-1&&Ae[se]!==se?Ae[te]=Ae[se]:ne!==-1&&Ae[ne]!==ne&&(Ae[te]=Ae[ne]));for(te=1;te<_e;++te)if(W[te].type!==0){if(Ne=te,Ne!=Ae[Ne])do Ne=Ae[Ne],ie[te]=ie[Ne]+"/"+ie[te];while(Ne!==0&&Ae[Ne]!==-1&&Ne!=Ae[Ne]);Ae[te]=-1}for(ie[0]+="/",te=1;te<_e;++te)W[te].type!==2&&(ie[te]+="/")}function m(W,ie,J){for(var te=W.start,ne=W.size,se=[],Se=te;J&&ne>0&&Se>=0;)se.push(ie.slice(Se*C,Se*C+C)),ne-=C,Se=Ro(J,Se*4);return se.length===0?Pe(0):yn(se).slice(0,W.size)}function S(W,ie,J,te,ne){var se=U;if(W===U){if(ie!==0)throw new Error("DIFAT chain shorter than expected")}else if(W!==-1){var Se=J[W],Ne=(te>>>2)-1;if(!Se)return;for(var _e=0;_e<Ne&&(se=Ro(Se,_e*4))!==U;++_e)ne.push(se);S(Ro(Se,te-4),ie-1,J,te,ne)}}function y(W,ie,J,te,ne){var se=[],Se=[];ne||(ne=[]);var Ne=te-1,_e=0,Ae=0;for(_e=ie;_e>=0;){ne[_e]=!0,se[se.length]=_e,Se.push(W[_e]);var Te=J[Math.floor(_e*4/te)];if(Ae=_e*4&Ne,te<4+Ae)throw new Error("FAT boundary crossed: "+_e+" 4 "+te);if(!W[Te])break;_e=Ro(W[Te],Ae)}return{nodes:se,data:j5([Se])}}function w(W,ie,J,te){var ne=W.length,se=[],Se=[],Ne=[],_e=[],Ae=te-1,Te=0,He=0,Ge=0,nt=0;for(Te=0;Te<ne;++Te)if(Ne=[],Ge=Te+ie,Ge>=ne&&(Ge-=ne),!Se[Ge]){_e=[];var $e=[];for(He=Ge;He>=0;){$e[He]=!0,Se[He]=!0,Ne[Ne.length]=He,_e.push(W[He]);var rt=J[Math.floor(He*4/te)];if(nt=He*4&Ae,te<4+nt)throw new Error("FAT boundary crossed: "+He+" 4 "+te);if(!W[rt]||(He=Ro(W[rt],nt),$e[He]))break}se[Ge]={nodes:Ne,data:j5([_e])}}return se}function x(W,ie,J,te,ne,se,Se,Ne){for(var _e=0,Ae=te.length?2:0,Te=ie[W].data,He=0,Ge=0,nt;He<Te.length;He+=128){var $e=Te.slice(He,He+128);xi($e,64),Ge=$e.read_shift(2),nt=K2($e,0,Ge-Ae),te.push(nt);var rt={name:nt,type:$e.read_shift(1),color:$e.read_shift(1),L:$e.read_shift(4,"i"),R:$e.read_shift(4,"i"),C:$e.read_shift(4,"i"),clsid:$e.read_shift(16),state:$e.read_shift(4,"i"),start:0,size:0},_t=$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2);_t!==0&&(rt.ct=A($e,$e.l-8));var Vt=$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2)+$e.read_shift(2);Vt!==0&&(rt.mt=A($e,$e.l-8)),rt.start=$e.read_shift(4,"i"),rt.size=$e.read_shift(4,"i"),rt.size<0&&rt.start<0&&(rt.size=rt.type=0,rt.start=U,rt.name=""),rt.type===5?(_e=rt.start,ne>0&&_e!==U&&(ie[_e].name="!StreamData")):rt.size>=4096?(rt.storage="fat",ie[rt.start]===void 0&&(ie[rt.start]=y(J,rt.start,ie.fat_addrs,ie.ssz)),ie[rt.start].name=rt.name,rt.content=ie[rt.start].data.slice(0,rt.size)):(rt.storage="minifat",rt.size<0?rt.size=0:_e!==U&&rt.start!==U&&ie[_e]&&(rt.content=m(rt,ie[_e].data,(ie[Ne]||{}).data))),rt.content&&xi(rt.content,0),se[nt]=rt,Se.push(rt)}}function A(W,ie){return new Date((Si(W,ie+4)/1e7*Math.pow(2,32)+Si(W,ie)/1e7-11644473600)*1e3)}function R(W,ie){return u(),f(l.readFileSync(W),ie)}function B(W,ie){var J=ie&&ie.type;switch(J||qt&&Buffer.isBuffer(W)&&(J="buffer"),J||"base64"){case"file":return R(W,ie);case"base64":return f(ma(ps(W)),ie);case"binary":return f(ma(W),ie)}return f(W,ie)}function T(W,ie){var J=ie||{},te=J.root||"Root Entry";if(W.FullPaths||(W.FullPaths=[]),W.FileIndex||(W.FileIndex=[]),W.FullPaths.length!==W.FileIndex.length)throw new Error("inconsistent CFB structure");W.FullPaths.length===0&&(W.FullPaths[0]=te+"/",W.FileIndex[0]={name:te,type:5}),J.CLSID&&(W.FileIndex[0].clsid=J.CLSID),L(W)}function L(W){var ie="Sh33tJ5";if(!nr.find(W,"/"+ie)){var J=Pe(4);J[0]=55,J[1]=J[3]=50,J[2]=54,W.FileIndex.push({name:ie,type:2,content:J,size:4,L:69,R:69,C:69}),W.FullPaths.push(W.FullPaths[0]+ie),P(W)}}function P(W,ie){T(W);for(var J=!1,te=!1,ne=W.FullPaths.length-1;ne>=0;--ne){var se=W.FileIndex[ne];switch(se.type){case 0:te?J=!0:(W.FileIndex.pop(),W.FullPaths.pop());break;case 1:case 2:case 5:te=!0,isNaN(se.R*se.L*se.C)&&(J=!0),se.R>-1&&se.L>-1&&se.R==se.L&&(J=!0);break;default:J=!0;break}}if(!(!J&&!ie)){var Se=new Date(1987,1,19),Ne=0,_e=Object.create?Object.create(null):{},Ae=[];for(ne=0;ne<W.FullPaths.length;++ne)_e[W.FullPaths[ne]]=!0,W.FileIndex[ne].type!==0&&Ae.push([W.FullPaths[ne],W.FileIndex[ne]]);for(ne=0;ne<Ae.length;++ne){var Te=n(Ae[ne][0]);te=_e[Te],te||(Ae.push([Te,{name:i(Te).replace("/",""),type:1,clsid:ee,ct:Se,mt:Se,content:null}]),_e[Te]=!0)}for(Ae.sort(function(nt,$e){return r(nt[0],$e[0])}),W.FullPaths=[],W.FileIndex=[],ne=0;ne<Ae.length;++ne)W.FullPaths[ne]=Ae[ne][0],W.FileIndex[ne]=Ae[ne][1];for(ne=0;ne<Ae.length;++ne){var He=W.FileIndex[ne],Ge=W.FullPaths[ne];if(He.name=i(Ge).replace("/",""),He.L=He.R=He.C=-(He.color=1),He.size=He.content?He.content.length:0,He.start=0,He.clsid=He.clsid||ee,ne===0)He.C=Ae.length>1?1:-1,He.size=0,He.type=5;else if(Ge.slice(-1)=="/"){for(Ne=ne+1;Ne<Ae.length&&n(W.FullPaths[Ne])!=Ge;++Ne);for(He.C=Ne>=Ae.length?-1:Ne,Ne=ne+1;Ne<Ae.length&&n(W.FullPaths[Ne])!=n(Ge);++Ne);He.R=Ne>=Ae.length?-1:Ne,He.type=1}else n(W.FullPaths[ne+1]||"")==n(Ge)&&(He.R=ne+1),He.type=2}}}function M(W,ie){var J=ie||{};if(J.fileType=="mad")return pt(W,J);switch(P(W),J.fileType){case"zip":return Xi(W,J)}var te=function(nt){for(var $e=0,rt=0,_t=0;_t<nt.FileIndex.length;++_t){var Vt=nt.FileIndex[_t];if(Vt.content){var tr=Vt.content.length;tr>0&&(tr<4096?$e+=tr+63>>6:rt+=tr+511>>9)}}for(var Mr=nt.FullPaths.length+3>>2,Ji=$e+7>>3,qa=$e+127>>7,Aa=Ji+rt+Mr+qa,Qi=Aa+127>>7,Ta=Qi<=109?0:Math.ceil((Qi-109)/127);Aa+Qi+Ta+127>>7>Qi;)Ta=++Qi<=109?0:Math.ceil((Qi-109)/127);var hi=[1,Ta,Qi,qa,Mr,rt,$e,0];return nt.FileIndex[0].size=$e<<6,hi[7]=(nt.FileIndex[0].start=hi[0]+hi[1]+hi[2]+hi[3]+hi[4]+hi[5])+(hi[6]+7>>3),hi}(W),ne=Pe(te[7]<<9),se=0,Se=0;{for(se=0;se<8;++se)ne.write_shift(1,ce[se]);for(se=0;se<8;++se)ne.write_shift(2,0);for(ne.write_shift(2,62),ne.write_shift(2,3),ne.write_shift(2,65534),ne.write_shift(2,9),ne.write_shift(2,6),se=0;se<3;++se)ne.write_shift(2,0);for(ne.write_shift(4,0),ne.write_shift(4,te[2]),ne.write_shift(4,te[0]+te[1]+te[2]+te[3]-1),ne.write_shift(4,0),ne.write_shift(4,4096),ne.write_shift(4,te[3]?te[0]+te[1]+te[2]-1:U),ne.write_shift(4,te[3]),ne.write_shift(-4,te[1]?te[0]-1:U),ne.write_shift(4,te[1]),se=0;se<109;++se)ne.write_shift(-4,se<te[2]?te[1]+se:-1)}if(te[1])for(Se=0;Se<te[1];++Se){for(;se<236+Se*127;++se)ne.write_shift(-4,se<te[2]?te[1]+se:-1);ne.write_shift(-4,Se===te[1]-1?U:Se+1)}var Ne=function(nt){for(Se+=nt;se<Se-1;++se)ne.write_shift(-4,se+1);nt&&(++se,ne.write_shift(-4,U))};for(Se=se=0,Se+=te[1];se<Se;++se)ne.write_shift(-4,Q.DIFSECT);for(Se+=te[2];se<Se;++se)ne.write_shift(-4,Q.FATSECT);Ne(te[3]),Ne(te[4]);for(var _e=0,Ae=0,Te=W.FileIndex[0];_e<W.FileIndex.length;++_e)Te=W.FileIndex[_e],Te.content&&(Ae=Te.content.length,!(Ae<4096)&&(Te.start=Se,Ne(Ae+511>>9)));for(Ne(te[6]+7>>3);ne.l&511;)ne.write_shift(-4,Q.ENDOFCHAIN);for(Se=se=0,_e=0;_e<W.FileIndex.length;++_e)Te=W.FileIndex[_e],Te.content&&(Ae=Te.content.length,!(!Ae||Ae>=4096)&&(Te.start=Se,Ne(Ae+63>>6)));for(;ne.l&511;)ne.write_shift(-4,Q.ENDOFCHAIN);for(se=0;se<te[4]<<2;++se){var He=W.FullPaths[se];if(!He||He.length===0){for(_e=0;_e<17;++_e)ne.write_shift(4,0);for(_e=0;_e<3;++_e)ne.write_shift(4,-1);for(_e=0;_e<12;++_e)ne.write_shift(4,0);continue}Te=W.FileIndex[se],se===0&&(Te.start=Te.size?Te.start-1:U);var Ge=se===0&&J.root||Te.name;if(Ae=2*(Ge.length+1),ne.write_shift(64,Ge,"utf16le"),ne.write_shift(2,Ae),ne.write_shift(1,Te.type),ne.write_shift(1,Te.color),ne.write_shift(-4,Te.L),ne.write_shift(-4,Te.R),ne.write_shift(-4,Te.C),Te.clsid)ne.write_shift(16,Te.clsid,"hex");else for(_e=0;_e<4;++_e)ne.write_shift(4,0);ne.write_shift(4,Te.state||0),ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(4,Te.start),ne.write_shift(4,Te.size),ne.write_shift(4,0)}for(se=1;se<W.FileIndex.length;++se)if(Te=W.FileIndex[se],Te.size>=4096)if(ne.l=Te.start+1<<9,qt&&Buffer.isBuffer(Te.content))Te.content.copy(ne,ne.l,0,Te.size),ne.l+=Te.size+511&-512;else{for(_e=0;_e<Te.size;++_e)ne.write_shift(1,Te.content[_e]);for(;_e&511;++_e)ne.write_shift(1,0)}for(se=1;se<W.FileIndex.length;++se)if(Te=W.FileIndex[se],Te.size>0&&Te.size<4096)if(qt&&Buffer.isBuffer(Te.content))Te.content.copy(ne,ne.l,0,Te.size),ne.l+=Te.size+63&-64;else{for(_e=0;_e<Te.size;++_e)ne.write_shift(1,Te.content[_e]);for(;_e&63;++_e)ne.write_shift(1,0)}if(qt)ne.l=ne.length;else for(;ne.l<ne.length;)ne.write_shift(1,0);return ne}function N(W,ie){var J=W.FullPaths.map(function(_e){return _e.toUpperCase()}),te=J.map(function(_e){var Ae=_e.split("/");return Ae[Ae.length-(_e.slice(-1)=="/"?2:1)]}),ne=!1;ie.charCodeAt(0)===47?(ne=!0,ie=J[0].slice(0,-1)+ie):ne=ie.indexOf("/")!==-1;var se=ie.toUpperCase(),Se=ne===!0?J.indexOf(se):te.indexOf(se);if(Se!==-1)return W.FileIndex[Se];var Ne=!se.match(r0);for(se=se.replace(Uc,""),Ne&&(se=se.replace(r0,"!")),Se=0;Se<J.length;++Se)if((Ne?J[Se].replace(r0,"!"):J[Se]).replace(Uc,"")==se||(Ne?te[Se].replace(r0,"!"):te[Se]).replace(Uc,"")==se)return W.FileIndex[Se];return null}var C=64,U=-2,Y="d0cf11e0a1b11ae1",ce=[208,207,17,224,161,177,26,225],ee="00000000000000000000000000000000",Q={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:U,FREESECT:-1,HEADER_SIGNATURE:Y,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:ee,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function X(W,ie,J){u();var te=M(W,J);l.writeFileSync(ie,te)}function z(W){for(var ie=new Array(W.length),J=0;J<W.length;++J)ie[J]=String.fromCharCode(W[J]);return ie.join("")}function ae(W,ie){var J=M(W,ie);switch(ie&&ie.type||"buffer"){case"file":return u(),l.writeFileSync(ie.filename,J),J;case"binary":return typeof J=="string"?J:z(J);case"base64":return bf(typeof J=="string"?J:z(J));case"buffer":if(qt)return Buffer.isBuffer(J)?J:ys(J);case"array":return typeof J=="string"?ma(J):J}return J}var me;function E(W){try{var ie=W.InflateRaw,J=new ie;if(J._processChunk(new Uint8Array([3,0]),J._finishFlushFlag),J.bytesRead)me=W;else throw new Error("zlib does not expose bytesRead")}catch(te){console.error("cannot use native zlib: "+(te.message||te))}}function O(W,ie){if(!me)return Mt(W,ie);var J=me.InflateRaw,te=new J,ne=te._processChunk(W.slice(W.l),te._finishFlushFlag);return W.l+=te.bytesRead,ne}function F(W){return me?me.deflateRawSync(W):Lt(W)}var I=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],V=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ue=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function fe(W){var ie=(W<<1|W<<11)&139536|(W<<5|W<<15)&558144;return(ie>>16|ie>>8|ie)&255}for(var he=typeof Uint8Array<"u",xe=he?new Uint8Array(256):[],Oe=0;Oe<256;++Oe)xe[Oe]=fe(Oe);function De(W,ie){var J=xe[W&255];return ie<=8?J>>>8-ie:(J=J<<8|xe[W>>8&255],ie<=16?J>>>16-ie:(J=J<<8|xe[W>>16&255],J>>>24-ie))}function qe(W,ie){var J=ie&7,te=ie>>>3;return(W[te]|(J<=6?0:W[te+1]<<8))>>>J&3}function Xe(W,ie){var J=ie&7,te=ie>>>3;return(W[te]|(J<=5?0:W[te+1]<<8))>>>J&7}function ke(W,ie){var J=ie&7,te=ie>>>3;return(W[te]|(J<=4?0:W[te+1]<<8))>>>J&15}function le(W,ie){var J=ie&7,te=ie>>>3;return(W[te]|(J<=3?0:W[te+1]<<8))>>>J&31}function je(W,ie){var J=ie&7,te=ie>>>3;return(W[te]|(J<=1?0:W[te+1]<<8))>>>J&127}function it(W,ie,J){var te=ie&7,ne=ie>>>3,se=(1<<J)-1,Se=W[ne]>>>te;return J<8-te||(Se|=W[ne+1]<<8-te,J<16-te)||(Se|=W[ne+2]<<16-te,J<24-te)||(Se|=W[ne+3]<<24-te),Se&se}function Ue(W,ie,J){var te=ie&7,ne=ie>>>3;return te<=5?W[ne]|=(J&7)<<te:(W[ne]|=J<<te&255,W[ne+1]=(J&7)>>8-te),ie+3}function Ve(W,ie,J){var te=ie&7,ne=ie>>>3;return J=(J&1)<<te,W[ne]|=J,ie+1}function Je(W,ie,J){var te=ie&7,ne=ie>>>3;return J<<=te,W[ne]|=J&255,J>>>=8,W[ne+1]=J,ie+8}function Ze(W,ie,J){var te=ie&7,ne=ie>>>3;return J<<=te,W[ne]|=J&255,J>>>=8,W[ne+1]=J&255,W[ne+2]=J>>>8,ie+16}function ct(W,ie){var J=W.length,te=2*J>ie?2*J:ie+5,ne=0;if(J>=ie)return W;if(qt){var se=S5(te);if(W.copy)W.copy(se);else for(;ne<W.length;++ne)se[ne]=W[ne];return se}else if(he){var Se=new Uint8Array(te);if(Se.set)Se.set(W);else for(;ne<J;++ne)Se[ne]=W[ne];return Se}return W.length=te,W}function ht(W){for(var ie=new Array(W),J=0;J<W;++J)ie[J]=0;return ie}function St(W,ie,J){var te=1,ne=0,se=0,Se=0,Ne=0,_e=W.length,Ae=he?new Uint16Array(32):ht(32);for(se=0;se<32;++se)Ae[se]=0;for(se=_e;se<J;++se)W[se]=0;_e=W.length;var Te=he?new Uint16Array(_e):ht(_e);for(se=0;se<_e;++se)Ae[ne=W[se]]++,te<ne&&(te=ne),Te[se]=0;for(Ae[0]=0,se=1;se<=te;++se)Ae[se+16]=Ne=Ne+Ae[se-1]<<1;for(se=0;se<_e;++se)Ne=W[se],Ne!=0&&(Te[se]=Ae[Ne+16]++);var He=0;for(se=0;se<_e;++se)if(He=W[se],He!=0)for(Ne=De(Te[se],te)>>te-He,Se=(1<<te+4-He)-1;Se>=0;--Se)ie[Ne|Se<<He]=He&15|se<<4;return te}var Nt=he?new Uint16Array(512):ht(512),Ot=he?new Uint16Array(32):ht(32);if(!he){for(var Rt=0;Rt<512;++Rt)Nt[Rt]=0;for(Rt=0;Rt<32;++Rt)Ot[Rt]=0}(function(){for(var W=[],ie=0;ie<32;ie++)W.push(5);St(W,Ot,32);var J=[];for(ie=0;ie<=143;ie++)J.push(8);for(;ie<=255;ie++)J.push(9);for(;ie<=279;ie++)J.push(7);for(;ie<=287;ie++)J.push(8);St(J,Nt,288)})();var wt=function(){for(var ie=he?new Uint8Array(32768):[],J=0,te=0;J<ue.length-1;++J)for(;te<ue[J+1];++te)ie[te]=J;for(;te<32768;++te)ie[te]=29;var ne=he?new Uint8Array(259):[];for(J=0,te=0;J<V.length-1;++J)for(;te<V[J+1];++te)ne[te]=J;function se(Ne,_e){for(var Ae=0;Ae<Ne.length;){var Te=Math.min(65535,Ne.length-Ae),He=Ae+Te==Ne.length;for(_e.write_shift(1,+He),_e.write_shift(2,Te),_e.write_shift(2,~Te&65535);Te-- >0;)_e[_e.l++]=Ne[Ae++]}return _e.l}function Se(Ne,_e){for(var Ae=0,Te=0,He=he?new Uint16Array(32768):[];Te<Ne.length;){var Ge=Math.min(65535,Ne.length-Te);if(Ge<10){for(Ae=Ue(_e,Ae,+(Te+Ge==Ne.length)),Ae&7&&(Ae+=8-(Ae&7)),_e.l=Ae/8|0,_e.write_shift(2,Ge),_e.write_shift(2,~Ge&65535);Ge-- >0;)_e[_e.l++]=Ne[Te++];Ae=_e.l*8;continue}Ae=Ue(_e,Ae,+(Te+Ge==Ne.length)+2);for(var nt=0;Ge-- >0;){var $e=Ne[Te];nt=(nt<<5^$e)&32767;var rt=-1,_t=0;if((rt=He[nt])&&(rt|=Te&-32768,rt>Te&&(rt-=32768),rt<Te))for(;Ne[rt+_t]==Ne[Te+_t]&&_t<250;)++_t;if(_t>2){$e=ne[_t],$e<=22?Ae=Je(_e,Ae,xe[$e+1]>>1)-1:(Je(_e,Ae,3),Ae+=5,Je(_e,Ae,xe[$e-23]>>5),Ae+=3);var Vt=$e<8?0:$e-4>>2;Vt>0&&(Ze(_e,Ae,_t-V[$e]),Ae+=Vt),$e=ie[Te-rt],Ae=Je(_e,Ae,xe[$e]>>3),Ae-=3;var tr=$e<4?0:$e-2>>1;tr>0&&(Ze(_e,Ae,Te-rt-ue[$e]),Ae+=tr);for(var Mr=0;Mr<_t;++Mr)He[nt]=Te&32767,nt=(nt<<5^Ne[Te])&32767,++Te;Ge-=_t-1}else $e<=143?$e=$e+48:Ae=Ve(_e,Ae,1),Ae=Je(_e,Ae,xe[$e]),He[nt]=Te&32767,++Te}Ae=Je(_e,Ae,0)-1}return _e.l=(Ae+7)/8|0,_e.l}return function(_e,Ae){return _e.length<8?se(_e,Ae):Se(_e,Ae)}}();function Lt(W){var ie=Pe(50+Math.floor(W.length*1.1)),J=wt(W,ie);return ie.slice(0,J)}var tt=he?new Uint16Array(32768):ht(32768),Gr=he?new Uint16Array(32768):ht(32768),Dt=he?new Uint16Array(128):ht(128),Kn=1,$t=1;function or(W,ie){var J=le(W,ie)+257;ie+=5;var te=le(W,ie)+1;ie+=5;var ne=ke(W,ie)+4;ie+=4;for(var se=0,Se=he?new Uint8Array(19):ht(19),Ne=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],_e=1,Ae=he?new Uint8Array(8):ht(8),Te=he?new Uint8Array(8):ht(8),He=Se.length,Ge=0;Ge<ne;++Ge)Se[I[Ge]]=se=Xe(W,ie),_e<se&&(_e=se),Ae[se]++,ie+=3;var nt=0;for(Ae[0]=0,Ge=1;Ge<=_e;++Ge)Te[Ge]=nt=nt+Ae[Ge-1]<<1;for(Ge=0;Ge<He;++Ge)(nt=Se[Ge])!=0&&(Ne[Ge]=Te[nt]++);var $e=0;for(Ge=0;Ge<He;++Ge)if($e=Se[Ge],$e!=0){nt=xe[Ne[Ge]]>>8-$e;for(var rt=(1<<7-$e)-1;rt>=0;--rt)Dt[nt|rt<<$e]=$e&7|Ge<<3}var _t=[];for(_e=1;_t.length<J+te;)switch(nt=Dt[je(W,ie)],ie+=nt&7,nt>>>=3){case 16:for(se=3+qe(W,ie),ie+=2,nt=_t[_t.length-1];se-- >0;)_t.push(nt);break;case 17:for(se=3+Xe(W,ie),ie+=3;se-- >0;)_t.push(0);break;case 18:for(se=11+je(W,ie),ie+=7;se-- >0;)_t.push(0);break;default:_t.push(nt),_e<nt&&(_e=nt);break}var Vt=_t.slice(0,J),tr=_t.slice(J);for(Ge=J;Ge<286;++Ge)Vt[Ge]=0;for(Ge=te;Ge<30;++Ge)tr[Ge]=0;return Kn=St(Vt,tt,286),$t=St(tr,Gr,30),ie}function Pi(W,ie){if(W[0]==3&&!(W[1]&3))return[Qo(ie),2];for(var J=0,te=0,ne=S5(ie||1<<18),se=0,Se=ne.length>>>0,Ne=0,_e=0;!(te&1);){if(te=Xe(W,J),J+=3,te>>>1)te>>1==1?(Ne=9,_e=5):(J=or(W,J),Ne=Kn,_e=$t);else{J&7&&(J+=8-(J&7));var Ae=W[J>>>3]|W[(J>>>3)+1]<<8;if(J+=32,Ae>0)for(!ie&&Se<se+Ae&&(ne=ct(ne,se+Ae),Se=ne.length);Ae-- >0;)ne[se++]=W[J>>>3],J+=8;continue}for(;;){!ie&&Se<se+32767&&(ne=ct(ne,se+32767),Se=ne.length);var Te=it(W,J,Ne),He=te>>>1==1?Nt[Te]:tt[Te];if(J+=He&15,He>>>=4,!(He>>>8&255))ne[se++]=He;else{if(He==256)break;He-=257;var Ge=He<8?0:He-4>>2;Ge>5&&(Ge=0);var nt=se+V[He];Ge>0&&(nt+=it(W,J,Ge),J+=Ge),Te=it(W,J,_e),He=te>>>1==1?Ot[Te]:Gr[Te],J+=He&15,He>>>=4;var $e=He<4?0:He-2>>1,rt=ue[He];for($e>0&&(rt+=it(W,J,$e),J+=$e),!ie&&Se<nt&&(ne=ct(ne,nt+100),Se=ne.length);se<nt;)ne[se]=ne[se-rt],++se}}}return ie?[ne,J+7>>>3]:[ne.slice(0,se),J+7>>>3]}function Mt(W,ie){var J=W.slice(W.l||0),te=Pi(J,ie);return W.l+=te[1],te[0]}function Ea(W,ie){if(W)typeof console<"u"&&console.error(ie);else throw new Error(ie)}function hr(W,ie){var J=W;xi(J,0);var te=[],ne=[],se={FileIndex:te,FullPaths:ne};T(se,{root:ie.root});for(var Se=J.length-4;(J[Se]!=80||J[Se+1]!=75||J[Se+2]!=5||J[Se+3]!=6)&&Se>=0;)--Se;J.l=Se+4,J.l+=4;var Ne=J.read_shift(2);J.l+=6;var _e=J.read_shift(4);for(J.l=_e,Se=0;Se<Ne;++Se){J.l+=20;var Ae=J.read_shift(4),Te=J.read_shift(4),He=J.read_shift(2),Ge=J.read_shift(2),nt=J.read_shift(2);J.l+=8;var $e=J.read_shift(4),rt=o(J.slice(J.l+He,J.l+He+Ge));J.l+=He+Ge+nt;var _t=J.l;J.l=$e+4,ci(J,Ae,Te,se,rt),J.l=_t}return se}function ci(W,ie,J,te,ne){W.l+=2;var se=W.read_shift(2),Se=W.read_shift(2),Ne=s(W);if(se&8257)throw new Error("Unsupported ZIP encryption");for(var _e=W.read_shift(4),Ae=W.read_shift(4),Te=W.read_shift(4),He=W.read_shift(2),Ge=W.read_shift(2),nt="",$e=0;$e<He;++$e)nt+=String.fromCharCode(W[W.l++]);if(Ge){var rt=o(W.slice(W.l,W.l+Ge));(rt[21589]||{}).mt&&(Ne=rt[21589].mt),((ne||{})[21589]||{}).mt&&(Ne=ne[21589].mt)}W.l+=Ge;var _t=W.slice(W.l,W.l+Ae);switch(Se){case 8:_t=O(W,Te);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Se)}var Vt=!1;se&8&&(_e=W.read_shift(4),_e==134695760&&(_e=W.read_shift(4),Vt=!0),Ae=W.read_shift(4),Te=W.read_shift(4)),Ae!=ie&&Ea(Vt,"Bad compressed size: "+ie+" != "+Ae),Te!=J&&Ea(Vt,"Bad uncompressed size: "+J+" != "+Te),Yn(te,nt,_t,{unsafe:!0,mt:Ne})}function Xi(W,ie){var J=ie||{},te=[],ne=[],se=Pe(1),Se=J.compression?8:0,Ne=0,_e=0,Ae=0,Te=0,He=0,Ge=W.FullPaths[0],nt=Ge,$e=W.FileIndex[0],rt=[],_t=0;for(_e=1;_e<W.FullPaths.length;++_e)if(nt=W.FullPaths[_e].slice(Ge.length),$e=W.FileIndex[_e],!(!$e.size||!$e.content||nt=="Sh33tJ5")){var Vt=Te,tr=Pe(nt.length);for(Ae=0;Ae<nt.length;++Ae)tr.write_shift(1,nt.charCodeAt(Ae)&127);tr=tr.slice(0,tr.l),rt[He]=DT.buf($e.content,0);var Mr=$e.content;Se==8&&(Mr=F(Mr)),se=Pe(30),se.write_shift(4,67324752),se.write_shift(2,20),se.write_shift(2,Ne),se.write_shift(2,Se),$e.mt?a(se,$e.mt):se.write_shift(4,0),se.write_shift(-4,rt[He]),se.write_shift(4,Mr.length),se.write_shift(4,$e.content.length),se.write_shift(2,tr.length),se.write_shift(2,0),Te+=se.length,te.push(se),Te+=tr.length,te.push(tr),Te+=Mr.length,te.push(Mr),se=Pe(46),se.write_shift(4,33639248),se.write_shift(2,0),se.write_shift(2,20),se.write_shift(2,Ne),se.write_shift(2,Se),se.write_shift(4,0),se.write_shift(-4,rt[He]),se.write_shift(4,Mr.length),se.write_shift(4,$e.content.length),se.write_shift(2,tr.length),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(4,0),se.write_shift(4,Vt),_t+=se.l,ne.push(se),_t+=tr.length,ne.push(tr),++He}return se=Pe(22),se.write_shift(4,101010256),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,He),se.write_shift(2,He),se.write_shift(4,_t),se.write_shift(4,Te),se.write_shift(2,0),yn([yn(te),yn(ne),se])}var ir={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function bt(W,ie){if(W.ctype)return W.ctype;var J=W.name||"",te=J.match(/\.([^\.]+)$/);return te&&ir[te[1]]||ie&&(te=(J=ie).match(/[\.\\]([^\.\\])+$/),te&&ir[te[1]])?ir[te[1]]:"application/octet-stream"}function zt(W){for(var ie=bf(W),J=[],te=0;te<ie.length;te+=76)J.push(ie.slice(te,te+76));return J.join(`\r
`)+`\r
`}function Wa(W){var ie=W.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ae){var Te=Ae.charCodeAt(0).toString(16).toUpperCase();return"="+(Te.length==1?"0"+Te:Te)});ie=ie.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ie.charAt(0)==`
`&&(ie="=0D"+ie.slice(1)),ie=ie.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var J=[],te=ie.split(`\r
`),ne=0;ne<te.length;++ne){var se=te[ne];if(se.length==0){J.push("");continue}for(var Se=0;Se<se.length;){var Ne=76,_e=se.slice(Se,Se+Ne);_e.charAt(Ne-1)=="="?Ne--:_e.charAt(Ne-2)=="="?Ne-=2:_e.charAt(Ne-3)=="="&&(Ne-=3),_e=se.slice(Se,Se+Ne),Se+=Ne,Se<se.length&&(_e+="="),J.push(_e)}}return J.join(`\r
`)}function Kr(W){for(var ie=[],J=0;J<W.length;++J){for(var te=W[J];J<=W.length&&te.charAt(te.length-1)=="=";)te=te.slice(0,te.length-1)+W[++J];ie.push(te)}for(var ne=0;ne<ie.length;++ne)ie[ne]=ie[ne].replace(/[=][0-9A-Fa-f]{2}/g,function(se){return String.fromCharCode(parseInt(se.slice(1),16))});return ma(ie.join(`\r
`))}function Oi(W,ie,J){for(var te="",ne="",se="",Se,Ne=0;Ne<10;++Ne){var _e=ie[Ne];if(!_e||_e.match(/^\s*$/))break;var Ae=_e.match(/^(.*?):\s*([^\s].*)$/);if(Ae)switch(Ae[1].toLowerCase()){case"content-location":te=Ae[2].trim();break;case"content-type":se=Ae[2].trim();break;case"content-transfer-encoding":ne=Ae[2].trim();break}}switch(++Ne,ne.toLowerCase()){case"base64":Se=ma(ps(ie.slice(Ne).join("")));break;case"quoted-printable":Se=Kr(ie.slice(Ne));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ne)}var Te=Yn(W,te.slice(J.length),Se,{unsafe:!0});se&&(Te.ctype=se)}function Fi(W,ie){if(z(W.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var J=ie&&ie.root||"",te=(qt&&Buffer.isBuffer(W)?W.toString("binary"):z(W)).split(`\r
`),ne=0,se="";for(ne=0;ne<te.length;++ne)if(se=te[ne],!!/^Content-Location:/i.test(se)&&(se=se.slice(se.indexOf("file")),J||(J=se.slice(0,se.lastIndexOf("/")+1)),se.slice(0,J.length)!=J))for(;J.length>0&&(J=J.slice(0,J.length-1),J=J.slice(0,J.lastIndexOf("/")+1),se.slice(0,J.length)!=J););var Se=(te[1]||"").match(/boundary="(.*?)"/);if(!Se)throw new Error("MAD cannot find boundary");var Ne="--"+(Se[1]||""),_e=[],Ae=[],Te={FileIndex:_e,FullPaths:Ae};T(Te);var He,Ge=0;for(ne=0;ne<te.length;++ne){var nt=te[ne];nt!==Ne&&nt!==Ne+"--"||(Ge++&&Oi(Te,te.slice(He,ne),J),He=ne)}return Te}function pt(W,ie){var J=ie||{},te=J.boundary||"SheetJS";te="------="+te;for(var ne=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+te.slice(2)+'"',"","",""],se=W.FullPaths[0],Se=se,Ne=W.FileIndex[0],_e=1;_e<W.FullPaths.length;++_e)if(Se=W.FullPaths[_e].slice(se.length),Ne=W.FileIndex[_e],!(!Ne.size||!Ne.content||Se=="Sh33tJ5")){Se=Se.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(_t){return"_x"+_t.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(_t){return"_u"+_t.charCodeAt(0).toString(16)+"_"});for(var Ae=Ne.content,Te=qt&&Buffer.isBuffer(Ae)?Ae.toString("binary"):z(Ae),He=0,Ge=Math.min(1024,Te.length),nt=0,$e=0;$e<=Ge;++$e)(nt=Te.charCodeAt($e))>=32&&nt<128&&++He;var rt=He>=Ge*4/5;ne.push(te),ne.push("Content-Location: "+(J.root||"file:///C:/SheetJS/")+Se),ne.push("Content-Transfer-Encoding: "+(rt?"quoted-printable":"base64")),ne.push("Content-Type: "+bt(Ne,Se)),ne.push(""),ne.push(rt?Wa(Te):zt(Te))}return ne.push(te+`--\r
`),ne.join(`\r
`)}function fi(W){var ie={};return T(ie,W),ie}function Yn(W,ie,J,te){var ne=te&&te.unsafe;ne||T(W);var se=!ne&&nr.find(W,ie);if(!se){var Se=W.FullPaths[0];ie.slice(0,Se.length)==Se?Se=ie:(Se.slice(-1)!="/"&&(Se+="/"),Se=(Se+ie).replace("//","/")),se={name:i(ie),type:2},W.FileIndex.push(se),W.FullPaths.push(Se),ne||nr.utils.cfb_gc(W)}return se.content=J,se.size=J?J.length:0,te&&(te.CLSID&&(se.clsid=te.CLSID),te.mt&&(se.mt=te.mt),te.ct&&(se.ct=te.ct)),se}function En(W,ie){T(W);var J=nr.find(W,ie);if(J){for(var te=0;te<W.FileIndex.length;++te)if(W.FileIndex[te]==J)return W.FileIndex.splice(te,1),W.FullPaths.splice(te,1),!0}return!1}function Lr(W,ie,J){T(W);var te=nr.find(W,ie);if(te){for(var ne=0;ne<W.FileIndex.length;++ne)if(W.FileIndex[ne]==te)return W.FileIndex[ne].name=i(J),W.FullPaths[ne]=J,!0}return!1}function Sr(W){P(W,!0)}return t.find=N,t.read=B,t.parse=f,t.write=ae,t.writeFile=X,t.utils={cfb_new:fi,cfb_add:Yn,cfb_del:En,cfb_mov:Lr,cfb_gc:Sr,ReadShift:Hc,CheckField:D_,prep_blob:xi,bconcat:yn,use_zlib:E,_deflateRaw:Lt,_inflateRaw:Mt,consts:Q},t}();function jT(e){return typeof e=="string"?Rd(e):Array.isArray(e)?uT(e):e}function Mf(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Rd(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Af(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var i=new Blob([jT(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=a,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=jf(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function bn(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function L5(e,t){for(var r=[],n=bn(e),i=0;i!==n.length;++i)r[e[n[i]][t]]==null&&(r[e[n[i]][t]]=n[i]);return r}function q2(e){for(var t=[],r=bn(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function jd(e){for(var t=[],r=bn(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function MT(e){for(var t=[],r=bn(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var nd=new Date(1899,11,30,0,0,0);function oi(e,t){var r=e.getTime(),n=nd.getTime()+(e.getTimezoneOffset()-nd.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var w_=new Date,BT=nd.getTime()+(w_.getTimezoneOffset()-nd.getTimezoneOffset())*6e4,P5=w_.getTimezoneOffset();function x_(e){var t=new Date;return t.setTime(e*24*60*60*1e3+BT),t.getTimezoneOffset()!==P5&&t.setTime(t.getTime()+(t.getTimezoneOffset()-P5)*6e4),t}var O5=new Date("2017-02-19T19:06:09.000Z"),__=isNaN(O5.getFullYear())?new Date("2/19/17"):O5,UT=__.getFullYear()==2017;function $n(e,t){var r=new Date(e);if(UT)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(__.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Md(e,t){if(qt&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(a){return r[a]||a})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function li(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=li(e[r]));return t}function Nr(e,t){for(var r="";r.length<t;)r+=e;return r}function ls(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var zT=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ef(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&zT.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function Pt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return qt?n=ys(r):n=cT(r),nr.utils.cfb_add(e,t,n)}nr.utils.cfb_add(e,t,r)}else e.file(t,r)}function $2(){return nr.utils.cfb_new()}var Vr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,HT={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},V2=q2(HT),G2=/[&<>'"]/g,WT=/[\u0000-\u0008\u000b-\u001f]/g;function Jt(e){var t=e+"";return t.replace(G2,function(r){return V2[r]}).replace(WT,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function F5(e){return Jt(e).replace(/ /g,"_x0020_")}var S_=/[\u0000-\u001f]/g;function qT(e){var t=e+"";return t.replace(G2,function(r){return V2[r]}).replace(/\n/g,"<br/>").replace(S_,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function $T(e){var t=e+"";return t.replace(G2,function(r){return V2[r]}).replace(S_,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function VT(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function GT(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function up(e){for(var t="",r=0,n=0,i=0,a=0,s=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=i&63,t+=String.fromCharCode(s);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|a&63);continue}s=e.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(a&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function R5(e){var t=Qo(2*e.length),r,n,i=1,a=0,s=0,o;for(n=0;n<e.length;n+=i)i=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[a++]=s&255,t[a++]=s>>>8,s=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function I5(e){return ys(e,"binary").toString("utf8")}var i0="foo bar baz",zc=qt&&(I5(i0)==up(i0)&&I5||R5(i0)==up(i0)&&R5)||up,Af=qt?function(e){return ys(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},KT=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),b_=/(^\s|\s$|\n)/;function wn(e,t){return"<"+e+(t.match(b_)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Tf(e){return bn(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Ke(e,t,r){return"<"+e+(r!=null?Tf(r):"")+(t!=null?(t.match(b_)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Lg(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function YT(e,t){switch(typeof e){case"string":var r=Ke("vt:lpwstr",Jt(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ke((e|0)==e?"vt:i4":"vt:r8",Jt(String(e)));case"boolean":return Ke("vt:bool",e?"true":"false")}if(e instanceof Date)return Ke("vt:filetime",Lg(e));throw new Error("Unable to serialize "+e)}var sn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Ou=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],_i={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function XT(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,a=5;a>=0;--a)i=i*256+e[t+a];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function JT(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,a=0,s=n?-t:t;isFinite(s)?s==0?i=a=0:(i=Math.floor(Math.log(s)/Math.LN2),a=s*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=a&255;e[r+6]=(i&15)<<4|a&15,e[r+7]=i>>4|n}var D5=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,a=e[0][n].length;i<a;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},j5=qt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ys(t)})):D5(e)}:D5,M5=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(Nc(e,i)));return n.join("").replace(Uc,"")},K2=qt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Uc,""):M5(e,t,r)}:M5,B5=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},E_=qt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):B5(e,t,r)}:B5,U5=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(Vl(e,i)));return n.join("")},Bf=qt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):U5(t,r,n)}:U5,A_=function(e,t){var r=Si(e,t);return r>0?Bf(e,t+4,t+4+r-1):""},T_=A_,k_=function(e,t){var r=Si(e,t);return r>0?Bf(e,t+4,t+4+r-1):""},N_=k_,C_=function(e,t){var r=2*Si(e,t);return r>0?Bf(e,t+4,t+4+r-1):""},L_=C_,P_=function(t,r){var n=Si(t,r);return n>0?K2(t,r+4,r+4+n):""},O_=P_,F_=function(e,t){var r=Si(e,t);return r>0?Bf(e,t+4,t+4+r):""},R_=F_,I_=function(e,t){return XT(e,t)},id=I_,Y2=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};qt&&(T_=function(t,r){if(!Buffer.isBuffer(t))return A_(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},N_=function(t,r){if(!Buffer.isBuffer(t))return k_(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},L_=function(t,r){if(!Buffer.isBuffer(t))return C_(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},O_=function(t,r){if(!Buffer.isBuffer(t))return P_(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},R_=function(t,r){if(!Buffer.isBuffer(t))return F_(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},id=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):I_(t,r)},Y2=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Vl=function(e,t){return e[t]},Nc=function(e,t){return e[t+1]*256+e[t]},QT=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Si=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ro=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},ZT=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Hc(e,t){var r="",n,i,a=[],s,o,l,u;switch(t){case"dbcs":if(u=this.l,qt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(Nc(this,u)),u+=2;e*=2;break;case"utf8":r=Bf(this,this.l,this.l+e);break;case"utf16le":e*=2,r=K2(this,this.l,this.l+e);break;case"wstr":return Hc.call(this,e,"dbcs");case"lpstr-ansi":r=T_(this,this.l),e=4+Si(this,this.l);break;case"lpstr-cp":r=N_(this,this.l),e=4+Si(this,this.l);break;case"lpwstr":r=L_(this,this.l),e=4+2*Si(this,this.l);break;case"lpp4":e=4+Si(this,this.l),r=O_(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Si(this,this.l),r=R_(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=Vl(this,this.l+e++))!==0;)a.push(t0(s));r=a.join("");break;case"_wstr":for(e=0,r="";(s=Nc(this,this.l+e))!==0;)a.push(t0(s)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return s=Vl(this,u),this.l=u+1,o=Hc.call(this,e-l,s?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(t0(Nc(this,u))),u+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return s=Vl(this,u),this.l=u+1,o=Hc.call(this,e-l,s?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(t0(Vl(this,u))),u+=1}r=a.join("");break;default:switch(e){case 1:return n=Vl(this,this.l),this.l++,n;case 2:return n=(t==="i"?QT:Nc)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Ro:ZT)(this,this.l),this.l+=4,n):(i=Si(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=id(this,this.l):i=id([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=E_(this,this.l,e);break}}return this.l+=e,r}var e8=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},t8=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},r8=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function n8(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)r8(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var s=t.charCodeAt(i);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,e8(this,t,this.l);break;case 8:if(n=8,r==="f"){JT(this,t,this.l);break}case 16:break;case-4:n=4,t8(this,t,this.l);break}return this.l+=n,this}function D_(e,t){var r=E_(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function xi(e,t){e.l=t,e.read_shift=Hc,e.chk=D_,e.write_shift=n8}function za(e,t){e.l+=t}function Pe(e){var t=Qo(e);return xi(t,0),t}function si(){var e=[],t=qt?256:2048,r=function(u){var f=Pe(u);return xi(f,0),f},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(u){return n&&u<n.length-n.l?n:(i(),n=r(Math.max(u+1,t)))},s=function(){return i(),yn(e)},o=function(u){i(),n=u,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:o,end:s,_bufs:e}}function Me(e,t,r,n){var i=+t,a;if(!isNaN(i)){n||(n=XP[i].p||(r||[]).length||0),a=1+(i>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var s=e.next(a);i<=127?s.write_shift(1,i):(s.write_shift(1,(i&127)+128),s.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&Y2(r)&&e.push(r)}}function Wc(e,t,r){var n=li(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function z5(e,t,r){var n=li(e);return n.s=Wc(n.s,t.s,r),n.e=Wc(n.e,t.s,r),n}function qc(e,t){if(e.cRel&&e.c<0)for(e=li(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=li(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=er(e);return!e.cRel&&e.cRel!=null&&(r=s8(r)),!e.rRel&&e.rRel!=null&&(r=i8(r)),r}function cp(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+In(e.s.c)+":"+(e.e.cRel?"":"$")+In(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+_n(e.s.r)+":"+(e.e.rRel?"":"$")+_n(e.e.r):qc(e.s,t.biff)+":"+qc(e.e,t.biff)}function X2(e){return parseInt(a8(e),10)-1}function _n(e){return""+(e+1)}function i8(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function a8(e){return e.replace(/\$(\d+)$/,"$1")}function J2(e){for(var t=o8(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function In(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function s8(e){return e.replace(/^([A-Z])/,"$$$1")}function o8(e){return e.replace(/^\$([A-Z])/,"$1")}function l8(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function on(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function er(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Ni(e){var t=e.indexOf(":");return t==-1?{s:on(e),e:on(e)}:{s:on(e.slice(0,t)),e:on(e.slice(t+1))}}function $r(e,t){return typeof t>"u"||typeof t=="number"?$r(e.s,e.e):(typeof e!="string"&&(e=er(e)),typeof t!="string"&&(t=er(t)),e==t?e:e+":"+t)}function mr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,a=e.length;for(r=0;n<a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===a||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function H5(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=so(e.z,r?oi(t):t)}catch{}try{return e.w=so((e.XF||{}).numFmtId||(r?14:0),r?oi(t):t)}catch{return""+t}}function gs(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Uf[e.v]||e.v:t==null?H5(e,e.v):H5(e,t))}function nl(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function j_(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,a=e||(i?[]:{}),s=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?on(n.origin):n.origin;s=l.r,o=l.c}a["!ref"]||(a["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var f=mr(a["!ref"]);u.s.c=f.s.c,u.s.r=f.s.r,u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),s==-1&&(u.e.r=s=f.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=t[d].length;++p)if(!(typeof t[d][p]>"u")){var h={v:t[d][p]},v=s+d,m=o+p;if(u.s.r>v&&(u.s.r=v),u.s.c>m&&(u.s.c=m),u.e.r<v&&(u.e.r=v),u.e.c<m&&(u.e.c=m),t[d][p]&&typeof t[d][p]=="object"&&!Array.isArray(t[d][p])&&!(t[d][p]instanceof Date))h=t[d][p];else if(Array.isArray(h.v)&&(h.f=t[d][p][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||Cr[14],n.cellDates?(h.t="d",h.w=so(h.z,oi(h.v))):(h.t="n",h.v=oi(h.v),h.w=so(h.z,h.v))):h.t="s";if(i)a[v]||(a[v]=[]),a[v][m]&&a[v][m].z&&(h.z=a[v][m].z),a[v][m]=h;else{var S=er({c:m,r:v});a[S]&&a[S].z&&(h.z=a[S].z),a[S]=h}}}return u.s.c<1e7&&(a["!ref"]=$r(u)),a}function Fu(e,t){return j_(null,e,t)}function u8(e){return e.read_shift(4,"i")}function xa(e,t){return t||(t=Pe(4)),t.write_shift(4,e),t}function Dn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function ln(e,t){var r=!1;return t==null&&(r=!0,t=Pe(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function c8(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function f8(e,t){return t||(t=Pe(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Q2(e,t){var r=e.l,n=e.read_shift(1),i=Dn(e),a=[],s={t:i,h:i};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)a.push(c8(e));s.r=a}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}function h8(e,t){var r=!1;return t==null&&(r=!0,t=Pe(15+4*e.t.length)),t.write_shift(1,0),ln(e.t,t),r?t.slice(0,t.l):t}var d8=Q2;function p8(e,t){var r=!1;return t==null&&(r=!0,t=Pe(23+4*e.t.length)),t.write_shift(1,1),ln(e.t,t),t.write_shift(4,1),f8({},t),r?t.slice(0,t.l):t}function Yi(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function il(e,t){return t==null&&(t=Pe(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function al(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function sl(e,t){return t==null&&(t=Pe(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var g8=Dn,M_=ln;function Z2(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function ad(e,t){var r=!1;return t==null&&(r=!0,t=Pe(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var m8=Dn,Pg=Z2,em=ad;function B_(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?id([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ro(t,0)>>2;return r?i/100:i}function U_(e,t){t==null&&(t=Pe(4));var r=0,n=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function z_(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function v8(e,t){return t||(t=Pe(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var ol=z_,Ru=v8;function Iu(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Zo(e,t){return(t||Pe(8)).write_shift(8,e,"f")}function y8(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),a=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var u=k8[i];u&&(t.rgb=Z5(u));break;case 2:t.rgb=Z5([s,o,l]);break;case 3:t.theme=i;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function sd(e,t){if(t||(t=Pe(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function w8(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function x8(e,t){t||(t=Pe(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var H_=2,yi=3,a0=11,od=19,s0=64,_8=65,S8=71,b8=4108,E8=4126,vn=80,W5={1:{n:"CodePage",t:H_},2:{n:"Category",t:vn},3:{n:"PresentationFormat",t:vn},4:{n:"ByteCount",t:yi},5:{n:"LineCount",t:yi},6:{n:"ParagraphCount",t:yi},7:{n:"SlideCount",t:yi},8:{n:"NoteCount",t:yi},9:{n:"HiddenCount",t:yi},10:{n:"MultimediaClipCount",t:yi},11:{n:"ScaleCrop",t:a0},12:{n:"HeadingPairs",t:b8},13:{n:"TitlesOfParts",t:E8},14:{n:"Manager",t:vn},15:{n:"Company",t:vn},16:{n:"LinksUpToDate",t:a0},17:{n:"CharacterCount",t:yi},19:{n:"SharedDoc",t:a0},22:{n:"HyperlinksChanged",t:a0},23:{n:"AppVersion",t:yi,p:"version"},24:{n:"DigSig",t:_8},26:{n:"ContentType",t:vn},27:{n:"ContentStatus",t:vn},28:{n:"Language",t:vn},29:{n:"Version",t:vn},255:{},2147483648:{n:"Locale",t:od},2147483651:{n:"Behavior",t:od},1919054434:{}},q5={1:{n:"CodePage",t:H_},2:{n:"Title",t:vn},3:{n:"Subject",t:vn},4:{n:"Author",t:vn},5:{n:"Keywords",t:vn},6:{n:"Comments",t:vn},7:{n:"Template",t:vn},8:{n:"LastAuthor",t:vn},9:{n:"RevNumber",t:vn},10:{n:"EditTime",t:s0},11:{n:"LastPrinted",t:s0},12:{n:"CreatedDate",t:s0},13:{n:"ModifiedDate",t:s0},14:{n:"PageCount",t:yi},15:{n:"WordCount",t:yi},16:{n:"CharCount",t:yi},17:{n:"Thumbnail",t:S8},18:{n:"Application",t:vn},19:{n:"DocSecurity",t:yi},255:{},2147483648:{n:"Locale",t:od},2147483651:{n:"Behavior",t:od},1919054434:{}};function A8(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var T8=A8([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),k8=li(T8),Uf={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},N8={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},o0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function W_(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function q_(e,t){var r=MT(N8),n=[],i;n[n.length]=Vr,n[n.length]=Ke("Types",null,{xmlns:sn.CT,"xmlns:xsd":sn.xsd,"xmlns:xsi":sn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Ke("Default",null,{Extension:l[0],ContentType:l[1]})}));var a=function(l){e[l]&&e[l].length>0&&(i=e[l][0],n[n.length]=Ke("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:o0[l][t.bookType]||o0[l].xlsx}))},s=function(l){(e[l]||[]).forEach(function(u){n[n.length]=Ke("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:o0[l][t.bookType]||o0[l].xlsx})})},o=function(l){(e[l]||[]).forEach(function(u){n[n.length]=Ke("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[l][0]})})};return a("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),s("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Ht={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function $_(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function vu(e){var t=[Vr,Ke("Relationships",null,{xmlns:sn.RELS})];return bn(e["!id"]).forEach(function(r){t[t.length]=Ke("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Xt(e,t,r,n,i,a){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,[Ht.HLINK,Ht.XPATH,Ht.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}function C8(e){var t=[Vr];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function $5(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function L8(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function P8(e){var t=[Vr];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push($5(e[r][0],e[r][1])),t.push(L8("",e[r][0]));return t.push($5("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function V_(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Q0.version+"</meta:generator></office:meta></office:document-meta>"}var Ho=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function fp(e,t,r,n,i){i[e]!=null||t==null||t===""||(i[e]=t,t=Jt(t),n[n.length]=r?Ke(e,t,r):wn(e,t))}function G_(e,t){var r=t||{},n=[Vr,Ke("cp:coreProperties",null,{"xmlns:cp":sn.CORE_PROPS,"xmlns:dc":sn.dc,"xmlns:dcterms":sn.dcterms,"xmlns:dcmitype":sn.dcmitype,"xmlns:xsi":sn.xsi})],i={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&fp("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Lg(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),e.ModifiedDate!=null&&fp("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Lg(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var a=0;a!=Ho.length;++a){var s=Ho[a],o=r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:e?e[s[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&fp(s[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var yu=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],K_=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function Y_(e){var t=[],r=Ke;return e||(e={}),e.Application="SheetJS",t[t.length]=Vr,t[t.length]=Ke("Properties",null,{xmlns:sn.EXT_PROPS,"xmlns:vt":sn.vt}),yu.forEach(function(n){if(e[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Jt(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(n[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Jt(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function X_(e){var t=[Vr,Ke("Properties",null,{xmlns:sn.CUST_PROPS,"xmlns:vt":sn.vt})];if(!e)return t.join("");var r=1;return bn(e).forEach(function(i){++r,t[t.length]=Ke("property",YT(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Jt(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var V5={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function O8(e,t){var r=[];return bn(V5).map(function(n){for(var i=0;i<Ho.length;++i)if(Ho[i][1]==n)return Ho[i];for(i=0;i<yu.length;++i)if(yu[i][1]==n)return yu[i];throw n}).forEach(function(n){if(e[n[1]]!=null){var i=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(wn(V5[n[1]]||n[1],i))}}),Ke("DocumentProperties",r.join(""),{xmlns:_i.o})}function F8(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&bn(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var s=0;s<Ho.length;++s)if(a==Ho[s][1])return;for(s=0;s<yu.length;++s)if(a==yu[s][1])return;for(s=0;s<r.length;++s)if(a==r[s])return;var o=e[a],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(Ke(F5(a),o,{"dt:dt":l}))}}),t&&bn(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var s=t[a],o="string";typeof s=="number"?(o="float",s=String(s)):s===!0||s===!1?(o="boolean",s=s?"1":"0"):s instanceof Date?(o="dateTime.tz",s=s.toISOString()):s=String(s),i.push(Ke(F5(a),s,{"dt:dt":o}))}}),"<"+n+' xmlns="'+_i.o+'">'+i.join("")+"</"+n+">"}function R8(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),i+=a);var s=Pe(8);return s.write_shift(4,n),s.write_shift(4,i),s}function G5(e,t){var r=Pe(4),n=Pe(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=Pe(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=R8(t);break;case 31:case 80:for(n=Pe(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return yn([r,n])}var J_=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function I8(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function K5(e,t,r){var n=Pe(8),i=[],a=[],s=8,o=0,l=Pe(8),u=Pe(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),a.push(l),i.push(u),s+=8+l.length,!t){u=Pe(8),u.write_shift(4,0),i.unshift(u);var f=[Pe(4)];for(f[0].write_shift(4,e.length),o=0;o<e.length;++o){var d=e[o][0];for(l=Pe(8+2*(d.length+1)+(d.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,d.length+1),l.write_shift(0,d,"dbcs");l.l!=l.length;)l.write_shift(1,0);f.push(l)}l=yn(f),a.unshift(l),s+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(J_.indexOf(e[o][0])>-1||K_.indexOf(e[o][0])>-1)&&e[o][1]!=null){var p=e[o][1],h=0;if(t){h=+t[e[o][0]];var v=r[h];if(v.p=="version"&&typeof p=="string"){var m=p.split(".");p=(+m[0]<<16)+(+m[1]||0)}l=G5(v.t,p)}else{var S=I8(p);S==-1&&(S=31,p=String(p)),l=G5(S,p)}a.push(l),u=Pe(8),u.write_shift(4,t?h:2+o),i.push(u),s+=8+l.length}var y=8*(a.length+1);for(o=0;o<a.length;++o)i[o].write_shift(4,y),y+=a[o].length;return n.write_shift(4,s),n.write_shift(4,a.length),yn([n].concat(i).concat(a))}function Y5(e,t,r,n,i,a){var s=Pe(i?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,nr.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,i?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,i?68:48);var l=K5(e,r,n);if(o.push(l),i){var u=K5(i,null,null);s.write_shift(16,a,"hex"),s.write_shift(4,68+l.length),o.push(u)}return yn(o)}function D8(e,t){t||(t=Pe(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function j8(e,t){return e.read_shift(t)===1}function Wn(e,t){return t||(t=Pe(2)),t.write_shift(2,+!!e),t}function Q_(e){return e.read_shift(2,"u")}function Hi(e,t){return t||(t=Pe(2)),t.write_shift(2,e),t}function Z_(e,t,r){return r||(r=Pe(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function e4(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var s=n?e.read_shift(n,i):"";return s}function M8(e){var t=e.t||"",r=Pe(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Pe(2*t.length);n.write_shift(2*t.length,t,"utf16le");var i=[r,n];return yn(i)}function B8(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function U8(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):B8(e,n,r)}function z8(e,t,r){if(r.biff>5)return U8(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function t4(e,t,r){return r||(r=Pe(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function X5(e,t){t||(t=Pe(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function H8(e){var t=Pe(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),a=i>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var s=[8,6815827,6619237,4849780,83];for(r=0;r<s.length;++r)t.write_shift(4,s[r]);if(a==28)n=n.slice(1),X5(n,t);else if(a&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));var o=i>-1?n.slice(0,i):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),a&8&&X5(i>-1?n.slice(i+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function el(e,t,r,n){return n||(n=Pe(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function W8(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),a=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[i,a,s]}function q8(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function r4(e,t){return t||(t=Pe(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function tm(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=Pe(i);return a.write_shift(2,n),a.write_shift(2,t),i>4&&a.write_shift(2,29282),i>6&&a.write_shift(2,1997),i>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function $8(e,t){var r=!t||t.biff==8,n=Pe(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function V8(e,t){var r=!t||t.biff>=8?2:1,n=Pe(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function G8(e,t){var r=Pe(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=M8(e[i]);var a=yn([r].concat(n));return a.parts=[r.length].concat(n.map(function(s){return s.length})),a}function K8(){var e=Pe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Y8(e){var t=Pe(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function X8(e,t){var r=e.name||"Arial",n=t&&t.biff==5,i=n?15+r.length:16+2*r.length,a=Pe(i);return a.write_shift(2,e.sz*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function J8(e,t,r,n){var i=Pe(10);return el(e,t,n,i),i.write_shift(4,r),i}function Q8(e,t,r,n,i){var a=!i||i.biff==8,s=Pe(8+ +a+(1+a)*r.length);return el(e,t,n,s),s.write_shift(2,r.length),a&&s.write_shift(1,1),s.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),s}function Z8(e,t,r,n){var i=r&&r.biff==5;n||(n=Pe(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}function ek(e,t){var r=t.biff==8||!t.biff?4:2,n=Pe(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function J5(e,t,r,n){var i=r&&r.biff==5;n||(n=Pe(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&i&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function tk(e){var t=Pe(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function rk(e,t,r,n,i,a){var s=Pe(8);return el(e,t,n,s),Z_(r,a,s),s}function nk(e,t,r,n){var i=Pe(14);return el(e,t,n,i),Zo(r,i),i}function ik(e,t,r){if(r.biff<8)return ak(e,t,r);for(var n=[],i=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(W8(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function ak(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=e4(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function sk(e){var t=Pe(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)r4(e[r],t);return t}function ok(e){var t=Pe(24),r=on(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return yn([t,H8(e[1])])}function lk(e){var t=e[1].Tooltip,r=Pe(10+2*(t.length+1));r.write_shift(2,2048);var n=on(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function uk(e){return e||(e=Pe(4)),e.write_shift(2,1),e.write_shift(2,1),e}function ck(e,t,r){if(!r.cellStyles)return za(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),a=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var u={s:i,e:a,w:s,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function fk(e,t){var r=Pe(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function hk(e){for(var t=Pe(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function dk(e,t,r){var n=Pe(15);return Hf(n,e,t),n.write_shift(8,r,"f"),n}function pk(e,t,r){var n=Pe(9);return Hf(n,e,t),n.write_shift(2,r),n}var gk=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=q2({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var u=[],f=Qo(1);switch(l.type){case"base64":f=ma(ps(o));break;case"binary":f=ma(o);break;case"buffer":case"array":f=o;break}xi(f,0);var d=f.read_shift(1),p=!!(d&136),h=!1,v=!1;switch(d){case 2:break;case 3:break;case 48:h=!0,p=!0;break;case 49:h=!0,p=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var m=0,S=521;d==2&&(m=f.read_shift(2)),f.l+=3,d!=2&&(m=f.read_shift(4)),m>1048576&&(m=1e6),d!=2&&(S=f.read_shift(2));var y=f.read_shift(2),w=l.codepage||1252;d!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(w=e[f[f.l]]),f.l+=1,f.l+=2),v&&(f.l+=36);for(var x=[],A={},R=Math.min(f.length,d==2?521:S-10-(h?264:0)),B=v?32:11;f.l<R&&f[f.l]!=13;)switch(A={},A.name=Z0.utils.decode(w,f.slice(f.l,f.l+B)).replace(/[\u0000\r\n].*$/g,""),f.l+=B,A.type=String.fromCharCode(f.read_shift(1)),d!=2&&!v&&(A.offset=f.read_shift(4)),A.len=f.read_shift(1),d==2&&(A.offset=f.read_shift(2)),A.dec=f.read_shift(1),A.name.length&&x.push(A),d!=2&&(f.l+=v?13:14),A.type){case"B":(!h||A.len!=8)&&l.WTF&&console.log("Skipping "+A.name+":"+A.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+A.name+":"+A.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+A.type)}if(f[f.l]!==13&&(f.l=S-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=S;var T=0,L=0;for(u[0]=[],L=0;L!=x.length;++L)u[0][L]=x[L].name;for(;m-- >0;){if(f[f.l]===42){f.l+=y;continue}for(++f.l,u[++T]=[],L=0,L=0;L!=x.length;++L){var P=f.slice(f.l,f.l+x[L].len);f.l+=x[L].len,xi(P,0);var M=Z0.utils.decode(w,P);switch(x[L].type){case"C":M.trim().length&&(u[T][L]=M.replace(/\s+$/,""));break;case"D":M.length===8?u[T][L]=new Date(+M.slice(0,4),+M.slice(4,6)-1,+M.slice(6,8)):u[T][L]=M;break;case"F":u[T][L]=parseFloat(M.trim());break;case"+":case"I":u[T][L]=v?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(M.trim().toUpperCase()){case"Y":case"T":u[T][L]=!0;break;case"N":case"F":u[T][L]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+M+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));u[T][L]="##MEMO##"+(v?parseInt(M.trim(),10):P.read_shift(4));break;case"N":M=M.replace(/\u0000/g,"").trim(),M&&M!="."&&(u[T][L]=+M||0);break;case"@":u[T][L]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":u[T][L]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":u[T][L]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[T][L]=-P.read_shift(-8,"f");break;case"B":if(h&&x[L].len==8){u[T][L]=P.read_shift(8,"f");break}case"G":case"P":P.l+=x[L].len;break;case"0":if(x[L].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+x[L].type)}}}if(d!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=x,u}function n(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var f=Fu(r(o,u),u);return f["!cols"]=u.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete u.DBF,f}function i(o,l){try{return nl(n(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,l){var u=l||{};if(+u.codepage>=0&&Sf(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=si(),d=hd(o,{header:1,raw:!0,cellDates:!0}),p=d[0],h=d.slice(1),v=o["!cols"]||[],m=0,S=0,y=0,w=1;for(m=0;m<p.length;++m){if(((v[m]||{}).DBF||{}).name){p[m]=v[m].DBF.name,++y;continue}if(p[m]!=null){if(++y,typeof p[m]=="number"&&(p[m]=p[m].toString(10)),typeof p[m]!="string")throw new Error("DBF Invalid column name "+p[m]+" |"+typeof p[m]+"|");if(p.indexOf(p[m])!==m){for(S=0;S<1024;++S)if(p.indexOf(p[m]+"_"+S)==-1){p[m]+="_"+S;break}}}}var x=mr(o["!ref"]),A=[],R=[],B=[];for(m=0;m<=x.e.c-x.s.c;++m){var T="",L="",P=0,M=[];for(S=0;S<h.length;++S)h[S][m]!=null&&M.push(h[S][m]);if(M.length==0||p[m]==null){A[m]="?";continue}for(S=0;S<M.length;++S){switch(typeof M[S]){case"number":L="B";break;case"string":L="C";break;case"boolean":L="L";break;case"object":L=M[S]instanceof Date?"D":"C";break;default:L="C"}P=Math.max(P,String(M[S]).length),T=T&&T!=L?"C":L}P>250&&(P=250),L=((v[m]||{}).DBF||{}).type,L=="C"&&v[m].DBF.len>P&&(P=v[m].DBF.len),T=="B"&&L=="N"&&(T="N",B[m]=v[m].DBF.dec,P=v[m].DBF.len),R[m]=T=="C"||L=="N"?P:a[T]||0,w+=R[m],A[m]=T}var N=f.next(32);for(N.write_shift(4,318902576),N.write_shift(4,h.length),N.write_shift(2,296+32*y),N.write_shift(2,w),m=0;m<4;++m)N.write_shift(4,0);for(N.write_shift(4,0|(+t[i_]||3)<<8),m=0,S=0;m<p.length;++m)if(p[m]!=null){var C=f.next(32),U=(p[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);C.write_shift(1,U,"sbcs"),C.write_shift(1,A[m]=="?"?"C":A[m],"sbcs"),C.write_shift(4,S),C.write_shift(1,R[m]||a[A[m]]||0),C.write_shift(1,B[m]||0),C.write_shift(1,2),C.write_shift(4,0),C.write_shift(1,0),C.write_shift(4,0),C.write_shift(4,0),S+=R[m]||a[A[m]]||0}var Y=f.next(264);for(Y.write_shift(4,13),m=0;m<65;++m)Y.write_shift(4,0);for(m=0;m<h.length;++m){var ce=f.next(w);for(ce.write_shift(1,0),S=0;S<p.length;++S)if(p[S]!=null)switch(A[S]){case"L":ce.write_shift(1,h[m][S]==null?63:h[m][S]?84:70);break;case"B":ce.write_shift(8,h[m][S]||0,"f");break;case"N":var ee="0";for(typeof h[m][S]=="number"&&(ee=h[m][S].toFixed(B[S]||0)),y=0;y<R[S]-ee.length;++y)ce.write_shift(1,32);ce.write_shift(1,ee,"sbcs");break;case"D":h[m][S]?(ce.write_shift(4,("0000"+h[m][S].getFullYear()).slice(-4),"sbcs"),ce.write_shift(2,("00"+(h[m][S].getMonth()+1)).slice(-2),"sbcs"),ce.write_shift(2,("00"+h[m][S].getDate()).slice(-2),"sbcs")):ce.write_shift(8,"00000000","sbcs");break;case"C":var Q=String(h[m][S]!=null?h[m][S]:"").slice(0,R[S]);for(ce.write_shift(1,Q,"sbcs"),y=0;y<R[S]-Q.length;++y)ce.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:i,to_sheet:n,from_sheet:s}}(),mk=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+bn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,h){var v=e[h];return typeof v=="number"?_5(v):v},n=function(p,h,v){var m=h.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return m==59?p:_5(m)};e["|"]=254;function i(p,h){switch(h.type){case"base64":return a(ps(p),h);case"binary":return a(p,h);case"buffer":return a(qt&&Buffer.isBuffer(p)?p.toString("binary"):jf(p),h);case"array":return a(Md(p),h)}throw new Error("Unrecognized type "+h.type)}function a(p,h){var v=p.split(/[\n\r]+/),m=-1,S=-1,y=0,w=0,x=[],A=[],R=null,B={},T=[],L=[],P=[],M=0,N;for(+h.codepage>=0&&Sf(+h.codepage);y!==v.length;++y){M=0;var C=v[y].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),U=C.replace(/;;/g,"\0").split(";").map(function(I){return I.replace(/\u0000/g,";")}),Y=U[0],ce;if(C.length>0)switch(Y){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":U[1].charAt(0)=="P"&&A.push(C.slice(3).replace(/;;/g,";"));break;case"C":var ee=!1,Q=!1,X=!1,z=!1,ae=-1,me=-1;for(w=1;w<U.length;++w)switch(U[w].charAt(0)){case"A":break;case"X":S=parseInt(U[w].slice(1))-1,Q=!0;break;case"Y":for(m=parseInt(U[w].slice(1))-1,Q||(S=0),N=x.length;N<=m;++N)x[N]=[];break;case"K":ce=U[w].slice(1),ce.charAt(0)==='"'?ce=ce.slice(1,ce.length-1):ce==="TRUE"?ce=!0:ce==="FALSE"?ce=!1:isNaN(ls(ce))?isNaN(Ef(ce).getDate())||(ce=$n(ce)):(ce=ls(ce),R!==null&&m_(R)&&(ce=x_(ce))),ee=!0;break;case"E":z=!0;var E=pN(U[w].slice(1),{r:m,c:S});x[m][S]=[x[m][S],E];break;case"S":X=!0,x[m][S]=[x[m][S],"S5S"];break;case"G":break;case"R":ae=parseInt(U[w].slice(1))-1;break;case"C":me=parseInt(U[w].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+C)}if(ee&&(x[m][S]&&x[m][S].length==2?x[m][S][0]=ce:x[m][S]=ce,R=null),X){if(z)throw new Error("SYLK shared formula cannot have own formula");var O=ae>-1&&x[ae][me];if(!O||!O[1])throw new Error("SYLK shared formula cannot find base");x[m][S][1]=gN(O[1],{r:m-ae,c:S-me})}break;case"F":var F=0;for(w=1;w<U.length;++w)switch(U[w].charAt(0)){case"X":S=parseInt(U[w].slice(1))-1,++F;break;case"Y":for(m=parseInt(U[w].slice(1))-1,N=x.length;N<=m;++N)x[N]=[];break;case"M":M=parseInt(U[w].slice(1))/20;break;case"F":break;case"G":break;case"P":R=A[parseInt(U[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=U[w].slice(1).split(" "),N=parseInt(P[0],10);N<=parseInt(P[1],10);++N)M=parseInt(P[2],10),L[N-1]=M===0?{hidden:!0}:{wch:M},rm(L[N-1]);break;case"C":S=parseInt(U[w].slice(1))-1,L[S]||(L[S]={});break;case"R":m=parseInt(U[w].slice(1))-1,T[m]||(T[m]={}),M>0?(T[m].hpt=M,T[m].hpx=o4(M)):M===0&&(T[m].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+C)}F<1&&(R=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+C)}}return T.length>0&&(B["!rows"]=T),L.length>0&&(B["!cols"]=L),h&&h.sheetRows&&(x=x.slice(0,h.sheetRows)),[x,B]}function s(p,h){var v=i(p,h),m=v[0],S=v[1],y=Fu(m,h);return bn(S).forEach(function(w){y[w]=S[w]}),y}function o(p,h){return nl(s(p,h),h)}function l(p,h,v,m){var S="C;Y"+(v+1)+";X"+(m+1)+";K";switch(p.t){case"n":S+=p.v||0,p.f&&!p.F&&(S+=";E"+im(p.f,{r:v,c:m}));break;case"b":S+=p.v?"TRUE":"FALSE";break;case"e":S+=p.w||p.v;break;case"d":S+='"'+(p.w||p.v)+'"';break;case"s":S+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return S}function u(p,h){h.forEach(function(v,m){var S="F;W"+(m+1)+" "+(m+1)+" ";v.hidden?S+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=ld(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=ud(v.wpx)),typeof v.wch=="number"&&(S+=Math.round(v.wch))),S.charAt(S.length-1)!=" "&&p.push(S)})}function f(p,h){h.forEach(function(v,m){var S="F;";v.hidden?S+="M0;":v.hpt?S+="M"+20*v.hpt+";":v.hpx&&(S+="M"+20*cd(v.hpx)+";"),S.length>2&&p.push(S+"R"+(m+1))})}function d(p,h){var v=["ID;PWXL;N;E"],m=[],S=mr(p["!ref"]),y,w=Array.isArray(p),x=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),p["!cols"]&&u(v,p["!cols"]),p["!rows"]&&f(v,p["!rows"]),v.push("B;Y"+(S.e.r-S.s.r+1)+";X"+(S.e.c-S.s.c+1)+";D"+[S.s.c,S.s.r,S.e.c,S.e.r].join(" "));for(var A=S.s.r;A<=S.e.r;++A)for(var R=S.s.c;R<=S.e.c;++R){var B=er({r:A,c:R});y=w?(p[A]||[])[R]:p[B],!(!y||y.v==null&&(!y.f||y.F))&&m.push(l(y,p,A,R))}return v.join(x)+x+m.join(x)+x+"E"+x}return{to_workbook:o,to_sheet:s,from_sheet:d}}(),vk=function(){function e(a,s){switch(s.type){case"base64":return t(ps(a),s);case"binary":return t(a,s);case"buffer":return t(qt&&Buffer.isBuffer(a)?a.toString("binary"):jf(a),s);case"array":return t(Md(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){for(var o=a.split(`
`),l=-1,u=-1,f=0,d=[];f!==o.length;++f){if(o[f].trim()==="BOT"){d[++l]=[],u=0;continue}if(!(l<0)){var p=o[f].trim().split(","),h=p[0],v=p[1];++f;for(var m=o[f]||"";(m.match(/["]/g)||[]).length&1&&f<o.length-1;)m+=`
`+o[++f];switch(m=m.trim(),+h){case-1:if(m==="BOT"){d[++l]=[],u=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?d[l][u]=!0:m==="FALSE"?d[l][u]=!1:isNaN(ls(v))?isNaN(Ef(v).getDate())?d[l][u]=v:d[l][u]=$n(v):d[l][u]=ls(v),++u;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),d[l][u++]=m!==""?m:null;break}if(m==="EOD")break}}return s&&s.sheetRows&&(d=d.slice(0,s.sheetRows)),d}function r(a,s){return Fu(e(a,s),s)}function n(a,s){return nl(r(a,s),s)}var i=function(){var a=function(l,u,f,d,p){l.push(u),l.push(f+","+d),l.push('"'+p.replace(/"/g,'""')+'"')},s=function(l,u,f,d){l.push(u+","+f),l.push(u==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(l){var u=[],f=mr(l["!ref"]),d,p=Array.isArray(l);a(u,"TABLE",0,1,"sheetjs"),a(u,"VECTORS",0,f.e.r-f.s.r+1,""),a(u,"TUPLES",0,f.e.c-f.s.c+1,""),a(u,"DATA",0,0,"");for(var h=f.s.r;h<=f.e.r;++h){s(u,-1,0,"BOT");for(var v=f.s.c;v<=f.e.c;++v){var m=er({r:h,c:v});if(d=p?(l[h]||[])[v]:l[m],!d){s(u,1,0,"");continue}switch(d.t){case"n":var S=d.w;!S&&d.v!=null&&(S=d.v),S==null?d.f&&!d.F?s(u,1,0,"="+d.f):s(u,1,0,""):s(u,0,S,"V");break;case"b":s(u,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":s(u,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=so(d.z||Cr[14],oi($n(d.v)))),s(u,0,d.w,"V");break;default:s(u,1,0,"")}}}s(u,-1,0,"EOD");var y=`\r
`,w=u.join(y);return w}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),n4=function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,p){for(var h=d.split(`
`),v=-1,m=-1,S=0,y=[];S!==h.length;++S){var w=h[S].trim().split(":");if(w[0]==="cell"){var x=on(w[1]);if(y.length<=x.r)for(v=y.length;v<=x.r;++v)y[v]||(y[v]=[]);switch(v=x.r,m=x.c,w[2]){case"t":y[v][m]=e(w[3]);break;case"v":y[v][m]=+w[3];break;case"vtf":var A=w[w.length-1];case"vtc":switch(w[3]){case"nl":y[v][m]=!!+w[4];break;default:y[v][m]=+w[4];break}w[2]=="vtf"&&(y[v][m]=[y[v][m],A])}}}return p&&p.sheetRows&&(y=y.slice(0,p.sheetRows)),y}function n(d,p){return Fu(r(d,p),p)}function i(d,p){return nl(n(d,p),p)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(d){if(!d||!d["!ref"])return"";for(var p=[],h=[],v,m="",S=Ni(d["!ref"]),y=Array.isArray(d),w=S.s.r;w<=S.e.r;++w)for(var x=S.s.c;x<=S.e.c;++x)if(m=er({r:w,c:x}),v=y?(d[w]||[])[x]:d[m],!(!v||v.v==null||v.t==="z")){switch(h=["cell",m,"t"],v.t){case"s":case"str":h.push(t(v.v));break;case"n":v.f?(h[2]="vtf",h[3]="n",h[4]=v.v,h[5]=t(v.f)):(h[2]="v",h[3]=v.v);break;case"b":h[2]="vt"+(v.f?"f":"c"),h[3]="nl",h[4]=v.v?"1":"0",h[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var A=oi($n(v.v));h[2]="vtc",h[3]="nd",h[4]=""+A,h[5]=v.w||so(v.z||Cr[14],A);break;case"e":continue}p.push(h.join(":"))}return p.push("sheet:c:"+(S.e.c-S.s.c+1)+":r:"+(S.e.r-S.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function f(d){return[a,s,o,s,u(d),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:f}}(),yk=function(){function e(f,d,p,h,v){v.raw?d[p][h]=f:f===""||(f==="TRUE"?d[p][h]=!0:f==="FALSE"?d[p][h]=!1:isNaN(ls(f))?isNaN(Ef(f).getDate())?d[p][h]=f:d[p][h]=$n(f):d[p][h]=ls(f))}function t(f,d){var p=d||{},h=[];if(!f||f.length===0)return h;for(var v=f.split(/[\r\n]/),m=v.length-1;m>=0&&v[m].length===0;)--m;for(var S=10,y=0,w=0;w<=m;++w)y=v[w].indexOf(" "),y==-1?y=v[w].length:y++,S=Math.max(S,y);for(w=0;w<=m;++w){h[w]=[];var x=0;for(e(v[w].slice(0,S).trim(),h,w,x,p),x=1;x<=(v[w].length-S)/10+1;++x)e(v[w].slice(S+(x-1)*10,S+x*10).trim(),h,w,x,p)}return p.sheetRows&&(h=h.slice(0,p.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(f){for(var d={},p=!1,h=0,v=0;h<f.length;++h)(v=f.charCodeAt(h))==34?p=!p:!p&&v in r&&(d[v]=(d[v]||0)+1);v=[];for(h in d)Object.prototype.hasOwnProperty.call(d,h)&&v.push([d[h],h]);if(!v.length){d=n;for(h in d)Object.prototype.hasOwnProperty.call(d,h)&&v.push([d[h],h])}return v.sort(function(m,S){return m[0]-S[0]||n[m[1]]-n[S[1]]}),r[v.pop()[1]]||44}function a(f,d){var p=d||{},h="",v=p.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(h=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(h=f.charAt(4),f=f.slice(6)):h=i(f.slice(0,1024)):p&&p.FS?h=p.FS:h=i(f.slice(0,1024));var S=0,y=0,w=0,x=0,A=0,R=h.charCodeAt(0),B=!1,T=0,L=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var P=p.dateNF!=null?RT(p.dateNF):null;function M(){var N=f.slice(x,A),C={};if(N.charAt(0)=='"'&&N.charAt(N.length-1)=='"'&&(N=N.slice(1,-1).replace(/""/g,'"')),N.length===0)C.t="z";else if(p.raw)C.t="s",C.v=N;else if(N.trim().length===0)C.t="s",C.v=N;else if(N.charCodeAt(0)==61)N.charCodeAt(1)==34&&N.charCodeAt(N.length-1)==34?(C.t="s",C.v=N.slice(2,-1).replace(/""/g,'"')):mN(N)?(C.t="n",C.f=N.slice(1)):(C.t="s",C.v=N);else if(N=="TRUE")C.t="b",C.v=!0;else if(N=="FALSE")C.t="b",C.v=!1;else if(!isNaN(w=ls(N)))C.t="n",p.cellText!==!1&&(C.w=N),C.v=w;else if(!isNaN(Ef(N).getDate())||P&&N.match(P)){C.z=p.dateNF||Cr[14];var U=0;P&&N.match(P)&&(N=IT(N,p.dateNF,N.match(P)||[]),U=1),p.cellDates?(C.t="d",C.v=$n(N,U)):(C.t="n",C.v=oi($n(N,U))),p.cellText!==!1&&(C.w=so(C.z,C.v instanceof Date?oi(C.v):C.v)),p.cellNF||delete C.z}else C.t="s",C.v=N;if(C.t=="z"||(p.dense?(v[S]||(v[S]=[]),v[S][y]=C):v[er({c:y,r:S})]=C),x=A+1,L=f.charCodeAt(x),m.e.c<y&&(m.e.c=y),m.e.r<S&&(m.e.r=S),T==R)++y;else if(y=0,++S,p.sheetRows&&p.sheetRows<=S)return!0}e:for(;A<f.length;++A)switch(T=f.charCodeAt(A)){case 34:L===34&&(B=!B);break;case R:case 10:case 13:if(!B&&M())break e;break}return A-x>0&&M(),v["!ref"]=$r(m),v}function s(f,d){return!(d&&d.PRN)||d.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?a(f,d):Fu(t(f,d),d)}function o(f,d){var p="",h=d.type=="string"?[0,0,0,0]:L7(f,d);switch(d.type){case"base64":p=ps(f);break;case"binary":p=f;break;case"buffer":d.codepage==65001?p=f.toString("utf8"):d.codepage&&typeof Z0<"u"||(p=qt&&Buffer.isBuffer(f)?f.toString("binary"):jf(f));break;case"array":p=Md(f);break;case"string":p=f;break;default:throw new Error("Unrecognized type "+d.type)}return h[0]==239&&h[1]==187&&h[2]==191?p=zc(p.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?p=zc(p):d.type=="binary"&&typeof Z0<"u",p.slice(0,19)=="socialcalc:version:"?n4.to_sheet(d.type=="string"?p:zc(p),d):s(p,d)}function l(f,d){return nl(o(f,d),d)}function u(f){for(var d=[],p=mr(f["!ref"]),h,v=Array.isArray(f),m=p.s.r;m<=p.e.r;++m){for(var S=[],y=p.s.c;y<=p.e.c;++y){var w=er({r:m,c:y});if(h=v?(f[m]||[])[y]:f[w],!h||h.v==null){S.push("          ");continue}for(var x=(h.w||(gs(h),h.w)||"").slice(0,10);x.length<10;)x+=" ";S.push(x+(y===0?" ":""))}d.push(S.join(""))}return d.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}}(),Q5=function(){function e(E,O,F){if(E){xi(E,E.l||0);for(var I=F.Enum||ae;E.l<E.length;){var V=E.read_shift(2),ue=I[V]||I[65535],fe=E.read_shift(2),he=E.l+fe,xe=ue.f&&ue.f(E,fe,F);if(E.l=he,O(xe,ue,V))return}}}function t(E,O){switch(O.type){case"base64":return r(ma(ps(E)),O);case"binary":return r(ma(E),O);case"buffer":case"array":return r(E,O)}throw"Unsupported type "+O.type}function r(E,O){if(!E)return E;var F=O||{},I=F.dense?[]:{},V="Sheet1",ue="",fe=0,he={},xe=[],Oe=[],De={s:{r:0,c:0},e:{r:0,c:0}},qe=F.sheetRows||0;if(E[2]==0&&(E[3]==8||E[3]==9)&&E.length>=16&&E[14]==5&&E[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(E[2]==2)F.Enum=ae,e(E,function(je,it,Ue){switch(Ue){case 0:F.vers=je,je>=4096&&(F.qpro=!0);break;case 6:De=je;break;case 204:je&&(ue=je);break;case 222:ue=je;break;case 15:case 51:F.qpro||(je[1].v=je[1].v.slice(1));case 13:case 14:case 16:Ue==14&&(je[2]&112)==112&&(je[2]&15)>1&&(je[2]&15)<15&&(je[1].z=F.dateNF||Cr[14],F.cellDates&&(je[1].t="d",je[1].v=x_(je[1].v))),F.qpro&&je[3]>fe&&(I["!ref"]=$r(De),he[V]=I,xe.push(V),I=F.dense?[]:{},De={s:{r:0,c:0},e:{r:0,c:0}},fe=je[3],V=ue||"Sheet"+(fe+1),ue="");var Ve=F.dense?(I[je[0].r]||[])[je[0].c]:I[er(je[0])];if(Ve){Ve.t=je[1].t,Ve.v=je[1].v,je[1].z!=null&&(Ve.z=je[1].z),je[1].f!=null&&(Ve.f=je[1].f);break}F.dense?(I[je[0].r]||(I[je[0].r]=[]),I[je[0].r][je[0].c]=je[1]):I[er(je[0])]=je[1];break}},F);else if(E[2]==26||E[2]==14)F.Enum=me,E[2]==14&&(F.qpro=!0,E.l=0),e(E,function(je,it,Ue){switch(Ue){case 204:V=je;break;case 22:je[1].v=je[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(je[3]>fe&&(I["!ref"]=$r(De),he[V]=I,xe.push(V),I=F.dense?[]:{},De={s:{r:0,c:0},e:{r:0,c:0}},fe=je[3],V="Sheet"+(fe+1)),qe>0&&je[0].r>=qe)break;F.dense?(I[je[0].r]||(I[je[0].r]=[]),I[je[0].r][je[0].c]=je[1]):I[er(je[0])]=je[1],De.e.c<je[0].c&&(De.e.c=je[0].c),De.e.r<je[0].r&&(De.e.r=je[0].r);break;case 27:je[14e3]&&(Oe[je[14e3][0]]=je[14e3][1]);break;case 1537:Oe[je[0]]=je[1],je[0]==fe&&(V=je[1]);break}},F);else throw new Error("Unrecognized LOTUS BOF "+E[2]);if(I["!ref"]=$r(De),he[ue||V]=I,xe.push(ue||V),!Oe.length)return{SheetNames:xe,Sheets:he};for(var Xe={},ke=[],le=0;le<Oe.length;++le)he[xe[le]]?(ke.push(Oe[le]||xe[le]),Xe[Oe[le]]=he[Oe[le]]||he[xe[le]]):(ke.push(Oe[le]),Xe[Oe[le]]={"!ref":"A1"});return{SheetNames:ke,Sheets:Xe}}function n(E,O){var F=O||{};if(+F.codepage>=0&&Sf(+F.codepage),F.type=="string")throw new Error("Cannot write WK1 to JS string");var I=si(),V=mr(E["!ref"]),ue=Array.isArray(E),fe=[];Ye(I,0,a(1030)),Ye(I,6,l(V));for(var he=Math.min(V.e.r,8191),xe=V.s.r;xe<=he;++xe)for(var Oe=_n(xe),De=V.s.c;De<=V.e.c;++De){xe===V.s.r&&(fe[De]=In(De));var qe=fe[De]+Oe,Xe=ue?(E[xe]||[])[De]:E[qe];if(!(!Xe||Xe.t=="z"))if(Xe.t=="n")(Xe.v|0)==Xe.v&&Xe.v>=-32768&&Xe.v<=32767?Ye(I,13,h(xe,De,Xe.v)):Ye(I,14,m(xe,De,Xe.v));else{var ke=gs(Xe);Ye(I,15,d(xe,De,ke.slice(0,239)))}}return Ye(I,1),I.end()}function i(E,O){var F=O||{};if(+F.codepage>=0&&Sf(+F.codepage),F.type=="string")throw new Error("Cannot write WK3 to JS string");var I=si();Ye(I,0,s(E));for(var V=0,ue=0;V<E.SheetNames.length;++V)(E.Sheets[E.SheetNames[V]]||{})["!ref"]&&Ye(I,27,z(E.SheetNames[V],ue++));var fe=0;for(V=0;V<E.SheetNames.length;++V){var he=E.Sheets[E.SheetNames[V]];if(!(!he||!he["!ref"])){for(var xe=mr(he["!ref"]),Oe=Array.isArray(he),De=[],qe=Math.min(xe.e.r,8191),Xe=xe.s.r;Xe<=qe;++Xe)for(var ke=_n(Xe),le=xe.s.c;le<=xe.e.c;++le){Xe===xe.s.r&&(De[le]=In(le));var je=De[le]+ke,it=Oe?(he[Xe]||[])[le]:he[je];if(!(!it||it.t=="z"))if(it.t=="n")Ye(I,23,M(Xe,le,fe,it.v));else{var Ue=gs(it);Ye(I,22,T(Xe,le,fe,Ue.slice(0,239)))}}++fe}}return Ye(I,1),I.end()}function a(E){var O=Pe(2);return O.write_shift(2,E),O}function s(E){var O=Pe(26);O.write_shift(2,4096),O.write_shift(2,4),O.write_shift(4,0);for(var F=0,I=0,V=0,ue=0;ue<E.SheetNames.length;++ue){var fe=E.SheetNames[ue],he=E.Sheets[fe];if(!(!he||!he["!ref"])){++V;var xe=Ni(he["!ref"]);F<xe.e.r&&(F=xe.e.r),I<xe.e.c&&(I=xe.e.c)}}return F>8191&&(F=8191),O.write_shift(2,F),O.write_shift(1,V),O.write_shift(1,I),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(1,1),O.write_shift(1,2),O.write_shift(4,0),O.write_shift(4,0),O}function o(E,O,F){var I={s:{c:0,r:0},e:{c:0,r:0}};return O==8&&F.qpro?(I.s.c=E.read_shift(1),E.l++,I.s.r=E.read_shift(2),I.e.c=E.read_shift(1),E.l++,I.e.r=E.read_shift(2),I):(I.s.c=E.read_shift(2),I.s.r=E.read_shift(2),O==12&&F.qpro&&(E.l+=2),I.e.c=E.read_shift(2),I.e.r=E.read_shift(2),O==12&&F.qpro&&(E.l+=2),I.s.c==65535&&(I.s.c=I.e.c=I.s.r=I.e.r=0),I)}function l(E){var O=Pe(8);return O.write_shift(2,E.s.c),O.write_shift(2,E.s.r),O.write_shift(2,E.e.c),O.write_shift(2,E.e.r),O}function u(E,O,F){var I=[{c:0,r:0},{t:"n",v:0},0,0];return F.qpro&&F.vers!=20768?(I[0].c=E.read_shift(1),I[3]=E.read_shift(1),I[0].r=E.read_shift(2),E.l+=2):(I[2]=E.read_shift(1),I[0].c=E.read_shift(2),I[0].r=E.read_shift(2)),I}function f(E,O,F){var I=E.l+O,V=u(E,O,F);if(V[1].t="s",F.vers==20768){E.l++;var ue=E.read_shift(1);return V[1].v=E.read_shift(ue,"utf8"),V}return F.qpro&&E.l++,V[1].v=E.read_shift(I-E.l,"cstr"),V}function d(E,O,F){var I=Pe(7+F.length);I.write_shift(1,255),I.write_shift(2,O),I.write_shift(2,E),I.write_shift(1,39);for(var V=0;V<I.length;++V){var ue=F.charCodeAt(V);I.write_shift(1,ue>=128?95:ue)}return I.write_shift(1,0),I}function p(E,O,F){var I=u(E,O,F);return I[1].v=E.read_shift(2,"i"),I}function h(E,O,F){var I=Pe(7);return I.write_shift(1,255),I.write_shift(2,O),I.write_shift(2,E),I.write_shift(2,F,"i"),I}function v(E,O,F){var I=u(E,O,F);return I[1].v=E.read_shift(8,"f"),I}function m(E,O,F){var I=Pe(13);return I.write_shift(1,255),I.write_shift(2,O),I.write_shift(2,E),I.write_shift(8,F,"f"),I}function S(E,O,F){var I=E.l+O,V=u(E,O,F);if(V[1].v=E.read_shift(8,"f"),F.qpro)E.l=I;else{var ue=E.read_shift(2);A(E.slice(E.l,E.l+ue),V),E.l+=ue}return V}function y(E,O,F){var I=O&32768;return O&=-32769,O=(I?E:0)+(O>=8192?O-16384:O),(I?"":"$")+(F?In(O):_n(O))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},x=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function A(E,O){xi(E,0);for(var F=[],I=0,V="",ue="",fe="",he="";E.l<E.length;){var xe=E[E.l++];switch(xe){case 0:F.push(E.read_shift(8,"f"));break;case 1:ue=y(O[0].c,E.read_shift(2),!0),V=y(O[0].r,E.read_shift(2),!1),F.push(ue+V);break;case 2:{var Oe=y(O[0].c,E.read_shift(2),!0),De=y(O[0].r,E.read_shift(2),!1);ue=y(O[0].c,E.read_shift(2),!0),V=y(O[0].r,E.read_shift(2),!1),F.push(Oe+De+":"+ue+V)}break;case 3:if(E.l<E.length){console.error("WK1 premature formula end");return}break;case 4:F.push("("+F.pop()+")");break;case 5:F.push(E.read_shift(2));break;case 6:{for(var qe="";xe=E[E.l++];)qe+=String.fromCharCode(xe);F.push('"'+qe.replace(/"/g,'""')+'"')}break;case 8:F.push("-"+F.pop());break;case 23:F.push("+"+F.pop());break;case 22:F.push("NOT("+F.pop()+")");break;case 20:case 21:he=F.pop(),fe=F.pop(),F.push(["AND","OR"][xe-20]+"("+fe+","+he+")");break;default:if(xe<32&&x[xe])he=F.pop(),fe=F.pop(),F.push(fe+x[xe]+he);else if(w[xe]){if(I=w[xe][1],I==69&&(I=E[E.l++]),I>F.length){console.error("WK1 bad formula parse 0x"+xe.toString(16)+":|"+F.join("|")+"|");return}var Xe=F.slice(-I);F.length-=I,F.push(w[xe][0]+"("+Xe.join(",")+")")}else return xe<=7?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=24?console.error("WK1 unsupported op "+xe.toString(16)):xe<=30?console.error("WK1 invalid opcode "+xe.toString(16)):xe<=115?console.error("WK1 unsupported function opcode "+xe.toString(16)):console.error("WK1 unrecognized opcode "+xe.toString(16))}}F.length==1?O[1].f=""+F[0]:console.error("WK1 bad formula parse |"+F.join("|")+"|")}function R(E){var O=[{c:0,r:0},{t:"n",v:0},0];return O[0].r=E.read_shift(2),O[3]=E[E.l++],O[0].c=E[E.l++],O}function B(E,O){var F=R(E);return F[1].t="s",F[1].v=E.read_shift(O-4,"cstr"),F}function T(E,O,F,I){var V=Pe(6+I.length);V.write_shift(2,E),V.write_shift(1,F),V.write_shift(1,O),V.write_shift(1,39);for(var ue=0;ue<I.length;++ue){var fe=I.charCodeAt(ue);V.write_shift(1,fe>=128?95:fe)}return V.write_shift(1,0),V}function L(E,O){var F=R(E);F[1].v=E.read_shift(2);var I=F[1].v>>1;if(F[1].v&1)switch(I&7){case 0:I=(I>>3)*5e3;break;case 1:I=(I>>3)*500;break;case 2:I=(I>>3)/20;break;case 3:I=(I>>3)/200;break;case 4:I=(I>>3)/2e3;break;case 5:I=(I>>3)/2e4;break;case 6:I=(I>>3)/16;break;case 7:I=(I>>3)/64;break}return F[1].v=I,F}function P(E,O){var F=R(E),I=E.read_shift(4),V=E.read_shift(4),ue=E.read_shift(2);if(ue==65535)return I===0&&V===3221225472?(F[1].t="e",F[1].v=15):I===0&&V===3489660928?(F[1].t="e",F[1].v=42):F[1].v=0,F;var fe=ue&32768;return ue=(ue&32767)-16446,F[1].v=(1-fe*2)*(V*Math.pow(2,ue+32)+I*Math.pow(2,ue)),F}function M(E,O,F,I){var V=Pe(14);if(V.write_shift(2,E),V.write_shift(1,F),V.write_shift(1,O),I==0)return V.write_shift(4,0),V.write_shift(4,0),V.write_shift(2,65535),V;var ue=0,fe=0,he=0,xe=0;return I<0&&(ue=1,I=-I),fe=Math.log2(I)|0,I/=Math.pow(2,fe-31),xe=I>>>0,xe&2147483648||(I/=2,++fe,xe=I>>>0),I-=xe,xe|=2147483648,xe>>>=0,I*=Math.pow(2,32),he=I>>>0,V.write_shift(4,he),V.write_shift(4,xe),fe+=16383+(ue?32768:0),V.write_shift(2,fe),V}function N(E,O){var F=P(E);return E.l+=O-14,F}function C(E,O){var F=R(E),I=E.read_shift(4);return F[1].v=I>>6,F}function U(E,O){var F=R(E),I=E.read_shift(8,"f");return F[1].v=I,F}function Y(E,O){var F=U(E);return E.l+=O-10,F}function ce(E,O){return E[E.l+O-1]==0?E.read_shift(O,"cstr"):""}function ee(E,O){var F=E[E.l++];F>O-1&&(F=O-1);for(var I="";I.length<F;)I+=String.fromCharCode(E[E.l++]);return I}function Q(E,O,F){if(!(!F.qpro||O<21)){var I=E.read_shift(1);E.l+=17,E.l+=1,E.l+=2;var V=E.read_shift(O-21,"cstr");return[I,V]}}function X(E,O){for(var F={},I=E.l+O;E.l<I;){var V=E.read_shift(2);if(V==14e3){for(F[V]=[0,""],F[V][0]=E.read_shift(2);E[E.l];)F[V][1]+=String.fromCharCode(E[E.l]),E.l++;E.l++}}return F}function z(E,O){var F=Pe(5+E.length);F.write_shift(2,14e3),F.write_shift(2,O);for(var I=0;I<E.length;++I){var V=E.charCodeAt(I);F[F.l++]=V>127?95:V}return F[F.l++]=0,F}var ae={0:{n:"BOF",f:Q_},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:v},15:{n:"LABEL",f},16:{n:"FORMULA",f:S},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ce},222:{n:"SHEETNAMELP",f:ee},65535:{n:""}},me={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:B},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:L},25:{n:"FORMULA19",f:N},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:X},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:C},38:{n:"??"},39:{n:"NUMBER27",f:U},40:{n:"FORMULA28",f:Y},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ce},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Q},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}(),wk=/^\s|\s$|[\t\n\r]/;function i4(e,t){if(!t.bookSST)return"";var r=[Vr];r[r.length]=Ke("sst",null,{xmlns:Ou[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var i=e[n],a="<si>";i.r?a+=i.r:(a+="<t",i.t||(i.t=""),i.t.match(wk)&&(a+=' xml:space="preserve"'),a+=">"+Jt(i.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function xk(e){return[e.read_shift(4),e.read_shift(4)]}function _k(e,t){return t||(t=Pe(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var Sk=h8;function bk(e){var t=si();Me(t,159,_k(e));for(var r=0;r<e.length;++r)Me(t,19,Sk(e[r]));return Me(t,160),t.end()}function Ek(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function a4(e){var t=0,r,n=Ek(e),i=n.length+1,a,s,o,l,u;for(r=Qo(i),r[0]=n.length,a=1;a!=i;++a)r[a]=n[a-1];for(a=i-1;a>=0;--a)s=r[a],o=t&16384?1:0,l=t<<1&32767,u=o|l,t=u^s;return t^52811}var Ak=function(){function e(i,a){switch(a.type){case"base64":return t(ps(i),a);case"binary":return t(i,a);case"buffer":return t(qt&&Buffer.isBuffer(i)?i.toString("binary"):jf(i),a);case"array":return t(Md(i),a)}throw new Error("Unrecognized type "+a.type)}function t(i,a){var s=a||{},o=s.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,d){Array.isArray(o)&&(o[d]=[]);for(var p=/\\\w+\b/g,h=0,v,m=-1;v=p.exec(f);){switch(v[0]){case"\\cell":var S=f.slice(h,p.lastIndex-v[0].length);if(S[0]==" "&&(S=S.slice(1)),++m,S.length){var y={v:S,t:"s"};Array.isArray(o)?o[d][m]=y:o[er({r:d,c:m})]=y}break}h=p.lastIndex}m>u.e.c&&(u.e.c=m)}),o["!ref"]=$r(u),o}function r(i,a){return nl(e(i,a),a)}function n(i){for(var a=["{\\rtf1\\ansi"],s=mr(i["!ref"]),o,l=Array.isArray(i),u=s.s.r;u<=s.e.r;++u){a.push("\\trowd\\trautofit1");for(var f=s.s.c;f<=s.e.c;++f)a.push("\\cellx"+(f+1));for(a.push("\\pard\\intbl"),f=s.s.c;f<=s.e.c;++f){var d=er({r:u,c:f});o=l?(i[u]||[])[f]:i[d],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(gs(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function Z5(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var Tk=6,us=Tk;function ld(e){return Math.floor((e+Math.round(128/us)/256)*us)}function ud(e){return Math.floor((e-5)/us*100+.5)/100}function Og(e){return Math.round((e*us+5)/us*256)/256}function rm(e){e.width?(e.wpx=ld(e.width),e.wch=ud(e.wpx),e.MDW=us):e.wpx?(e.wch=ud(e.wpx),e.width=Og(e.wch),e.MDW=us):typeof e.wch=="number"&&(e.width=Og(e.wch),e.wpx=ld(e.width),e.MDW=us),e.customWidth&&delete e.customWidth}var kk=96,s4=kk;function cd(e){return e*96/s4}function o4(e){return e*s4/96}function Nk(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Ke("numFmt",null,{numFmtId:n,formatCode:Jt(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Ke("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function Ck(e){var t=[];return t[t.length]=Ke("cellXfs",null),e.forEach(function(r){t[t.length]=Ke("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Ke("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function l4(e,t){var r=[Vr,Ke("styleSheet",null,{xmlns:Ou[0],"xmlns:vt":sn.vt})],n;return e.SSF&&(n=Nk(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Ck(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Lk(e,t){var r=e.read_shift(2),n=Dn(e);return[r,n]}function Pk(e,t,r){r||(r=Pe(6+4*t.length)),r.write_shift(2,e),ln(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function Ok(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=w8(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=y8(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Dn(e),n}function Fk(e,t){t||(t=Pe(25+4*32)),t.write_shift(2,e.sz*20),x8(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),sd(e.color,t);var n=0;return n=2,t.write_shift(1,n),ln(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Rk=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],hp,Ik=za;function ey(e,t){t||(t=Pe(4*3+8*7+16*1)),hp||(hp=q2(Rk));var r=hp[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(sd({auto:1},t),sd({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Dk(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}function u4(e,t,r){r||(r=Pe(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function xc(e,t){return t||(t=Pe(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var jk=za;function Mk(e,t){return t||(t=Pe(51)),t.write_shift(1,0),xc(null,t),xc(null,t),xc(null,t),xc(null,t),xc(null,t),t.length>t.l?t.slice(0,t.l):t}function Bk(e,t){return t||(t=Pe(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),ad(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function Uk(e,t,r){var n=Pe(2052);return n.write_shift(4,e),ad(t,n),ad(r,n),n.length>n.l?n.slice(0,n.l):n}function zk(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&++r}),r!=0&&(Me(e,615,xa(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&Me(e,44,Pk(i,t[i]))}),Me(e,616))}}function Hk(e){var t=1;Me(e,611,xa(t)),Me(e,43,Fk({sz:12,color:{theme:1},name:"Calibri",family:2})),Me(e,612)}function Wk(e){var t=2;Me(e,603,xa(t)),Me(e,45,ey({patternType:"none"})),Me(e,45,ey({patternType:"gray125"})),Me(e,604)}function qk(e){var t=1;Me(e,613,xa(t)),Me(e,46,Mk()),Me(e,614)}function $k(e){var t=1;Me(e,626,xa(t)),Me(e,47,u4({numFmtId:0},65535)),Me(e,627)}function Vk(e,t){Me(e,617,xa(t.length)),t.forEach(function(r){Me(e,47,u4(r,0))}),Me(e,618)}function Gk(e){var t=1;Me(e,619,xa(t)),Me(e,48,Bk({xfId:0,name:"Normal"})),Me(e,620)}function Kk(e){var t=0;Me(e,505,xa(t)),Me(e,506)}function Yk(e){var t=0;Me(e,508,Uk(t,"TableStyleMedium9","PivotStyleMedium4")),Me(e,509)}function Xk(e,t){var r=si();return Me(r,278),zk(r,e.SSF),Hk(r),Wk(r),qk(r),$k(r),Vk(r,t.cellXfs),Gk(r),Kk(r),Yk(r),Me(r,279),r.end()}function c4(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Vr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Jk(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Dn(e)}}function Qk(e){var t=Pe(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),ln(e.name,t),t.slice(0,t.l)}function Zk(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function eN(e){var t=Pe(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function tN(e,t){var r=Pe(8+2*t.length);return r.write_shift(4,e),ln(t,r),r.slice(0,r.l)}function rN(e){return e.l+=4,e.read_shift(4)!=0}function nN(e,t){var r=Pe(8);return r.write_shift(4,e),r.write_shift(4,1),r}function iN(){var e=si();return Me(e,332),Me(e,334,xa(1)),Me(e,335,Qk({name:"XLDAPR",version:12e4,flags:3496657072})),Me(e,336),Me(e,339,tN(1,"XLDAPR")),Me(e,52),Me(e,35,xa(514)),Me(e,4096,xa(0)),Me(e,4097,Hi(1)),Me(e,36),Me(e,53),Me(e,340),Me(e,337,nN(1)),Me(e,51,eN([[1,0]])),Me(e,338),Me(e,333),e.end()}function f4(){var e=[Vr];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function aN(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=er(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var lu=1024;function h4(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[Ke("xml",null,{"xmlns:v":_i.v,"xmlns:o":_i.o,"xmlns:x":_i.x,"xmlns:mv":_i.mv}).replace(/\/>/,">"),Ke("o:shapelayout",Ke("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ke("v:shapetype",[Ke("v:stroke",null,{joinstyle:"miter"}),Ke("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];lu<e*1e3;)lu+=1e3;return t.forEach(function(a){var s=on(a[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?Ke("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Ke("v:fill",l,o),f={on:"t",obscured:"t"};++lu,i=i.concat(["<v:shape"+Tf({id:"_x0000_s"+lu,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Ke("v:shadow",null,f),Ke("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",wn("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),wn("x:AutoFill","False"),wn("x:Row",String(s.r)),wn("x:Column",String(s.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function d4(e){var t=[Vr,Ke("comments",null,{xmlns:Ou[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(i){var a=Jt(i.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var i=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(Jt(l.a))),a.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),a.length<=1)t.push(wn("t",Jt(a[0]||"")));else{for(var s=`Comment:
    `+a[0]+`
`,o=1;o<a.length;++o)s+=`Reply:
    `+a[o]+`
`;t.push(wn("t",Jt(s)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function sN(e,t,r){var n=[Vr,Ke("ThreadedComments",null,{xmlns:sn.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var a="";(i[1]||[]).forEach(function(s,o){if(!s.T){delete s.ID;return}s.a&&t.indexOf(s.a)==-1&&t.push(s.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?a=l.id:l.parentId=a,s.ID=l.id,s.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),n.push(Ke("threadedComment",wn("text",s.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function oN(e){var t=[Vr,Ke("personList",null,{xmlns:sn.TCMNT,"xmlns:x":Ou[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Ke("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function lN(e){var t={};t.iauthor=e.read_shift(4);var r=ol(e);return t.rfx=r.s,t.ref=er(r.s),e.l+=16,t}function uN(e,t){return t==null&&(t=Pe(36)),t.write_shift(4,e[1].iauthor),Ru(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var cN=Dn;function fN(e){return ln(e.slice(0,54))}function hN(e){var t=si(),r=[];return Me(t,628),Me(t,630),e.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),Me(t,632,fN(i.a)))})}),Me(t,631),Me(t,633),e.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var a={s:on(n[0]),e:on(n[0])};Me(t,635,uN([a,i])),i.t&&i.t.length>0&&Me(t,637,p8(i)),Me(t,636),delete i.iauthor})}),Me(t,634),Me(t,629),t.end()}function dN(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&nr.utils.cfb_add(e,i,t.FileIndex[n].content)}})}var p4=["xlsb","xlsm","xlam","biff8","xla"],pN=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,a,s){var o=!1,l=!1;a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var u=a.length>0?parseInt(a,10)|0:0,f=s.length>0?parseInt(s,10)|0:0;return o?f+=t.c:--f,l?u+=t.r:--u,i+(o?"":"$")+In(f)+(l?"":"$")+_n(u)}return function(i,a){return t=a,i.replace(e,r)}}(),nm=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,im=function(){return function(t,r){return t.replace(nm,function(n,i,a,s,o,l){var u=J2(s)-(a?0:r.c),f=X2(l)-(o?0:r.r),d=f==0?"":o?f+1:"["+f+"]",p=u==0?"":a?u+1:"["+u+"]";return i+"R"+d+"C"+p})}}();function gN(e,t){return e.replace(nm,function(r,n,i,a,s,o){return n+(i=="$"?i+a:In(J2(a)+t.c))+(s=="$"?s+o:_n(X2(o)+t.r))})}function mN(e){return e.length!=1}function Hr(e){e.l+=1}function oo(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function g4(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return m4(e);r.biff==12&&(n=4)}var i=e.read_shift(n),a=e.read_shift(n),s=oo(e),o=oo(e);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function m4(e){var t=oo(e),r=oo(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function vN(e,t,r){if(r.biff<8)return m4(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),a=oo(e),s=oo(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:s[0],cRel:s[1],rRel:s[2]}}}function v4(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return yN(e);var n=e.read_shift(r&&r.biff==12?4:2),i=oo(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function yN(e){var t=oo(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function wN(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function xN(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return _N(e);var i=e.read_shift(n>=12?4:2),a=e.read_shift(2),s=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;i>524287;)i-=1048576;if(s==1)for(;a>8191;)a=a-16384;return{r:i,c:a,cRel:s,rRel:o}}function _N(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function SN(e,t,r){var n=(e[e.l++]&96)>>5,i=g4(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function bN(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var s=g4(e,a,r);return[n,i,s]}function EN(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function AN(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,i]}function TN(e,t,r){var n=(e[e.l++]&96)>>5,i=vN(e,t-1,r);return[n,i]}function kN(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function ty(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function NN(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],a=0;a<=n;++a)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function CN(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function LN(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function PN(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function ON(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function y4(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function FN(e){return e.read_shift(2),y4(e)}function RN(e){return e.read_shift(2),y4(e)}function IN(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=v4(e,0,r);return[n,i]}function DN(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=xN(e,0,r);return[n,i]}function jN(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=v4(e,0,r);return[n,i,a]}function MN(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[MC[i],_4[i],n]}function BN(e,t,r){var n=e[e.l++],i=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:UN(e);return[i,(a[0]===0?_4:jC)[a[1]]]}function UN(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function zN(e,t,r){e.l+=r&&r.biff==2?3:4}function HN(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function WN(e){return e.l++,Uf[e.read_shift(1)]}function qN(e){return e.l++,e.read_shift(2)}function $N(e){return e.l++,e.read_shift(1)!==0}function VN(e){return e.l++,Iu(e)}function GN(e,t,r){return e.l++,e4(e,t-1,r)}function KN(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=j8(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Uf[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Iu(e);break;case 2:r[1]=z8(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function YN(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],a=0;a!=n;++a)i.push((r.biff==12?ol:q8)(e));return i}function XN(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var a=0,s=[];a!=n&&(s[a]=[]);++a)for(var o=0;o!=i;++o)s[a][o]=KN(e,r.biff);return s}function JN(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,a=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function QN(e,t,r){if(r.biff==5)return ZN(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),a=e.read_shift(4);return[n,i,a]}function ZN(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function eC(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function tC(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function rC(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function nC(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,i]}var iC=za,aC=za,sC=za;function zf(e,t,r){return e.l+=2,[wN(e)]}function am(e){return e.l+=6,[]}var oC=zf,lC=am,uC=am,cC=zf;function w4(e){return e.l+=2,[Q_(e),e.read_shift(2)&1]}var fC=zf,hC=w4,dC=am,pC=zf,gC=zf,mC=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function vC(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),a=e.read_shift(2),s=mC[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:i,C:a}}function yC(e){return e.l+=2,[e.read_shift(4)]}function wC(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function xC(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function _C(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function SC(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function bC(e){return e.l+=4,[0,0]}var ry={1:{n:"PtgExp",f:HN},2:{n:"PtgTbl",f:sC},3:{n:"PtgAdd",f:Hr},4:{n:"PtgSub",f:Hr},5:{n:"PtgMul",f:Hr},6:{n:"PtgDiv",f:Hr},7:{n:"PtgPower",f:Hr},8:{n:"PtgConcat",f:Hr},9:{n:"PtgLt",f:Hr},10:{n:"PtgLe",f:Hr},11:{n:"PtgEq",f:Hr},12:{n:"PtgGe",f:Hr},13:{n:"PtgGt",f:Hr},14:{n:"PtgNe",f:Hr},15:{n:"PtgIsect",f:Hr},16:{n:"PtgUnion",f:Hr},17:{n:"PtgRange",f:Hr},18:{n:"PtgUplus",f:Hr},19:{n:"PtgUminus",f:Hr},20:{n:"PtgPercent",f:Hr},21:{n:"PtgParen",f:Hr},22:{n:"PtgMissArg",f:Hr},23:{n:"PtgStr",f:GN},26:{n:"PtgSheet",f:wC},27:{n:"PtgEndSheet",f:xC},28:{n:"PtgErr",f:WN},29:{n:"PtgBool",f:$N},30:{n:"PtgInt",f:qN},31:{n:"PtgNum",f:VN},32:{n:"PtgArray",f:kN},33:{n:"PtgFunc",f:MN},34:{n:"PtgFuncVar",f:BN},35:{n:"PtgName",f:JN},36:{n:"PtgRef",f:IN},37:{n:"PtgArea",f:SN},38:{n:"PtgMemArea",f:eC},39:{n:"PtgMemErr",f:iC},40:{n:"PtgMemNoMem",f:aC},41:{n:"PtgMemFunc",f:tC},42:{n:"PtgRefErr",f:rC},43:{n:"PtgAreaErr",f:EN},44:{n:"PtgRefN",f:DN},45:{n:"PtgAreaN",f:TN},46:{n:"PtgMemAreaN",f:_C},47:{n:"PtgMemNoMemN",f:SC},57:{n:"PtgNameX",f:QN},58:{n:"PtgRef3d",f:jN},59:{n:"PtgArea3d",f:bN},60:{n:"PtgRefErr3d",f:nC},61:{n:"PtgAreaErr3d",f:AN},255:{}},EC={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},AC={1:{n:"PtgElfLel",f:w4},2:{n:"PtgElfRw",f:pC},3:{n:"PtgElfCol",f:oC},6:{n:"PtgElfRwV",f:gC},7:{n:"PtgElfColV",f:cC},10:{n:"PtgElfRadical",f:fC},11:{n:"PtgElfRadicalS",f:dC},13:{n:"PtgElfColS",f:lC},15:{n:"PtgElfColSV",f:uC},16:{n:"PtgElfRadicalLel",f:hC},25:{n:"PtgList",f:vC},29:{n:"PtgSxName",f:yC},255:{}},TC={0:{n:"PtgAttrNoop",f:bC},1:{n:"PtgAttrSemi",f:ON},2:{n:"PtgAttrIf",f:LN},4:{n:"PtgAttrChoose",f:NN},8:{n:"PtgAttrGoto",f:CN},16:{n:"PtgAttrSum",f:zN},32:{n:"PtgAttrBaxcel",f:ty},33:{n:"PtgAttrBaxcel",f:ty},64:{n:"PtgAttrSpace",f:FN},65:{n:"PtgAttrSpaceSemi",f:RN},128:{n:"PtgAttrIfError",f:PN},255:{}};function kC(e,t,r,n){if(n.biff<8)return za(e,t);for(var i=e.l+t,a=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=XN(e,0,n),a.push(r[s][1]);break;case"PtgMemArea":r[s][2]=YN(e,r[s][1],n),a.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),a.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=i-e.l,t!==0&&a.push(za(e,t)),a}function NC(e,t,r){for(var n=e.l+t,i,a,s=[];n!=e.l;)t=n-e.l,a=e[e.l],i=ry[a]||ry[EC[a]],(a===24||a===25)&&(i=(a===24?AC:TC)[e[e.l+1]]),!i||!i.f?za(e,t):s.push([i.n,i.f(e,t,r)]);return s}function CC(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],a=0;a<n.length;++a){var s=n[a];if(s)switch(s[0]){case 2:i.push('"'+s[1].replace(/"/g,'""')+'"');break;default:i.push(s[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var LC={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function PC(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function x4(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function ny(e,t,r){var n=x4(e,t,r);return n=="#REF"?n:PC(n,r)}function ku(e,t,r,n,i){var a=i&&i.biff||8,s={s:{c:0,r:0}},o=[],l,u,f,d=0,p=0,h,v="";if(!e[0]||!e[0][0])return"";for(var m=-1,S="",y=0,w=e[0].length;y<w;++y){var x=e[0][y];switch(x[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),m>=0){switch(e[0][m][1][0]){case 0:S=Nr(" ",e[0][m][1][1]);break;case 1:S=Nr("\r",e[0][m][1][1]);break;default:if(S="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}u=u+S,m=-1}o.push(u+LC[x[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Wc(x[1][1],s,i),o.push(qc(f,a));break;case"PtgRefN":f=r?Wc(x[1][1],r,i):x[1][1],o.push(qc(f,a));break;case"PtgRef3d":d=x[1][1],f=Wc(x[1][2],s,i),v=ny(n,d,i),o.push(v+"!"+qc(f,a));break;case"PtgFunc":case"PtgFuncVar":var A=x[1][0],R=x[1][1];A||(A=0),A&=127;var B=A==0?[]:o.slice(-A);o.length-=A,R==="User"&&(R=B.shift()),o.push(R+"("+B.join(",")+")");break;case"PtgBool":o.push(x[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(x[1]);break;case"PtgNum":o.push(String(x[1]));break;case"PtgStr":o.push('"'+x[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(x[1]);break;case"PtgAreaN":h=z5(x[1][1],r?{s:r}:s,i),o.push(cp(h,i));break;case"PtgArea":h=z5(x[1][1],s,i),o.push(cp(h,i));break;case"PtgArea3d":d=x[1][1],h=x[1][2],v=ny(n,d,i),o.push(v+"!"+cp(h,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=x[1][2];var T=(n.names||[])[p-1]||(n[0]||[])[p],L=T?T.Name:"SH33TJSNAME"+String(p);L&&L.slice(0,6)=="_xlfn."&&!i.xlfn&&(L=L.slice(6)),o.push(L);break;case"PtgNameX":var P=x[1][1];p=x[1][2];var M;if(i.biff<=5)P<0&&(P=-P),n[P]&&(M=n[P][p]);else{var N="";if(((n[P]||[])[0]||[])[0]==14849||(((n[P]||[])[0]||[])[0]==1025?n[P][p]&&n[P][p].itab>0&&(N=n.SheetNames[n[P][p].itab-1]+"!"):N=n.SheetNames[p-1]+"!"),n[P]&&n[P][p])N+=n[P][p].Name;else if(n[0]&&n[0][p])N+=n[0][p].Name;else{var C=(x4(n,P,i)||"").split(";;");C[p-1]?N=C[p-1]:N+="SH33TJSERRX"}o.push(N);break}M||(M={Name:"SH33TJSERRY"}),o.push(M.Name);break;case"PtgParen":var U="(",Y=")";if(m>=0){switch(S="",e[0][m][1][0]){case 2:U=Nr(" ",e[0][m][1][1])+U;break;case 3:U=Nr("\r",e[0][m][1][1])+U;break;case 4:Y=Nr(" ",e[0][m][1][1])+Y;break;case 5:Y=Nr("\r",e[0][m][1][1])+Y;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}o.push(U+o.pop()+Y);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:x[1][1],r:x[1][0]};var ce={c:r.c,r:r.r};if(n.sharedf[er(f)]){var ee=n.sharedf[er(f)];o.push(ku(ee,s,ce,n,i))}else{var Q=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(f.c<u[0].s.c||f.c>u[0].e.c)&&!(f.r<u[0].s.r||f.r>u[0].e.r)){o.push(ku(u[1],s,ce,n,i)),Q=!0;break}Q||o.push(x[1])}break;case"PtgArray":o.push("{"+CC(x[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=y;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+x[1].idx+"[#"+x[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(x));default:throw new Error("Unrecognized Formula Token: "+String(x))}var X=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&m>=0&&X.indexOf(e[0][y][0])==-1){x=e[0][m];var z=!0;switch(x[1][0]){case 4:z=!1;case 0:S=Nr(" ",x[1][1]);break;case 5:z=!1;case 1:S=Nr("\r",x[1][1]);break;default:if(S="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+x[1][0])}o.push((z?S:"")+o.pop()+(z?"":S)),m=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function OC(e){if(e==null){var t=Pe(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Zo(e);return Zo(0)}function FC(e,t,r,n,i){var a=el(t,r,i),s=OC(e.v),o=Pe(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var u=Pe(e.bf.length),f=0;f<e.bf.length;++f)u[f]=e.bf[f];var d=yn([a,s,o,u]);return d}function Bd(e,t,r){var n=e.read_shift(4),i=NC(e,n,r),a=e.read_shift(4),s=a>0?kC(e,a,i,r):null;return[i,s]}var RC=Bd,Ud=Bd,IC=Bd,DC=Bd,jC={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},_4={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},MC={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function BC(e){var t="of:="+e.replace(nm,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function UC(e){return e.replace(/\./,"!")}var $c=typeof Map<"u";function sm(e,t,r){var n=0,i=e.length;if(r){if($c?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=$c?r.get(t):r[t];n<a.length;++n)if(e[a[n]].t===t)return e.Count++,a[n]}}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t},e.Count++,e.Unique++,r&&($c?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function zd(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(us=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=ud(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Og(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function S4(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function go(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],i=60,a=e.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){v_(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}}for(i=0;i!=a;++i)if(e[i].numFmtId===n)return i;return e[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function zC(e,t,r){if(e&&e["!ref"]){var n=mr(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function HC(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+$r(e[r])+'"/>';return t+"</mergeCells>"}function WC(e,t,r,n,i){var a=!1,s={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}a=!0,s.codeName=Af(Jt(l))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+Ke("outlinePr",null,u)}!a&&!o||(i[i.length]=Ke("sheetPr",o,s))}var qC=["objects","scenarios","selectLockedCells","selectUnlockedCells"],$C=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function VC(e){var t={sheet:1};return qC.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),$C.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=a4(e.password).toString(16).toUpperCase()),Ke("sheetProtection",null,t)}function GC(e){return S4(e),Ke("pageMargins",null,e)}function KC(e,t){for(var r=["<cols>"],n,i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=Ke("col",null,zd(i,n)));return r[r.length]="</cols>",r.join("")}function YC(e,t,r,n){var i=typeof e.ref=="string"?e.ref:$r(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,s=Ni(i);s.s.r==s.e.r&&(s.e.r=Ni(t["!ref"]).e.r,i=$r(s));for(var o=0;o<a.length;++o){var l=a[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Ke("autoFilter",null,{ref:i})}function XC(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ke("sheetViews",Ke("sheetView",null,i),{})}function JC(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",a=e.t,s=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=Uf[e.v];break;case"d":n&&n.cellDates?i=$n(e.v,-1).toISOString():(e=li(e),e.t="n",i=""+(e.v=oi($n(e.v)))),typeof e.z>"u"&&(e.z=Cr[14]);break;default:i=e.v;break}var o=wn("v",Jt(i)),l={r:t},u=go(n.cellXfs,e,n);switch(u!==0&&(l.s=u),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=wn("v",""+sm(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=a&&(e.t=a,e.v=s),typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Ke("f",Jt(e.f),f)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),Ke("c",o,l)}function QC(e,t,r,n){var i=[],a=[],s=mr(e["!ref"]),o="",l,u="",f=[],d=0,p=0,h=e["!rows"],v=Array.isArray(e),m={r:u},S,y=-1;for(p=s.s.c;p<=s.e.c;++p)f[p]=In(p);for(d=s.s.r;d<=s.e.r;++d){for(a=[],u=_n(d),p=s.s.c;p<=s.e.c;++p){l=f[p]+u;var w=v?(e[d]||[])[p]:e[l];w!==void 0&&(o=JC(w,l,e,t))!=null&&a.push(o)}(a.length>0||h&&h[d])&&(m={r:u},h&&h[d]&&(S=h[d],S.hidden&&(m.hidden=1),y=-1,S.hpx?y=cd(S.hpx):S.hpt&&(y=S.hpt),y>-1&&(m.ht=y,m.customHeight=1),S.level&&(m.outlineLevel=S.level)),i[i.length]=Ke("row",a.join(""),m))}if(h)for(;d<h.length;++d)h&&h[d]&&(m={r:d+1},S=h[d],S.hidden&&(m.hidden=1),y=-1,S.hpx?y=cd(S.hpx):S.hpt&&(y=S.hpt),y>-1&&(m.ht=y,m.customHeight=1),S.level&&(m.outlineLevel=S.level),i[i.length]=Ke("row","",m));return i.join("")}function b4(e,t,r,n){var i=[Vr,Ke("worksheet",null,{xmlns:Ou[0],"xmlns:r":sn.r})],a=r.SheetNames[e],s=0,o="",l=r.Sheets[a];l==null&&(l={});var u=l["!ref"]||"A1",f=mr(u);if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),u=$r(f)}n||(n={}),l["!comments"]=[];var d=[];WC(l,r,e,t,i),i[i.length]=Ke("dimension",null,{ref:u}),i[i.length]=XC(l,t,e,r),t.sheetFormat&&(i[i.length]=Ke("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=KC(l,l["!cols"])),i[s=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=QC(l,t),o.length>0&&(i[i.length]=o)),i.length>s+1&&(i[i.length]="</sheetData>",i[s]=i[s].replace("/>",">")),l["!protect"]&&(i[i.length]=VC(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=YC(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=HC(l["!merges"]));var p=-1,h,v=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(m){m[1].Target&&(h={ref:m[0]},m[1].Target.charAt(0)!="#"&&(v=Xt(n,-1,Jt(m[1].Target).replace(/#.*$/,""),Ht.HLINK),h["r:id"]="rId"+v),(p=m[1].Target.indexOf("#"))>-1&&(h.location=Jt(m[1].Target.slice(p+1))),m[1].Tooltip&&(h.tooltip=Jt(m[1].Tooltip)),i[i.length]=Ke("hyperlink",null,h))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=GC(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=wn("ignoredErrors",Ke("ignoredError",null,{numberStoredAsText:1,sqref:u}))),d.length>0&&(v=Xt(n,-1,"../drawings/drawing"+(e+1)+".xml",Ht.DRAW),i[i.length]=Ke("drawing",null,{"r:id":"rId"+v}),l["!drawing"]=d),l["!comments"].length>0&&(v=Xt(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Ht.VML),i[i.length]=Ke("legacyDrawing",null,{"r:id":"rId"+v}),l["!legacy"]=v),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function ZC(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=i/20),r}function eL(e,t,r){var n=Pe(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var a=320;i.hpx?a=cd(i.hpx)*20:i.hpt&&(a=i.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var s=0;i.level&&(s|=i.level),i.hidden&&(s|=16),(i.hpx||i.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var u={r:e,c:0},f=0;f<16;++f)if(!(t.s.c>f+1<<10||t.e.c<f<<10)){for(var d=-1,p=-1,h=f<<10;h<f+1<<10;++h){u.c=h;var v=Array.isArray(r)?(r[u.r]||[])[u.c]:r[er(u)];v&&(d<0&&(d=h),p=h)}d<0||(++o,n.write_shift(4,d),n.write_shift(4,p))}var m=n.l;return n.l=l,n.write_shift(4,o),n.l=m,n.length>n.l?n.slice(0,n.l):n}function tL(e,t,r,n){var i=eL(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&Me(e,0,i)}var rL=ol,nL=Ru;function iL(){}function aL(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=g8(e),r}function sL(e,t,r){r==null&&(r=Pe(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return sd({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),M_(e,r),r.slice(0,r.l)}function oL(e){var t=Yi(e);return[t]}function lL(e,t,r){return r==null&&(r=Pe(8)),il(t,r)}function uL(e){var t=al(e);return[t]}function cL(e,t,r){return r==null&&(r=Pe(4)),sl(t,r)}function fL(e){var t=Yi(e),r=e.read_shift(1);return[t,r,"b"]}function hL(e,t,r){return r==null&&(r=Pe(9)),il(t,r),r.write_shift(1,e.v?1:0),r}function dL(e){var t=al(e),r=e.read_shift(1);return[t,r,"b"]}function pL(e,t,r){return r==null&&(r=Pe(5)),sl(t,r),r.write_shift(1,e.v?1:0),r}function gL(e){var t=Yi(e),r=e.read_shift(1);return[t,r,"e"]}function mL(e,t,r){return r==null&&(r=Pe(9)),il(t,r),r.write_shift(1,e.v),r}function vL(e){var t=al(e),r=e.read_shift(1);return[t,r,"e"]}function yL(e,t,r){return r==null&&(r=Pe(8)),sl(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function wL(e){var t=Yi(e),r=e.read_shift(4);return[t,r,"s"]}function xL(e,t,r){return r==null&&(r=Pe(12)),il(t,r),r.write_shift(4,t.v),r}function _L(e){var t=al(e),r=e.read_shift(4);return[t,r,"s"]}function SL(e,t,r){return r==null&&(r=Pe(8)),sl(t,r),r.write_shift(4,t.v),r}function bL(e){var t=Yi(e),r=Iu(e);return[t,r,"n"]}function EL(e,t,r){return r==null&&(r=Pe(16)),il(t,r),Zo(e.v,r),r}function AL(e){var t=al(e),r=Iu(e);return[t,r,"n"]}function TL(e,t,r){return r==null&&(r=Pe(12)),sl(t,r),Zo(e.v,r),r}function kL(e){var t=Yi(e),r=B_(e);return[t,r,"n"]}function NL(e,t,r){return r==null&&(r=Pe(12)),il(t,r),U_(e.v,r),r}function CL(e){var t=al(e),r=B_(e);return[t,r,"n"]}function LL(e,t,r){return r==null&&(r=Pe(8)),sl(t,r),U_(e.v,r),r}function PL(e){var t=Yi(e),r=Q2(e);return[t,r,"is"]}function OL(e){var t=Yi(e),r=Dn(e);return[t,r,"str"]}function FL(e,t,r){return r==null&&(r=Pe(12+4*e.v.length)),il(t,r),ln(e.v,r),r.length>r.l?r.slice(0,r.l):r}function RL(e){var t=al(e),r=Dn(e);return[t,r,"str"]}function IL(e,t,r){return r==null&&(r=Pe(8+4*e.v.length)),sl(t,r),ln(e.v,r),r.length>r.l?r.slice(0,r.l):r}function DL(e,t,r){var n=e.l+t,i=Yi(e);i.r=r["!row"];var a=e.read_shift(1),s=[i,a,"b"];if(r.cellFormula){e.l+=2;var o=Ud(e,n-e.l,r);s[3]=ku(o,null,i,r.supbooks,r)}else e.l=n;return s}function jL(e,t,r){var n=e.l+t,i=Yi(e);i.r=r["!row"];var a=e.read_shift(1),s=[i,a,"e"];if(r.cellFormula){e.l+=2;var o=Ud(e,n-e.l,r);s[3]=ku(o,null,i,r.supbooks,r)}else e.l=n;return s}function ML(e,t,r){var n=e.l+t,i=Yi(e);i.r=r["!row"];var a=Iu(e),s=[i,a,"n"];if(r.cellFormula){e.l+=2;var o=Ud(e,n-e.l,r);s[3]=ku(o,null,i,r.supbooks,r)}else e.l=n;return s}function BL(e,t,r){var n=e.l+t,i=Yi(e);i.r=r["!row"];var a=Dn(e),s=[i,a,"str"];if(r.cellFormula){e.l+=2;var o=Ud(e,n-e.l,r);s[3]=ku(o,null,i,r.supbooks,r)}else e.l=n;return s}var UL=ol,zL=Ru;function HL(e,t){return t==null&&(t=Pe(4)),t.write_shift(4,e),t}function WL(e,t){var r=e.l+t,n=ol(e),i=Z2(e),a=Dn(e),s=Dn(e),o=Dn(e);e.l=r;var l={rfx:n,relId:i,loc:a,display:o};return s&&(l.Tooltip=s),l}function qL(e,t){var r=Pe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Ru({s:on(e[0]),e:on(e[0])},r),em("rId"+t,r);var n=e[1].Target.indexOf("#"),i=n==-1?"":e[1].Target.slice(n+1);return ln(i||"",r),ln(e[1].Tooltip||"",r),ln("",r),r.slice(0,r.l)}function $L(){}function VL(e,t,r){var n=e.l+t,i=z_(e),a=e.read_shift(1),s=[i];if(s[2]=a,r.cellFormula){var o=RC(e,n-e.l,r);s[1]=o}else e.l=n;return s}function GL(e,t,r){var n=e.l+t,i=ol(e),a=[i];if(r.cellFormula){var s=DC(e,n-e.l,r);a[1]=s,e.l=n}else e.l=n;return a}function KL(e,t,r){r==null&&(r=Pe(18));var n=zd(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var E4=["left","right","top","bottom","header","footer"];function YL(e){var t={};return E4.forEach(function(r){t[r]=Iu(e)}),t}function XL(e,t){return t==null&&(t=Pe(6*8)),S4(e),E4.forEach(function(r){Zo(e[r],t)}),t}function JL(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function QL(e,t,r){r==null&&(r=Pe(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function ZL(e){var t=Pe(24);return t.write_shift(4,4),t.write_shift(4,1),Ru(e,t),t}function eP(e,t){return t==null&&(t=Pe(16*4+2)),t.write_shift(2,e.password?a4(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function tP(){}function rP(){}function nP(e,t,r,n,i,a,s){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=li(t),t.z=t.z||Cr[14],t.v=oi($n(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r,c:n};switch(l.s=go(i.cellXfs,t,i),t.l&&a["!links"].push([er(l),t.l]),t.c&&a["!comments"].push([er(l),t.c]),t.t){case"s":case"str":return i.bookSST?(o=sm(i.Strings,t.v,i.revStrings),l.t="s",l.v=o,s?Me(e,18,SL(t,l)):Me(e,7,xL(t,l))):(l.t="str",s?Me(e,17,IL(t,l)):Me(e,6,FL(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?s?Me(e,13,LL(t,l)):Me(e,2,NL(t,l)):s?Me(e,16,TL(t,l)):Me(e,5,EL(t,l)),!0;case"b":return l.t="b",s?Me(e,15,pL(t,l)):Me(e,4,hL(t,l)),!0;case"e":return l.t="e",s?Me(e,14,yL(t,l)):Me(e,3,mL(t,l)),!0}return s?Me(e,12,cL(t,l)):Me(e,1,lL(t,l)),!0}function iP(e,t,r,n){var i=mr(t["!ref"]||"A1"),a,s="",o=[];Me(e,145);var l=Array.isArray(t),u=i.e.r;t["!rows"]&&(u=Math.max(i.e.r,t["!rows"].length-1));for(var f=i.s.r;f<=u;++f){s=_n(f),tL(e,t,i,f);var d=!1;if(f<=i.e.r)for(var p=i.s.c;p<=i.e.c;++p){f===i.s.r&&(o[p]=In(p)),a=o[p]+s;var h=l?(t[f]||[])[p]:t[a];if(!h){d=!1;continue}d=nP(e,h,f,p,n,t,d)}}Me(e,146)}function aP(e,t){!t||!t["!merges"]||(Me(e,177,HL(t["!merges"].length)),t["!merges"].forEach(function(r){Me(e,176,zL(r))}),Me(e,178))}function sP(e,t){!t||!t["!cols"]||(Me(e,390),t["!cols"].forEach(function(r,n){r&&Me(e,60,KL(n,r))}),Me(e,391))}function oP(e,t){!t||!t["!ref"]||(Me(e,648),Me(e,649,ZL(mr(t["!ref"]))),Me(e,650))}function lP(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var i=Xt(r,-1,n[1].Target.replace(/#.*$/,""),Ht.HLINK);Me(e,494,qL(n,i))}}),delete t["!links"]}function uP(e,t,r,n){if(t["!comments"].length>0){var i=Xt(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Ht.VML);Me(e,551,em("rId"+i)),t["!legacy"]=i}}function cP(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],a=typeof i.ref=="string"?i.ref:$r(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=Ni(a);o.s.r==o.e.r&&(o.e.r=Ni(t["!ref"]).e.r,a=$r(o));for(var l=0;l<s.length;++l){var u=s[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+a;break}}l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Me(e,161,Ru(mr(a))),Me(e,162)}}function fP(e,t,r){Me(e,133),Me(e,137,QL(t,r)),Me(e,138),Me(e,134)}function hP(e,t){t["!protect"]&&Me(e,535,eP(t["!protect"]))}function dP(e,t,r,n){var i=si(),a=r.SheetNames[e],s=r.Sheets[a]||{},o=a;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var l=mr(s["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],Me(i,129),(r.vbaraw||s["!outline"])&&Me(i,147,sL(o,s["!outline"])),Me(i,148,nL(l)),fP(i,s,r.Workbook),sP(i,s),iP(i,s,e,t),hP(i,s),cP(i,s,r,e),aP(i,s),lP(i,s,n),s["!margins"]&&Me(i,476,XL(s["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&oP(i,s),uP(i,s,e,n),Me(i,130),i.end()}function pP(e,t){e.l+=10;var r=Dn(e);return{name:r}}var gP=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function mP(e){return!e.Workbook||!e.Workbook.WBProps?"false":GT(e.Workbook.WBProps.date1904)?"true":"false"}var vP="][*?/\\".split("");function A4(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return vP.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function yP(e,t,r){e.forEach(function(n,i){A4(n);for(var a=0;a<i;++a)if(n==e[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var s=t&&t[i]&&t[i].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function wP(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];yP(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)zC(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function T4(e){var t=[Vr];t[t.length]=Ke("workbook",null,{xmlns:Ou[0],"xmlns:r":sn.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(gP.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Ke("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],a=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!i[a]||!i[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var s={name:Jt(e.SheetNames[a].slice(0,31))};if(s.sheetId=""+(a+1),s["r:id"]="rId"+(a+1),i[a])switch(i[a].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}t[t.length]=Ke("sheet",null,s)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=Ke("definedName",Jt(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function xP(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Pg(e),r.name=Dn(e),r}function _P(e,t){return t||(t=Pe(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),em(e.strRelID,t),ln(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function SP(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?Dn(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function bP(e,t){t||(t=Pe(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),M_(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function EP(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),a=m8(e),s=IC(e,0,r),o=Z2(e);e.l=n;var l={Name:a,Ptg:s};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function AP(e,t){Me(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Me(e,156,_P(i))}Me(e,144)}function TP(e,t){t||(t=Pe(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return ln("SheetJS",t),ln(Q0.version,t),ln(Q0.version,t),ln("7262",t),t.length>t.l?t.slice(0,t.l):t}function kP(e,t){t||(t=Pe(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function NP(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,i=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&a==-1&&(a=n);a>i||(Me(e,135),Me(e,158,kP(i)),Me(e,136))}}function CP(e,t){var r=si();return Me(r,131),Me(r,128,TP()),Me(r,153,bP(e.Workbook&&e.Workbook.WBProps||null)),NP(r,e),AP(r,e),Me(r,132),r.end()}function LP(e,t,r){return(t.slice(-4)===".bin"?CP:T4)(e)}function PP(e,t,r,n,i){return(t.slice(-4)===".bin"?dP:b4)(e,r,n,i)}function OP(e,t,r){return(t.slice(-4)===".bin"?Xk:l4)(e,r)}function FP(e,t,r){return(t.slice(-4)===".bin"?bk:i4)(e,r)}function RP(e,t,r){return(t.slice(-4)===".bin"?hN:d4)(e)}function IP(e){return(e.slice(-4)===".bin"?iN:f4)()}function DP(e,t){var r=[];return e.Props&&r.push(O8(e.Props,t)),e.Custprops&&r.push(F8(e.Props,e.Custprops)),r.join("")}function jP(){return""}function MP(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,i){var a=[];a.push(Ke("NumberFormat",null,{"ss:Format":Jt(Cr[n.numFmtId])}));var s={"ss:ID":"s"+(21+i)};r.push(Ke("Style",a.join(""),s))}),Ke("Styles",r.join(""))}function k4(e){return Ke("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+im(e.Ref,{r:0,c:0})})}function BP(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(k4(i)))}return Ke("Names",r.join(""))}function UP(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,a=[],s=0;s<i.length;++s){var o=i[s];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||a.push(k4(o)))}return a.join("")}function zP(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(Ke("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(Ke("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(Ke("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(Ke("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(wn("ProtectContents","True")),e["!protect"].objects&&i.push(wn("ProtectObjects","True")),e["!protect"].scenarios&&i.push(wn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(wn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(wn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&i.push("<"+s[1]+"/>")})),i.length==0?"":Ke("WorksheetOptions",i.join(""),{xmlns:_i.x})}function HP(e){return e.map(function(t){var r=VT(t.t||""),n=Ke("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ke("Comment",n,{"ss:Author":t.a})}).join("")}function WP(e,t,r,n,i,a,s){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+Jt(im(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var l=on(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==s.r?"":"["+(l.r-s.r)+"]")+"C"+(l.c==s.c?"":"["+(l.c-s.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=Jt(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=Jt(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],f=0;f!=u.length;++f)u[f].s.c!=s.c||u[f].s.r!=s.r||(u[f].e.c>u[f].s.c&&(o["ss:MergeAcross"]=u[f].e.c-u[f].s.c),u[f].e.r>u[f].s.r&&(o["ss:MergeDown"]=u[f].e.r-u[f].s.r));var d="",p="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":d="Number",p=String(e.v);break;case"b":d="Boolean",p=e.v?"1":"0";break;case"e":d="Error",p=Uf[e.v];break;case"d":d="DateTime",p=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Cr[14]);break;case"s":d="String",p=$T(e.v||"");break}var h=go(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+h),o["ss:Index"]=s.c+1;var v=e.v!=null?p:"",m=e.t=="z"?"":'<Data ss:Type="'+d+'">'+v+"</Data>";return(e.c||[]).length>0&&(m+=HP(e.c)),Ke("Cell",m,o)}function qP(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=o4(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function $P(e,t,r,n){if(!e["!ref"])return"";var i=mr(e["!ref"]),a=e["!merges"]||[],s=0,o=[];e["!cols"]&&e["!cols"].forEach(function(S,y){rm(S);var w=!!S.width,x=zd(y,S),A={"ss:Index":y+1};w&&(A["ss:Width"]=ld(x.width)),S.hidden&&(A["ss:Hidden"]="1"),o.push(Ke("Column",null,A))});for(var l=Array.isArray(e),u=i.s.r;u<=i.e.r;++u){for(var f=[qP(u,(e["!rows"]||[])[u])],d=i.s.c;d<=i.e.c;++d){var p=!1;for(s=0;s!=a.length;++s)if(!(a[s].s.c>d)&&!(a[s].s.r>u)&&!(a[s].e.c<d)&&!(a[s].e.r<u)){(a[s].s.c!=d||a[s].s.r!=u)&&(p=!0);break}if(!p){var h={r:u,c:d},v=er(h),m=l?(e[u]||[])[d]:e[v];f.push(WP(m,v,e,t,r,n,h))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function VP(e,t,r){var n=[],i=r.SheetNames[e],a=r.Sheets[i],s=a?UP(a,t,e,r):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=a?$P(a,t,e,r):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(zP(a,t,e,r)),n.join("")}function GP(e,t){t||(t={}),e.SSF||(e.SSF=li(Cr)),e.SSF&&(Dd(),Id(e.SSF),t.revssf=jd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],go(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(DP(e,t)),r.push(jP()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Ke("Worksheet",VP(n,t,e),{"ss:Name":Jt(e.SheetNames[n])}));return r[2]=MP(e,t),r[3]=BP(e),Vr+Ke("Workbook",r.join(""),{xmlns:_i.ss,"xmlns:o":_i.o,"xmlns:x":_i.x,"xmlns:ss":_i.ss,"xmlns:dt":_i.dt,"xmlns:html":_i.html})}var dp={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function KP(e,t){var r=[],n=[],i=[],a=0,s,o=L5(W5,"n"),l=L5(q5,"n");if(e.Props)for(s=bn(e.Props),a=0;a<s.length;++a)(Object.prototype.hasOwnProperty.call(o,s[a])?r:Object.prototype.hasOwnProperty.call(l,s[a])?n:i).push([s[a],e.Props[s[a]]]);if(e.Custprops)for(s=bn(e.Custprops),a=0;a<s.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},s[a])||(Object.prototype.hasOwnProperty.call(o,s[a])?r:Object.prototype.hasOwnProperty.call(l,s[a])?n:i).push([s[a],e.Custprops[s[a]]]);var u=[];for(a=0;a<i.length;++a)J_.indexOf(i[a][0])>-1||K_.indexOf(i[a][0])>-1||i[a][1]!=null&&u.push(i[a]);n.length&&nr.utils.cfb_add(t,"/SummaryInformation",Y5(n,dp.SI,l,q5)),(r.length||u.length)&&nr.utils.cfb_add(t,"/DocumentSummaryInformation",Y5(r,dp.DSI,o,W5,u.length?u:null,dp.UDI))}function YP(e,t){var r=t||{},n=nr.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return nr.utils.cfb_add(n,i,N4(e,r)),r.biff==8&&(e.Props||e.Custprops)&&KP(e,n),r.biff==8&&e.vbaraw&&dN(n,nr.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var XP={0:{f:ZC},1:{f:oL},2:{f:kL},3:{f:gL},4:{f:fL},5:{f:bL},6:{f:OL},7:{f:wL},8:{f:BL},9:{f:ML},10:{f:DL},11:{f:jL},12:{f:uL},13:{f:CL},14:{f:vL},15:{f:dL},16:{f:AL},17:{f:RL},18:{f:_L},19:{f:Q2},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:EP},40:{},42:{},43:{f:Ok},44:{f:Lk},45:{f:Ik},46:{f:jk},47:{f:Dk},48:{},49:{f:u8},50:{},51:{f:Zk},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:ck},62:{f:PL},63:{f:aN},64:{f:tP},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:za,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:JL},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:aL},148:{f:rL,p:16},151:{f:$L},152:{},153:{f:SP},154:{},155:{},156:{f:xP},157:{},158:{},159:{T:1,f:xk},160:{T:-1},161:{T:1,f:ol},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:UL},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Jk},336:{T:-1},337:{f:rN,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Pg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:ik},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:VL},427:{f:GL},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:YL},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:iL},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:WL},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Pg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:cN},633:{T:1},634:{T:-1},635:{T:1,f:lN},636:{T:-1},637:{f:d8},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:pP},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:rP},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Ye(e,t,r,n){var i=t;if(!isNaN(i)){var a=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,i),s.write_shift(2,a),a>0&&Y2(r)&&e.push(r)}}function JP(e,t,r,n){var i=(r||[]).length||0;if(i<=8224)return Ye(e,t,r,i);var a=t;if(!isNaN(a)){for(var s=r.parts||[],o=0,l=0,u=0;u+(s[o]||8224)<=8224;)u+=s[o]||8224,o++;var f=e.next(4);for(f.write_shift(2,a),f.write_shift(2,u),e.push(r.slice(l,l+u)),l+=u;l<i;){for(f=e.next(4),f.write_shift(2,60),u=0;u+(s[o]||8224)<=8224;)u+=s[o]||8224,o++;f.write_shift(2,u),e.push(r.slice(l,l+u)),l+=u}}}function Hf(e,t,r){return e||(e=Pe(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function QP(e,t,r,n){var i=Pe(9);return Hf(i,e,t),Z_(r,n||"b",i),i}function ZP(e,t,r){var n=Pe(8+2*r.length);return Hf(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function e7(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?oi($n(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?Ye(e,2,pk(r,n,i)):Ye(e,3,dk(r,n,i));return;case"b":case"e":Ye(e,5,QP(r,n,t.v,t.t));return;case"s":case"str":Ye(e,4,ZP(r,n,(t.v||"").slice(0,255)));return}Ye(e,1,Hf(null,r,n))}function t7(e,t,r,n){var i=Array.isArray(t),a=mr(t["!ref"]||"A1"),s,o="",l=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),s=$r(a)}for(var u=a.s.r;u<=a.e.r;++u){o=_n(u);for(var f=a.s.c;f<=a.e.c;++f){u===a.s.r&&(l[f]=In(f)),s=l[f]+o;var d=i?(t[u]||[])[f]:t[s];d&&e7(e,d,u,f)}}}function r7(e,t){for(var r=t||{},n=si(),i=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(i=a);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Ye(n,r.biff==4?1033:r.biff==3?521:9,tm(e,16,r)),t7(n,e.Sheets[e.SheetNames[i]],i,r),Ye(n,10),n.end()}function n7(e,t,r){Ye(e,49,X8({sz:12,name:"Arial"},r))}function i7(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&Ye(e,1054,Z8(i,t[i],r))})}function a7(e,t){var r=Pe(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Ye(e,2151,r),r=Pe(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),r4(mr(t["!ref"]||"A1"),r),r.write_shift(4,4),Ye(e,2152,r)}function s7(e,t){for(var r=0;r<16;++r)Ye(e,224,J5({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Ye(e,224,J5(n,0,t))})}function o7(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Ye(e,440,ok(n)),n[1].Tooltip&&Ye(e,2048,lk(n))}delete t["!links"]}function l7(e,t){if(t){var r=0;t.forEach(function(n,i){++r<=256&&n&&Ye(e,125,fk(zd(i,n),i))})}}function u7(e,t,r,n,i){var a=16+go(i.cellXfs,t,i);if(t.v==null&&!t.bf){Ye(e,513,el(r,n,a));return}if(t.bf)Ye(e,6,FC(t,r,n,i,a));else switch(t.t){case"d":case"n":var s=t.t=="d"?oi($n(t.v)):t.v;Ye(e,515,nk(r,n,s,a));break;case"b":case"e":Ye(e,517,rk(r,n,t.v,a,i,t.t));break;case"s":case"str":if(i.bookSST){var o=sm(i.Strings,t.v,i.revStrings);Ye(e,253,J8(r,n,o,a))}else Ye(e,516,Q8(r,n,(t.v||"").slice(0,255),a,i));break;default:Ye(e,513,el(r,n,a))}}function c7(e,t,r){var n=si(),i=r.SheetNames[e],a=r.Sheets[i]||{},s=(r||{}).Workbook||{},o=(s.Sheets||[])[e]||{},l=Array.isArray(a),u=t.biff==8,f,d="",p=[],h=mr(a["!ref"]||"A1"),v=u?65536:16384;if(h.e.c>255||h.e.r>=v){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,v-1)}Ye(n,2057,tm(r,16,t)),Ye(n,13,Hi(1)),Ye(n,12,Hi(100)),Ye(n,15,Wn(!0)),Ye(n,17,Wn(!1)),Ye(n,16,Zo(.001)),Ye(n,95,Wn(!0)),Ye(n,42,Wn(!1)),Ye(n,43,Wn(!1)),Ye(n,130,Hi(1)),Ye(n,128,tk()),Ye(n,131,Wn(!1)),Ye(n,132,Wn(!1)),u&&l7(n,a["!cols"]),Ye(n,512,ek(h,t)),u&&(a["!links"]=[]);for(var m=h.s.r;m<=h.e.r;++m){d=_n(m);for(var S=h.s.c;S<=h.e.c;++S){m===h.s.r&&(p[S]=In(S)),f=p[S]+d;var y=l?(a[m]||[])[S]:a[f];y&&(u7(n,y,m,S,t),u&&y.l&&a["!links"].push([f,y.l]))}}var w=o.CodeName||o.name||i;return u&&Ye(n,574,Y8((s.Views||[])[0])),u&&(a["!merges"]||[]).length&&Ye(n,229,sk(a["!merges"])),u&&o7(n,a),Ye(n,442,t4(w)),u&&a7(n,a),Ye(n,10),n.end()}function f7(e,t,r){var n=si(),i=(e||{}).Workbook||{},a=i.Sheets||[],s=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(Ye(n,2057,tm(e,5,r)),r.bookType=="xla"&&Ye(n,135),Ye(n,225,o?Hi(1200):null),Ye(n,193,D8(2)),l&&Ye(n,191),l&&Ye(n,192),Ye(n,226),Ye(n,92,$8("SheetJS",r)),Ye(n,66,Hi(o?1200:1252)),o&&Ye(n,353,Hi(0)),o&&Ye(n,448),Ye(n,317,hk(e.SheetNames.length)),o&&e.vbaraw&&Ye(n,211),o&&e.vbaraw){var u=s.CodeName||"ThisWorkbook";Ye(n,442,t4(u))}Ye(n,156,Hi(17)),Ye(n,25,Wn(!1)),Ye(n,18,Wn(!1)),Ye(n,19,Hi(0)),o&&Ye(n,431,Wn(!1)),o&&Ye(n,444,Hi(0)),Ye(n,61,K8()),Ye(n,64,Wn(!1)),Ye(n,141,Hi(0)),Ye(n,34,Wn(mP(e)=="true")),Ye(n,14,Wn(!0)),o&&Ye(n,439,Wn(!1)),Ye(n,218,Hi(0)),n7(n,e,r),i7(n,e.SSF,r),s7(n,r),o&&Ye(n,352,Wn(!1));var f=n.end(),d=si();o&&Ye(d,140,uk()),o&&r.Strings&&JP(d,252,G8(r.Strings)),Ye(d,10);var p=d.end(),h=si(),v=0,m=0;for(m=0;m<e.SheetNames.length;++m)v+=(o?12:11)+(o?2:1)*e.SheetNames[m].length;var S=f.length+v+p.length;for(m=0;m<e.SheetNames.length;++m){var y=a[m]||{};Ye(h,133,V8({pos:S,hs:y.Hidden||0,dt:0,name:e.SheetNames[m]},r)),S+=t[m].length}var w=h.end();if(v!=w.length)throw new Error("BS8 "+v+" != "+w.length);var x=[];return f.length&&x.push(f),w.length&&x.push(w),p.length&&x.push(p),yn(x)}function h7(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=li(Cr)),e&&e.SSF&&(Dd(),Id(e.SSF),r.revssf=jd(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,om(r),r.cellXfs=[],go(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=c7(i,r,e);return n.unshift(f7(e,n,r)),yn(n)}function N4(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var i=Ni(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return h7(e,t);case 4:case 3:case 2:return r7(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function d7(e,t,r,n){for(var i=e["!merges"]||[],a=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,l=0,u=0;u<i.length;++u)if(!(i[u].s.r>r||i[u].s.c>s)&&!(i[u].e.r<r||i[u].e.c<s)){if(i[u].s.r<r||i[u].s.c<s){o=-1;break}o=i[u].e.r-i[u].s.r+1,l=i[u].e.c-i[u].s.c+1;break}if(!(o<0)){var f=er({r,c:s}),d=n.dense?(e[r]||[])[s]:e[f],p=d&&d.v!=null&&(d.h||qT(d.w||(gs(d),d.w)||""))||"",h={};o>1&&(h.rowspan=o),l>1&&(h.colspan=l),n.editable?p='<span contenteditable="true">'+p+"</span>":d&&(h["data-t"]=d&&d.t||"z",d.v!=null&&(h["data-v"]=d.v),d.z!=null&&(h["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+d.l.Target+'">'+p+"</a>")),h.id=(n.id||"sjs")+"-"+f,a.push(Ke("td",p,h))}}var v="<tr>";return v+a.join("")+"</tr>"}var p7='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',g7="</body></html>";function m7(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function C4(e,t){var r=t||{},n=r.header!=null?r.header:p7,i=r.footer!=null?r.footer:g7,a=[n],s=Ni(e["!ref"]);r.dense=Array.isArray(e),a.push(m7(e,s,r));for(var o=s.s.r;o<=s.e.r;++o)a.push(d7(e,s,o,r));return a.push("</table>"+i),a.join("")}function L4(e,t,r){var n=r||{},i=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var s=typeof n.origin=="string"?on(n.origin):n.origin;i=s.r,a=s.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:i,c:a}};if(e["!ref"]){var f=Ni(e["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),i==-1&&(u.e.r=i=f.e.r+1)}var d=[],p=0,h=e["!rows"]||(e["!rows"]=[]),v=0,m=0,S=0,y=0,w=0,x=0;for(e["!cols"]||(e["!cols"]=[]);v<o.length&&m<l;++v){var A=o[v];if(iy(A)){if(n.display)continue;h[m]={hidden:!0}}var R=A.children;for(S=y=0;S<R.length;++S){var B=R[S];if(!(n.display&&iy(B))){var T=B.hasAttribute("data-v")?B.getAttribute("data-v"):B.hasAttribute("v")?B.getAttribute("v"):KT(B.innerHTML),L=B.getAttribute("data-z")||B.getAttribute("z");for(p=0;p<d.length;++p){var P=d[p];P.s.c==y+a&&P.s.r<m+i&&m+i<=P.e.r&&(y=P.e.c+1-a,p=-1)}x=+B.getAttribute("colspan")||1,((w=+B.getAttribute("rowspan")||1)>1||x>1)&&d.push({s:{r:m+i,c:y+a},e:{r:m+i+(w||1)-1,c:y+a+(x||1)-1}});var M={t:"s",v:T},N=B.getAttribute("data-t")||B.getAttribute("t")||"";T!=null&&(T.length==0?M.t=N||"z":n.raw||T.trim().length==0||N=="s"||(T==="TRUE"?M={t:"b",v:!0}:T==="FALSE"?M={t:"b",v:!1}:isNaN(ls(T))?isNaN(Ef(T).getDate())||(M={t:"d",v:$n(T)},n.cellDates||(M={t:"n",v:oi(M.v)}),M.z=n.dateNF||Cr[14]):M={t:"n",v:ls(T)})),M.z===void 0&&L!=null&&(M.z=L);var C="",U=B.getElementsByTagName("A");if(U&&U.length)for(var Y=0;Y<U.length&&!(U[Y].hasAttribute("href")&&(C=U[Y].getAttribute("href"),C.charAt(0)!="#"));++Y);C&&C.charAt(0)!="#"&&(M.l={Target:C}),n.dense?(e[m+i]||(e[m+i]=[]),e[m+i][y+a]=M):e[er({c:y+a,r:m+i})]=M,u.e.c<y+a&&(u.e.c=y+a),y+=x}}++m}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),u.e.r=Math.max(u.e.r,m-1+i),e["!ref"]=$r(u),m>=l&&(e["!fullref"]=$r((u.e.r=o.length-v+m-1+i,u))),e}function P4(e,t){var r=t||{},n=r.dense?[]:{};return L4(n,e,t)}function v7(e,t){return nl(P4(e,t),t)}function iy(e){var t="",r=y7(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function y7(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var w7=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Tf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Vr+t}}(),ay=function(){var e=function(a){return Jt(a).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,s,o){var l=[];l.push('      <table:table table:name="'+Jt(s.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,f=0,d=Ni(a["!ref"]||"A1"),p=a["!merges"]||[],h=0,v=Array.isArray(a);if(a["!cols"])for(f=0;f<=d.e.c;++f)l.push("        <table:table-column"+(a["!cols"][f]?' table:style-name="co'+a["!cols"][f].ods+'"':"")+`></table:table-column>
`);var m="",S=a["!rows"]||[];for(u=0;u<d.s.r;++u)m=S[u]?' table:style-name="ro'+S[u].ods+'"':"",l.push("        <table:table-row"+m+`></table:table-row>
`);for(;u<=d.e.r;++u){for(m=S[u]?' table:style-name="ro'+S[u].ods+'"':"",l.push("        <table:table-row"+m+`>
`),f=0;f<d.s.c;++f)l.push(t);for(;f<=d.e.c;++f){var y=!1,w={},x="";for(h=0;h!=p.length;++h)if(!(p[h].s.c>f)&&!(p[h].s.r>u)&&!(p[h].e.c<f)&&!(p[h].e.r<u)){(p[h].s.c!=f||p[h].s.r!=u)&&(y=!0),w["table:number-columns-spanned"]=p[h].e.c-p[h].s.c+1,w["table:number-rows-spanned"]=p[h].e.r-p[h].s.r+1;break}if(y){l.push(r);continue}var A=er({r:u,c:f}),R=v?(a[u]||[])[f]:a[A];if(R&&R.f&&(w["table:formula"]=Jt(BC(R.f)),R.F&&R.F.slice(0,A.length)==A)){var B=Ni(R.F);w["table:number-matrix-columns-spanned"]=B.e.c-B.s.c+1,w["table:number-matrix-rows-spanned"]=B.e.r-B.s.r+1}if(!R){l.push(t);continue}switch(R.t){case"b":x=R.v?"TRUE":"FALSE",w["office:value-type"]="boolean",w["office:boolean-value"]=R.v?"true":"false";break;case"n":x=R.w||String(R.v||0),w["office:value-type"]="float",w["office:value"]=R.v||0;break;case"s":case"str":x=R.v==null?"":R.v,w["office:value-type"]="string";break;case"d":x=R.w||$n(R.v).toISOString(),w["office:value-type"]="date",w["office:date-value"]=$n(R.v).toISOString(),w["table:style-name"]="ce1";break;default:l.push(t);continue}var T=e(x);if(R.l&&R.l.Target){var L=R.l.Target;L=L.charAt(0)=="#"?"#"+UC(L.slice(1)):L,L.charAt(0)!="#"&&!L.match(/^\w+:/)&&(L="../"+L),T=Ke("text:a",T,{"xlink:href":L.replace(/&/g,"&amp;")})}l.push("          "+Ke("table:table-cell",Ke("text:p",T,{}),w)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(a,s){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var o=0;s.SheetNames.map(function(u){return s.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var f=0;f<u["!cols"].length;++f)if(u["!cols"][f]){var d=u["!cols"][f];if(d.width==null&&d.wpx==null&&d.wch==null)continue;rm(d),d.ods=o;var p=u["!cols"][f].wpx+"px";a.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),a.push(`  </style:style>
`),++o}}});var l=0;s.SheetNames.map(function(u){return s.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var f=0;f<u["!rows"].length;++f)if(u["!rows"][f]){u["!rows"][f].ods=l;var d=u["!rows"][f].hpx+"px";a.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+d+`"/>
`),a.push(`  </style:style>
`),++l}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(s,o){var l=[Vr],u=Tf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=Tf({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+u+f+`>
`),l.push(V_().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),i(l,s),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var d=0;d!=s.SheetNames.length;++d)l.push(n(s.Sheets[s.SheetNames[d]],s,d));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function O4(e,t){if(t.bookType=="fods")return ay(e,t);var r=$2(),n="",i=[],a=[];return n="mimetype",Pt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Pt(r,n,ay(e,t)),i.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",Pt(r,n,w7(e,t)),i.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",Pt(r,n,Vr+V_()),i.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",Pt(r,n,P8(a)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Pt(r,n,C8(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function fd(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function x7(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):ma(Af(e))}function _7(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function lo(e){var t=e.reduce(function(i,a){return i+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function S7(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var a=0;i>=1;++a,i/=256)e[t+a]=i&255;e[t+15]|=r>=0?0:128}function kf(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Yt(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function wu(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Jr(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=kf(e,r),a=i&7;i=Math.floor(i/8);var s=0,o;if(i==0)break;switch(a){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:s=4,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=kf(e,r),o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(n))}var u={data:o,type:a};t[i]==null?t[i]=[u]:t[i].push(u)}return t}function pn(e){var t=[];return e.forEach(function(r,n){r.forEach(function(i){i.data&&(t.push(Yt(n*8+i.type)),i.type==2&&t.push(Yt(i.data.length)),t.push(i.data))})}),lo(t)}function aa(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=kf(e,n),a=Jr(e.slice(n[0],n[0]+i));n[0]+=i;var s={id:wu(a[1][0].data),messages:[]};a[2].forEach(function(o){var l=Jr(o.data),u=wu(l[3][0].data);s.messages.push({meta:l,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=a[3])!=null&&t[0]&&(s.merge=wu(a[3][0].data)>>>0>0),r.push(s)}return r}function Bl(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Yt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Yt(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(s){i.push(s.data),s.meta[3]=[{type:0,data:Yt(s.data.length)}],n[2].push({data:pn(s.meta),type:2})});var a=pn(n);t.push(Yt(a.length)),t.push(a),i.forEach(function(s){return t.push(s)})}),lo(t)}function b7(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=kf(t,r),i=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var s=t[r[0]++]>>2;if(s<60)++s;else{var o=s-59;s=t[r[0]],o>1&&(s|=t[r[0]+1]<<8),o>2&&(s|=t[r[0]+2]<<16),o>3&&(s|=t[r[0]+3]<<24),s>>>=0,s++,r[0]+=o}i.push(t.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var l=0,u=0;if(a==1?(u=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,a==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[lo(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(i.push(i[0].slice(-l)),u-=l;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-l,-l+u))}}var f=lo(i);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function sa(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(b7(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return lo(t)}function Ul(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var a=Yt(n),s=a.length;t.push(a),n<=60?(s++,t.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),s+=n,i[0]=0,i[1]=s&255,i[2]=s>>8&255,i[3]=s>>16&255,r+=n}return lo(t)}function pp(e,t){var r=new Uint8Array(32),n=fd(r),i=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,S7(r,i,e.v),a|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),a|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(i,t.indexOf(e.v),!0),a|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,a,!0),r.slice(0,i)}function gp(e,t){var r=new Uint8Array(32),n=fd(r),i=12,a=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(i,e.v,!0),a|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,e.v?1:0,!0),a|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(i,t.indexOf(e.v),!0),a|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,a,!0),r.slice(0,i)}function Rs(e){var t=Jr(e);return kf(t[1][0].data)}function E7(e,t,r){var n,i,a,s;if(!((n=e[6])!=null&&n[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((s=(a=e[8])==null?void 0:a[0])==null?void 0:s.data)&&wu(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,u=fd(e[7][0].data),f=0,d=[],p=fd(e[4][0].data),h=0,v=[],m=0;m<t.length;++m){if(t[m]==null){u.setUint16(m*2,65535,!0),p.setUint16(m*2,65535);continue}u.setUint16(m*2,f,!0),p.setUint16(m*2,h,!0);var S,y;switch(typeof t[m]){case"string":S=pp({t:"s",v:t[m]},r),y=gp({t:"s",v:t[m]},r);break;case"number":S=pp({t:"n",v:t[m]},r),y=gp({t:"n",v:t[m]},r);break;case"boolean":S=pp({t:"b",v:t[m]},r),y=gp({t:"b",v:t[m]},r);break;default:throw new Error("Unsupported value "+t[m])}d.push(S),f+=S.length,v.push(y),h+=y.length,++l}for(e[2][0].data=Yt(l);m<e[7][0].data.length/2;++m)u.setUint16(m*2,65535,!0),p.setUint16(m*2,65535,!0);return e[6][0].data=lo(d),e[3][0].data=lo(v),l}function A7(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Ni(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat($r(n)));var a=hd(r,{range:n,header:1}),s=["~Sh33tJ5~"];a.forEach(function(O){return O.forEach(function(F){typeof F=="string"&&s.push(F)})});var o={},l=[],u=nr.read(t.numbers,{type:"base64"});u.FileIndex.map(function(O,F){return[O,u.FullPaths[F]]}).forEach(function(O){var F=O[0],I=O[1];if(F.type==2&&F.name.match(/\.iwa/)){var V=F.content,ue=sa(V),fe=aa(ue);fe.forEach(function(he){l.push(he.id),o[he.id]={deps:[],location:I,type:wu(he.messages[0].meta[1][0].data)}})}}),l.sort(function(O,F){return O-F});var f=l.filter(function(O){return O>1}).map(function(O){return[O,Yt(O)]});u.FileIndex.map(function(O,F){return[O,u.FullPaths[F]]}).forEach(function(O){var F=O[0];if(O[1],!!F.name.match(/\.iwa/)){var I=aa(sa(F.content));I.forEach(function(V){V.messages.forEach(function(ue){f.forEach(function(fe){V.messages.some(function(he){return wu(he.meta[1][0].data)!=11006&&_7(he.data,fe[1])})&&o[fe[0]].deps.push(V.id)})})})}});for(var d=nr.find(u,o[1].location),p=aa(sa(d.content)),h,v=0;v<p.length;++v){var m=p[v];m.id==1&&(h=m)}var S=Rs(Jr(h.messages[0].data)[1][0].data);for(d=nr.find(u,o[S].location),p=aa(sa(d.content)),v=0;v<p.length;++v)m=p[v],m.id==S&&(h=m);for(S=Rs(Jr(h.messages[0].data)[2][0].data),d=nr.find(u,o[S].location),p=aa(sa(d.content)),v=0;v<p.length;++v)m=p[v],m.id==S&&(h=m);for(S=Rs(Jr(h.messages[0].data)[2][0].data),d=nr.find(u,o[S].location),p=aa(sa(d.content)),v=0;v<p.length;++v)m=p[v],m.id==S&&(h=m);var y=Jr(h.messages[0].data);{y[6][0].data=Yt(n.e.r+1),y[7][0].data=Yt(n.e.c+1);var w=Rs(y[46][0].data),x=nr.find(u,o[w].location),A=aa(sa(x.content));{for(var R=0;R<A.length&&A[R].id!=w;++R);if(A[R].id!=w)throw"Bad ColumnRowUIDMapArchive";var B=Jr(A[R].messages[0].data);B[1]=[],B[2]=[],B[3]=[];for(var T=0;T<=n.e.c;++T){var L=[];L[1]=L[2]=[{type:0,data:Yt(T+420690)}],B[1].push({type:2,data:pn(L)}),B[2].push({type:0,data:Yt(T)}),B[3].push({type:0,data:Yt(T)})}B[4]=[],B[5]=[],B[6]=[];for(var P=0;P<=n.e.r;++P)L=[],L[1]=L[2]=[{type:0,data:Yt(P+726270)}],B[4].push({type:2,data:pn(L)}),B[5].push({type:0,data:Yt(P)}),B[6].push({type:0,data:Yt(P)});A[R].messages[0].data=pn(B)}x.content=Ul(Bl(A)),x.size=x.content.length,delete y[46];var M=Jr(y[4][0].data);{M[7][0].data=Yt(n.e.r+1);var N=Jr(M[1][0].data),C=Rs(N[2][0].data);x=nr.find(u,o[C].location),A=aa(sa(x.content));{if(A[0].id!=C)throw"Bad HeaderStorageBucket";var U=Jr(A[0].messages[0].data);for(P=0;P<a.length;++P){var Y=Jr(U[2][0].data);Y[1][0].data=Yt(P),Y[4][0].data=Yt(a[P].length),U[2][P]={type:U[2][0].type,data:pn(Y)}}A[0].messages[0].data=pn(U)}x.content=Ul(Bl(A)),x.size=x.content.length;var ce=Rs(M[2][0].data);x=nr.find(u,o[ce].location),A=aa(sa(x.content));{if(A[0].id!=ce)throw"Bad HeaderStorageBucket";for(U=Jr(A[0].messages[0].data),T=0;T<=n.e.c;++T)Y=Jr(U[2][0].data),Y[1][0].data=Yt(T),Y[4][0].data=Yt(n.e.r+1),U[2][T]={type:U[2][0].type,data:pn(Y)};A[0].messages[0].data=pn(U)}x.content=Ul(Bl(A)),x.size=x.content.length;var ee=Rs(M[4][0].data);(function(){for(var O=nr.find(u,o[ee].location),F=aa(sa(O.content)),I,V=0;V<F.length;++V){var ue=F[V];ue.id==ee&&(I=ue)}var fe=Jr(I.messages[0].data);{fe[3]=[];var he=[];s.forEach(function(De,qe){he[1]=[{type:0,data:Yt(qe)}],he[2]=[{type:0,data:Yt(1)}],he[3]=[{type:2,data:x7(De)}],fe[3].push({type:2,data:pn(he)})})}I.messages[0].data=pn(fe);var xe=Bl(F),Oe=Ul(xe);O.content=Oe,O.size=O.content.length})();var Q=Jr(M[3][0].data);{var X=Q[1][0];delete Q[2];var z=Jr(X.data);{var ae=Rs(z[2][0].data);(function(){for(var O=nr.find(u,o[ae].location),F=aa(sa(O.content)),I,V=0;V<F.length;++V){var ue=F[V];ue.id==ae&&(I=ue)}var fe=Jr(I.messages[0].data);{delete fe[6],delete Q[7];var he=new Uint8Array(fe[5][0].data);fe[5]=[];for(var xe=0,Oe=0;Oe<=n.e.r;++Oe){var De=Jr(he);xe+=E7(De,a[Oe],s),De[1][0].data=Yt(Oe),fe[5].push({data:pn(De),type:2})}fe[1]=[{type:0,data:Yt(n.e.c+1)}],fe[2]=[{type:0,data:Yt(n.e.r+1)}],fe[3]=[{type:0,data:Yt(xe)}],fe[4]=[{type:0,data:Yt(n.e.r+1)}]}I.messages[0].data=pn(fe);var qe=Bl(F),Xe=Ul(qe);O.content=Xe,O.size=O.content.length})()}X.data=pn(z)}M[3][0].data=pn(Q)}y[4][0].data=pn(M)}h.messages[0].data=pn(y);var me=Bl(p),E=Ul(me);return d.content=E,d.size=d.content.length,u}function T7(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function om(e){T7([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function k7(e,t){return t.bookType=="ods"?O4(e,t):t.bookType=="numbers"?A7(e,t):t.bookType=="xlsb"?N7(e,t):C7(e,t)}function N7(e,t){lu=1024,e&&!e.SSF&&(e.SSF=li(Cr)),e&&e.SSF&&(Dd(),Id(e.SSF),t.revssf=jd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,$c?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=p4.indexOf(t.bookType)>-1,i=W_();om(t=t||{});var a=$2(),s="",o=0;if(t.cellXfs=[],go(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Pt(a,s,G_(e.Props,t)),i.coreprops.push(s),Xt(t.rels,2,s,Ht.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,Pt(a,s,Y_(e.Props)),i.extprops.push(s),Xt(t.rels,3,s,Ht.EXT_PROPS),e.Custprops!==e.Props&&bn(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Pt(a,s,X_(e.Custprops)),i.custprops.push(s),Xt(t.rels,4,s,Ht.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},d=e.Sheets[e.SheetNames[o-1]],p=(d||{})["!type"]||"sheet";switch(p){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,Pt(a,s,PP(o-1,s,t,e,f)),i.sheets.push(s),Xt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Ht.WS[0])}if(d){var h=d["!comments"],v=!1,m="";h&&h.length>0&&(m="xl/comments"+o+"."+r,Pt(a,m,RP(h,m)),i.comments.push(m),Xt(f,-1,"../comments"+o+"."+r,Ht.CMNT),v=!0),d["!legacy"]&&v&&Pt(a,"xl/drawings/vmlDrawing"+o+".vml",h4(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}f["!id"].rId1&&Pt(a,$_(s),vu(f))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,Pt(a,s,FP(t.Strings,s,t)),i.strs.push(s),Xt(t.wbrels,-1,"sharedStrings."+r,Ht.SST)),s="xl/workbook."+r,Pt(a,s,LP(e,s)),i.workbooks.push(s),Xt(t.rels,1,s,Ht.WB),s="xl/theme/theme1.xml",Pt(a,s,c4(e.Themes,t)),i.themes.push(s),Xt(t.wbrels,-1,"theme/theme1.xml",Ht.THEME),s="xl/styles."+r,Pt(a,s,OP(e,s,t)),i.styles.push(s),Xt(t.wbrels,-1,"styles."+r,Ht.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",Pt(a,s,e.vbaraw),i.vba.push(s),Xt(t.wbrels,-1,"vbaProject.bin",Ht.VBA)),s="xl/metadata."+r,Pt(a,s,IP(s)),i.metadata.push(s),Xt(t.wbrels,-1,"metadata."+r,Ht.XLMETA),Pt(a,"[Content_Types].xml",q_(i,t)),Pt(a,"_rels/.rels",vu(t.rels)),Pt(a,"xl/_rels/workbook."+r+".rels",vu(t.wbrels)),delete t.revssf,delete t.ssf,a}function C7(e,t){lu=1024,e&&!e.SSF&&(e.SSF=li(Cr)),e&&e.SSF&&(Dd(),Id(e.SSF),t.revssf=jd(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,$c?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=p4.indexOf(t.bookType)>-1,i=W_();om(t=t||{});var a=$2(),s="",o=0;if(t.cellXfs=[],go(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Pt(a,s,G_(e.Props,t)),i.coreprops.push(s),Xt(t.rels,2,s,Ht.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,Pt(a,s,Y_(e.Props)),i.extprops.push(s),Xt(t.rels,3,s,Ht.EXT_PROPS),e.Custprops!==e.Props&&bn(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Pt(a,s,X_(e.Custprops)),i.custprops.push(s),Xt(t.rels,4,s,Ht.CUST_PROPS));var f=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},p=e.Sheets[e.SheetNames[o-1]],h=(p||{})["!type"]||"sheet";switch(h){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,Pt(a,s,b4(o-1,t,e,d)),i.sheets.push(s),Xt(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Ht.WS[0])}if(p){var v=p["!comments"],m=!1,S="";if(v&&v.length>0){var y=!1;v.forEach(function(w){w[1].forEach(function(x){x.T==!0&&(y=!0)})}),y&&(S="xl/threadedComments/threadedComment"+o+"."+r,Pt(a,S,sN(v,f,t)),i.threadedcomments.push(S),Xt(d,-1,"../threadedComments/threadedComment"+o+"."+r,Ht.TCMNT)),S="xl/comments"+o+"."+r,Pt(a,S,d4(v)),i.comments.push(S),Xt(d,-1,"../comments"+o+"."+r,Ht.CMNT),m=!0}p["!legacy"]&&m&&Pt(a,"xl/drawings/vmlDrawing"+o+".vml",h4(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}d["!id"].rId1&&Pt(a,$_(s),vu(d))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,Pt(a,s,i4(t.Strings,t)),i.strs.push(s),Xt(t.wbrels,-1,"sharedStrings."+r,Ht.SST)),s="xl/workbook."+r,Pt(a,s,T4(e)),i.workbooks.push(s),Xt(t.rels,1,s,Ht.WB),s="xl/theme/theme1.xml",Pt(a,s,c4(e.Themes,t)),i.themes.push(s),Xt(t.wbrels,-1,"theme/theme1.xml",Ht.THEME),s="xl/styles."+r,Pt(a,s,l4(e,t)),i.styles.push(s),Xt(t.wbrels,-1,"styles."+r,Ht.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",Pt(a,s,e.vbaraw),i.vba.push(s),Xt(t.wbrels,-1,"vbaProject.bin",Ht.VBA)),s="xl/metadata."+r,Pt(a,s,f4()),i.metadata.push(s),Xt(t.wbrels,-1,"metadata."+r,Ht.XLMETA),f.length>1&&(s="xl/persons/person.xml",Pt(a,s,oN(f)),i.people.push(s),Xt(t.wbrels,-1,"persons/person.xml",Ht.PEOPLE)),Pt(a,"[Content_Types].xml",q_(i,t)),Pt(a,"_rels/.rels",vu(t.rels)),Pt(a,"xl/_rels/workbook."+r+".rels",vu(t.wbrels)),delete t.revssf,delete t.ssf,a}function L7(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ps(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function F4(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Mf(t.file,nr.write(e,{type:qt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return nr.write(e,t)}function P7(e,t){var r=li(t||{}),n=k7(e,r);return O7(n,r)}function O7(e,t){var r={},n=qt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?nr.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(Rd(i))}return t.password&&typeof encrypt_agile<"u"?F4(encrypt_agile(i,t.password),t):t.type==="file"?Mf(t.file,i):t.type=="string"?zc(i):i}function F7(e,t){var r=t||{},n=YP(e,r);return F4(n,r)}function Fa(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return bf(Af(n));case"binary":return Af(n);case"string":return e;case"file":return Mf(t.file,n,"utf8");case"buffer":return qt?ys(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Fa(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function R7(e,t){switch(t.type){case"base64":return bf(e);case"binary":return e;case"string":return e;case"file":return Mf(t.file,e,"binary");case"buffer":return qt?ys(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function l0(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?bf(r):t.type=="string"?zc(r):r;case"file":return Mf(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function R4(e,t){lT(),wP(e);var r=li(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=R4(e,r);return r.type="array",Rd(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Fa(GP(e,r),r);case"slk":case"sylk":return Fa(mk.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return Fa(C4(e.Sheets[e.SheetNames[i]],r),r);case"txt":return R7(I4(e.Sheets[e.SheetNames[i]],r),r);case"csv":return Fa(lm(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return Fa(vk.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return l0(gk.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return Fa(yk.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return Fa(Ak.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return Fa(n4.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return Fa(O4(e,r),r);case"wk1":return l0(Q5.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return l0(Q5.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),l0(N4(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),F7(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return P7(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function I7(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function D7(e,t,r){var n={};return n.type="file",n.file=t,I7(n),R4(e,n)}function j7(e,t,r,n,i,a,s,o){var l=_n(r),u=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,p=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!s||e[r])for(var h=t.s.c;h<=t.e.c;++h){var v=s?e[r][h]:e[n[h]+l];if(v===void 0||v.t===void 0){if(u===void 0)continue;a[h]!=null&&(p[a[h]]=u);continue}var m=v.v;switch(v.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(a[h]!=null){if(m==null)if(v.t=="e"&&m===null)p[a[h]]=null;else if(u!==void 0)p[a[h]]=u;else if(f&&m===null)p[a[h]]=null;else continue;else p[a[h]]=f&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?m:gs(v,m,o);m!=null&&(d=!1)}}return{row:p,isempty:d}}function hd(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,a=[],s=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},f=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof f){case"string":l=mr(f);break;case"number":l=mr(e["!ref"]),l.s.r=f;break;default:l=f}n>0&&(i=0);var d=_n(l.s.r),p=[],h=[],v=0,m=0,S=Array.isArray(e),y=l.s.r,w=0,x={};S&&!e[y]&&(e[y]=[]);var A=u.skipHidden&&e["!cols"]||[],R=u.skipHidden&&e["!rows"]||[];for(w=l.s.c;w<=l.e.c;++w)if(!(A[w]||{}).hidden)switch(p[w]=In(w),r=S?e[y][w]:e[p[w]+d],n){case 1:a[w]=w-l.s.c;break;case 2:a[w]=p[w];break;case 3:a[w]=u.header[w-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=s=gs(r,null,u),m=x[s]||0,!m)x[s]=1;else{do o=s+"_"+m++;while(x[o]);x[s]=m,x[o]=1}a[w]=o}for(y=l.s.r+i;y<=l.e.r;++y)if(!(R[y]||{}).hidden){var B=j7(e,l,y,p,n,a,S,u);(B.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(h[v++]=B.row)}return h.length=v,h}var sy=/"/g;function M7(e,t,r,n,i,a,s,o){for(var l=!0,u=[],f="",d=_n(r),p=t.s.c;p<=t.e.c;++p)if(n[p]){var h=o.dense?(e[r]||[])[p]:e[n[p]+d];if(h==null)f="";else if(h.v!=null){l=!1,f=""+(o.rawNumbers&&h.t=="n"?h.v:gs(h,null,o));for(var v=0,m=0;v!==f.length;++v)if((m=f.charCodeAt(v))===i||m===a||m===34||o.forceQuotes){f='"'+f.replace(sy,'""')+'"';break}f=="ID"&&(f='"ID"')}else h.f!=null&&!h.F?(l=!1,f="="+h.f,f.indexOf(",")>=0&&(f='"'+f.replace(sy,'""')+'"')):f="";u.push(f)}return o.blankrows===!1&&l?null:u.join(s)}function lm(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=mr(e["!ref"]),a=n.FS!==void 0?n.FS:",",s=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),u=new RegExp((a=="|"?"\\|":a)+"+$"),f="",d=[];n.dense=Array.isArray(e);for(var p=n.skipHidden&&e["!cols"]||[],h=n.skipHidden&&e["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(p[v]||{}).hidden||(d[v]=In(v));for(var m=0,S=i.s.r;S<=i.e.r;++S)(h[S]||{}).hidden||(f=M7(e,i,S,d,s,l,a,n),f!=null&&(n.strip&&(f=f.replace(u,"")),(f||n.blankrows!==!1)&&r.push((m++?o:"")+f)));return delete n.dense,r.join("")}function I4(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=lm(e,t);return r}function B7(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=mr(e["!ref"]),a="",s=[],o,l=[],u=Array.isArray(e);for(o=i.s.c;o<=i.e.c;++o)s[o]=In(o);for(var f=i.s.r;f<=i.e.r;++f)for(a=_n(f),o=i.s.c;o<=i.e.c;++o)if(t=s[o]+a,r=u?(e[f]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function D4(e,t,r){var n=r||{},i=+!n.skipHeader,a=e||{},s=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?on(n.origin):n.origin;s=l.r,o=l.c}var u,f={s:{c:0,r:0},e:{c:o,r:s+t.length-1+i}};if(a["!ref"]){var d=mr(a["!ref"]);f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),s==-1&&(s=d.e.r+1,f.e.r=s+t.length-1+i)}else s==-1&&(s=0,f.e.r=t.length-1+i);var p=n.header||[],h=0;t.forEach(function(m,S){bn(m).forEach(function(y){(h=p.indexOf(y))==-1&&(p[h=p.length]=y);var w=m[y],x="z",A="",R=er({c:o+h,r:s+S+i});u=Nf(a,R),w&&typeof w=="object"&&!(w instanceof Date)?a[R]=w:(typeof w=="number"?x="n":typeof w=="boolean"?x="b":typeof w=="string"?x="s":w instanceof Date?(x="d",n.cellDates||(x="n",w=oi(w)),A=n.dateNF||Cr[14]):w===null&&n.nullError&&(x="e",w=0),u?(u.t=x,u.v=w,delete u.w,delete u.R,A&&(u.z=A)):a[R]=u={t:x,v:w},A&&(u.z=A))})}),f.e.c=Math.max(f.e.c,o+p.length-1);var v=_n(s);if(i)for(h=0;h<p.length;++h)a[In(h+o)+v]={t:"s",v:p[h]};return a["!ref"]=$r(f),a}function U7(e,t){return D4(null,e,t)}function Nf(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=on(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Nf(e,er(t)):Nf(e,er({r:t,c:r||0}))}function z7(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function H7(){return{SheetNames:[],Sheets:{}}}function W7(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);i=a&&+a[2]||0;var s=a&&a[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=s+i)!=-1;++i);}if(A4(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function q7(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=z7(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function $7(e,t){return e.z=t,e}function j4(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function V7(e,t,r){return j4(e,"#"+t,r)}function G7(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function K7(e,t,r,n){for(var i=typeof t!="string"?t:mr(t),a=typeof t=="string"?t:$r(t),s=i.s.r;s<=i.e.r;++s)for(var o=i.s.c;o<=i.e.c;++o){var l=Nf(e,s,o);l.t="n",l.F=a,delete l.v,s==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return e}var mp={encode_col:In,encode_row:_n,encode_cell:er,encode_range:$r,decode_col:J2,decode_row:X2,split_cell:l8,decode_cell:on,decode_range:Ni,format_cell:gs,sheet_add_aoa:j_,sheet_add_json:D4,sheet_add_dom:L4,aoa_to_sheet:Fu,json_to_sheet:U7,table_to_sheet:P4,table_to_book:v7,sheet_to_csv:lm,sheet_to_txt:I4,sheet_to_json:hd,sheet_to_html:C4,sheet_to_formulae:B7,sheet_to_row_object_array:hd,sheet_get_cell:Nf,book_new:H7,book_append_sheet:W7,book_set_sheet_visibility:q7,cell_set_number_format:$7,cell_set_hyperlink:j4,cell_set_internal_link:V7,cell_add_comment:G7,sheet_set_array_formula:K7,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Y7="modulepreload",X7=function(e){return"/CTCDailyHours/"+e},oy={},Fg=function(t,r,n){let i=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const s=document.querySelector("meta[property=csp-nonce]"),o=(s==null?void 0:s.nonce)||(s==null?void 0:s.getAttribute("nonce"));i=Promise.allSettled(r.map(l=>{if(l=X7(l),l in oy)return;oy[l]=!0;const u=l.endsWith(".css"),f=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${f}`))return;const d=document.createElement("link");if(d.rel=u?"stylesheet":Y7,u||(d.as="script"),d.crossOrigin="",d.href=l,o&&d.setAttribute("nonce",o),document.head.appendChild(d),u)return new Promise((p,h)=>{d.addEventListener("load",p),d.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${l}`)))})}))}function a(s){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=s,window.dispatchEvent(o),!o.defaultPrevented)throw s}return i.then(s=>{for(const o of s||[])o.status==="rejected"&&a(o.reason);return t().catch(a)})};function Qt(e){"@babel/helpers - typeof";return Qt=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qt(e)}var Rn=Uint8Array,Ai=Uint16Array,um=Int32Array,Hd=new Rn([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Wd=new Rn([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Rg=new Rn([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),M4=function(e,t){for(var r=new Ai(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var i=new um(r[30]),n=1;n<30;++n)for(var a=r[n];a<r[n+1];++a)i[a]=a-r[n]<<5|n;return{b:r,r:i}},B4=M4(Hd,2),U4=B4.b,Ig=B4.r;U4[28]=258,Ig[258]=28;var z4=M4(Wd,0),J7=z4.b,ly=z4.r,Dg=new Ai(32768);for(var pr=0;pr<32768;++pr){var Is=(pr&43690)>>1|(pr&21845)<<1;Is=(Is&52428)>>2|(Is&13107)<<2,Is=(Is&61680)>>4|(Is&3855)<<4,Dg[pr]=((Is&65280)>>8|(Is&255)<<8)>>1}var Ua=function(e,t,r){for(var n=e.length,i=0,a=new Ai(t);i<n;++i)e[i]&&++a[e[i]-1];var s=new Ai(t);for(i=1;i<t;++i)s[i]=s[i-1]+a[i-1]<<1;var o;if(r){o=new Ai(1<<t);var l=15-t;for(i=0;i<n;++i)if(e[i])for(var u=i<<4|e[i],f=t-e[i],d=s[e[i]-1]++<<f,p=d|(1<<f)-1;d<=p;++d)o[Dg[d]>>l]=u}else for(o=new Ai(n),i=0;i<n;++i)e[i]&&(o[i]=Dg[s[e[i]-1]++]>>15-e[i]);return o},uo=new Rn(288);for(var pr=0;pr<144;++pr)uo[pr]=8;for(var pr=144;pr<256;++pr)uo[pr]=9;for(var pr=256;pr<280;++pr)uo[pr]=7;for(var pr=280;pr<288;++pr)uo[pr]=8;var Cf=new Rn(32);for(var pr=0;pr<32;++pr)Cf[pr]=5;var Q7=Ua(uo,9,0),Z7=Ua(uo,9,1),eO=Ua(Cf,5,0),tO=Ua(Cf,5,1),vp=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},oa=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(t&7)&r},yp=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(t&7)},cm=function(e){return(e+7)/8|0},H4=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new Rn(e.subarray(t,r))},rO=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ha=function(e,t,r){var n=new Error(t||rO[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,ha),!r)throw n;return n},nO=function(e,t,r,n){var i=e.length,a=0;if(!i||t.f&&!t.l)return r||new Rn(0);var s=!r,o=s||t.i!=2,l=t.i;s&&(r=new Rn(i*3));var u=function(Oe){var De=r.length;if(Oe>De){var qe=new Rn(Math.max(De*2,Oe));qe.set(r),r=qe}},f=t.f||0,d=t.p||0,p=t.b||0,h=t.l,v=t.d,m=t.m,S=t.n,y=i*8;do{if(!h){f=oa(e,d,1);var w=oa(e,d+1,3);if(d+=3,w)if(w==1)h=Z7,v=tO,m=9,S=5;else if(w==2){var B=oa(e,d,31)+257,T=oa(e,d+10,15)+4,L=B+oa(e,d+5,31)+1;d+=14;for(var P=new Rn(L),M=new Rn(19),N=0;N<T;++N)M[Rg[N]]=oa(e,d+N*3,7);d+=T*3;for(var C=vp(M),U=(1<<C)-1,Y=Ua(M,C,1),N=0;N<L;){var ce=Y[oa(e,d,U)];d+=ce&15;var x=ce>>4;if(x<16)P[N++]=x;else{var ee=0,Q=0;for(x==16?(Q=3+oa(e,d,3),d+=2,ee=P[N-1]):x==17?(Q=3+oa(e,d,7),d+=3):x==18&&(Q=11+oa(e,d,127),d+=7);Q--;)P[N++]=ee}}var X=P.subarray(0,B),z=P.subarray(B);m=vp(X),S=vp(z),h=Ua(X,m,1),v=Ua(z,S,1)}else ha(1);else{var x=cm(d)+4,A=e[x-4]|e[x-3]<<8,R=x+A;if(R>i){l&&ha(0);break}o&&u(p+A),r.set(e.subarray(x,R),p),t.b=p+=A,t.p=d=R*8,t.f=f;continue}if(d>y){l&&ha(0);break}}o&&u(p+131072);for(var ae=(1<<m)-1,me=(1<<S)-1,E=d;;E=d){var ee=h[yp(e,d)&ae],O=ee>>4;if(d+=ee&15,d>y){l&&ha(0);break}if(ee||ha(2),O<256)r[p++]=O;else if(O==256){E=d,h=null;break}else{var F=O-254;if(O>264){var N=O-257,I=Hd[N];F=oa(e,d,(1<<I)-1)+U4[N],d+=I}var V=v[yp(e,d)&me],ue=V>>4;V||ha(3),d+=V&15;var z=J7[ue];if(ue>3){var I=Wd[ue];z+=yp(e,d)&(1<<I)-1,d+=I}if(d>y){l&&ha(0);break}o&&u(p+131072);var fe=p+F;if(p<z){var he=a-z,xe=Math.min(z,fe);for(he+p<0&&ha(3);p<xe;++p)r[p]=n[he+p]}for(;p<fe;++p)r[p]=r[p-z]}}t.l=h,t.p=E,t.b=p,t.f=f,h&&(f=1,t.m=m,t.d=v,t.n=S)}while(!f);return p!=r.length&&s?H4(r,0,p):r.subarray(0,p)},es=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},_c=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},wp=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var i=r.length,a=r.slice();if(!i)return{t:q4,l:0};if(i==1){var s=new Rn(r[0].s+1);return s[r[0].s]=1,{t:s,l:1}}r.sort(function(R,B){return R.f-B.f}),r.push({s:-1,f:25001});var o=r[0],l=r[1],u=0,f=1,d=2;for(r[0]={s:-1,f:o.f+l.f,l:o,r:l};f!=i-1;)o=r[r[u].f<r[d].f?u++:d++],l=r[u!=f&&r[u].f<r[d].f?u++:d++],r[f++]={s:-1,f:o.f+l.f,l:o,r:l};for(var p=a[0].s,n=1;n<i;++n)a[n].s>p&&(p=a[n].s);var h=new Ai(p+1),v=jg(r[f-1],h,0);if(v>t){var n=0,m=0,S=v-t,y=1<<S;for(a.sort(function(B,T){return h[T.s]-h[B.s]||B.f-T.f});n<i;++n){var w=a[n].s;if(h[w]>t)m+=y-(1<<v-h[w]),h[w]=t;else break}for(m>>=S;m>0;){var x=a[n].s;h[x]<t?m-=1<<t-h[x]++-1:++n}for(;n>=0&&m;--n){var A=a[n].s;h[A]==t&&(--h[A],++m)}v=t}return{t:new Rn(h),l:v}},jg=function(e,t,r){return e.s==-1?Math.max(jg(e.l,t,r+1),jg(e.r,t,r+1)):t[e.s]=r},uy=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new Ai(++t),n=0,i=e[0],a=1,s=function(l){r[n++]=l},o=1;o<=t;++o)if(e[o]==i&&o!=t)++a;else{if(!i&&a>2){for(;a>138;a-=138)s(32754);a>2&&(s(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(s(i),--a;a>6;a-=6)s(8304);a>2&&(s(a-3<<5|8208),a=0)}for(;a--;)s(i);a=1,i=e[o]}return{c:r.subarray(0,n),n:t}},Sc=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},W4=function(e,t,r){var n=r.length,i=cm(t+2);e[i]=n&255,e[i+1]=n>>8,e[i+2]=e[i]^255,e[i+3]=e[i+1]^255;for(var a=0;a<n;++a)e[i+a+4]=r[a];return(i+4+n)*8},cy=function(e,t,r,n,i,a,s,o,l,u,f){es(t,f++,r),++i[256];for(var d=wp(i,15),p=d.t,h=d.l,v=wp(a,15),m=v.t,S=v.l,y=uy(p),w=y.c,x=y.n,A=uy(m),R=A.c,B=A.n,T=new Ai(19),L=0;L<w.length;++L)++T[w[L]&31];for(var L=0;L<R.length;++L)++T[R[L]&31];for(var P=wp(T,7),M=P.t,N=P.l,C=19;C>4&&!M[Rg[C-1]];--C);var U=u+5<<3,Y=Sc(i,uo)+Sc(a,Cf)+s,ce=Sc(i,p)+Sc(a,m)+s+14+3*C+Sc(T,M)+2*T[16]+3*T[17]+7*T[18];if(l>=0&&U<=Y&&U<=ce)return W4(t,f,e.subarray(l,l+u));var ee,Q,X,z;if(es(t,f,1+(ce<Y)),f+=2,ce<Y){ee=Ua(p,h,0),Q=p,X=Ua(m,S,0),z=m;var ae=Ua(M,N,0);es(t,f,x-257),es(t,f+5,B-1),es(t,f+10,C-4),f+=14;for(var L=0;L<C;++L)es(t,f+3*L,M[Rg[L]]);f+=3*C;for(var me=[w,R],E=0;E<2;++E)for(var O=me[E],L=0;L<O.length;++L){var F=O[L]&31;es(t,f,ae[F]),f+=M[F],F>15&&(es(t,f,O[L]>>5&127),f+=O[L]>>12)}}else ee=Q7,Q=uo,X=eO,z=Cf;for(var L=0;L<o;++L){var I=n[L];if(I>255){var F=I>>18&31;_c(t,f,ee[F+257]),f+=Q[F+257],F>7&&(es(t,f,I>>23&31),f+=Hd[F]);var V=I&31;_c(t,f,X[V]),f+=z[V],V>3&&(_c(t,f,I>>5&8191),f+=Wd[V])}else _c(t,f,ee[I]),f+=Q[I]}return _c(t,f,ee[256]),f+Q[256]},iO=new um([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),q4=new Rn(0),aO=function(e,t,r,n,i,a){var s=a.z||e.length,o=new Rn(n+s+5*(1+Math.ceil(s/7e3))+i),l=o.subarray(n,o.length-i),u=a.l,f=(a.r||0)&7;if(t){f&&(l[0]=a.r>>3);for(var d=iO[t-1],p=d>>13,h=d&8191,v=(1<<r)-1,m=a.p||new Ai(32768),S=a.h||new Ai(v+1),y=Math.ceil(r/3),w=2*y,x=function(Xe){return(e[Xe]^e[Xe+1]<<y^e[Xe+2]<<w)&v},A=new um(25e3),R=new Ai(288),B=new Ai(32),T=0,L=0,P=a.i||0,M=0,N=a.w||0,C=0;P+2<s;++P){var U=x(P),Y=P&32767,ce=S[U];if(m[Y]=ce,S[U]=Y,N<=P){var ee=s-P;if((T>7e3||M>24576)&&(ee>423||!u)){f=cy(e,l,0,A,R,B,L,M,C,P-C,f),M=T=L=0,C=P;for(var Q=0;Q<286;++Q)R[Q]=0;for(var Q=0;Q<30;++Q)B[Q]=0}var X=2,z=0,ae=h,me=Y-ce&32767;if(ee>2&&U==x(P-me))for(var E=Math.min(p,ee)-1,O=Math.min(32767,P),F=Math.min(258,ee);me<=O&&--ae&&Y!=ce;){if(e[P+X]==e[P+X-me]){for(var I=0;I<F&&e[P+I]==e[P+I-me];++I);if(I>X){if(X=I,z=me,I>E)break;for(var V=Math.min(me,I-2),ue=0,Q=0;Q<V;++Q){var fe=P-me+Q&32767,he=m[fe],xe=fe-he&32767;xe>ue&&(ue=xe,ce=fe)}}}Y=ce,ce=m[Y],me+=Y-ce&32767}if(z){A[M++]=268435456|Ig[X]<<18|ly[z];var Oe=Ig[X]&31,De=ly[z]&31;L+=Hd[Oe]+Wd[De],++R[257+Oe],++B[De],N=P+X,++T}else A[M++]=e[P],++R[e[P]]}}for(P=Math.max(P,N);P<s;++P)A[M++]=e[P],++R[e[P]];f=cy(e,l,u,A,R,B,L,M,C,P-C,f),u||(a.r=f&7|l[f/8|0]<<3,f-=7,a.h=S,a.p=m,a.i=P,a.w=N)}else{for(var P=a.w||0;P<s+u;P+=65535){var qe=P+65535;qe>=s&&(l[f/8|0]=u,qe=s),f=W4(l,f+1,e.subarray(P,qe))}a.i=s}return H4(o,0,n+cm(f)+i)},$4=function(){var e=1,t=0;return{p:function(r){for(var n=e,i=t,a=r.length|0,s=0;s!=a;){for(var o=Math.min(s+2655,a);s<o;++s)i+=n+=r[s];n=(n&65535)+15*(n>>16),i=(i&65535)+15*(i>>16)}e=n,t=i},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},sO=function(e,t,r,n,i){if(!i&&(i={l:1},t.dictionary)){var a=t.dictionary.subarray(-32768),s=new Rn(a.length+e.length);s.set(a),s.set(e,a.length),e=s,i.w=a.length}return aO(e,t.level==null?6:t.level,t.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,i)},V4=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},oO=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var i=$4();i.p(t.dictionary),V4(e,2,i.d())}},lO=function(e,t){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&ha(6,"invalid zlib data"),(e[1]>>5&1)==1&&ha(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function Mg(e,t){t||(t={});var r=$4();r.p(e);var n=sO(e,t,t.dictionary?6:2,4);return oO(n,t),V4(n,n.length-4,r.d()),n}function uO(e,t){return nO(e.subarray(lO(e),-4),{i:2},t,t)}var cO=typeof TextDecoder<"u"&&new TextDecoder,fO=0;try{cO.decode(q4,{stream:!0}),fO=1}catch{}var xt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function xp(){xt.console&&typeof xt.console.log=="function"&&xt.console.log.apply(xt.console,arguments)}var sr={log:xp,warn:function(e){xt.console&&(typeof xt.console.warn=="function"?xt.console.warn.apply(xt.console,arguments):xp.call(null,arguments))},error:function(e){xt.console&&(typeof xt.console.error=="function"?xt.console.error.apply(xt.console,arguments):xp(e))}};function _p(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){Po(n.response,t,r)},n.onerror=function(){sr.error("could not download file")},n.send()}function fy(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function u0(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var Vc,Bg,Po=xt.saveAs||((typeof window>"u"?"undefined":Qt(window))!=="object"||window!==xt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=xt.URL||xt.webkitURL,i=document.createElement("a");t=t||e.name||"download",i.download=t,i.rel="noopener",typeof e=="string"?(i.href=e,i.origin!==location.origin?fy(i.href)?_p(e,t,r):u0(i,i.target="_blank"):u0(i)):(i.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(i.href)},4e4),setTimeout(function(){u0(i)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(fy(e))_p(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){u0(n)})}else navigator.msSaveOrOpenBlob(function(i,a){return a===void 0?a={autoBom:!1}:Qt(a)!=="object"&&(sr.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return _p(e,t,r);var i=e.type==="application/octet-stream",a=/constructor/i.test(xt.HTMLElement)||xt.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||i&&a)&&(typeof FileReader>"u"?"undefined":Qt(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var f=o.result;f=s?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=f:location=f,n=null},o.readAsDataURL(e)}else{var l=xt.URL||xt.webkitURL,u=l.createObjectURL(e);n?n.location=u:location.href=u,n=null,setTimeout(function(){l.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function G4(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<r.length;n++){var i=r[n].re,a=r[n].process,s=i.exec(e);s&&(t=a(s),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),l=this.g.toString(16),u=this.b.toString(16);return o.length==1&&(o="0"+o),l.length==1&&(l="0"+l),u.length==1&&(u="0"+u),"#"+o+l+u}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Sp(e,t){var r=e[0],n=e[1],i=e[2],a=e[3];r=Cn(r,n,i,a,t[0],7,-680876936),a=Cn(a,r,n,i,t[1],12,-389564586),i=Cn(i,a,r,n,t[2],17,606105819),n=Cn(n,i,a,r,t[3],22,-1044525330),r=Cn(r,n,i,a,t[4],7,-176418897),a=Cn(a,r,n,i,t[5],12,1200080426),i=Cn(i,a,r,n,t[6],17,-1473231341),n=Cn(n,i,a,r,t[7],22,-45705983),r=Cn(r,n,i,a,t[8],7,1770035416),a=Cn(a,r,n,i,t[9],12,-1958414417),i=Cn(i,a,r,n,t[10],17,-42063),n=Cn(n,i,a,r,t[11],22,-1990404162),r=Cn(r,n,i,a,t[12],7,1804603682),a=Cn(a,r,n,i,t[13],12,-40341101),i=Cn(i,a,r,n,t[14],17,-1502002290),r=Ln(r,n=Cn(n,i,a,r,t[15],22,1236535329),i,a,t[1],5,-165796510),a=Ln(a,r,n,i,t[6],9,-1069501632),i=Ln(i,a,r,n,t[11],14,643717713),n=Ln(n,i,a,r,t[0],20,-373897302),r=Ln(r,n,i,a,t[5],5,-701558691),a=Ln(a,r,n,i,t[10],9,38016083),i=Ln(i,a,r,n,t[15],14,-660478335),n=Ln(n,i,a,r,t[4],20,-405537848),r=Ln(r,n,i,a,t[9],5,568446438),a=Ln(a,r,n,i,t[14],9,-1019803690),i=Ln(i,a,r,n,t[3],14,-187363961),n=Ln(n,i,a,r,t[8],20,1163531501),r=Ln(r,n,i,a,t[13],5,-1444681467),a=Ln(a,r,n,i,t[2],9,-51403784),i=Ln(i,a,r,n,t[7],14,1735328473),r=Pn(r,n=Ln(n,i,a,r,t[12],20,-1926607734),i,a,t[5],4,-378558),a=Pn(a,r,n,i,t[8],11,-2022574463),i=Pn(i,a,r,n,t[11],16,1839030562),n=Pn(n,i,a,r,t[14],23,-35309556),r=Pn(r,n,i,a,t[1],4,-1530992060),a=Pn(a,r,n,i,t[4],11,1272893353),i=Pn(i,a,r,n,t[7],16,-155497632),n=Pn(n,i,a,r,t[10],23,-1094730640),r=Pn(r,n,i,a,t[13],4,681279174),a=Pn(a,r,n,i,t[0],11,-358537222),i=Pn(i,a,r,n,t[3],16,-722521979),n=Pn(n,i,a,r,t[6],23,76029189),r=Pn(r,n,i,a,t[9],4,-640364487),a=Pn(a,r,n,i,t[12],11,-421815835),i=Pn(i,a,r,n,t[15],16,530742520),r=On(r,n=Pn(n,i,a,r,t[2],23,-995338651),i,a,t[0],6,-198630844),a=On(a,r,n,i,t[7],10,1126891415),i=On(i,a,r,n,t[14],15,-1416354905),n=On(n,i,a,r,t[5],21,-57434055),r=On(r,n,i,a,t[12],6,1700485571),a=On(a,r,n,i,t[3],10,-1894986606),i=On(i,a,r,n,t[10],15,-1051523),n=On(n,i,a,r,t[1],21,-2054922799),r=On(r,n,i,a,t[8],6,1873313359),a=On(a,r,n,i,t[15],10,-30611744),i=On(i,a,r,n,t[6],15,-1560198380),n=On(n,i,a,r,t[13],21,1309151649),r=On(r,n,i,a,t[4],6,-145523070),a=On(a,r,n,i,t[11],10,-1120210379),i=On(i,a,r,n,t[2],15,718787259),n=On(n,i,a,r,t[9],21,-343485551),e[0]=Ks(r,e[0]),e[1]=Ks(n,e[1]),e[2]=Ks(i,e[2]),e[3]=Ks(a,e[3])}function qd(e,t,r,n,i,a){return t=Ks(Ks(t,e),Ks(n,a)),Ks(t<<i|t>>>32-i,r)}function Cn(e,t,r,n,i,a,s){return qd(t&r|~t&n,e,t,i,a,s)}function Ln(e,t,r,n,i,a,s){return qd(t&n|r&~n,e,t,i,a,s)}function Pn(e,t,r,n,i,a,s){return qd(t^r^n,e,t,i,a,s)}function On(e,t,r,n,i,a,s){return qd(r^(t|~n),e,t,i,a,s)}function K4(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)Sp(n,hO(e.substring(t-64,t)));e=e.substring(t-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)i[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(i[t>>2]|=128<<(t%4<<3),t>55)for(Sp(n,i),t=0;t<16;t++)i[t]=0;return i[14]=8*r,Sp(n,i),n}function hO(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}Vc=xt.atob.bind(xt),Bg=xt.btoa.bind(xt);var hy="0123456789abcdef".split("");function dO(e){for(var t="",r=0;r<4;r++)t+=hy[e>>8*r+4&15]+hy[e>>8*r&15];return t}function pO(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function Ug(e){return K4(e).map(pO).join("")}var gO=function(e){for(var t=0;t<e.length;t++)e[t]=dO(e[t]);return e.join("")}(K4("hello"))!="5d41402abc4b2a76b9719d911017c592";function Ks(e,t){if(gO){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function zg(e,t){var r,n,i,a;if(e!==r){for(var s=(i=e,a=1+(256/e.length>>0),new Array(a+1).join(i)),o=[],l=0;l<256;l++)o[l]=l;var u=0;for(l=0;l<256;l++){var f=o[l];u=(u+f+s.charCodeAt(l))%256,o[l]=o[u],o[u]=f}r=e,n=o}else o=n;var d=t.length,p=0,h=0,v="";for(l=0;l<d;l++)h=(h+(f=o[p=(p+1)%256]))%256,o[p]=o[h],o[h]=f,s=o[(o[p]+o[h])%256],v+=String.fromCharCode(t.charCodeAt(l)^s);return v}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var dy={print:4,modify:8,copy:16,"annot-forms":32};function Gl(e,t,r,n){this.v=1,this.r=2;var i=192;e.forEach(function(o){if(dy.perm!==void 0)throw new Error("Invalid permission: "+o);i+=dy[o]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var a=(t+this.padding).substr(0,32),s=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(a,s),this.P=-(1+(255^i)),this.encryptionKey=Ug(a+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=zg(this.encryptionKey,this.padding)}function Kl(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var i=e.charCodeAt(n);i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?t+="#"+("0"+i.toString(16)).slice(-2):t+=e[n]}return t}function py(e){if(Qt(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,i){if(i=i||!1,typeof r!="string"||typeof n!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var a=Math.random().toString(35);return t[r][a]=[n,!!i],a},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),i=[];for(var a in t[r]){var s=t[r][a];try{s[0].apply(e,n)}catch(o){xt.console&&sr.error("jsPDF PubSub Error",o.message,o)}s[1]&&i.push(a)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function Lf(e){if(!(this instanceof Lf))return new Lf(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function Y4(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function Ws(e,t,r,n,i){if(!(this instanceof Ws))return new Ws(e,t,r,n,i);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,Y4.call(this,n,i)}function Bo(e,t,r,n,i){if(!(this instanceof Bo))return new Bo(e,t,r,n,i);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,Y4.call(this,n,i)}function mt(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],i=arguments[2],a=arguments[3],s=[],o=1,l=16,u="S",f=null;Qt(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,i=e.format||i,a=e.compress||e.compressPdf||a,(f=e.encryption||null)!==null&&(f.userPassword=f.userPassword||"",f.ownerPassword=f.ownerPassword||"",f.userPermissions=f.userPermissions||[]),o=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(l=e.floatPrecision),u=e.defaultPathOperation||"S"),s=e.filters||(a===!0?["FlateEncode"]:s),n=n||"mm",r=(""+(r||"P")).toLowerCase();var d=e.putOnlyUsedFonts||!1,p={},h={internal:{},__private__:{}};h.__private__.PubSub=py;var v="1.3",m=h.__private__.getPdfVersion=function(){return v};h.__private__.setPdfVersion=function(_){v=_};var S={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return S};var y=h.__private__.getPageFormat=function(_){return S[_]};i=i||"a4";var w={COMPAT:"compat",ADVANCED:"advanced"},x=w.COMPAT;function A(){this.saveGraphicsState(),le(new pt(tt,0,0,-tt,0,_s()*tt).toString()+" cm"),this.setFontSize(this.getFontSize()/tt),u="n",x=w.ADVANCED}function R(){this.restoreGraphicsState(),u="S",x=w.COMPAT}var B=h.__private__.combineFontStyleAndFontWeight=function(_,j){if(_=="bold"&&j=="normal"||_=="bold"&&j==400||_=="normal"&&j=="italic"||_=="bold"&&j=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return j&&(_=j==400||j==="normal"?_==="italic"?"italic":"normal":j!=700&&j!=="bold"||_!=="normal"?(j==700?"bold":j)+""+_:"bold"),_};h.advancedAPI=function(_){var j=x===w.COMPAT;return j&&A.call(this),typeof _!="function"||(_(this),j&&R.call(this)),this},h.compatAPI=function(_){var j=x===w.ADVANCED;return j&&R.call(this),typeof _!="function"||(_(this),j&&A.call(this)),this},h.isAdvancedAPI=function(){return x===w.ADVANCED};var T,L=function(_){if(x!==w.ADVANCED)throw new Error(_+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},P=h.roundToPrecision=h.__private__.roundToPrecision=function(_,j){var oe=t||j;if(isNaN(_)||isNaN(oe))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return _.toFixed(oe).replace(/0+$/,"")};T=h.hpf=h.__private__.hpf=typeof l=="number"?function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.hpf");return P(_,l)}:l==="smart"?function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.hpf");return P(_,_>-1&&_<1?16:5)}:function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.hpf");return P(_,16)};var M=h.f2=h.__private__.f2=function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.f2");return P(_,2)},N=h.__private__.f3=function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.f3");return P(_,3)},C=h.scale=h.__private__.scale=function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.scale");return x===w.COMPAT?_*tt:x===w.ADVANCED?_:void 0},U=function(_){return x===w.COMPAT?_s()-_:x===w.ADVANCED?_:void 0},Y=function(_){return C(U(_))};h.__private__.setPrecision=h.setPrecision=function(_){typeof parseInt(_,10)=="number"&&(t=parseInt(_,10))};var ce,ee="00000000000000000000000000000000",Q=h.__private__.getFileId=function(){return ee},X=h.__private__.setFileId=function(_){return ee=_!==void 0&&/^[a-fA-F0-9]{32}$/.test(_)?_.toUpperCase():ee.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),f!==null&&(An=new Gl(f.userPermissions,f.userPassword,f.ownerPassword,ee)),ee};h.setFileId=function(_){return X(_),this},h.getFileId=function(){return Q()};var z=h.__private__.convertDateToPDFDate=function(_){var j=_.getTimezoneOffset(),oe=j<0?"+":"-",de=Math.floor(Math.abs(j/60)),we=Math.abs(j%60),Le=[oe,F(de),"'",F(we),"'"].join("");return["D:",_.getFullYear(),F(_.getMonth()+1),F(_.getDate()),F(_.getHours()),F(_.getMinutes()),F(_.getSeconds()),Le].join("")},ae=h.__private__.convertPDFDateToDate=function(_){var j=parseInt(_.substr(2,4),10),oe=parseInt(_.substr(6,2),10)-1,de=parseInt(_.substr(8,2),10),we=parseInt(_.substr(10,2),10),Le=parseInt(_.substr(12,2),10),ze=parseInt(_.substr(14,2),10);return new Date(j,oe,de,we,Le,ze,0)},me=h.__private__.setCreationDate=function(_){var j;if(_===void 0&&(_=new Date),_ instanceof Date)j=z(_);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(_))throw new Error("Invalid argument passed to jsPDF.setCreationDate");j=_}return ce=j},E=h.__private__.getCreationDate=function(_){var j=ce;return _==="jsDate"&&(j=ae(ce)),j};h.setCreationDate=function(_){return me(_),this},h.getCreationDate=function(_){return E(_)};var O,F=h.__private__.padd2=function(_){return("0"+parseInt(_)).slice(-2)},I=h.__private__.padd2Hex=function(_){return("00"+(_=_.toString())).substr(_.length)},V=0,ue=[],fe=[],he=0,xe=[],Oe=[],De=!1,qe=fe,Xe=function(){V=0,he=0,fe=[],ue=[],xe=[],J=Sr(),te=Sr()};h.__private__.setCustomOutputDestination=function(_){De=!0,qe=_};var ke=function(_){De||(qe=_)};h.__private__.resetCustomOutputDestination=function(){De=!1,qe=fe};var le=h.__private__.out=function(_){return _=_.toString(),he+=_.length+1,qe.push(_),qe},je=h.__private__.write=function(_){return le(arguments.length===1?_.toString():Array.prototype.join.call(arguments," "))},it=h.__private__.getArrayBuffer=function(_){for(var j=_.length,oe=new ArrayBuffer(j),de=new Uint8Array(oe);j--;)de[j]=_.charCodeAt(j);return oe},Ue=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return Ue};var Ve=e.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(_){return Ve=x===w.ADVANCED?_/tt:_,this};var Je,Ze=h.__private__.getFontSize=h.getFontSize=function(){return x===w.COMPAT?Ve:Ve*tt},ct=e.R2L||!1;h.__private__.setR2L=h.setR2L=function(_){return ct=_,this},h.__private__.getR2L=h.getR2L=function(){return ct};var ht,St=h.__private__.setZoomMode=function(_){var j=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(_))Je=_;else if(isNaN(_)){if(j.indexOf(_)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+_+'" is not recognized.');Je=_}else Je=parseInt(_,10)};h.__private__.getZoomMode=function(){return Je};var Nt,Ot=h.__private__.setPageMode=function(_){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(_)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+_+'" is not recognized.');ht=_};h.__private__.getPageMode=function(){return ht};var Rt=h.__private__.setLayoutMode=function(_){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(_)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+_+'" is not recognized.');Nt=_};h.__private__.getLayoutMode=function(){return Nt},h.__private__.setDisplayMode=h.setDisplayMode=function(_,j,oe){return St(_),Rt(j),Ot(oe),this};var wt={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(_){if(Object.keys(wt).indexOf(_)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return wt[_]},h.__private__.getDocumentProperties=function(){return wt},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(_){for(var j in wt)wt.hasOwnProperty(j)&&_[j]&&(wt[j]=_[j]);return this},h.__private__.setDocumentProperty=function(_,j){if(Object.keys(wt).indexOf(_)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return wt[_]=j};var Lt,tt,Gr,Dt,Kn,$t={},or={},Pi=[],Mt={},Ea={},hr={},ci={},Xi=null,ir=0,bt=[],zt=new py(h),Wa=e.hotfixes||[],Kr={},Oi={},Fi=[],pt=function _(j,oe,de,we,Le,ze){if(!(this instanceof _))return new _(j,oe,de,we,Le,ze);isNaN(j)&&(j=1),isNaN(oe)&&(oe=0),isNaN(de)&&(de=0),isNaN(we)&&(we=1),isNaN(Le)&&(Le=0),isNaN(ze)&&(ze=0),this._matrix=[j,oe,de,we,Le,ze]};Object.defineProperty(pt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(_){this._matrix[0]=_}}),Object.defineProperty(pt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(_){this._matrix[1]=_}}),Object.defineProperty(pt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(_){this._matrix[2]=_}}),Object.defineProperty(pt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(_){this._matrix[3]=_}}),Object.defineProperty(pt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(_){this._matrix[4]=_}}),Object.defineProperty(pt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(_){this._matrix[5]=_}}),Object.defineProperty(pt.prototype,"a",{get:function(){return this._matrix[0]},set:function(_){this._matrix[0]=_}}),Object.defineProperty(pt.prototype,"b",{get:function(){return this._matrix[1]},set:function(_){this._matrix[1]=_}}),Object.defineProperty(pt.prototype,"c",{get:function(){return this._matrix[2]},set:function(_){this._matrix[2]=_}}),Object.defineProperty(pt.prototype,"d",{get:function(){return this._matrix[3]},set:function(_){this._matrix[3]=_}}),Object.defineProperty(pt.prototype,"e",{get:function(){return this._matrix[4]},set:function(_){this._matrix[4]=_}}),Object.defineProperty(pt.prototype,"f",{get:function(){return this._matrix[5]},set:function(_){this._matrix[5]=_}}),Object.defineProperty(pt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(pt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(pt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(pt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),pt.prototype.join=function(_){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(T).join(_)},pt.prototype.multiply=function(_){var j=_.sx*this.sx+_.shy*this.shx,oe=_.sx*this.shy+_.shy*this.sy,de=_.shx*this.sx+_.sy*this.shx,we=_.shx*this.shy+_.sy*this.sy,Le=_.tx*this.sx+_.ty*this.shx+this.tx,ze=_.tx*this.shy+_.ty*this.sy+this.ty;return new pt(j,oe,de,we,Le,ze)},pt.prototype.decompose=function(){var _=this.sx,j=this.shy,oe=this.shx,de=this.sy,we=this.tx,Le=this.ty,ze=Math.sqrt(_*_+j*j),at=(_/=ze)*oe+(j/=ze)*de;oe-=_*at,de-=j*at;var dt=Math.sqrt(oe*oe+de*de);return at/=dt,_*(de/=dt)<j*(oe/=dt)&&(_=-_,j=-j,at=-at,ze=-ze),{scale:new pt(ze,0,0,dt,0,0),translate:new pt(1,0,0,1,we,Le),rotate:new pt(_,j,-j,_,0,0),skew:new pt(1,0,at,1,0,0)}},pt.prototype.toString=function(_){return this.join(" ")},pt.prototype.inversed=function(){var _=this.sx,j=this.shy,oe=this.shx,de=this.sy,we=this.tx,Le=this.ty,ze=1/(_*de-j*oe),at=de*ze,dt=-j*ze,kt=-oe*ze,At=_*ze;return new pt(at,dt,kt,At,-at*we-kt*Le,-dt*we-At*Le)},pt.prototype.applyToPoint=function(_){var j=_.x*this.sx+_.y*this.shx+this.tx,oe=_.x*this.shy+_.y*this.sy+this.ty;return new gl(j,oe)},pt.prototype.applyToRectangle=function(_){var j=this.applyToPoint(_),oe=this.applyToPoint(new gl(_.x+_.w,_.y+_.h));return new $u(j.x,j.y,oe.x-j.x,oe.y-j.y)},pt.prototype.clone=function(){var _=this.sx,j=this.shy,oe=this.shx,de=this.sy,we=this.tx,Le=this.ty;return new pt(_,j,oe,de,we,Le)},h.Matrix=pt;var fi=h.matrixMult=function(_,j){return j.multiply(_)},Yn=new pt(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=Yn;var En=function(_,j){if(!Ea[_]){var oe=(j instanceof Ws?"Sh":"P")+(Object.keys(Mt).length+1).toString(10);j.id=oe,Ea[_]=oe,Mt[oe]=j,zt.publish("addPattern",j)}};h.ShadingPattern=Ws,h.TilingPattern=Bo,h.addShadingPattern=function(_,j){return L("addShadingPattern()"),En(_,j),this},h.beginTilingPattern=function(_){L("beginTilingPattern()"),ih(_.boundingBox[0],_.boundingBox[1],_.boundingBox[2]-_.boundingBox[0],_.boundingBox[3]-_.boundingBox[1],_.matrix)},h.endTilingPattern=function(_,j){L("endTilingPattern()"),j.stream=Oe[O].join(`
`),En(_,j),zt.publish("endTilingPattern",j),Fi.pop().restore()};var Lr=h.__private__.newObject=function(){var _=Sr();return W(_,!0),_},Sr=h.__private__.newObjectDeferred=function(){return V++,ue[V]=function(){return he},V},W=function(_,j){return j=typeof j=="boolean"&&j,ue[_]=he,j&&le(_+" 0 obj"),_},ie=h.__private__.newAdditionalObject=function(){var _={objId:Sr(),content:""};return xe.push(_),_},J=Sr(),te=Sr(),ne=h.__private__.decodeColorString=function(_){var j=_.split(" ");if(j.length!==2||j[1]!=="g"&&j[1]!=="G")j.length===5&&(j[4]==="k"||j[4]==="K")&&(j=[(1-j[0])*(1-j[3]),(1-j[1])*(1-j[3]),(1-j[2])*(1-j[3]),"r"]);else{var oe=parseFloat(j[0]);j=[oe,oe,oe,"r"]}for(var de="#",we=0;we<3;we++)de+=("0"+Math.floor(255*parseFloat(j[we])).toString(16)).slice(-2);return de},se=h.__private__.encodeColorString=function(_){var j;typeof _=="string"&&(_={ch1:_});var oe=_.ch1,de=_.ch2,we=_.ch3,Le=_.ch4,ze=_.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof oe=="string"&&oe.charAt(0)!=="#"){var at=new G4(oe);if(at.ok)oe=at.toHex();else if(!/^\d*\.?\d*$/.test(oe))throw new Error('Invalid color "'+oe+'" passed to jsPDF.encodeColorString.')}if(typeof oe=="string"&&/^#[0-9A-Fa-f]{3}$/.test(oe)&&(oe="#"+oe[1]+oe[1]+oe[2]+oe[2]+oe[3]+oe[3]),typeof oe=="string"&&/^#[0-9A-Fa-f]{6}$/.test(oe)){var dt=parseInt(oe.substr(1),16);oe=dt>>16&255,de=dt>>8&255,we=255&dt}if(de===void 0||Le===void 0&&oe===de&&de===we)if(typeof oe=="string")j=oe+" "+ze[0];else switch(_.precision){case 2:j=M(oe/255)+" "+ze[0];break;case 3:default:j=N(oe/255)+" "+ze[0]}else if(Le===void 0||Qt(Le)==="object"){if(Le&&!isNaN(Le.a)&&Le.a===0)return j=["1.","1.","1.",ze[1]].join(" ");if(typeof oe=="string")j=[oe,de,we,ze[1]].join(" ");else switch(_.precision){case 2:j=[M(oe/255),M(de/255),M(we/255),ze[1]].join(" ");break;default:case 3:j=[N(oe/255),N(de/255),N(we/255),ze[1]].join(" ")}}else if(typeof oe=="string")j=[oe,de,we,Le,ze[2]].join(" ");else switch(_.precision){case 2:j=[M(oe),M(de),M(we),M(Le),ze[2]].join(" ");break;case 3:default:j=[N(oe),N(de),N(we),N(Le),ze[2]].join(" ")}return j},Se=h.__private__.getFilters=function(){return s},Ne=h.__private__.putStream=function(_){var j=(_=_||{}).data||"",oe=_.filters||Se(),de=_.alreadyAppliedFilters||[],we=_.addLength1||!1,Le=j.length,ze=_.objectId,at=function(Tn){return Tn};if(f!==null&&ze===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");f!==null&&(at=An.encryptor(ze,0));var dt={};oe===!0&&(oe=["FlateEncode"]);var kt=_.additionalKeyValues||[],At=(dt=mt.API.processDataByFilters!==void 0?mt.API.processDataByFilters(j,oe):{data:j,reverseChain:[]}).reverseChain+(Array.isArray(de)?de.join(" "):de.toString());if(dt.data.length!==0&&(kt.push({key:"Length",value:dt.data.length}),we===!0&&kt.push({key:"Length1",value:Le})),At.length!=0)if(At.split("/").length-1==1)kt.push({key:"Filter",value:At});else{kt.push({key:"Filter",value:"["+At+"]"});for(var jt=0;jt<kt.length;jt+=1)if(kt[jt].key==="DecodeParms"){for(var yr=[],br=0;br<dt.reverseChain.split("/").length-1;br+=1)yr.push("null");yr.push(kt[jt].value),kt[jt].value="["+yr.join(" ")+"]"}}le("<<");for(var Br=0;Br<kt.length;Br++)le("/"+kt[Br].key+" "+kt[Br].value);le(">>"),dt.data.length!==0&&(le("stream"),le(at(dt.data)),le("endstream"))},_e=h.__private__.putPage=function(_){var j=_.number,oe=_.data,de=_.objId,we=_.contentsObjId;W(de,!0),le("<</Type /Page"),le("/Parent "+_.rootDictionaryObjId+" 0 R"),le("/Resources "+_.resourceDictionaryObjId+" 0 R"),le("/MediaBox ["+parseFloat(T(_.mediaBox.bottomLeftX))+" "+parseFloat(T(_.mediaBox.bottomLeftY))+" "+T(_.mediaBox.topRightX)+" "+T(_.mediaBox.topRightY)+"]"),_.cropBox!==null&&le("/CropBox ["+T(_.cropBox.bottomLeftX)+" "+T(_.cropBox.bottomLeftY)+" "+T(_.cropBox.topRightX)+" "+T(_.cropBox.topRightY)+"]"),_.bleedBox!==null&&le("/BleedBox ["+T(_.bleedBox.bottomLeftX)+" "+T(_.bleedBox.bottomLeftY)+" "+T(_.bleedBox.topRightX)+" "+T(_.bleedBox.topRightY)+"]"),_.trimBox!==null&&le("/TrimBox ["+T(_.trimBox.bottomLeftX)+" "+T(_.trimBox.bottomLeftY)+" "+T(_.trimBox.topRightX)+" "+T(_.trimBox.topRightY)+"]"),_.artBox!==null&&le("/ArtBox ["+T(_.artBox.bottomLeftX)+" "+T(_.artBox.bottomLeftY)+" "+T(_.artBox.topRightX)+" "+T(_.artBox.topRightY)+"]"),typeof _.userUnit=="number"&&_.userUnit!==1&&le("/UserUnit "+_.userUnit),zt.publish("putPage",{objId:de,pageContext:bt[j],pageNumber:j,page:oe}),le("/Contents "+we+" 0 R"),le(">>"),le("endobj");var Le=oe.join(`
`);return x===w.ADVANCED&&(Le+=`
Q`),W(we,!0),Ne({data:Le,filters:Se(),objectId:we}),le("endobj"),de},Ae=h.__private__.putPages=function(){var _,j,oe=[];for(_=1;_<=ir;_++)bt[_].objId=Sr(),bt[_].contentsObjId=Sr();for(_=1;_<=ir;_++)oe.push(_e({number:_,data:Oe[_],objId:bt[_].objId,contentsObjId:bt[_].contentsObjId,mediaBox:bt[_].mediaBox,cropBox:bt[_].cropBox,bleedBox:bt[_].bleedBox,trimBox:bt[_].trimBox,artBox:bt[_].artBox,userUnit:bt[_].userUnit,rootDictionaryObjId:J,resourceDictionaryObjId:te}));W(J,!0),le("<</Type /Pages");var de="/Kids [";for(j=0;j<ir;j++)de+=oe[j]+" 0 R ";le(de+"]"),le("/Count "+ir),le(">>"),le("endobj"),zt.publish("postPutPages")},Te=function(_){zt.publish("putFont",{font:_,out:le,newObject:Lr,putStream:Ne}),_.isAlreadyPutted!==!0&&(_.objectNumber=Lr(),le("<<"),le("/Type /Font"),le("/BaseFont /"+Kl(_.postScriptName)),le("/Subtype /Type1"),typeof _.encoding=="string"&&le("/Encoding /"+_.encoding),le("/FirstChar 32"),le("/LastChar 255"),le(">>"),le("endobj"))},He=function(){for(var _ in $t)$t.hasOwnProperty(_)&&(d===!1||d===!0&&p.hasOwnProperty(_))&&Te($t[_])},Ge=function(_){_.objectNumber=Lr();var j=[];j.push({key:"Type",value:"/XObject"}),j.push({key:"Subtype",value:"/Form"}),j.push({key:"BBox",value:"["+[T(_.x),T(_.y),T(_.x+_.width),T(_.y+_.height)].join(" ")+"]"}),j.push({key:"Matrix",value:"["+_.matrix.toString()+"]"});var oe=_.pages[1].join(`
`);Ne({data:oe,additionalKeyValues:j,objectId:_.objectNumber}),le("endobj")},nt=function(){for(var _ in Kr)Kr.hasOwnProperty(_)&&Ge(Kr[_])},$e=function(_,j){var oe,de=[],we=1/(j-1);for(oe=0;oe<1;oe+=we)de.push(oe);if(de.push(1),_[0].offset!=0){var Le={offset:0,color:_[0].color};_.unshift(Le)}if(_[_.length-1].offset!=1){var ze={offset:1,color:_[_.length-1].color};_.push(ze)}for(var at="",dt=0,kt=0;kt<de.length;kt++){for(oe=de[kt];oe>_[dt+1].offset;)dt++;var At=_[dt].offset,jt=(oe-At)/(_[dt+1].offset-At),yr=_[dt].color,br=_[dt+1].color;at+=I(Math.round((1-jt)*yr[0]+jt*br[0]).toString(16))+I(Math.round((1-jt)*yr[1]+jt*br[1]).toString(16))+I(Math.round((1-jt)*yr[2]+jt*br[2]).toString(16))}return at.trim()},rt=function(_,j){j||(j=21);var oe=Lr(),de=$e(_.colors,j),we=[];we.push({key:"FunctionType",value:"0"}),we.push({key:"Domain",value:"[0.0 1.0]"}),we.push({key:"Size",value:"["+j+"]"}),we.push({key:"BitsPerSample",value:"8"}),we.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),we.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ne({data:de,additionalKeyValues:we,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:oe}),le("endobj"),_.objectNumber=Lr(),le("<< /ShadingType "+_.type),le("/ColorSpace /DeviceRGB");var Le="/Coords ["+T(parseFloat(_.coords[0]))+" "+T(parseFloat(_.coords[1]))+" ";_.type===2?Le+=T(parseFloat(_.coords[2]))+" "+T(parseFloat(_.coords[3])):Le+=T(parseFloat(_.coords[2]))+" "+T(parseFloat(_.coords[3]))+" "+T(parseFloat(_.coords[4]))+" "+T(parseFloat(_.coords[5])),le(Le+="]"),_.matrix&&le("/Matrix ["+_.matrix.toString()+"]"),le("/Function "+oe+" 0 R"),le("/Extend [true true]"),le(">>"),le("endobj")},_t=function(_,j){var oe=Sr(),de=Lr();j.push({resourcesOid:oe,objectOid:de}),_.objectNumber=de;var we=[];we.push({key:"Type",value:"/Pattern"}),we.push({key:"PatternType",value:"1"}),we.push({key:"PaintType",value:"1"}),we.push({key:"TilingType",value:"1"}),we.push({key:"BBox",value:"["+_.boundingBox.map(T).join(" ")+"]"}),we.push({key:"XStep",value:T(_.xStep)}),we.push({key:"YStep",value:T(_.yStep)}),we.push({key:"Resources",value:oe+" 0 R"}),_.matrix&&we.push({key:"Matrix",value:"["+_.matrix.toString()+"]"}),Ne({data:_.stream,additionalKeyValues:we,objectId:_.objectNumber}),le("endobj")},Vt=function(_){var j;for(j in Mt)Mt.hasOwnProperty(j)&&(Mt[j]instanceof Ws?rt(Mt[j]):Mt[j]instanceof Bo&&_t(Mt[j],_))},tr=function(_){for(var j in _.objectNumber=Lr(),le("<<"),_)switch(j){case"opacity":le("/ca "+M(_[j]));break;case"stroke-opacity":le("/CA "+M(_[j]))}le(">>"),le("endobj")},Mr=function(){var _;for(_ in hr)hr.hasOwnProperty(_)&&tr(hr[_])},Ji=function(){for(var _ in le("/XObject <<"),Kr)Kr.hasOwnProperty(_)&&Kr[_].objectNumber>=0&&le("/"+_+" "+Kr[_].objectNumber+" 0 R");zt.publish("putXobjectDict"),le(">>")},qa=function(){An.oid=Lr(),le("<<"),le("/Filter /Standard"),le("/V "+An.v),le("/R "+An.r),le("/U <"+An.toHexString(An.U)+">"),le("/O <"+An.toHexString(An.O)+">"),le("/P "+An.P),le(">>"),le("endobj")},Aa=function(){for(var _ in le("/Font <<"),$t)$t.hasOwnProperty(_)&&(d===!1||d===!0&&p.hasOwnProperty(_))&&le("/"+_+" "+$t[_].objectNumber+" 0 R");le(">>")},Qi=function(){if(Object.keys(Mt).length>0){for(var _ in le("/Shading <<"),Mt)Mt.hasOwnProperty(_)&&Mt[_]instanceof Ws&&Mt[_].objectNumber>=0&&le("/"+_+" "+Mt[_].objectNumber+" 0 R");zt.publish("putShadingPatternDict"),le(">>")}},Ta=function(_){if(Object.keys(Mt).length>0){for(var j in le("/Pattern <<"),Mt)Mt.hasOwnProperty(j)&&Mt[j]instanceof h.TilingPattern&&Mt[j].objectNumber>=0&&Mt[j].objectNumber<_&&le("/"+j+" "+Mt[j].objectNumber+" 0 R");zt.publish("putTilingPatternDict"),le(">>")}},hi=function(){if(Object.keys(hr).length>0){var _;for(_ in le("/ExtGState <<"),hr)hr.hasOwnProperty(_)&&hr[_].objectNumber>=0&&le("/"+_+" "+hr[_].objectNumber+" 0 R");zt.publish("putGStateDict"),le(">>")}},Pr=function(_){W(_.resourcesOid,!0),le("<<"),le("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Aa(),Qi(),Ta(_.objectOid),hi(),Ji(),le(">>"),le("endobj")},Wf=function(){var _=[];He(),Mr(),nt(),Vt(_),zt.publish("putResources"),_.forEach(Pr),Pr({resourcesOid:te,objectOid:Number.MAX_SAFE_INTEGER}),zt.publish("postPutResources")},qf=function(){zt.publish("putAdditionalObjects");for(var _=0;_<xe.length;_++){var j=xe[_];W(j.objId,!0),le(j.content),le("endobj")}zt.publish("postPutAdditionalObjects")},$f=function(_){or[_.fontName]=or[_.fontName]||{},or[_.fontName][_.fontStyle]=_.id},Du=function(_,j,oe,de,we){var Le={id:"F"+(Object.keys($t).length+1).toString(10),postScriptName:_,fontName:j,fontStyle:oe,encoding:de,isStandardFont:we||!1,metadata:{}};return zt.publish("addFont",{font:Le,instance:this}),$t[Le.id]=Le,$f(Le),Le.id},$d=function(_){for(var j=0,oe=Ue.length;j<oe;j++){var de=Du.call(this,_[j][0],_[j][1],_[j][2],Ue[j][3],!0);d===!1&&(p[de]=!0);var we=_[j][0].split("-");$f({id:de,fontName:we[0],fontStyle:we[1]||""})}zt.publish("addFonts",{fonts:$t,dictionary:or})},Zi=function(_){return _.foo=function(){try{return _.apply(this,arguments)}catch(de){var j=de.stack||"";~j.indexOf(" at ")&&(j=j.split(" at ")[1]);var oe="Error in function "+j.split(`
`)[0].split("<")[0]+": "+de.message;if(!xt.console)throw new Error(oe);xt.console.error(oe,de),xt.alert&&alert(oe)}},_.foo.bar=_,_.foo},ul=function(_,j){var oe,de,we,Le,ze,at,dt,kt,At;if(we=(j=j||{}).sourceEncoding||"Unicode",ze=j.outputEncoding,(j.autoencode||ze)&&$t[Lt].metadata&&$t[Lt].metadata[we]&&$t[Lt].metadata[we].encoding&&(Le=$t[Lt].metadata[we].encoding,!ze&&$t[Lt].encoding&&(ze=$t[Lt].encoding),!ze&&Le.codePages&&(ze=Le.codePages[0]),typeof ze=="string"&&(ze=Le[ze]),ze)){for(dt=!1,at=[],oe=0,de=_.length;oe<de;oe++)(kt=ze[_.charCodeAt(oe)])?at.push(String.fromCharCode(kt)):at.push(_[oe]),at[oe].charCodeAt(0)>>8&&(dt=!0);_=at.join("")}for(oe=_.length;dt===void 0&&oe!==0;)_.charCodeAt(oe-1)>>8&&(dt=!0),oe--;if(!dt)return _;for(at=j.noBOM?[]:[254,255],oe=0,de=_.length;oe<de;oe++){if((At=(kt=_.charCodeAt(oe))>>8)>>8)throw new Error("Character at position "+oe+" of string '"+_+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");at.push(At),at.push(kt-(At<<8))}return String.fromCharCode.apply(void 0,at)},Xn=h.__private__.pdfEscape=h.pdfEscape=function(_,j){return ul(_,j).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ju=h.__private__.beginPage=function(_){Oe[++ir]=[],bt[ir]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(_[0]),topRightY:Number(_[1])}},Gf(ir),ke(Oe[O])},Vf=function(_,j){var oe,de,we;switch(r=j||r,typeof _=="string"&&(oe=y(_.toLowerCase()),Array.isArray(oe)&&(de=oe[0],we=oe[1])),Array.isArray(_)&&(de=_[0]*tt,we=_[1]*tt),isNaN(de)&&(de=i[0],we=i[1]),(de>14400||we>14400)&&(sr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),de=Math.min(14400,de),we=Math.min(14400,we)),i=[de,we],r.substr(0,1)){case"l":we>de&&(i=[we,de]);break;case"p":de>we&&(i=[we,de])}ju(i),Zf(zu),le(ea),Wu!==0&&le(Wu+" J"),qu!==0&&le(qu+" j"),zt.publish("addPage",{pageNumber:ir})},Vd=function(_){_>0&&_<=ir&&(Oe.splice(_,1),bt.splice(_,1),ir--,O>ir&&(O=ir),this.setPage(O))},Gf=function(_){_>0&&_<=ir&&(O=_)},Gd=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return Oe.length-1},Kf=function(_,j,oe){var de,we=void 0;return oe=oe||{},_=_!==void 0?_:$t[Lt].fontName,j=j!==void 0?j:$t[Lt].fontStyle,de=_.toLowerCase(),or[de]!==void 0&&or[de][j]!==void 0?we=or[de][j]:or[_]!==void 0&&or[_][j]!==void 0?we=or[_][j]:oe.disableWarning===!1&&sr.warn("Unable to look up font label for font '"+_+"', '"+j+"'. Refer to getFontList() for available fonts."),we||oe.noFallback||(we=or.times[j])==null&&(we=or.times.normal),we},Kd=h.__private__.putInfo=function(){var _=Lr(),j=function(de){return de};for(var oe in f!==null&&(j=An.encryptor(_,0)),le("<<"),le("/Producer ("+Xn(j("jsPDF "+mt.version))+")"),wt)wt.hasOwnProperty(oe)&&wt[oe]&&le("/"+oe.substr(0,1).toUpperCase()+oe.substr(1)+" ("+Xn(j(wt[oe]))+")");le("/CreationDate ("+Xn(j(ce))+")"),le(">>"),le("endobj")},Mu=h.__private__.putCatalog=function(_){var j=(_=_||{}).rootDictionaryObjId||J;switch(Lr(),le("<<"),le("/Type /Catalog"),le("/Pages "+j+" 0 R"),Je||(Je="fullwidth"),Je){case"fullwidth":le("/OpenAction [3 0 R /FitH null]");break;case"fullheight":le("/OpenAction [3 0 R /FitV null]");break;case"fullpage":le("/OpenAction [3 0 R /Fit]");break;case"original":le("/OpenAction [3 0 R /XYZ null null 1]");break;default:var oe=""+Je;oe.substr(oe.length-1)==="%"&&(Je=parseInt(Je)/100),typeof Je=="number"&&le("/OpenAction [3 0 R /XYZ null null "+M(Je)+"]")}switch(Nt||(Nt="continuous"),Nt){case"continuous":le("/PageLayout /OneColumn");break;case"single":le("/PageLayout /SinglePage");break;case"two":case"twoleft":le("/PageLayout /TwoColumnLeft");break;case"tworight":le("/PageLayout /TwoColumnRight")}ht&&le("/PageMode /"+ht),zt.publish("putCatalog"),le(">>"),le("endobj")},Yd=h.__private__.putTrailer=function(){le("trailer"),le("<<"),le("/Size "+(V+1)),le("/Root "+V+" 0 R"),le("/Info "+(V-1)+" 0 R"),f!==null&&le("/Encrypt "+An.oid+" 0 R"),le("/ID [ <"+ee+"> <"+ee+"> ]"),le(">>")},Xd=h.__private__.putHeader=function(){le("%PDF-"+v),le("%")},Jd=h.__private__.putXRef=function(){var _="0000000000";le("xref"),le("0 "+(V+1)),le("0000000000 65535 f ");for(var j=1;j<=V;j++)typeof ue[j]=="function"?le((_+ue[j]()).slice(-10)+" 00000 n "):ue[j]!==void 0?le((_+ue[j]).slice(-10)+" 00000 n "):le("0000000000 00000 n ")},$a=h.__private__.buildDocument=function(){Xe(),ke(fe),zt.publish("buildDocument"),Xd(),Ae(),qf(),Wf(),f!==null&&qa(),Kd(),Mu();var _=he;return Jd(),Yd(),le("startxref"),le(""+_),le("%%EOF"),ke(Oe[O]),fe.join(`
`)},cl=h.__private__.getBlob=function(_){return new Blob([it(_)],{type:"application/pdf"})},fl=h.output=h.__private__.output=Zi(function(_,j){switch(typeof(j=j||{})=="string"?j={filename:j}:j.filename=j.filename||"generated.pdf",_){case void 0:return $a();case"save":h.save(j.filename);break;case"arraybuffer":return it($a());case"blob":return cl($a());case"bloburi":case"bloburl":if(xt.URL!==void 0&&typeof xt.URL.createObjectURL=="function")return xt.URL&&xt.URL.createObjectURL(cl($a()))||void 0;sr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var oe="",de=$a();try{oe=Bg(de)}catch{oe=Bg(unescape(encodeURIComponent(de)))}return"data:application/pdf;filename="+j.filename+";base64,"+oe;case"pdfobjectnewwindow":if(Object.prototype.toString.call(xt)==="[object Window]"){var we="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Le=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';j.pdfObjectUrl&&(we=j.pdfObjectUrl,Le="");var ze='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+we+'"'+Le+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(j)+");<\/script></body></html>",at=xt.open();return at!==null&&at.document.write(ze),at}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(xt)==="[object Window]"){var dt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(j.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+j.filename+'" width="500px" height="400px" /></body></html>',kt=xt.open();if(kt!==null){kt.document.write(dt);var At=this;kt.document.documentElement.querySelector("#pdfViewer").onload=function(){kt.document.title=j.filename,kt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(At.output("bloburl"))}}return kt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(xt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var jt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",j)+'"></iframe></body></html>',yr=xt.open();if(yr!==null&&(yr.document.write(jt),yr.document.title=j.filename),yr||typeof safari>"u")return yr;break;case"datauri":case"dataurl":return xt.document.location.href=this.output("datauristring",j);default:return null}}),Yf=function(_){return Array.isArray(Wa)===!0&&Wa.indexOf(_)>-1};switch(n){case"pt":tt=1;break;case"mm":tt=72/25.4;break;case"cm":tt=72/2.54;break;case"in":tt=72;break;case"px":tt=Yf("px_scaling")==1?.75:96/72;break;case"pc":case"em":tt=12;break;case"ex":tt=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);tt=n}var An=null;me(),X();var Qd=function(_){return f!==null?An.encryptor(_,0):function(j){return j}},Xf=h.__private__.getPageInfo=h.getPageInfo=function(_){if(isNaN(_)||_%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:bt[_].objId,pageNumber:_,pageContext:bt[_]}},Et=h.__private__.getPageInfoByObjId=function(_){if(isNaN(_)||_%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var j in bt)if(bt[j].objId===_)break;return Xf(j)},Zd=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:bt[O].objId,pageNumber:O,pageContext:bt[O]}};h.addPage=function(){return Vf.apply(this,arguments),this},h.setPage=function(){return Gf.apply(this,arguments),ke.call(this,Oe[O]),this},h.insertPage=function(_){return this.addPage(),this.movePage(O,_),this},h.movePage=function(_,j){var oe,de;if(_>j){oe=Oe[_],de=bt[_];for(var we=_;we>j;we--)Oe[we]=Oe[we-1],bt[we]=bt[we-1];Oe[j]=oe,bt[j]=de,this.setPage(j)}else if(_<j){oe=Oe[_],de=bt[_];for(var Le=_;Le<j;Le++)Oe[Le]=Oe[Le+1],bt[Le]=bt[Le+1];Oe[j]=oe,bt[j]=de,this.setPage(j)}return this},h.deletePage=function(){return Vd.apply(this,arguments),this},h.__private__.text=h.text=function(_,j,oe,de,we){var Le,ze,at,dt,kt,At,jt,yr,br,Br=(de=de||{}).scope||this;if(typeof _=="number"&&typeof j=="number"&&(typeof oe=="string"||Array.isArray(oe))){var Tn=oe;oe=j,j=_,_=Tn}if(arguments[3]instanceof pt?(L("The transform parameter of text() with a Matrix value"),br=we):(at=arguments[4],dt=arguments[5],Qt(jt=arguments[3])==="object"&&jt!==null||(typeof at=="string"&&(dt=at,at=null),typeof jt=="string"&&(dt=jt,jt=null),typeof jt=="number"&&(at=jt,jt=null),de={flags:jt,angle:at,align:dt})),isNaN(j)||isNaN(oe)||_==null)throw new Error("Invalid arguments passed to jsPDF.text");if(_.length===0)return Br;var tn="",ta=!1,di=typeof de.lineHeightFactor=="number"?de.lineHeightFactor:vo,Ca=Br.internal.scaleFactor;function ah(lr){return lr=lr.split("	").join(Array(de.TabLen||9).join(" ")),Xn(lr,jt)}function Yu(lr){for(var ur,Fr=lr.concat(),Yr=[],Xa=Fr.length;Xa--;)typeof(ur=Fr.shift())=="string"?Yr.push(ur):Array.isArray(lr)&&(ur.length===1||ur[1]===void 0&&ur[2]===void 0)?Yr.push(ur[0]):Yr.push([ur[0],ur[1],ur[2]]);return Yr}function Xu(lr,ur){var Fr;if(typeof lr=="string")Fr=ur(lr)[0];else if(Array.isArray(lr)){for(var Yr,Xa,ic=lr.concat(),Tl=[],ch=ic.length;ch--;)typeof(Yr=ic.shift())=="string"?Tl.push(ur(Yr)[0]):Array.isArray(Yr)&&typeof Yr[0]=="string"&&(Xa=ur(Yr[0],Yr[1],Yr[2]),Tl.push([Xa[0],Xa[1],Xa[2]]));Fr=Tl}return Fr}var vl=!1,Ju=!0;if(typeof _=="string")vl=!0;else if(Array.isArray(_)){var Qu=_.concat();ze=[];for(var yl,cn=Qu.length;cn--;)(typeof(yl=Qu.shift())!="string"||Array.isArray(yl)&&typeof yl[0]!="string")&&(Ju=!1);vl=Ju}if(vl===!1)throw new Error('Type of text must be string or Array. "'+_+'" is not recognized.');typeof _=="string"&&(_=_.match(/[\r?\n]/)?_.split(/\r\n|\r|\n/g):[_]);var wl=Ve/Br.internal.scaleFactor,xl=wl*(di-1);switch(de.baseline){case"bottom":oe-=xl;break;case"top":oe+=wl-xl;break;case"hanging":oe+=wl-2*xl;break;case"middle":oe+=wl/2-xl}if((At=de.maxWidth||0)>0&&(typeof _=="string"?_=Br.splitTextToSize(_,At):Object.prototype.toString.call(_)==="[object Array]"&&(_=_.reduce(function(lr,ur){return lr.concat(Br.splitTextToSize(ur,At))},[]))),Le={text:_,x:j,y:oe,options:de,mutex:{pdfEscape:Xn,activeFontKey:Lt,fonts:$t,activeFontSize:Ve}},zt.publish("preProcessText",Le),_=Le.text,at=(de=Le.options).angle,!(br instanceof pt)&&at&&typeof at=="number"){at*=Math.PI/180,de.rotationDirection===0&&(at=-at),x===w.ADVANCED&&(at=-at);var _l=Math.cos(at),Zu=Math.sin(at);br=new pt(_l,Zu,-Zu,_l,0,0)}else at&&at instanceof pt&&(br=at);x!==w.ADVANCED||br||(br=Yn),(kt=de.charSpace||pl)!==void 0&&(tn+=T(C(kt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(yr=de.horizontalScale)!==void 0&&(tn+=T(100*yr)+` Tz
`),de.lang;var Jn=-1,u1=de.renderingMode!==void 0?de.renderingMode:de.stroke,ec=Br.internal.getCurrentPageInfo().pageContext;switch(u1){case 0:case!1:case"fill":Jn=0;break;case 1:case!0:case"stroke":Jn=1;break;case 2:case"fillThenStroke":Jn=2;break;case 3:case"invisible":Jn=3;break;case 4:case"fillAndAddForClipping":Jn=4;break;case 5:case"strokeAndAddPathForClipping":Jn=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Jn=6;break;case 7:case"addToPathForClipping":Jn=7}var sh=ec.usedRenderingMode!==void 0?ec.usedRenderingMode:-1;Jn!==-1?tn+=Jn+` Tr
`:sh!==-1&&(tn+=`0 Tr
`),Jn!==-1&&(ec.usedRenderingMode=Jn),dt=de.align||"left";var Ri,Sl=Ve*di,oh=Br.internal.pageSize.getWidth(),lh=$t[Lt];kt=de.charSpace||pl,At=de.maxWidth||0,jt=Object.assign({autoencode:!0,noBOM:!0},de.flags);var Ss=[],xo=function(lr){return Br.getStringUnitWidth(lr,{font:lh,charSpace:kt,fontSize:Ve,doKerning:!1})*Ve/Ca};if(Object.prototype.toString.call(_)==="[object Array]"){var Qn;ze=Yu(_),dt!=="left"&&(Ri=ze.map(xo));var Mn,bs=0;if(dt==="right"){j-=Ri[0],_=[],cn=ze.length;for(var Ga=0;Ga<cn;Ga++)Ga===0?(Mn=Na(j),Qn=Va(oe)):(Mn=C(bs-Ri[Ga]),Qn=-Sl),_.push([ze[Ga],Mn,Qn]),bs=Ri[Ga]}else if(dt==="center"){j-=Ri[0]/2,_=[],cn=ze.length;for(var Ka=0;Ka<cn;Ka++)Ka===0?(Mn=Na(j),Qn=Va(oe)):(Mn=C((bs-Ri[Ka])/2),Qn=-Sl),_.push([ze[Ka],Mn,Qn]),bs=Ri[Ka]}else if(dt==="left"){_=[],cn=ze.length;for(var bl=0;bl<cn;bl++)_.push(ze[bl])}else if(dt==="justify"&&lh.encoding==="Identity-H"){_=[],cn=ze.length,At=At!==0?At:oh;for(var Ya=0,Or=0;Or<cn;Or++)if(Qn=Or===0?Va(oe):-Sl,Mn=Or===0?Na(j):Ya,Or<cn-1){var tc=C((At-Ri[Or])/(ze[Or].split(" ").length-1)),Bn=ze[Or].split(" ");_.push([Bn[0]+" ",Mn,Qn]),Ya=0;for(var Ii=1;Ii<Bn.length;Ii++){var El=(xo(Bn[Ii-1]+" "+Bn[Ii])-xo(Bn[Ii]))*Ca+tc;Ii==Bn.length-1?_.push([Bn[Ii],El,0]):_.push([Bn[Ii]+" ",El,0]),Ya-=El}}else _.push([ze[Or],Mn,Qn]);_.push(["",Ya,0])}else{if(dt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(_=[],cn=ze.length,At=At!==0?At:oh,Or=0;Or<cn;Or++)Qn=Or===0?Va(oe):-Sl,Mn=Or===0?Na(j):0,Or<cn-1?Ss.push(T(C((At-Ri[Or])/(ze[Or].split(" ").length-1)))):Ss.push(0),_.push([ze[Or],Mn,Qn])}}var uh=typeof de.R2L=="boolean"?de.R2L:ct;uh===!0&&(_=Xu(_,function(lr,ur,Fr){return[lr.split("").reverse().join(""),ur,Fr]})),Le={text:_,x:j,y:oe,options:de,mutex:{pdfEscape:Xn,activeFontKey:Lt,fonts:$t,activeFontSize:Ve}},zt.publish("postProcessText",Le),_=Le.text,ta=Le.mutex.isHex||!1;var rc=$t[Lt].encoding;rc!=="WinAnsiEncoding"&&rc!=="StandardEncoding"||(_=Xu(_,function(lr,ur,Fr){return[ah(lr),ur,Fr]})),ze=Yu(_),_=[];for(var _o,So,Es,bo=0,Al=1,Eo=Array.isArray(ze[0])?Al:bo,As="",nc=function(lr,ur,Fr){var Yr="";return Fr instanceof pt?(Fr=typeof de.angle=="number"?fi(Fr,new pt(1,0,0,1,lr,ur)):fi(new pt(1,0,0,1,lr,ur),Fr),x===w.ADVANCED&&(Fr=fi(new pt(1,0,0,-1,0,0),Fr)),Yr=Fr.join(" ")+` Tm
`):Yr=T(lr)+" "+T(ur)+` Td
`,Yr},Di=0;Di<ze.length;Di++){switch(As="",Eo){case Al:Es=(ta?"<":"(")+ze[Di][0]+(ta?">":")"),_o=parseFloat(ze[Di][1]),So=parseFloat(ze[Di][2]);break;case bo:Es=(ta?"<":"(")+ze[Di]+(ta?">":")"),_o=Na(j),So=Va(oe)}Ss!==void 0&&Ss[Di]!==void 0&&(As=Ss[Di]+` Tw
`),Di===0?_.push(As+nc(_o,So,br)+Es):Eo===bo?_.push(As+Es):Eo===Al&&_.push(As+nc(_o,So,br)+Es)}_=Eo===bo?_.join(` Tj
T* `):_.join(` Tj
`),_+=` Tj
`;var ji=`BT
/`;return ji+=Lt+" "+Ve+` Tf
`,ji+=T(Ve*di)+` TL
`,ji+=yo+`
`,ji+=tn,ji+=_,le(ji+="ET"),p[Lt]=!0,Br};var e1=h.__private__.clip=h.clip=function(_){return le(_==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return e1("evenodd")},h.__private__.discardPath=h.discardPath=function(){return le("n"),this};var ka=h.__private__.isValidStyle=function(_){var j=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(_)!==-1&&(j=!0),j};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(_){return ka(_)&&(u=_),this};var Jf=h.__private__.getStyle=h.getStyle=function(_){var j=u;switch(_){case"D":case"S":j="S";break;case"F":j="f";break;case"FD":case"DF":j="B";break;case"f":case"f*":case"B":case"B*":j=_}return j},Qf=h.close=function(){return le("h"),this};h.stroke=function(){return le("S"),this},h.fill=function(_){return hl("f",_),this},h.fillEvenOdd=function(_){return hl("f*",_),this},h.fillStroke=function(_){return hl("B",_),this},h.fillStrokeEvenOdd=function(_){return hl("B*",_),this};var hl=function(_,j){Qt(j)==="object"?r1(j,_):le(_)},Bu=function(_){_===null||x===w.ADVANCED&&_===void 0||(_=Jf(_),le(_))};function t1(_,j,oe,de,we){var Le=new Bo(j||this.boundingBox,oe||this.xStep,de||this.yStep,this.gState,we||this.matrix);Le.stream=this.stream;var ze=_+"$$"+this.cloneIndex+++"$$";return En(ze,Le),Le}var r1=function(_,j){var oe=Ea[_.key],de=Mt[oe];if(de instanceof Ws)le("q"),le(n1(j)),de.gState&&h.setGState(de.gState),le(_.matrix.toString()+" cm"),le("/"+oe+" sh"),le("Q");else if(de instanceof Bo){var we=new pt(1,0,0,-1,0,_s());_.matrix&&(we=we.multiply(_.matrix||Yn),oe=t1.call(de,_.key,_.boundingBox,_.xStep,_.yStep,we).id),le("q"),le("/Pattern cs"),le("/"+oe+" scn"),de.gState&&h.setGState(de.gState),le(j),le("Q")}},n1=function(_){switch(_){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},Uu=h.moveTo=function(_,j){return le(T(C(_))+" "+T(Y(j))+" m"),this},mo=h.lineTo=function(_,j){return le(T(C(_))+" "+T(Y(j))+" l"),this},ws=h.curveTo=function(_,j,oe,de,we,Le){return le([T(C(_)),T(Y(j)),T(C(oe)),T(Y(de)),T(C(we)),T(Y(Le)),"c"].join(" ")),this};h.__private__.line=h.line=function(_,j,oe,de,we){if(isNaN(_)||isNaN(j)||isNaN(oe)||isNaN(de)||!ka(we))throw new Error("Invalid arguments passed to jsPDF.line");return x===w.COMPAT?this.lines([[oe-_,de-j]],_,j,[1,1],we||"S"):this.lines([[oe-_,de-j]],_,j,[1,1]).stroke()},h.__private__.lines=h.lines=function(_,j,oe,de,we,Le){var ze,at,dt,kt,At,jt,yr,br,Br,Tn,tn,ta;if(typeof _=="number"&&(ta=oe,oe=j,j=_,_=ta),de=de||[1,1],Le=Le||!1,isNaN(j)||isNaN(oe)||!Array.isArray(_)||!Array.isArray(de)||!ka(we)||typeof Le!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Uu(j,oe),ze=de[0],at=de[1],kt=_.length,Tn=j,tn=oe,dt=0;dt<kt;dt++)(At=_[dt]).length===2?(Tn=At[0]*ze+Tn,tn=At[1]*at+tn,mo(Tn,tn)):(jt=At[0]*ze+Tn,yr=At[1]*at+tn,br=At[2]*ze+Tn,Br=At[3]*at+tn,Tn=At[4]*ze+Tn,tn=At[5]*at+tn,ws(jt,yr,br,Br,Tn,tn));return Le&&Qf(),Bu(we),this},h.path=function(_){for(var j=0;j<_.length;j++){var oe=_[j],de=oe.c;switch(oe.op){case"m":Uu(de[0],de[1]);break;case"l":mo(de[0],de[1]);break;case"c":ws.apply(this,de);break;case"h":Qf()}}return this},h.__private__.rect=h.rect=function(_,j,oe,de,we){if(isNaN(_)||isNaN(j)||isNaN(oe)||isNaN(de)||!ka(we))throw new Error("Invalid arguments passed to jsPDF.rect");return x===w.COMPAT&&(de=-de),le([T(C(_)),T(Y(j)),T(C(oe)),T(C(de)),"re"].join(" ")),Bu(we),this},h.__private__.triangle=h.triangle=function(_,j,oe,de,we,Le,ze){if(isNaN(_)||isNaN(j)||isNaN(oe)||isNaN(de)||isNaN(we)||isNaN(Le)||!ka(ze))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[oe-_,de-j],[we-oe,Le-de],[_-we,j-Le]],_,j,[1,1],ze,!0),this},h.__private__.roundedRect=h.roundedRect=function(_,j,oe,de,we,Le,ze){if(isNaN(_)||isNaN(j)||isNaN(oe)||isNaN(de)||isNaN(we)||isNaN(Le)||!ka(ze))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var at=4/3*(Math.SQRT2-1);return we=Math.min(we,.5*oe),Le=Math.min(Le,.5*de),this.lines([[oe-2*we,0],[we*at,0,we,Le-Le*at,we,Le],[0,de-2*Le],[0,Le*at,-we*at,Le,-we,Le],[2*we-oe,0],[-we*at,0,-we,-Le*at,-we,-Le],[0,2*Le-de],[0,-Le*at,we*at,-Le,we,-Le]],_+we,j,[1,1],ze,!0),this},h.__private__.ellipse=h.ellipse=function(_,j,oe,de,we){if(isNaN(_)||isNaN(j)||isNaN(oe)||isNaN(de)||!ka(we))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Le=4/3*(Math.SQRT2-1)*oe,ze=4/3*(Math.SQRT2-1)*de;return Uu(_+oe,j),ws(_+oe,j-ze,_+Le,j-de,_,j-de),ws(_-Le,j-de,_-oe,j-ze,_-oe,j),ws(_-oe,j+ze,_-Le,j+de,_,j+de),ws(_+Le,j+de,_+oe,j+ze,_+oe,j),Bu(we),this},h.__private__.circle=h.circle=function(_,j,oe,de){if(isNaN(_)||isNaN(j)||isNaN(oe)||!ka(de))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(_,j,oe,oe,de)},h.setFont=function(_,j,oe){return oe&&(j=B(j,oe)),Lt=Kf(_,j,{disableWarning:!1}),this};var i1=h.__private__.getFont=h.getFont=function(){return $t[Kf.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var _,j,oe={};for(_ in or)if(or.hasOwnProperty(_))for(j in oe[_]=[],or[_])or[_].hasOwnProperty(j)&&oe[_].push(j);return oe},h.addFont=function(_,j,oe,de,we){var Le=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Le.indexOf(arguments[3])!==-1?we=arguments[3]:arguments[3]&&Le.indexOf(arguments[3])==-1&&(oe=B(oe,de)),we=we||"Identity-H",Du.call(this,_,j,oe,we)};var vo,zu=e.lineWidth||.200025,dl=h.__private__.getLineWidth=h.getLineWidth=function(){return zu},Zf=h.__private__.setLineWidth=h.setLineWidth=function(_){return zu=_,le(T(C(_))+" w"),this};h.__private__.setLineDash=mt.API.setLineDash=mt.API.setLineDashPattern=function(_,j){if(_=_||[],j=j||0,isNaN(j)||!Array.isArray(_))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return _=_.map(function(oe){return T(C(oe))}).join(" "),j=T(C(j)),le("["+_+"] "+j+" d"),this};var eh=h.__private__.getLineHeight=h.getLineHeight=function(){return Ve*vo};h.__private__.getLineHeight=h.getLineHeight=function(){return Ve*vo};var th=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(_){return typeof(_=_||1.15)=="number"&&(vo=_),this},rh=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return vo};th(e.lineHeight);var Na=h.__private__.getHorizontalCoordinate=function(_){return C(_)},Va=h.__private__.getVerticalCoordinate=function(_){return x===w.ADVANCED?_:bt[O].mediaBox.topRightY-bt[O].mediaBox.bottomLeftY-C(_)},a1=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(_){return T(Na(_))},xs=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(_){return T(Va(_))},ea=e.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return ne(ea)},h.__private__.setStrokeColor=h.setDrawColor=function(_,j,oe,de){return ea=se({ch1:_,ch2:j,ch3:oe,ch4:de,pdfColorType:"draw",precision:2}),le(ea),this};var Hu=e.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return ne(Hu)},h.__private__.setFillColor=h.setFillColor=function(_,j,oe,de){return Hu=se({ch1:_,ch2:j,ch3:oe,ch4:de,pdfColorType:"fill",precision:2}),le(Hu),this};var yo=e.textColor||"0 g",s1=h.__private__.getTextColor=h.getTextColor=function(){return ne(yo)};h.__private__.setTextColor=h.setTextColor=function(_,j,oe,de){return yo=se({ch1:_,ch2:j,ch3:oe,ch4:de,pdfColorType:"text",precision:3}),this};var pl=e.charSpace,o1=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(pl||0)};h.__private__.setCharSpace=h.setCharSpace=function(_){if(isNaN(_))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return pl=_,this};var Wu=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(_){var j=h.CapJoinStyles[_];if(j===void 0)throw new Error("Line cap style of '"+_+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Wu=j,le(j+" J"),this};var qu=0;h.__private__.setLineJoin=h.setLineJoin=function(_){var j=h.CapJoinStyles[_];if(j===void 0)throw new Error("Line join style of '"+_+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return qu=j,le(j+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(_){if(_=_||0,isNaN(_))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return le(T(C(_))+" M"),this},h.GState=Lf,h.setGState=function(_){(_=typeof _=="string"?hr[ci[_]]:nh(null,_)).equals(Xi)||(le("/"+_.id+" gs"),Xi=_)};var nh=function(_,j){if(!_||!ci[_]){var oe=!1;for(var de in hr)if(hr.hasOwnProperty(de)&&hr[de].equals(j)){oe=!0;break}if(oe)j=hr[de];else{var we="GS"+(Object.keys(hr).length+1).toString(10);hr[we]=j,j.id=we}return _&&(ci[_]=j.id),zt.publish("addGState",j),j}};h.addGState=function(_,j){return nh(_,j),this},h.saveGraphicsState=function(){return le("q"),Pi.push({key:Lt,size:Ve,color:yo}),this},h.restoreGraphicsState=function(){le("Q");var _=Pi.pop();return Lt=_.key,Ve=_.size,yo=_.color,Xi=null,this},h.setCurrentTransformationMatrix=function(_){return le(_.toString()+" cm"),this},h.comment=function(_){return le("#"+_),this};var gl=function(_,j){var oe=_||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return oe},set:function(Le){isNaN(Le)||(oe=parseFloat(Le))}});var de=j||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return de},set:function(Le){isNaN(Le)||(de=parseFloat(Le))}});var we="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return we},set:function(Le){we=Le.toString()}}),this},$u=function(_,j,oe,de){gl.call(this,_,j),this.type="rect";var we=oe||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return we},set:function(ze){isNaN(ze)||(we=parseFloat(ze))}});var Le=de||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Le},set:function(ze){isNaN(ze)||(Le=parseFloat(ze))}}),this},Vu=function(){this.page=ir,this.currentPage=O,this.pages=Oe.slice(0),this.pagesContext=bt.slice(0),this.x=Gr,this.y=Dt,this.matrix=Kn,this.width=wo(O),this.height=_s(O),this.outputDestination=qe,this.id="",this.objectNumber=-1};Vu.prototype.restore=function(){ir=this.page,O=this.currentPage,bt=this.pagesContext,Oe=this.pages,Gr=this.x,Dt=this.y,Kn=this.matrix,Gu(O,this.width),Ku(O,this.height),qe=this.outputDestination};var ih=function(_,j,oe,de,we){Fi.push(new Vu),ir=O=0,Oe=[],Gr=_,Dt=j,Kn=we,ju([oe,de])},l1=function(_){if(Oi[_])Fi.pop().restore();else{var j=new Vu,oe="Xo"+(Object.keys(Kr).length+1).toString(10);j.id=oe,Oi[_]=oe,Kr[oe]=j,zt.publish("addFormObject",j),Fi.pop().restore()}};for(var ml in h.beginFormObject=function(_,j,oe,de,we){return ih(_,j,oe,de,we),this},h.endFormObject=function(_){return l1(_),this},h.doFormObject=function(_,j){var oe=Kr[Oi[_]];return le("q"),le(j.toString()+" cm"),le("/"+oe.id+" Do"),le("Q"),this},h.getFormObject=function(_){var j=Kr[Oi[_]];return{x:j.x,y:j.y,width:j.width,height:j.height,matrix:j.matrix}},h.save=function(_,j){return _=_||"generated.pdf",(j=j||{}).returnPromise=j.returnPromise||!1,j.returnPromise===!1?(Po(cl($a()),_),typeof Po.unload=="function"&&xt.setTimeout&&setTimeout(Po.unload,911),this):new Promise(function(oe,de){try{var we=Po(cl($a()),_);typeof Po.unload=="function"&&xt.setTimeout&&setTimeout(Po.unload,911),oe(we)}catch(Le){de(Le.message)}})},mt.API)mt.API.hasOwnProperty(ml)&&(ml==="events"&&mt.API.events.length?function(_,j){var oe,de,we;for(we=j.length-1;we!==-1;we--)oe=j[we][0],de=j[we][1],_.subscribe.apply(_,[oe].concat(typeof de=="function"?[de]:de))}(zt,mt.API.events):h[ml]=mt.API[ml]);var wo=h.getPageWidth=function(_){return(bt[_=_||O].mediaBox.topRightX-bt[_].mediaBox.bottomLeftX)/tt},Gu=h.setPageWidth=function(_,j){bt[_].mediaBox.topRightX=j*tt+bt[_].mediaBox.bottomLeftX},_s=h.getPageHeight=function(_){return(bt[_=_||O].mediaBox.topRightY-bt[_].mediaBox.bottomLeftY)/tt},Ku=h.setPageHeight=function(_,j){bt[_].mediaBox.topRightY=j*tt+bt[_].mediaBox.bottomLeftY};return h.internal={pdfEscape:Xn,getStyle:Jf,getFont:i1,getFontSize:Ze,getCharSpace:o1,getTextColor:s1,getLineHeight:eh,getLineHeightFactor:rh,getLineWidth:dl,write:je,getHorizontalCoordinate:Na,getVerticalCoordinate:Va,getCoordinateString:a1,getVerticalCoordinateString:xs,collections:{},newObject:Lr,newAdditionalObject:ie,newObjectDeferred:Sr,newObjectDeferredBegin:W,getFilters:Se,putStream:Ne,events:zt,scaleFactor:tt,pageSize:{getWidth:function(){return wo(O)},setWidth:function(_){Gu(O,_)},getHeight:function(){return _s(O)},setHeight:function(_){Ku(O,_)}},encryptionOptions:f,encryption:An,getEncryptor:Qd,output:fl,getNumberOfPages:Gd,pages:Oe,out:le,f2:M,f3:N,getPageInfo:Xf,getPageInfoByObjId:Et,getCurrentPageInfo:Zd,getPDFVersion:m,Point:gl,Rectangle:$u,Matrix:pt,hasHotfix:Yf},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return wo(O)},set:function(_){Gu(O,_)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return _s(O)},set:function(_){Ku(O,_)},enumerable:!0,configurable:!0}),$d.call(h,Ue),Lt="F1",Vf(i,r),zt.publish("initialized"),h}Gl.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},Gl.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Gl.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},Gl.prototype.processOwnerPassword=function(e,t){return zg(Ug(t).substr(0,5),e)},Gl.prototype.encryptor=function(e,t){var r=Ug(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return zg(r,n)}},Lf.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||Qt(e)!==Qt(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},mt.API={events:[]},mt.version="2.5.2";var Ar=mt.API,fm=1,ll=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},zl=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Tt=function(e){return e.toFixed(2)},Ds=function(e){return e.toFixed(5)};Ar.__acroform__={};var ui=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},gy=function(e){return e*fm},Ra=function(e){var t=new J4,r=lt.internal.getHeight(e)||0,n=lt.internal.getWidth(e)||0;return t.BBox=[0,0,Number(Tt(n)),Number(Tt(r))],t},mO=Ar.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|=1<<t},vO=Ar.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&=~(1<<t)},yO=Ar.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},Ir=Ar.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return yO(e,t-1)},Dr=Ar.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return mO(e,t-1)},jr=Ar.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return vO(e,t-1)},wO=Ar.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,i=e[0],a=e[1],s=e[2],o=e[3],l={};return l.lowerLeft_X=r(i)||0,l.lowerLeft_Y=n(a+o)||0,l.upperRight_X=r(i+s)||0,l.upperRight_Y=n(a)||0,[Number(Tt(l.lowerLeft_X)),Number(Tt(l.lowerLeft_Y)),Number(Tt(l.upperRight_X)),Number(Tt(l.upperRight_Y))]},xO=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=Hg(e,r),i=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+i+" "+Tt(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var a=Ra(e);return a.scope=e.scope,a.stream=t.join(`
`),a}},Hg=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},i=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");i=e.multiline?i.map(function(N){return N.split(`
`)}):i.map(function(N){return[N]});var a=r,s=lt.internal.getHeight(e)||0;s=s<0?-s:s;var o=lt.internal.getWidth(e)||0;o=o<0?-o:o;var l=function(N,C,U){if(N+1<i.length){var Y=C+" "+i[N+1][0];return c0(Y,e,U).width<=o-4}return!1};a++;e:for(;a>0;){t="",a--;var u,f,d=c0("3",e,a).height,p=e.multiline?s-a:(s-d)/2,h=p+=2,v=0,m=0,S=0;if(a<=0){t=`(...) Tj
`,t+="% Width of Text: "+c0(t,e,a=12).width+", FieldWidth:"+o+`
`;break}for(var y="",w=0,x=0;x<i.length;x++)if(i.hasOwnProperty(x)){var A=!1;if(i[x].length!==1&&S!==i[x].length-1){if((d+2)*(w+2)+2>s)continue e;y+=i[x][S],A=!0,m=x,x--}else{y=(y+=i[x][S]+" ").substr(y.length-1)==" "?y.substr(0,y.length-1):y;var R=parseInt(x),B=l(R,y,a),T=x>=i.length-1;if(B&&!T){y+=" ",S=0;continue}if(B||T){if(T)m=R;else if(e.multiline&&(d+2)*(w+2)+2>s)continue e}else{if(!e.multiline||(d+2)*(w+2)+2>s)continue e;m=R}}for(var L="",P=v;P<=m;P++){var M=i[P];if(e.multiline){if(P===m){L+=M[S]+" ",S=(S+1)%M.length;continue}if(P===v){L+=M[M.length-1]+" ";continue}}L+=M[0]+" "}switch(L=L.substr(L.length-1)==" "?L.substr(0,L.length-1):L,f=c0(L,e,a).width,e.textAlign){case"right":u=o-f-2;break;case"center":u=(o-f)/2;break;case"left":default:u=2}t+=Tt(u)+" "+Tt(h)+` Td
`,t+="("+ll(L)+`) Tj
`,t+=-Tt(u)+` 0 Td
`,h=-(a+2),f=0,v=A?m:m+1,w++,y=""}break}return n.text=t,n.fontSize=a,n},c0=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),i=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:i}},_O={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},SO=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},bO=function(e,t){for(var r in e)if(e.hasOwnProperty(r)){var n=r,i=e[r];t.internal.newObjectDeferredBegin(i.objId,!0),Qt(i)==="object"&&typeof i.putStream=="function"&&i.putStream(),delete e[n]}},EO=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(Sa.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(_O)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");fm=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new Q4,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in n)if(n.hasOwnProperty(i)){var a=n[i];a.objId=void 0,a.hasAnnotation&&SO(a,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,i){var a=!n;for(var s in n||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(s)){var o=n[s],l=[],u=o.Rect;if(o.Rect&&(o.Rect=wO(o.Rect,i)),i.internal.newObjectDeferredBegin(o.objId,!0),o.DA=lt.createDefaultAppearanceStream(o),Qt(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(l=o.getKeyValueListForStream()),o.Rect=u,o.hasAppearanceStream&&!o.appearanceStreamContent){var f=xO(o);l.push({key:"AP",value:"<</N "+f+">>"}),i.internal.acroformPlugin.xForms.push(f)}if(o.appearanceStreamContent){var d="";for(var p in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(p)){var h=o.appearanceStreamContent[p];if(d+="/"+p+" ",d+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var s in h)if(h.hasOwnProperty(s)){var v=h[s];typeof v=="function"&&(v=v.call(i,o)),d+="/"+s+" "+v+" ",i.internal.acroformPlugin.xForms.indexOf(v)>=0||i.internal.acroformPlugin.xForms.push(v)}}else typeof(v=h)=="function"&&(v=v.call(i,o)),d+="/"+s+" "+v,i.internal.acroformPlugin.xForms.indexOf(v)>=0||i.internal.acroformPlugin.xForms.push(v);d+=">>"}l.push({key:"AP",value:`<<
`+d+">>"})}i.internal.putStream({additionalKeyValues:l,objectId:o.objId}),i.internal.out("endobj")}a&&bO(i.internal.acroformPlugin.xForms,i)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},X4=Ar.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(s){return s};if(Array.isArray(e)){for(var i="[",a=0;a<e.length;a++)switch(a!==0&&(i+=" "),Qt(e[a])){case"boolean":case"number":case"object":i+=e[a].toString();break;case"string":e[a].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),i+="("+ll(n(e[a].toString()))+")"):i+=e[a].toString()}return i+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},bp=function(e,t,r){var n=function(i){return i};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),e="("+ll(n(e))+")"},ja=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};ja.prototype.toString=function(){return this.objId+" 0 R"},ja.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},ja.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(a){return a!="content"&&a!="appearanceStreamContent"&&a!="scope"&&a!="objId"&&a.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],i=this[n];i&&(Array.isArray(i)?e.push({key:n,value:X4(i,this.objId,this.scope)}):i instanceof ja?(i.scope=this.scope,e.push({key:n,value:i.objId+" 0 R"})):typeof i!="function"&&e.push({key:n,value:i}))}return e};var J4=function(){ja.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};ui(J4,ja);var Q4=function(){ja.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+ll(r(e))+")"}},set:function(r){e=r}})};ui(Q4,ja);var Sa=function e(){ja.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute F supplied.');t=y}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Ir(t,3)},set:function(y){y?this.F=Dr(t,3):this.F=jr(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(y){if(isNaN(y))throw new Error('Invalid value "'+y+'" for attribute Ff supplied.');r=y}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(y){n=y!==void 0?y:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(y){n[0]=y}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(y){n[1]=y}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(y){n[2]=y}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(y){n[3]=y}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(y){switch(y){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=y;break;default:throw new Error('Invalid value "'+y+'" for attribute FT supplied.')}}});var a=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!a||a.length<1){if(this instanceof dd)return;a="FieldObject"+e.FieldNum++}var y=function(w){return w};return this.scope&&(y=this.scope.internal.getEncryptor(this.objId)),"("+ll(y(a))+")"},set:function(y){a=y.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return a},set:function(y){a=y}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(y){s=y}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(y){o=y}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(y){l=y}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/fm:u},set:function(y){u=y}});var f="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return f},set:function(y){f=y}});var d="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!d||this instanceof dd||this instanceof no))return bp(d,this.objId,this.scope)},set:function(y){y=y.toString(),d=y}});var p=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof Zr?p:bp(p,this.objId,this.scope)},set:function(y){y=y.toString(),p=this instanceof Zr?y:y.substr(0,1)==="("?zl(y.substr(1,y.length-2)):zl(y)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Zr?zl(p.substr(1,p.length-1)):p},set:function(y){y=y.toString(),p=this instanceof Zr?"/"+y:y}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(y){this.V=y}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof Zr?h:bp(h,this.objId,this.scope)},set:function(y){y=y.toString(),h=this instanceof Zr?y:y.substr(0,1)==="("?zl(y.substr(1,y.length-2)):zl(y)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Zr?zl(h.substr(1,h.length-1)):h},set:function(y){y=y.toString(),h=this instanceof Zr?"/"+y:y}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var v,m=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return m},set:function(y){y=!!y,m=y}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(v)return v},set:function(y){v=y}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Ir(this.Ff,1)},set:function(y){y?this.Ff=Dr(this.Ff,1):this.Ff=jr(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Ir(this.Ff,2)},set:function(y){y?this.Ff=Dr(this.Ff,2):this.Ff=jr(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Ir(this.Ff,3)},set:function(y){y?this.Ff=Dr(this.Ff,3):this.Ff=jr(this.Ff,3)}});var S=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(S!==null)return S},set:function(y){if([0,1,2].indexOf(y)===-1)throw new Error('Invalid value "'+y+'" for attribute Q supplied.');S=y}}),Object.defineProperty(this,"textAlign",{get:function(){var y;switch(S){case 0:default:y="left";break;case 1:y="center";break;case 2:y="right"}return y},configurable:!0,enumerable:!0,set:function(y){switch(y){case"right":case 2:S=2;break;case"center":case 1:S=1;break;case"left":case 0:default:S=0}}})};ui(Sa,ja);var Wo=function(){Sa.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return X4(t,this.objId,this.scope)},set:function(r){var n,i;i=[],typeof(n=r)=="string"&&(i=function(a,s,o){o||(o=1);for(var l,u=[];l=s.exec(a);)u.push(l[o]);return u}(n,/\((.*?)\)/g)),t=i}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Ir(this.Ff,18)},set:function(r){r?this.Ff=Dr(this.Ff,18):this.Ff=jr(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Ir(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Dr(this.Ff,19):this.Ff=jr(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Ir(this.Ff,20)},set:function(r){r?(this.Ff=Dr(this.Ff,20),t.sort()):this.Ff=jr(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Ir(this.Ff,22)},set:function(r){r?this.Ff=Dr(this.Ff,22):this.Ff=jr(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Ir(this.Ff,23)},set:function(r){r?this.Ff=Dr(this.Ff,23):this.Ff=jr(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Ir(this.Ff,27)},set:function(r){r?this.Ff=Dr(this.Ff,27):this.Ff=jr(this.Ff,27)}}),this.hasAppearanceStream=!1};ui(Wo,Sa);var qo=function(){Wo.call(this),this.fontName="helvetica",this.combo=!1};ui(qo,Wo);var $o=function(){qo.call(this),this.combo=!0};ui($o,qo);var Gc=function(){$o.call(this),this.edit=!0};ui(Gc,$o);var Zr=function(){Sa.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Ir(this.Ff,15)},set:function(r){r?this.Ff=Dr(this.Ff,15):this.Ff=jr(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Ir(this.Ff,16)},set:function(r){r?this.Ff=Dr(this.Ff,16):this.Ff=jr(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Ir(this.Ff,17)},set:function(r){r?this.Ff=Dr(this.Ff,17):this.Ff=jr(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Ir(this.Ff,26)},set:function(r){r?this.Ff=Dr(this.Ff,26):this.Ff=jr(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(a){return a};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,i=[];for(n in i.push("<<"),t)i.push("/"+n+" ("+ll(r(t[n]))+")");return i.push(">>"),i.join(`
`)}},set:function(r){Qt(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};ui(Zr,Sa);var Kc=function(){Zr.call(this),this.pushButton=!0};ui(Kc,Zr);var Vo=function(){Zr.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};ui(Vo,Zr);var dd=function(){var e,t;Sa.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(i){e=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(i){t=i}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(o){return o};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var a,s=[];for(a in s.push("<<"),n)s.push("/"+a+" ("+ll(i(n[a]))+")");return s.push(">>"),s.join(`
`)},set:function(i){Qt(i)==="object"&&(n=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(i){typeof i=="string"&&(n.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(i){r=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(i){r="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=lt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};ui(dd,Sa),Vo.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},Vo.prototype.createOption=function(e){var t=new dd;return t.Parent=this,t.optionName=e,this.Kids.push(t),AO.call(this.scope,t),t};var Yc=function(){Zr.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=lt.CheckBox.createAppearanceStream()};ui(Yc,Zr);var no=function(){Sa.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Ir(this.Ff,13)},set:function(t){t?this.Ff=Dr(this.Ff,13):this.Ff=jr(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Ir(this.Ff,21)},set:function(t){t?this.Ff=Dr(this.Ff,21):this.Ff=jr(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Ir(this.Ff,23)},set:function(t){t?this.Ff=Dr(this.Ff,23):this.Ff=jr(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Ir(this.Ff,24)},set:function(t){t?this.Ff=Dr(this.Ff,24):this.Ff=jr(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Ir(this.Ff,25)},set:function(t){t?this.Ff=Dr(this.Ff,25):this.Ff=jr(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Ir(this.Ff,26)},set:function(t){t?this.Ff=Dr(this.Ff,26):this.Ff=jr(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};ui(no,Sa);var Xc=function(){no.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Ir(this.Ff,14)},set:function(e){e?this.Ff=Dr(this.Ff,14):this.Ff=jr(this.Ff,14)}}),this.password=!0};ui(Xc,no);var lt={CheckBox:{createAppearanceStream:function(){return{N:{On:lt.CheckBox.YesNormal},D:{On:lt.CheckBox.YesPushDown,Off:lt.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=Ra(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,i=e.scope.__private__.encodeColorString(e.color),a=Hg(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+Tt(lt.internal.getWidth(e))+" "+Tt(lt.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Tt(a.fontSize)+" Tf "+i),r.push("BT"),r.push(a.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=Ra(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),i=[],a=lt.internal.getHeight(e),s=lt.internal.getWidth(e),o=Hg(e,e.caption);return i.push("1 g"),i.push("0 0 "+Tt(s)+" "+Tt(a)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+Tt(s-1)+" "+Tt(a-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+r+" "+Tt(o.fontSize)+" Tf "+n),i.push(o.text),i.push("ET"),i.push("Q"),t.stream=i.join(`
`),t},OffPushDown:function(e){var t=Ra(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Tt(lt.internal.getWidth(e))+" "+Tt(lt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:lt.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=lt.RadioButton.Circle.YesNormal,t.D[e]=lt.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=Ra(e);t.scope=e.scope;var r=[],n=lt.internal.getWidth(e)<=lt.internal.getHeight(e)?lt.internal.getWidth(e)/4:lt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=lt.internal.Bezier_C,a=Number((n*i).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+Ds(lt.internal.getWidth(e)/2)+" "+Ds(lt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),r.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),r.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),r.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Ra(e);t.scope=e.scope;var r=[],n=lt.internal.getWidth(e)<=lt.internal.getHeight(e)?lt.internal.getWidth(e)/4:lt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),a=Number((i*lt.internal.Bezier_C).toFixed(5)),s=Number((n*lt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Ds(lt.internal.getWidth(e)/2)+" "+Ds(lt.internal.getHeight(e)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),r.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),r.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),r.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+Ds(lt.internal.getWidth(e)/2)+" "+Ds(lt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=Ra(e);t.scope=e.scope;var r=[],n=lt.internal.getWidth(e)<=lt.internal.getHeight(e)?lt.internal.getWidth(e)/4:lt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),a=Number((i*lt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+Ds(lt.internal.getWidth(e)/2)+" "+Ds(lt.internal.getHeight(e)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),r.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),r.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),r.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:lt.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=lt.RadioButton.Cross.YesNormal,t.D[e]=lt.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=Ra(e);t.scope=e.scope;var r=[],n=lt.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+Tt(lt.internal.getWidth(e)-2)+" "+Tt(lt.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(Tt(n.x1.x)+" "+Tt(n.x1.y)+" m"),r.push(Tt(n.x2.x)+" "+Tt(n.x2.y)+" l"),r.push(Tt(n.x4.x)+" "+Tt(n.x4.y)+" m"),r.push(Tt(n.x3.x)+" "+Tt(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Ra(e);t.scope=e.scope;var r=lt.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+Tt(lt.internal.getWidth(e))+" "+Tt(lt.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Tt(lt.internal.getWidth(e)-2)+" "+Tt(lt.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(Tt(r.x1.x)+" "+Tt(r.x1.y)+" m"),n.push(Tt(r.x2.x)+" "+Tt(r.x2.y)+" l"),n.push(Tt(r.x4.x)+" "+Tt(r.x4.y)+" m"),n.push(Tt(r.x3.x)+" "+Tt(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=Ra(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Tt(lt.internal.getWidth(e))+" "+Tt(lt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};lt.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=lt.internal.getWidth(e),r=lt.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},lt.internal.getWidth=function(e){var t=0;return Qt(e)==="object"&&(t=gy(e.Rect[2])),t},lt.internal.getHeight=function(e){var t=0;return Qt(e)==="object"&&(t=gy(e.Rect[3])),t};var AO=Ar.addField=function(e){if(EO(this,e),!(e instanceof Sa))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};Ar.AcroFormChoiceField=Wo,Ar.AcroFormListBox=qo,Ar.AcroFormComboBox=$o,Ar.AcroFormEditBox=Gc,Ar.AcroFormButton=Zr,Ar.AcroFormPushButton=Kc,Ar.AcroFormRadioButton=Vo,Ar.AcroFormCheckBox=Yc,Ar.AcroFormTextField=no,Ar.AcroFormPasswordField=Xc,Ar.AcroFormAppearance=lt,Ar.AcroForm={ChoiceField:Wo,ListBox:qo,ComboBox:$o,EditBox:Gc,Button:Zr,PushButton:Kc,RadioButton:Vo,CheckBox:Yc,TextField:no,PasswordField:Xc,Appearance:lt},mt.AcroForm={ChoiceField:Wo,ListBox:qo,ComboBox:$o,EditBox:Gc,Button:Zr,PushButton:Kc,RadioButton:Vo,CheckBox:Yc,TextField:no,PasswordField:Xc,Appearance:lt};var TO=mt.AcroForm;function Z4(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){e.__addimage__={};var t="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},n=e.__addimage__.getImageFileTypeByImageData=function(N,C){var U,Y,ce,ee,Q,X=t;if((C=C||t)==="RGBA"||N.data!==void 0&&N.data instanceof Uint8ClampedArray&&"height"in N&&"width"in N)return"RGBA";if(B(N))for(Q in r)for(ce=r[Q],U=0;U<ce.length;U+=1){for(ee=!0,Y=0;Y<ce[U].length;Y+=1)if(ce[U][Y]!==void 0&&ce[U][Y]!==N[Y]){ee=!1;break}if(ee===!0){X=Q;break}}else for(Q in r)for(ce=r[Q],U=0;U<ce.length;U+=1){for(ee=!0,Y=0;Y<ce[U].length;Y+=1)if(ce[U][Y]!==void 0&&ce[U][Y]!==N.charCodeAt(Y)){ee=!1;break}if(ee===!0){X=Q;break}}return X===t&&C!==t&&(X=C),X},i=function N(C){for(var U=this.internal.write,Y=this.internal.putStream,ce=(0,this.internal.getFilters)();ce.indexOf("FlateEncode")!==-1;)ce.splice(ce.indexOf("FlateEncode"),1);C.objectId=this.internal.newObject();var ee=[];if(ee.push({key:"Type",value:"/XObject"}),ee.push({key:"Subtype",value:"/Image"}),ee.push({key:"Width",value:C.width}),ee.push({key:"Height",value:C.height}),C.colorSpace===S.INDEXED?ee.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(C.palette.length/3-1)+" "+("sMask"in C&&C.sMask!==void 0?C.objectId+2:C.objectId+1)+" 0 R]"}):(ee.push({key:"ColorSpace",value:"/"+C.colorSpace}),C.colorSpace===S.DEVICE_CMYK&&ee.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),ee.push({key:"BitsPerComponent",value:C.bitsPerComponent}),"decodeParameters"in C&&C.decodeParameters!==void 0&&ee.push({key:"DecodeParms",value:"<<"+C.decodeParameters+">>"}),"transparency"in C&&Array.isArray(C.transparency)){for(var Q="",X=0,z=C.transparency.length;X<z;X++)Q+=C.transparency[X]+" "+C.transparency[X]+" ";ee.push({key:"Mask",value:"["+Q+"]"})}C.sMask!==void 0&&ee.push({key:"SMask",value:C.objectId+1+" 0 R"});var ae=C.filter!==void 0?["/"+C.filter]:void 0;if(Y({data:C.data,additionalKeyValues:ee,alreadyAppliedFilters:ae,objectId:C.objectId}),U("endobj"),"sMask"in C&&C.sMask!==void 0){var me="/Predictor "+C.predictor+" /Colors 1 /BitsPerComponent "+C.bitsPerComponent+" /Columns "+C.width,E={width:C.width,height:C.height,colorSpace:"DeviceGray",bitsPerComponent:C.bitsPerComponent,decodeParameters:me,data:C.sMask};"filter"in C&&(E.filter=C.filter),N.call(this,E)}if(C.colorSpace===S.INDEXED){var O=this.internal.newObject();Y({data:L(new Uint8Array(C.palette)),objectId:O}),U("endobj")}},a=function(){var N=this.internal.collections.addImage_images;for(var C in N)i.call(this,N[C])},s=function(){var N,C=this.internal.collections.addImage_images,U=this.internal.write;for(var Y in C)U("/I"+(N=C[Y]).index,N.objectId,"0","R")},o=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",a),this.internal.events.subscribe("putXobjectDict",s))},l=function(){var N=this.internal.collections.addImage_images;return o.call(this),N},u=function(){return Object.keys(this.internal.collections.addImage_images).length},f=function(N){return typeof e["process"+N.toUpperCase()]=="function"},d=function(N){return Qt(N)==="object"&&N.nodeType===1},p=function(N,C){if(N.nodeName==="IMG"&&N.hasAttribute("src")){var U=""+N.getAttribute("src");if(U.indexOf("data:image/")===0)return Vc(unescape(U).split("base64,").pop());var Y=e.loadFile(U,!0);if(Y!==void 0)return Y}if(N.nodeName==="CANVAS"){if(N.width===0||N.height===0)throw new Error("Given canvas must have data. Canvas width: "+N.width+", height: "+N.height);var ce;switch(C){case"PNG":ce="image/png";break;case"WEBP":ce="image/webp";break;case"JPEG":case"JPG":default:ce="image/jpeg"}return Vc(N.toDataURL(ce,1).split("base64,").pop())}},h=function(N){var C=this.internal.collections.addImage_images;if(C){for(var U in C)if(N===C[U].alias)return C[U]}},v=function(N,C,U){return N||C||(N=-96,C=-96),N<0&&(N=-1*U.width*72/N/this.internal.scaleFactor),C<0&&(C=-1*U.height*72/C/this.internal.scaleFactor),N===0&&(N=C*U.width/U.height),C===0&&(C=N*U.height/U.width),[N,C]},m=function(N,C,U,Y,ce,ee){var Q=v.call(this,U,Y,ce),X=this.internal.getCoordinateString,z=this.internal.getVerticalCoordinateString,ae=l.call(this);if(U=Q[0],Y=Q[1],ae[ce.index]=ce,ee){ee*=Math.PI/180;var me=Math.cos(ee),E=Math.sin(ee),O=function(I){return I.toFixed(4)},F=[O(me),O(E),O(-1*E),O(me),0,0,"cm"]}this.internal.write("q"),ee?(this.internal.write([1,"0","0",1,X(N),z(C+Y),"cm"].join(" ")),this.internal.write(F.join(" ")),this.internal.write([X(U),"0","0",X(Y),"0","0","cm"].join(" "))):this.internal.write([X(U),"0","0",X(Y),X(N),z(C+Y),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ce.index+" Do"),this.internal.write("Q")},S=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var y=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},w=e.__addimage__.sHashCode=function(N){var C,U,Y=0;if(typeof N=="string")for(U=N.length,C=0;C<U;C++)Y=(Y<<5)-Y+N.charCodeAt(C),Y|=0;else if(B(N))for(U=N.byteLength/2,C=0;C<U;C++)Y=(Y<<5)-Y+N[C],Y|=0;return Y},x=e.__addimage__.validateStringAsBase64=function(N){(N=N||"").toString().trim();var C=!0;return N.length===0&&(C=!1),N.length%4!=0&&(C=!1),/^[A-Za-z0-9+/]+$/.test(N.substr(0,N.length-2))===!1&&(C=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(N.substr(-2))===!1&&(C=!1),C},A=e.__addimage__.extractImageFromDataUrl=function(N){var C=(N=N||"").split("base64,"),U=null;if(C.length===2){var Y=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(C[0]);Array.isArray(Y)&&(U={mimeType:Y[1],charset:Y[2],data:C[1]})}return U},R=e.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};e.__addimage__.isArrayBuffer=function(N){return R()&&N instanceof ArrayBuffer};var B=e.__addimage__.isArrayBufferView=function(N){return R()&&typeof Uint32Array<"u"&&(N instanceof Int8Array||N instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&N instanceof Uint8ClampedArray||N instanceof Int16Array||N instanceof Uint16Array||N instanceof Int32Array||N instanceof Uint32Array||N instanceof Float32Array||N instanceof Float64Array)},T=e.__addimage__.binaryStringToUint8Array=function(N){for(var C=N.length,U=new Uint8Array(C),Y=0;Y<C;Y++)U[Y]=N.charCodeAt(Y);return U},L=e.__addimage__.arrayBufferToBinaryString=function(N){for(var C="",U=B(N)?N:new Uint8Array(N),Y=0;Y<U.length;Y+=8192)C+=String.fromCharCode.apply(null,U.subarray(Y,Y+8192));return C};e.addImage=function(){var N,C,U,Y,ce,ee,Q,X,z;if(typeof arguments[1]=="number"?(C=t,U=arguments[1],Y=arguments[2],ce=arguments[3],ee=arguments[4],Q=arguments[5],X=arguments[6],z=arguments[7]):(C=arguments[1],U=arguments[2],Y=arguments[3],ce=arguments[4],ee=arguments[5],Q=arguments[6],X=arguments[7],z=arguments[8]),Qt(N=arguments[0])==="object"&&!d(N)&&"imageData"in N){var ae=N;N=ae.imageData,C=ae.format||C||t,U=ae.x||U||0,Y=ae.y||Y||0,ce=ae.w||ae.width||ce,ee=ae.h||ae.height||ee,Q=ae.alias||Q,X=ae.compression||X,z=ae.rotation||ae.angle||z}var me=this.internal.getFilters();if(X===void 0&&me.indexOf("FlateEncode")!==-1&&(X="SLOW"),isNaN(U)||isNaN(Y))throw new Error("Invalid coordinates passed to jsPDF.addImage");o.call(this);var E=P.call(this,N,C,Q,X);return m.call(this,U,Y,ce,ee,E,z),this};var P=function(N,C,U,Y){var ce,ee,Q;if(typeof N=="string"&&n(N)===t){N=unescape(N);var X=M(N,!1);(X!==""||(X=e.loadFile(N,!0))!==void 0)&&(N=X)}if(d(N)&&(N=p(N,C)),C=n(N,C),!f(C))throw new Error("addImage does not support files of type '"+C+"', please ensure that a plugin for '"+C+"' support is added.");if(((Q=U)==null||Q.length===0)&&(U=function(z){return typeof z=="string"||B(z)?w(z):B(z.data)?w(z.data):null}(N)),(ce=h.call(this,U))||(R()&&(N instanceof Uint8Array||C==="RGBA"||(ee=N,N=T(N))),ce=this["process"+C.toUpperCase()](N,u.call(this),U,function(z){return z&&typeof z=="string"&&(z=z.toUpperCase()),z in e.image_compression?z:y.NONE}(Y),ee)),!ce)throw new Error("An unknown error occurred whilst processing the image.");return ce},M=e.__addimage__.convertBase64ToBinaryString=function(N,C){var U;C=typeof C!="boolean"||C;var Y,ce="";if(typeof N=="string"){Y=(U=A(N))!==null?U.data:N;try{ce=Vc(Y)}catch(ee){if(C)throw x(Y)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+ee.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return ce};e.getImageProperties=function(N){var C,U,Y="";if(d(N)&&(N=p(N)),typeof N=="string"&&n(N)===t&&((Y=M(N,!1))===""&&(Y=e.loadFile(N)||""),N=Y),U=n(N),!f(U))throw new Error("addImage does not support files of type '"+U+"', please ensure that a plugin for '"+U+"' support is added.");if(!R()||N instanceof Uint8Array||(N=T(N)),!(C=this["process"+U.toUpperCase()](N)))throw new Error("An unknown error occurred whilst processing the image");return C.fileType=U,C}})(mt.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};mt.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,i,a,s=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,l=this.internal.getPageInfoByObjId(r.objId),u=r.pageContext.annotations,f=!1,d=0;d<u.length&&!f;d++)switch((n=u[d]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(f=!0);break;case"reference":case"text":case"freetext":f=!0}if(f!=0){this.internal.write("/Annots [");for(var p=0;p<u.length;p++){n=u[p];var h=this.internal.pdfEscape,v=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var m=this.internal.newAdditionalObject(),S=this.internal.newAdditionalObject(),y=this.internal.getEncryptor(m.objId),w=n.title||"Note";a="<</Type /Annot /Subtype /Text "+(i="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+h(y(n.contents))+")",a+=" /Popup "+S.objId+" 0 R",a+=" /P "+l.objId+" 0 R",a+=" /T ("+h(y(w))+") >>",m.content=a;var x=m.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+s(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+x,n.open&&(a+=" /Open true"),a+=" >>",S.content=a,this.internal.write(m.objId,"0 R",S.objId,"0 R");break;case"freetext":i="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var A=n.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+h(v(n.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+A+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(n.options.name){var R=this.annotations._nameMap[n.options.name];n.options.pageNumber=R.page,n.options.top=R.y}else n.options.top||(n.options.top=0);if(i="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",a="",n.options.url)a="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+h(v(n.options.url))+") >>";else if(n.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,a+=" /FitV "+n.options.left+"]";break;case"XYZ":default:var B=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),a+=" /XYZ "+n.options.left+" "+B+" "+n.options.zoom+"]"}a!=""&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,i,a,s){var o=this.internal.getCurrentPageInfo(),l=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:l(r),y:u(n),w:l(r+i),h:u(n+a)},options:s,type:"link"})},e.textWithLink=function(r,n,i,a){var s,o,l=this.getTextWidth(r),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(a.maxWidth!==void 0){o=a.maxWidth;var f=this.splitTextToSize(r,o).length;s=Math.ceil(u*f)}else o=l,s=u;return this.text(r,n,i,a),i+=.2*u,a.align==="center"&&(n-=l/2),a.align==="right"&&(n-=l),this.link(n,i-u,o,s,a),l},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(mt.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];e.__arabicParser__={};var a=e.__arabicParser__.isInArabicSubstitutionA=function(m){return t[m.charCodeAt(0)]!==void 0},s=e.__arabicParser__.isArabicLetter=function(m){return typeof m=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(m)},o=e.__arabicParser__.isArabicEndLetter=function(m){return s(m)&&a(m)&&t[m.charCodeAt(0)].length<=2},l=e.__arabicParser__.isArabicAlfLetter=function(m){return s(m)&&i.indexOf(m.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(m){return s(m)&&a(m)&&t[m.charCodeAt(0)].length>=1};var u=e.__arabicParser__.arabicLetterHasFinalForm=function(m){return s(m)&&a(m)&&t[m.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(m){return s(m)&&a(m)&&t[m.charCodeAt(0)].length>=3};var f=e.__arabicParser__.arabicLetterHasMedialForm=function(m){return s(m)&&a(m)&&t[m.charCodeAt(0)].length==4},d=e.__arabicParser__.resolveLigatures=function(m){var S=0,y=r,w="",x=0;for(S=0;S<m.length;S+=1)y[m.charCodeAt(S)]!==void 0?(x++,typeof(y=y[m.charCodeAt(S)])=="number"&&(w+=String.fromCharCode(y),y=r,x=0),S===m.length-1&&(y=r,w+=m.charAt(S-(x-1)),S-=x-1,x=0)):(y=r,w+=m.charAt(S-x),S-=x,x=0);return w};e.__arabicParser__.isArabicDiacritic=function(m){return m!==void 0&&n[m.charCodeAt(0)]!==void 0};var p=e.__arabicParser__.getCorrectForm=function(m,S,y){return s(m)?a(m)===!1?-1:!u(m)||!s(S)&&!s(y)||!s(y)&&o(S)||o(m)&&!s(S)||o(m)&&l(S)||o(m)&&o(S)?0:f(m)&&s(S)&&!o(S)&&s(y)&&u(y)?3:o(m)||!s(y)?1:2:-1},h=function(m){var S=0,y=0,w=0,x="",A="",R="",B=(m=m||"").split("\\s+"),T=[];for(S=0;S<B.length;S+=1){for(T.push(""),y=0;y<B[S].length;y+=1)x=B[S][y],A=B[S][y-1],R=B[S][y+1],s(x)?(w=p(x,A,R),T[S]+=w!==-1?String.fromCharCode(t[x.charCodeAt(0)][w]):x):T[S]+=x;T[S]=d(T[S])}return T.join(" ")},v=e.__arabicParser__.processArabic=e.processArabic=function(){var m,S=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,y=[];if(Array.isArray(S)){var w=0;for(y=[],w=0;w<S.length;w+=1)Array.isArray(S[w])?y.push([h(S[w][0]),S[w][1],S[w][2]]):y.push([h(S[w])]);m=y}else m=h(S);return typeof arguments[0]=="string"?m:(arguments[0].text=m,arguments[0])};e.events.push(["preProcessText",v])}(mt.API),mt.API.autoPrint=function(e){var t;switch((e=e||{}).variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})}return this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(o){r=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(o){i=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var a=[];Object.defineProperty(this,"childNodes",{get:function(){return a},set:function(o){a=o}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(o){s=o}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var i;if((r=r||"2d")!=="2d")return null;for(i in n)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=n[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(mt.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new a,this.internal.__cell__.pages=1},a=function(){var l=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return l},set:function(m){l=m}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(m){u=m}});var f=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return f},set:function(m){f=m}});var d=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return d},set:function(m){d=m}});var p=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return p},set:function(m){p=m}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(m){h=m}});var v=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return v},set:function(m){v=m}}),this};a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},a.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(l){return n.call(this),this.internal.__cell__.headerFunction=typeof l=="function"?l:void 0,this},e.getTextDimensions=function(l,u){n.call(this);var f=(u=u||{}).fontSize||this.getFontSize(),d=u.font||this.getFont(),p=u.scaleFactor||this.internal.scaleFactor,h=0,v=0,m=0,S=this;if(!Array.isArray(l)&&typeof l!="string"){if(typeof l!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");l=String(l)}var y=u.maxWidth;y>0?typeof l=="string"?l=this.splitTextToSize(l,y):Object.prototype.toString.call(l)==="[object Array]"&&(l=l.reduce(function(x,A){return x.concat(S.splitTextToSize(A,y))},[])):l=Array.isArray(l)?l:[l];for(var w=0;w<l.length;w++)h<(m=this.getStringUnitWidth(l[w],{font:d})*f)&&(h=m);return h!==0&&(v=l.length),{w:h/=p,h:Math.max((v*f*this.getLineHeightFactor()-f*(this.getLineHeightFactor()-1))/p,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var l=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new a(l.left,l.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=e.cell=function(){var l;l=arguments[0]instanceof a?arguments[0]:new a(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var u=this.internal.__cell__.lastCell,f=this.internal.__cell__.padding,d=this.internal.__cell__.margins||t,p=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===l.lineNumber?(l.x=(u.x||0)+(u.width||0),l.y=u.y||0):u.y+u.height+l.height+d.bottom>this.getPageHeight()?(this.cellAddPage(),l.y=d.top,h&&p&&(this.printHeaderRow(l.lineNumber,!0),l.y+=p[0].height)):l.y=u.y+u.height||l.y),l.text[0]!==void 0&&(this.rect(l.x,l.y,l.width,l.height,r===!0?"FD":void 0),l.align==="right"?this.text(l.text,l.x+l.width-f,l.y+f,{align:"right",baseline:"top"}):l.align==="center"?this.text(l.text,l.x+l.width/2,l.y+f,{align:"center",baseline:"top",maxWidth:l.width-f-f}):this.text(l.text,l.x+f,l.y+f,{align:"left",baseline:"top",maxWidth:l.width-f-f})),this.internal.__cell__.lastCell=l,this};e.table=function(l,u,f,d,p){if(n.call(this),!f)throw new Error("No data for PDF table.");var h,v,m,S,y=[],w=[],x=[],A={},R={},B=[],T=[],L=(p=p||{}).autoSize||!1,P=p.printHeaders!==!1,M=p.css&&p.css["font-size"]!==void 0?16*p.css["font-size"]:p.fontSize||12,N=p.margins||Object.assign({width:this.getPageWidth()},t),C=typeof p.padding=="number"?p.padding:3,U=p.headerBackgroundColor||"#c8c8c8",Y=p.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=P,this.internal.__cell__.margins=N,this.internal.__cell__.table_font_size=M,this.internal.__cell__.padding=C,this.internal.__cell__.headerBackgroundColor=U,this.internal.__cell__.headerTextColor=Y,this.setFontSize(M),d==null)w=y=Object.keys(f[0]),x=y.map(function(){return"left"});else if(Array.isArray(d)&&Qt(d[0])==="object")for(y=d.map(function(ae){return ae.name}),w=d.map(function(ae){return ae.prompt||ae.name||""}),x=d.map(function(ae){return ae.align||"left"}),h=0;h<d.length;h+=1)R[d[h].name]=d[h].width*(19.049976/25.4);else Array.isArray(d)&&typeof d[0]=="string"&&(w=y=d,x=y.map(function(){return"left"}));if(L||Array.isArray(d)&&typeof d[0]=="string")for(h=0;h<y.length;h+=1){for(A[S=y[h]]=f.map(function(ae){return ae[S]}),this.setFont(void 0,"bold"),B.push(this.getTextDimensions(w[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),v=A[S],this.setFont(void 0,"normal"),m=0;m<v.length;m+=1)B.push(this.getTextDimensions(v[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);R[S]=Math.max.apply(null,B)+C+C,B=[]}if(P){var ce={};for(h=0;h<y.length;h+=1)ce[y[h]]={},ce[y[h]].text=w[h],ce[y[h]].align=x[h];var ee=o.call(this,ce,R);T=y.map(function(ae){return new a(l,u,R[ae],ee,ce[ae].text,void 0,ce[ae].align)}),this.setTableHeaderRow(T),this.printHeaderRow(1,!1)}var Q=d.reduce(function(ae,me){return ae[me.name]=me.align,ae},{});for(h=0;h<f.length;h+=1){"rowStart"in p&&p.rowStart instanceof Function&&p.rowStart({row:h,data:f[h]},this);var X=o.call(this,f[h],R);for(m=0;m<y.length;m+=1){var z=f[h][y[m]];"cellStart"in p&&p.cellStart instanceof Function&&p.cellStart({row:h,col:m,data:z},this),s.call(this,new a(l,u,R[y[m]],X,z,h+2,Q[y[m]]))}}return this.internal.__cell__.table_x=l,this.internal.__cell__.table_y=u,this};var o=function(l,u){var f=this.internal.__cell__.padding,d=this.internal.__cell__.table_font_size,p=this.internal.scaleFactor;return Object.keys(l).map(function(h){var v=l[h];return this.splitTextToSize(v.hasOwnProperty("text")?v.text:v,u[h]-f-f)},this).map(function(h){return this.getLineHeightFactor()*h.length*d/p+f+f},this).reduce(function(h,v){return Math.max(h,v)},0)};e.setTableHeaderRow=function(l){n.call(this),this.internal.__cell__.tableHeaderRow=l},e.printHeaderRow=function(l,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var f;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var d=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new a(d[0],d[1],d[2],d[3],void 0,-1)}this.setFont(void 0,"bold");for(var p=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){f=this.internal.__cell__.tableHeaderRow[h].clone(),u&&(f.y=this.internal.__cell__.margins.top||0,p.push(f)),f.lineNumber=l;var v=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,f),this.setTextColor(v)}p.length>0&&this.setTableHeaderRow(p),this.setFont(void 0,"normal"),r=!1}}(mt.API);var e3={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},t3=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Wg=Z4(t3),r3=[100,200,300,400,500,600,700,800,900],kO=Z4(r3);function qg(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(a){return e3[a=a||"normal"]?a:"normal"}(e.style),n=function(a){if(!a)return 400;if(typeof a=="number")return a>=100&&a<=900&&a%100==0?a:400;if(/^\d00$/.test(a))return parseInt(a);switch(a){case"bold":return 700;case"normal":default:return 400}}(e.weight),i=function(a){return typeof Wg[a=a||"normal"]=="number"?a:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:i,src:e.src||[],ref:e.ref||{name:t,style:[i,r,n].join(" ")}}}function my(e,t,r,n){var i;for(i=r;i>=0&&i<t.length;i+=n)if(e[t[i]])return e[t[i]];for(i=r;i>=0&&i<t.length;i-=n)if(e[t[i]])return e[t[i]]}var NO={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},vy={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function yy(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function CO(e,t,r){for(var n=(r=r||{}).defaultFontFamily||"times",i=Object.assign({},NO,r.genericFontFamilies||{}),a=null,s=null,o=0;o<t.length;++o)if(i[(a=qg(t[o])).family]&&(a.family=i[a.family]),e.hasOwnProperty(a.family)){s=e[a.family];break}if(!(s=s||e[n]))throw new Error("Could not find a font-family for the rule '"+yy(a)+"' and default family '"+n+"'.");if(s=function(l,u){if(u[l])return u[l];var f=Wg[l],d=f<=Wg.normal?-1:1,p=my(u,t3,f,d);if(!p)throw new Error("Could not find a matching font-stretch value for "+l);return p}(a.stretch,s),s=function(l,u){if(u[l])return u[l];for(var f=e3[l],d=0;d<f.length;++d)if(u[f[d]])return u[f[d]];throw new Error("Could not find a matching font-style for "+l)}(a.style,s),!(s=function(l,u){if(u[l])return u[l];if(l===400&&u[500])return u[500];if(l===500&&u[400])return u[400];var f=kO[l],d=my(u,r3,f,l<400?-1:1);if(!d)throw new Error("Could not find a matching font-weight for value "+l);return d}(a.weight,s)))throw new Error("Failed to resolve a font for the rule '"+yy(a)+"'.");return s}function wy(e){return e.trimLeft()}function LO(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function PO(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var f0,xy,_y,Ep=["times"];(function(e){var t,r,n,i,a,s,o,l,u,f=function(E){return E=E||{},this.isStrokeTransparent=E.isStrokeTransparent||!1,this.strokeOpacity=E.strokeOpacity||1,this.strokeStyle=E.strokeStyle||"#000000",this.fillStyle=E.fillStyle||"#000000",this.isFillTransparent=E.isFillTransparent||!1,this.fillOpacity=E.fillOpacity||1,this.font=E.font||"10px sans-serif",this.textBaseline=E.textBaseline||"alphabetic",this.textAlign=E.textAlign||"left",this.lineWidth=E.lineWidth||1,this.lineJoin=E.lineJoin||"miter",this.lineCap=E.lineCap||"butt",this.path=E.path||[],this.transform=E.transform!==void 0?E.transform.clone():new l,this.globalCompositeOperation=E.globalCompositeOperation||"normal",this.globalAlpha=E.globalAlpha||1,this.clip_path=E.clip_path||[],this.currentPoint=E.currentPoint||new s,this.miterLimit=E.miterLimit||10,this.lastPoint=E.lastPoint||new s,this.lineDashOffset=E.lineDashOffset||0,this.lineDash=E.lineDash||[],this.margin=E.margin||[0,0,0,0],this.prevPageLastElemOffset=E.prevPageLastElemOffset||0,this.ignoreClearRect=typeof E.ignoreClearRect!="boolean"||E.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new d(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,a=this.internal.getVerticalCoordinate,s=this.internal.Point,o=this.internal.Rectangle,l=this.internal.Matrix,u=new f}]);var d=function(E){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var O=E;Object.defineProperty(this,"pdf",{get:function(){return O}});var F=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return F},set:function(ke){F=!!ke}});var I=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return I},set:function(ke){I=!!ke}});var V=0;Object.defineProperty(this,"posX",{get:function(){return V},set:function(ke){isNaN(ke)||(V=ke)}});var ue=0;Object.defineProperty(this,"posY",{get:function(){return ue},set:function(ke){isNaN(ke)||(ue=ke)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(ke){var le;typeof ke=="number"?le=[ke,ke,ke,ke]:((le=new Array(4))[0]=ke[0],le[1]=ke.length>=2?ke[1]:le[0],le[2]=ke.length>=3?ke[2]:le[0],le[3]=ke.length>=4?ke[3]:le[1]),u.margin=le}});var fe=!1;Object.defineProperty(this,"autoPaging",{get:function(){return fe},set:function(ke){fe=ke}});var he=0;Object.defineProperty(this,"lastBreak",{get:function(){return he},set:function(ke){he=ke}});var xe=[];Object.defineProperty(this,"pageBreaks",{get:function(){return xe},set:function(ke){xe=ke}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(ke){ke instanceof f&&(u=ke)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(ke){u.path=ke}});var Oe=[];Object.defineProperty(this,"ctxStack",{get:function(){return Oe},set:function(ke){Oe=ke}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(ke){var le;le=p(ke),this.ctx.fillStyle=le.style,this.ctx.isFillTransparent=le.a===0,this.ctx.fillOpacity=le.a,this.pdf.setFillColor(le.r,le.g,le.b,{a:le.a}),this.pdf.setTextColor(le.r,le.g,le.b,{a:le.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(ke){var le=p(ke);this.ctx.strokeStyle=le.style,this.ctx.isStrokeTransparent=le.a===0,this.ctx.strokeOpacity=le.a,le.a===0?this.pdf.setDrawColor(255,255,255):(le.a,this.pdf.setDrawColor(le.r,le.g,le.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(ke){["butt","round","square"].indexOf(ke)!==-1&&(this.ctx.lineCap=ke,this.pdf.setLineCap(ke))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(ke){isNaN(ke)||(this.ctx.lineWidth=ke,this.pdf.setLineWidth(ke))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(ke){["bevel","round","miter"].indexOf(ke)!==-1&&(this.ctx.lineJoin=ke,this.pdf.setLineJoin(ke))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(ke){isNaN(ke)||(this.ctx.miterLimit=ke,this.pdf.setMiterLimit(ke))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(ke){this.ctx.textBaseline=ke}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(ke){["right","end","center","left","start"].indexOf(ke)!==-1&&(this.ctx.textAlign=ke)}});var De=null;function qe(ke,le){if(De===null){var je=function(it){var Ue=[];return Object.keys(it).forEach(function(Ve){it[Ve].forEach(function(Je){var Ze=null;switch(Je){case"bold":Ze={family:Ve,weight:"bold"};break;case"italic":Ze={family:Ve,style:"italic"};break;case"bolditalic":Ze={family:Ve,weight:"bold",style:"italic"};break;case"":case"normal":Ze={family:Ve}}Ze!==null&&(Ze.ref={name:Ve,style:Je},Ue.push(Ze))})}),Ue}(ke.getFontList());De=function(it){for(var Ue={},Ve=0;Ve<it.length;++Ve){var Je=qg(it[Ve]),Ze=Je.family,ct=Je.stretch,ht=Je.style,St=Je.weight;Ue[Ze]=Ue[Ze]||{},Ue[Ze][ct]=Ue[Ze][ct]||{},Ue[Ze][ct][ht]=Ue[Ze][ct][ht]||{},Ue[Ze][ct][ht][St]=Je}return Ue}(je.concat(le))}return De}var Xe=null;Object.defineProperty(this,"fontFaces",{get:function(){return Xe},set:function(ke){De=null,Xe=ke}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(ke){var le;if(this.ctx.font=ke,(le=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(ke))!==null){var je=le[1],it=(le[2],le[3]),Ue=le[4],Ve=(le[5],le[6]),Je=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Ue)[2];Ue=Math.floor(Je==="px"?parseFloat(Ue)*this.pdf.internal.scaleFactor:Je==="em"?parseFloat(Ue)*this.pdf.getFontSize():parseFloat(Ue)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Ue);var Ze=function(wt){var Lt,tt,Gr=[],Dt=wt.trim();if(Dt==="")return Ep;if(Dt in vy)return[vy[Dt]];for(;Dt!=="";){switch(tt=null,Lt=(Dt=wy(Dt)).charAt(0)){case'"':case"'":tt=LO(Dt.substring(1),Lt);break;default:tt=PO(Dt)}if(tt===null||(Gr.push(tt[0]),(Dt=wy(tt[1]))!==""&&Dt.charAt(0)!==","))return Ep;Dt=Dt.replace(/^,/,"")}return Gr}(Ve);if(this.fontFaces){var ct=CO(qe(this.pdf,this.fontFaces),Ze.map(function(wt){return{family:wt,stretch:"normal",weight:it,style:je}}));this.pdf.setFont(ct.ref.name,ct.ref.style)}else{var ht="";(it==="bold"||parseInt(it,10)>=700||je==="bold")&&(ht="bold"),je==="italic"&&(ht+="italic"),ht.length===0&&(ht="normal");for(var St="",Nt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Ot=0;Ot<Ze.length;Ot++){if(this.pdf.internal.getFont(Ze[Ot],ht,{noFallback:!0,disableWarning:!0})!==void 0){St=Ze[Ot];break}if(ht==="bolditalic"&&this.pdf.internal.getFont(Ze[Ot],"bold",{noFallback:!0,disableWarning:!0})!==void 0)St=Ze[Ot],ht="bold";else if(this.pdf.internal.getFont(Ze[Ot],"normal",{noFallback:!0,disableWarning:!0})!==void 0){St=Ze[Ot],ht="normal";break}}if(St===""){for(var Rt=0;Rt<Ze.length;Rt++)if(Nt[Ze[Rt]]){St=Nt[Ze[Rt]];break}}St=St===""?"Times":St,this.pdf.setFont(St,ht)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(ke){this.ctx.globalCompositeOperation=ke}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(ke){this.ctx.globalAlpha=ke}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(ke){this.ctx.lineDashOffset=ke,me.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(ke){this.ctx.lineDash=ke,me.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(ke){this.ctx.ignoreClearRect=!!ke}})};d.prototype.setLineDash=function(E){this.lineDash=E},d.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},d.prototype.fill=function(){A.call(this,"fill",!1)},d.prototype.stroke=function(){A.call(this,"stroke",!1)},d.prototype.beginPath=function(){this.path=[{type:"begin"}]},d.prototype.moveTo=function(E,O){if(isNaN(E)||isNaN(O))throw sr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var F=this.ctx.transform.applyToPoint(new s(E,O));this.path.push({type:"mt",x:F.x,y:F.y}),this.ctx.lastPoint=new s(E,O)},d.prototype.closePath=function(){var E=new s(0,0),O=0;for(O=this.path.length-1;O!==-1;O--)if(this.path[O].type==="begin"&&Qt(this.path[O+1])==="object"&&typeof this.path[O+1].x=="number"){E=new s(this.path[O+1].x,this.path[O+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(E.x,E.y)},d.prototype.lineTo=function(E,O){if(isNaN(E)||isNaN(O))throw sr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var F=this.ctx.transform.applyToPoint(new s(E,O));this.path.push({type:"lt",x:F.x,y:F.y}),this.ctx.lastPoint=new s(F.x,F.y)},d.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),A.call(this,null,!0)},d.prototype.quadraticCurveTo=function(E,O,F,I){if(isNaN(F)||isNaN(I)||isNaN(E)||isNaN(O))throw sr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var V=this.ctx.transform.applyToPoint(new s(F,I)),ue=this.ctx.transform.applyToPoint(new s(E,O));this.path.push({type:"qct",x1:ue.x,y1:ue.y,x:V.x,y:V.y}),this.ctx.lastPoint=new s(V.x,V.y)},d.prototype.bezierCurveTo=function(E,O,F,I,V,ue){if(isNaN(V)||isNaN(ue)||isNaN(E)||isNaN(O)||isNaN(F)||isNaN(I))throw sr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var fe=this.ctx.transform.applyToPoint(new s(V,ue)),he=this.ctx.transform.applyToPoint(new s(E,O)),xe=this.ctx.transform.applyToPoint(new s(F,I));this.path.push({type:"bct",x1:he.x,y1:he.y,x2:xe.x,y2:xe.y,x:fe.x,y:fe.y}),this.ctx.lastPoint=new s(fe.x,fe.y)},d.prototype.arc=function(E,O,F,I,V,ue){if(isNaN(E)||isNaN(O)||isNaN(F)||isNaN(I)||isNaN(V))throw sr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ue=!!ue,!this.ctx.transform.isIdentity){var fe=this.ctx.transform.applyToPoint(new s(E,O));E=fe.x,O=fe.y;var he=this.ctx.transform.applyToPoint(new s(0,F)),xe=this.ctx.transform.applyToPoint(new s(0,0));F=Math.sqrt(Math.pow(he.x-xe.x,2)+Math.pow(he.y-xe.y,2))}Math.abs(V-I)>=2*Math.PI&&(I=0,V=2*Math.PI),this.path.push({type:"arc",x:E,y:O,radius:F,startAngle:I,endAngle:V,counterclockwise:ue})},d.prototype.arcTo=function(E,O,F,I,V){throw new Error("arcTo not implemented.")},d.prototype.rect=function(E,O,F,I){if(isNaN(E)||isNaN(O)||isNaN(F)||isNaN(I))throw sr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(E,O),this.lineTo(E+F,O),this.lineTo(E+F,O+I),this.lineTo(E,O+I),this.lineTo(E,O),this.lineTo(E+F,O),this.lineTo(E,O)},d.prototype.fillRect=function(E,O,F,I){if(isNaN(E)||isNaN(O)||isNaN(F)||isNaN(I))throw sr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var V={};this.lineCap!=="butt"&&(V.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(V.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(E,O,F,I),this.fill(),V.hasOwnProperty("lineCap")&&(this.lineCap=V.lineCap),V.hasOwnProperty("lineJoin")&&(this.lineJoin=V.lineJoin)}},d.prototype.strokeRect=function(E,O,F,I){if(isNaN(E)||isNaN(O)||isNaN(F)||isNaN(I))throw sr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");v.call(this)||(this.beginPath(),this.rect(E,O,F,I),this.stroke())},d.prototype.clearRect=function(E,O,F,I){if(isNaN(E)||isNaN(O)||isNaN(F)||isNaN(I))throw sr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(E,O,F,I))},d.prototype.save=function(E){E=typeof E!="boolean"||E;for(var O=this.pdf.internal.getCurrentPageInfo().pageNumber,F=0;F<this.pdf.internal.getNumberOfPages();F++)this.pdf.setPage(F+1),this.pdf.internal.out("q");if(this.pdf.setPage(O),E){this.ctx.fontSize=this.pdf.internal.getFontSize();var I=new f(this.ctx);this.ctxStack.push(this.ctx),this.ctx=I}},d.prototype.restore=function(E){E=typeof E!="boolean"||E;for(var O=this.pdf.internal.getCurrentPageInfo().pageNumber,F=0;F<this.pdf.internal.getNumberOfPages();F++)this.pdf.setPage(F+1),this.pdf.internal.out("Q");this.pdf.setPage(O),E&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},d.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var p=function(E){var O,F,I,V;if(E.isCanvasGradient===!0&&(E=E.getColor()),!E)return{r:0,g:0,b:0,a:0,style:E};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(E))O=0,F=0,I=0,V=0;else{var ue=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(E);if(ue!==null)O=parseInt(ue[1]),F=parseInt(ue[2]),I=parseInt(ue[3]),V=1;else if((ue=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(E))!==null)O=parseInt(ue[1]),F=parseInt(ue[2]),I=parseInt(ue[3]),V=parseFloat(ue[4]);else{if(V=1,typeof E=="string"&&E.charAt(0)!=="#"){var fe=new G4(E);E=fe.ok?fe.toHex():"#000000"}E.length===4?(O=E.substring(1,2),O+=O,F=E.substring(2,3),F+=F,I=E.substring(3,4),I+=I):(O=E.substring(1,3),F=E.substring(3,5),I=E.substring(5,7)),O=parseInt(O,16),F=parseInt(F,16),I=parseInt(I,16)}}return{r:O,g:F,b:I,a:V,style:E}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},v=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};d.prototype.fillText=function(E,O,F,I){if(isNaN(O)||isNaN(F)||typeof E!="string")throw sr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(I=isNaN(I)?void 0:I,!h.call(this)){var V=X(this.ctx.transform.rotation),ue=this.ctx.transform.scaleX;C.call(this,{text:E,x:O,y:F,scale:ue,angle:V,align:this.textAlign,maxWidth:I})}},d.prototype.strokeText=function(E,O,F,I){if(isNaN(O)||isNaN(F)||typeof E!="string")throw sr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!v.call(this)){I=isNaN(I)?void 0:I;var V=X(this.ctx.transform.rotation),ue=this.ctx.transform.scaleX;C.call(this,{text:E,x:O,y:F,scale:ue,renderingMode:"stroke",angle:V,align:this.textAlign,maxWidth:I})}},d.prototype.measureText=function(E){if(typeof E!="string")throw sr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var O=this.pdf,F=this.pdf.internal.scaleFactor,I=O.internal.getFontSize(),V=O.getStringUnitWidth(E)*I/O.internal.scaleFactor,ue=function(fe){var he=(fe=fe||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return he}}),this};return new ue({width:V*=Math.round(96*F/72*1e4)/1e4})},d.prototype.scale=function(E,O){if(isNaN(E)||isNaN(O))throw sr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var F=new l(E,0,0,O,0,0);this.ctx.transform=this.ctx.transform.multiply(F)},d.prototype.rotate=function(E){if(isNaN(E))throw sr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var O=new l(Math.cos(E),Math.sin(E),-Math.sin(E),Math.cos(E),0,0);this.ctx.transform=this.ctx.transform.multiply(O)},d.prototype.translate=function(E,O){if(isNaN(E)||isNaN(O))throw sr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var F=new l(1,0,0,1,E,O);this.ctx.transform=this.ctx.transform.multiply(F)},d.prototype.transform=function(E,O,F,I,V,ue){if(isNaN(E)||isNaN(O)||isNaN(F)||isNaN(I)||isNaN(V)||isNaN(ue))throw sr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var fe=new l(E,O,F,I,V,ue);this.ctx.transform=this.ctx.transform.multiply(fe)},d.prototype.setTransform=function(E,O,F,I,V,ue){E=isNaN(E)?1:E,O=isNaN(O)?0:O,F=isNaN(F)?0:F,I=isNaN(I)?1:I,V=isNaN(V)?0:V,ue=isNaN(ue)?0:ue,this.ctx.transform=new l(E,O,F,I,V,ue)};var m=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};d.prototype.drawImage=function(E,O,F,I,V,ue,fe,he,xe){var Oe=this.pdf.getImageProperties(E),De=1,qe=1,Xe=1,ke=1;I!==void 0&&he!==void 0&&(Xe=he/I,ke=xe/V,De=Oe.width/I*he/I,qe=Oe.height/V*xe/V),ue===void 0&&(ue=O,fe=F,O=0,F=0),I!==void 0&&he===void 0&&(he=I,xe=V),I===void 0&&he===void 0&&(he=Oe.width,xe=Oe.height);for(var le,je=this.ctx.transform.decompose(),it=X(je.rotate.shx),Ue=new l,Ve=(Ue=(Ue=(Ue=Ue.multiply(je.translate)).multiply(je.skew)).multiply(je.scale)).applyToRectangle(new o(ue-O*Xe,fe-F*ke,I*De,V*qe)),Je=S.call(this,Ve),Ze=[],ct=0;ct<Je.length;ct+=1)Ze.indexOf(Je[ct])===-1&&Ze.push(Je[ct]);if(x(Ze),this.autoPaging)for(var ht=Ze[0],St=Ze[Ze.length-1],Nt=ht;Nt<St+1;Nt++){this.pdf.setPage(Nt);var Ot=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Rt=Nt===1?this.posY+this.margin[0]:this.margin[0],wt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Lt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],tt=Nt===1?0:wt+(Nt-2)*Lt;if(this.ctx.clip_path.length!==0){var Gr=this.path;le=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(le,this.posX+this.margin[3],-tt+Rt+this.ctx.prevPageLastElemOffset),R.call(this,"fill",!0),this.path=Gr}var Dt=JSON.parse(JSON.stringify(Ve));Dt=w([Dt],this.posX+this.margin[3],-tt+Rt+this.ctx.prevPageLastElemOffset)[0];var Kn=(Nt>ht||Nt<St)&&m.call(this);Kn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ot,Lt,null).clip().discardPath()),this.pdf.addImage(E,"JPEG",Dt.x,Dt.y,Dt.w,Dt.h,null,null,it),Kn&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(E,"JPEG",Ve.x,Ve.y,Ve.w,Ve.h,null,null,it)};var S=function(E,O,F){var I=[];O=O||this.pdf.internal.pageSize.width,F=F||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var V=this.posY+this.ctx.prevPageLastElemOffset;switch(E.type){default:case"mt":case"lt":I.push(Math.floor((E.y+V)/F)+1);break;case"arc":I.push(Math.floor((E.y+V-E.radius)/F)+1),I.push(Math.floor((E.y+V+E.radius)/F)+1);break;case"qct":var ue=z(this.ctx.lastPoint.x,this.ctx.lastPoint.y,E.x1,E.y1,E.x,E.y);I.push(Math.floor((ue.y+V)/F)+1),I.push(Math.floor((ue.y+ue.h+V)/F)+1);break;case"bct":var fe=ae(this.ctx.lastPoint.x,this.ctx.lastPoint.y,E.x1,E.y1,E.x2,E.y2,E.x,E.y);I.push(Math.floor((fe.y+V)/F)+1),I.push(Math.floor((fe.y+fe.h+V)/F)+1);break;case"rect":I.push(Math.floor((E.y+V)/F)+1),I.push(Math.floor((E.y+E.h+V)/F)+1)}for(var he=0;he<I.length;he+=1)for(;this.pdf.internal.getNumberOfPages()<I[he];)y.call(this);return I},y=function(){var E=this.fillStyle,O=this.strokeStyle,F=this.font,I=this.lineCap,V=this.lineWidth,ue=this.lineJoin;this.pdf.addPage(),this.fillStyle=E,this.strokeStyle=O,this.font=F,this.lineCap=I,this.lineWidth=V,this.lineJoin=ue},w=function(E,O,F){for(var I=0;I<E.length;I++)switch(E[I].type){case"bct":E[I].x2+=O,E[I].y2+=F;case"qct":E[I].x1+=O,E[I].y1+=F;case"mt":case"lt":case"arc":default:E[I].x+=O,E[I].y+=F}return E},x=function(E){return E.sort(function(O,F){return O-F})},A=function(E,O){for(var F,I,V=this.fillStyle,ue=this.strokeStyle,fe=this.lineCap,he=this.lineWidth,xe=Math.abs(he*this.ctx.transform.scaleX),Oe=this.lineJoin,De=JSON.parse(JSON.stringify(this.path)),qe=JSON.parse(JSON.stringify(this.path)),Xe=[],ke=0;ke<qe.length;ke++)if(qe[ke].x!==void 0)for(var le=S.call(this,qe[ke]),je=0;je<le.length;je+=1)Xe.indexOf(le[je])===-1&&Xe.push(le[je]);for(var it=0;it<Xe.length;it++)for(;this.pdf.internal.getNumberOfPages()<Xe[it];)y.call(this);if(x(Xe),this.autoPaging)for(var Ue=Xe[0],Ve=Xe[Xe.length-1],Je=Ue;Je<Ve+1;Je++){this.pdf.setPage(Je),this.fillStyle=V,this.strokeStyle=ue,this.lineCap=fe,this.lineWidth=xe,this.lineJoin=Oe;var Ze=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ct=Je===1?this.posY+this.margin[0]:this.margin[0],ht=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],St=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Nt=Je===1?0:ht+(Je-2)*St;if(this.ctx.clip_path.length!==0){var Ot=this.path;F=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(F,this.posX+this.margin[3],-Nt+ct+this.ctx.prevPageLastElemOffset),R.call(this,E,!0),this.path=Ot}if(I=JSON.parse(JSON.stringify(De)),this.path=w(I,this.posX+this.margin[3],-Nt+ct+this.ctx.prevPageLastElemOffset),O===!1||Je===0){var Rt=(Je>Ue||Je<Ve)&&m.call(this);Rt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ze,St,null).clip().discardPath()),R.call(this,E,O),Rt&&this.pdf.restoreGraphicsState()}this.lineWidth=he}else this.lineWidth=xe,R.call(this,E,O),this.lineWidth=he;this.path=De},R=function(E,O){if((E!=="stroke"||O||!v.call(this))&&(E==="stroke"||O||!h.call(this))){for(var F,I,V=[],ue=this.path,fe=0;fe<ue.length;fe++){var he=ue[fe];switch(he.type){case"begin":V.push({begin:!0});break;case"close":V.push({close:!0});break;case"mt":V.push({start:he,deltas:[],abs:[]});break;case"lt":var xe=V.length;if(ue[fe-1]&&!isNaN(ue[fe-1].x)&&(F=[he.x-ue[fe-1].x,he.y-ue[fe-1].y],xe>0)){for(;xe>=0;xe--)if(V[xe-1].close!==!0&&V[xe-1].begin!==!0){V[xe-1].deltas.push(F),V[xe-1].abs.push(he);break}}break;case"bct":F=[he.x1-ue[fe-1].x,he.y1-ue[fe-1].y,he.x2-ue[fe-1].x,he.y2-ue[fe-1].y,he.x-ue[fe-1].x,he.y-ue[fe-1].y],V[V.length-1].deltas.push(F);break;case"qct":var Oe=ue[fe-1].x+2/3*(he.x1-ue[fe-1].x),De=ue[fe-1].y+2/3*(he.y1-ue[fe-1].y),qe=he.x+2/3*(he.x1-he.x),Xe=he.y+2/3*(he.y1-he.y),ke=he.x,le=he.y;F=[Oe-ue[fe-1].x,De-ue[fe-1].y,qe-ue[fe-1].x,Xe-ue[fe-1].y,ke-ue[fe-1].x,le-ue[fe-1].y],V[V.length-1].deltas.push(F);break;case"arc":V.push({deltas:[],abs:[],arc:!0}),Array.isArray(V[V.length-1].abs)&&V[V.length-1].abs.push(he)}}I=O?null:E==="stroke"?"stroke":"fill";for(var je=!1,it=0;it<V.length;it++)if(V[it].arc)for(var Ue=V[it].abs,Ve=0;Ve<Ue.length;Ve++){var Je=Ue[Ve];Je.type==="arc"?L.call(this,Je.x,Je.y,Je.radius,Je.startAngle,Je.endAngle,Je.counterclockwise,void 0,O,!je):U.call(this,Je.x,Je.y),je=!0}else if(V[it].close===!0)this.pdf.internal.out("h"),je=!1;else if(V[it].begin!==!0){var Ze=V[it].start.x,ct=V[it].start.y;Y.call(this,V[it].deltas,Ze,ct),je=!0}I&&P.call(this,I),O&&M.call(this)}},B=function(E){var O=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,F=O*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return E-F;case"top":return E+O-F;case"hanging":return E+O-2*F;case"middle":return E+O/2-F;case"ideographic":return E;case"alphabetic":default:return E}},T=function(E){return E+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};d.prototype.createLinearGradient=function(){var E=function(){};return E.colorStops=[],E.addColorStop=function(O,F){this.colorStops.push([O,F])},E.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},E.isCanvasGradient=!0,E},d.prototype.createPattern=function(){return this.createLinearGradient()},d.prototype.createRadialGradient=function(){return this.createLinearGradient()};var L=function(E,O,F,I,V,ue,fe,he,xe){for(var Oe=ee.call(this,F,I,V,ue),De=0;De<Oe.length;De++){var qe=Oe[De];De===0&&(xe?N.call(this,qe.x1+E,qe.y1+O):U.call(this,qe.x1+E,qe.y1+O)),ce.call(this,E,O,qe.x2,qe.y2,qe.x3,qe.y3,qe.x4,qe.y4)}he?M.call(this):P.call(this,fe)},P=function(E){switch(E){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},M=function(){this.pdf.clip(),this.pdf.discardPath()},N=function(E,O){this.pdf.internal.out(r(E)+" "+n(O)+" m")},C=function(E){var O;switch(E.align){case"right":case"end":O="right";break;case"center":O="center";break;case"left":case"start":default:O="left"}var F=this.pdf.getTextDimensions(E.text),I=B.call(this,E.y),V=T.call(this,I)-F.h,ue=this.ctx.transform.applyToPoint(new s(E.x,I)),fe=this.ctx.transform.decompose(),he=new l;he=(he=(he=he.multiply(fe.translate)).multiply(fe.skew)).multiply(fe.scale);for(var xe,Oe,De,qe=this.ctx.transform.applyToRectangle(new o(E.x,I,F.w,F.h)),Xe=he.applyToRectangle(new o(E.x,V,F.w,F.h)),ke=S.call(this,Xe),le=[],je=0;je<ke.length;je+=1)le.indexOf(ke[je])===-1&&le.push(ke[je]);if(x(le),this.autoPaging)for(var it=le[0],Ue=le[le.length-1],Ve=it;Ve<Ue+1;Ve++){this.pdf.setPage(Ve);var Je=Ve===1?this.posY+this.margin[0]:this.margin[0],Ze=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ct=this.pdf.internal.pageSize.height-this.margin[2],ht=ct-this.margin[0],St=this.pdf.internal.pageSize.width-this.margin[1],Nt=St-this.margin[3],Ot=Ve===1?0:Ze+(Ve-2)*ht;if(this.ctx.clip_path.length!==0){var Rt=this.path;xe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(xe,this.posX+this.margin[3],-1*Ot+Je),R.call(this,"fill",!0),this.path=Rt}var wt=w([JSON.parse(JSON.stringify(Xe))],this.posX+this.margin[3],-Ot+Je+this.ctx.prevPageLastElemOffset)[0];E.scale>=.01&&(Oe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Oe*E.scale),De=this.lineWidth,this.lineWidth=De*E.scale);var Lt=this.autoPaging!=="text";if(Lt||wt.y+wt.h<=ct){if(Lt||wt.y>=Je&&wt.x<=St){var tt=Lt?E.text:this.pdf.splitTextToSize(E.text,E.maxWidth||St-wt.x)[0],Gr=w([JSON.parse(JSON.stringify(qe))],this.posX+this.margin[3],-Ot+Je+this.ctx.prevPageLastElemOffset)[0],Dt=Lt&&(Ve>it||Ve<Ue)&&m.call(this);Dt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Nt,ht,null).clip().discardPath()),this.pdf.text(tt,Gr.x,Gr.y,{angle:E.angle,align:O,renderingMode:E.renderingMode}),Dt&&this.pdf.restoreGraphicsState()}}else wt.y<ct&&(this.ctx.prevPageLastElemOffset+=ct-wt.y);E.scale>=.01&&(this.pdf.setFontSize(Oe),this.lineWidth=De)}else E.scale>=.01&&(Oe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Oe*E.scale),De=this.lineWidth,this.lineWidth=De*E.scale),this.pdf.text(E.text,ue.x+this.posX,ue.y+this.posY,{angle:E.angle,align:O,renderingMode:E.renderingMode,maxWidth:E.maxWidth}),E.scale>=.01&&(this.pdf.setFontSize(Oe),this.lineWidth=De)},U=function(E,O,F,I){F=F||0,I=I||0,this.pdf.internal.out(r(E+F)+" "+n(O+I)+" l")},Y=function(E,O,F){return this.pdf.lines(E,O,F,null,null)},ce=function(E,O,F,I,V,ue,fe,he){this.pdf.internal.out([t(i(F+E)),t(a(I+O)),t(i(V+E)),t(a(ue+O)),t(i(fe+E)),t(a(he+O)),"c"].join(" "))},ee=function(E,O,F,I){for(var V=2*Math.PI,ue=Math.PI/2;O>F;)O-=V;var fe=Math.abs(F-O);fe<V&&I&&(fe=V-fe);for(var he=[],xe=I?-1:1,Oe=O;fe>1e-5;){var De=Oe+xe*Math.min(fe,ue);he.push(Q.call(this,E,Oe,De)),fe-=Math.abs(De-Oe),Oe=De}return he},Q=function(E,O,F){var I=(F-O)/2,V=E*Math.cos(I),ue=E*Math.sin(I),fe=V,he=-ue,xe=fe*fe+he*he,Oe=xe+fe*V+he*ue,De=4/3*(Math.sqrt(2*xe*Oe)-Oe)/(fe*ue-he*V),qe=fe-De*he,Xe=he+De*fe,ke=qe,le=-Xe,je=I+O,it=Math.cos(je),Ue=Math.sin(je);return{x1:E*Math.cos(O),y1:E*Math.sin(O),x2:qe*it-Xe*Ue,y2:qe*Ue+Xe*it,x3:ke*it-le*Ue,y3:ke*Ue+le*it,x4:E*Math.cos(F),y4:E*Math.sin(F)}},X=function(E){return 180*E/Math.PI},z=function(E,O,F,I,V,ue){var fe=E+.5*(F-E),he=O+.5*(I-O),xe=V+.5*(F-V),Oe=ue+.5*(I-ue),De=Math.min(E,V,fe,xe),qe=Math.max(E,V,fe,xe),Xe=Math.min(O,ue,he,Oe),ke=Math.max(O,ue,he,Oe);return new o(De,Xe,qe-De,ke-Xe)},ae=function(E,O,F,I,V,ue,fe,he){var xe,Oe,De,qe,Xe,ke,le,je,it,Ue,Ve,Je,Ze,ct,ht=F-E,St=I-O,Nt=V-F,Ot=ue-I,Rt=fe-V,wt=he-ue;for(Oe=0;Oe<41;Oe++)it=(le=(De=E+(xe=Oe/40)*ht)+xe*((Xe=F+xe*Nt)-De))+xe*(Xe+xe*(V+xe*Rt-Xe)-le),Ue=(je=(qe=O+xe*St)+xe*((ke=I+xe*Ot)-qe))+xe*(ke+xe*(ue+xe*wt-ke)-je),Oe==0?(Ve=it,Je=Ue,Ze=it,ct=Ue):(Ve=Math.min(Ve,it),Je=Math.min(Je,Ue),Ze=Math.max(Ze,it),ct=Math.max(ct,Ue));return new o(Math.round(Ve),Math.round(Je),Math.round(Ze-Ve),Math.round(ct-Je))},me=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var E,O,F=(E=this.ctx.lineDash,O=this.ctx.lineDashOffset,JSON.stringify({lineDash:E,lineDashOffset:O}));this.prevLineDash!==F&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=F)}}})(mt.API),function(e){var t=function(a){var s,o,l,u,f,d,p,h,v,m;for(o=[],l=0,u=(a+=s="\0\0\0\0".slice(a.length%4||4)).length;u>l;l+=4)(f=(a.charCodeAt(l)<<24)+(a.charCodeAt(l+1)<<16)+(a.charCodeAt(l+2)<<8)+a.charCodeAt(l+3))!==0?(d=(f=((f=((f=((f=(f-(m=f%85))/85)-(v=f%85))/85)-(h=f%85))/85)-(p=f%85))/85)%85,o.push(d+33,p+33,h+33,v+33,m+33)):o.push(122);return function(S,y){for(var w=y;w>0;w--)S.pop()}(o,s.length),String.fromCharCode.apply(String,o)+"~>"},r=function(a){var s,o,l,u,f,d=String,p="length",h=255,v="charCodeAt",m="slice",S="replace";for(a[m](-2),a=a[m](0,-2)[S](/\s/g,"")[S]("z","!!!!!"),l=[],u=0,f=(a+=s="uuuuu"[m](a[p]%5||5))[p];f>u;u+=5)o=52200625*(a[v](u)-33)+614125*(a[v](u+1)-33)+7225*(a[v](u+2)-33)+85*(a[v](u+3)-33)+(a[v](u+4)-33),l.push(h&o>>24,h&o>>16,h&o>>8,h&o);return function(y,w){for(var x=w;x>0;x--)y.pop()}(l,s[p]),d.fromCharCode.apply(d,l)},n=function(a){var s=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((a=a.replace(/\s/g,"")).indexOf(">")!==-1&&(a=a.substr(0,a.indexOf(">"))),a.length%2&&(a+="0"),s.test(a)===!1)return"";for(var o="",l=0;l<a.length;l+=2)o+=String.fromCharCode("0x"+(a[l]+a[l+1]));return o},i=function(a){for(var s=new Uint8Array(a.length),o=a.length;o--;)s[o]=a.charCodeAt(o);return a=(s=Mg(s)).reduce(function(l,u){return l+String.fromCharCode(u)},"")};e.processDataByFilters=function(a,s){var o=0,l=a||"",u=[];for(typeof(s=s||[])=="string"&&(s=[s]),o=0;o<s.length;o+=1)switch(s[o]){case"ASCII85Decode":case"/ASCII85Decode":l=r(l),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":l=t(l),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":l=n(l),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":l=l.split("").map(function(f){return("0"+f.charCodeAt().toString(16)).slice(-2)}).join("")+">",u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":l=i(l),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+s[o]+'" is not implemented')}return{data:l,reverseChain:u.reverse().join(" ")}}}(mt.API),function(e){e.loadFile=function(t,r,n){return function(i,a,s){a=a!==!1,s=typeof s=="function"?s:function(){};var o=void 0;try{o=function(l,u,f){var d=new XMLHttpRequest,p=0,h=function(v){var m=v.length,S=[],y=String.fromCharCode;for(p=0;p<m;p+=1)S.push(y(255&v.charCodeAt(p)));return S.join("")};if(d.open("GET",l,!u),d.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(d.onload=function(){d.status===200?f(h(this.responseText)):f(void 0)}),d.send(null),u&&d.status===200)return h(d.responseText)}(i,a,s)}catch{}return o}(t,r,n)},e.loadImageFile=e.loadFile}(mt.API),function(e){function t(){return(xt.html2canvas?Promise.resolve(xt.html2canvas):Fg(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(s){return Promise.reject(new Error("Could not load html2canvas: "+s))}).then(function(s){return s.default?s.default:s})}function r(){return(xt.DOMPurify?Promise.resolve(xt.DOMPurify):Fg(()=>import("./purify.es-C_uT9hQ1.js"),[])).catch(function(s){return Promise.reject(new Error("Could not load dompurify: "+s))}).then(function(s){return s.default?s.default:s})}var n=function(s){var o=Qt(s);return o==="undefined"?"undefined":o==="string"||s instanceof String?"string":o==="number"||s instanceof Number?"number":o==="function"||s instanceof Function?"function":s&&s.constructor===Array?"array":s&&s.nodeType===1?"element":o==="object"?"object":"unknown"},i=function(s,o){var l=document.createElement(s);for(var u in o.className&&(l.className=o.className),o.innerHTML&&o.dompurify&&(l.innerHTML=o.dompurify.sanitize(o.innerHTML)),o.style)l.style[u]=o.style[u];return l},a=function s(o){var l=Object.assign(s.convert(Promise.resolve()),JSON.parse(JSON.stringify(s.template))),u=s.convert(Promise.resolve(),l);return u=(u=u.setProgress(1,s,1,[s])).set(o)};(a.prototype=Object.create(Promise.prototype)).constructor=a,a.convert=function(s,o){return s.__proto__=o||a.prototype,s},a.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},a.prototype.from=function(s,o){return this.then(function(){switch(o=o||function(l){switch(n(l)){case"string":return"string";case"element":return l.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(s)){case"string":return this.then(r).then(function(l){return this.set({src:i("div",{innerHTML:s,dompurify:l})})});case"element":return this.set({src:s});case"canvas":return this.set({canvas:s});case"img":return this.set({img:s});default:return this.error("Unknown source type.")}})},a.prototype.to=function(s){switch(s){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},a.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var s={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},o=function l(u,f){for(var d=u.nodeType===3?document.createTextNode(u.nodeValue):u.cloneNode(!1),p=u.firstChild;p;p=p.nextSibling)f!==!0&&p.nodeType===1&&p.nodeName==="SCRIPT"||d.appendChild(l(p,f));return u.nodeType===1&&(u.nodeName==="CANVAS"?(d.width=u.width,d.height=u.height,d.getContext("2d").drawImage(u,0,0)):u.nodeName!=="TEXTAREA"&&u.nodeName!=="SELECT"||(d.value=u.value),d.addEventListener("load",function(){d.scrollTop=u.scrollTop,d.scrollLeft=u.scrollLeft},!0)),d}(this.prop.src,this.opt.html2canvas.javascriptEnabled);o.tagName==="BODY"&&(s.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:s}),this.prop.container.appendChild(o),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},a.prototype.toCanvas=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(t).then(function(o){var l=Object.assign({},this.opt.html2canvas);return delete l.onrendered,o(this.prop.container,l)}).then(function(o){(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},a.prototype.toContext2d=function(){var s=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(s).then(t).then(function(o){var l=this.opt.jsPDF,u=this.opt.fontFaces,f=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,d=Object.assign({async:!0,allowTaint:!0,scale:f,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete d.onrendered,l.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,l.context2d.posX=this.opt.x,l.context2d.posY=this.opt.y,l.context2d.margin=this.opt.margin,l.context2d.fontFaces=u,u)for(var p=0;p<u.length;++p){var h=u[p],v=h.src.find(function(m){return m.format==="truetype"});v&&l.addFont(v.url,h.ref.name,h.ref.style)}return d.windowHeight=d.windowHeight||0,d.windowHeight=d.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):d.windowHeight,l.context2d.save(!0),o(this.prop.container,d)}).then(function(o){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(o),this.prop.canvas=o,document.body.removeChild(this.prop.overlay)})},a.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var s=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=s})},a.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},a.prototype.output=function(s,o,l){return(l=l||"pdf").toLowerCase()==="img"||l.toLowerCase()==="image"?this.outputImg(s,o):this.outputPdf(s,o)},a.prototype.outputPdf=function(s,o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(s,o)})},a.prototype.outputImg=function(s){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(s){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+s+'" is not supported.'}})},a.prototype.save=function(s){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(s?{filename:s}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},a.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},a.prototype.set=function(s){if(n(s)!=="object")return this;var o=Object.keys(s||{}).map(function(l){if(l in a.template.prop)return function(){this.prop[l]=s[l]};switch(l){case"margin":return this.setMargin.bind(this,s.margin);case"jsPDF":return function(){return this.opt.jsPDF=s.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,s.pageSize);default:return function(){this.opt[l]=s[l]}}},this);return this.then(function(){return this.thenList(o)})},a.prototype.get=function(s,o){return this.then(function(){var l=s in a.template.prop?this.prop[s]:this.opt[s];return o?o(l):l})},a.prototype.setMargin=function(s){return this.then(function(){switch(n(s)){case"number":s=[s,s,s,s];case"array":if(s.length===2&&(s=[s[0],s[1],s[0],s[1]]),s.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=s}).then(this.setPageSize)},a.prototype.setPageSize=function(s){function o(l,u){return Math.floor(l*u/72*96)}return this.then(function(){(s=s||mt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(s.inner={width:s.width-this.opt.margin[1]-this.opt.margin[3],height:s.height-this.opt.margin[0]-this.opt.margin[2]},s.inner.px={width:o(s.inner.width,s.k),height:o(s.inner.height,s.k)},s.inner.ratio=s.inner.height/s.inner.width),this.prop.pageSize=s})},a.prototype.setProgress=function(s,o,l,u){return s!=null&&(this.progress.val=s),o!=null&&(this.progress.state=o),l!=null&&(this.progress.n=l),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},a.prototype.updateProgress=function(s,o,l,u){return this.setProgress(s?this.progress.val+s:null,o||null,l?this.progress.n+l:null,u?this.progress.stack.concat(u):null)},a.prototype.then=function(s,o){var l=this;return this.thenCore(s,o,function(u,f){return l.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(d){return l.updateProgress(null,u),d}).then(u,f).then(function(d){return l.updateProgress(1),d})})},a.prototype.thenCore=function(s,o,l){l=l||Promise.prototype.then,s&&(s=s.bind(this)),o&&(o=o.bind(this));var u=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:a.convert(Object.assign({},this),Promise.prototype),f=l.call(u,s,o);return a.convert(f,this.__proto__)},a.prototype.thenExternal=function(s,o){return Promise.prototype.then.call(this,s,o)},a.prototype.thenList=function(s){var o=this;return s.forEach(function(l){o=o.thenCore(l)}),o},a.prototype.catch=function(s){s&&(s=s.bind(this));var o=Promise.prototype.catch.call(this,s);return a.convert(o,this)},a.prototype.catchExternal=function(s){return Promise.prototype.catch.call(this,s)},a.prototype.error=function(s){return this.then(function(){throw new Error(s)})},a.prototype.using=a.prototype.set,a.prototype.saveAs=a.prototype.save,a.prototype.export=a.prototype.output,a.prototype.run=a.prototype.then,mt.getPageSize=function(s,o,l){if(Qt(s)==="object"){var u=s;s=u.orientation,o=u.unit||o,l=u.format||l}o=o||"mm",l=l||"a4",s=(""+(s||"P")).toLowerCase();var f,d=(""+l).toLowerCase(),p={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(o){case"pt":f=1;break;case"mm":f=72/25.4;break;case"cm":f=72/2.54;break;case"in":f=72;break;case"px":f=.75;break;case"pc":case"em":f=12;break;case"ex":f=6;break;default:throw"Invalid unit: "+o}var h,v=0,m=0;if(p.hasOwnProperty(d))v=p[d][1]/f,m=p[d][0]/f;else try{v=l[1],m=l[0]}catch{throw new Error("Invalid format: "+l)}if(s==="p"||s==="portrait")s="p",m>v&&(h=m,m=v,v=h);else{if(s!=="l"&&s!=="landscape")throw"Invalid orientation: "+s;s="l",v>m&&(h=m,m=v,v=h)}return{width:m,height:v,unit:o,k:f,orientation:s}},e.html=function(s,o){(o=o||{}).callback=o.callback||function(){},o.html2canvas=o.html2canvas||{},o.html2canvas.canvas=o.html2canvas.canvas||this.canvas,o.jsPDF=o.jsPDF||this,o.fontFaces=o.fontFaces?o.fontFaces.map(qg):null;var l=new a(o);return o.worker?l:l.from(s).doCallback()}}(mt.API),mt.API.addJS=function(e){return _y=e,this.internal.events.subscribe("postPutResources",function(){f0=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(f0+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),xy=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+_y+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){f0!==void 0&&xy!==void 0&&this.internal.out("/Names <</JavaScript "+f0+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=r.outline.render().split(/\r\n/),a=0;a<i.length;a++){var s=i[a],o=n.exec(s);if(o!=null){var l=o[1];r.internal.newObjectDeferredBegin(l,!1)}r.internal.write(s)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,f=[];for(a=0;a<u;a++){var d=r.internal.newObject();f.push(d);var p=r.internal.getPageInfo(a+1);r.internal.write("<< /D["+p.objId+" 0 R /XYZ null null null]>> endobj")}var h=r.internal.newObject();for(r.internal.write("<< /Names [ "),a=0;a<f.length;a++)r.internal.write("(page_"+(a+1)+")"+f[a]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+h+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,i,a){var s={title:i,options:a,children:[]};return n==null&&(n=this.root),n.children.push(s),s},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var i=0;i<n.children.length;i++)this.genIds_r(n.children[i])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,a=0;a<n.children.length;a++){var s=n.children[a];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(n)),a>0&&this.line("/Prev "+this.makeRef(n.children[a-1])),a<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[a+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var o=this.count=this.count_r({count:0},s);if(o>0&&this.line("/Count "+o),s.options&&s.options.pageNumber){var l=r.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+l.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,i){for(var a=0;a<i.children.length;a++)n.count++,this.count_r(n,i.children[a]);return n.count}}])}(mt.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,i,a,s,o){var l,u=this.decode.DCT_DECODE,f=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=s||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(l=function(d){for(var p,h=256*d.charCodeAt(4)+d.charCodeAt(5),v=d.length,m={width:0,height:0,numcomponents:1},S=4;S<v;S+=2){if(S+=h,t.indexOf(d.charCodeAt(S+1))!==-1){p=256*d.charCodeAt(S+5)+d.charCodeAt(S+6),m={width:256*d.charCodeAt(S+7)+d.charCodeAt(S+8),height:p,numcomponents:d.charCodeAt(S+9)};break}h=256*d.charCodeAt(S+2)+d.charCodeAt(S+3)}return m}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}f={data:r,width:l.width,height:l.height,colorSpace:o,bitsPerComponent:8,filter:u,index:n,alias:i}}return f}}(mt.API);var Hl,h0,Sy,by,Ey,OO=function(){var e,t,r;function n(a){var s,o,l,u,f,d,p,h,v,m,S,y,w,x;for(this.data=a,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},d=null;;){switch(s=this.readUInt32(),v=(function(){var A,R;for(R=[],A=0;A<4;++A)R.push(String.fromCharCode(this.data[this.pos++]));return R}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(s);break;case"fcTL":d&&this.animation.frames.push(d),this.pos+=4,d={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},f=this.readUInt16(),u=this.readUInt16()||100,d.delay=1e3*f/u,d.disposeOp=this.data[this.pos++],d.blendOp=this.data[this.pos++],d.data=[];break;case"IDAT":case"fdAT":for(v==="fdAT"&&(this.pos+=4,s-=4),a=(d!=null?d.data:void 0)||this.imgData,y=0;0<=s?y<s:y>s;0<=s?++y:--y)a.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(l=this.palette.length/3,this.transparency.indexed=this.read(s),this.transparency.indexed.length>l)throw new Error("More transparent colors than palette size");if((m=l-this.transparency.indexed.length)>0)for(w=0;0<=m?w<m:w>m;0<=m?++w:--w)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(s)[0];break;case 2:this.transparency.rgb=this.read(s)}break;case"tEXt":p=(S=this.read(s)).indexOf(0),h=String.fromCharCode.apply(String,S.slice(0,p)),this.text[h]=String.fromCharCode.apply(String,S.slice(p+1));break;case"IEND":return d&&this.animation.frames.push(d),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(x=this.colorType)===4||x===6,o=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*o,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=s}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}n.prototype.read=function(a){var s,o;for(o=[],s=0;0<=a?s<a:s>a;0<=a?++s:--s)o.push(this.data[this.pos++]);return o},n.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},n.prototype.decodePixels=function(a){var s=this.pixelBitlength/8,o=new Uint8Array(this.width*this.height*s),l=0,u=this;if(a==null&&(a=this.imgData),a.length===0)return new Uint8Array(0);function f(d,p,h,v){var m,S,y,w,x,A,R,B,T,L,P,M,N,C,U,Y,ce,ee,Q,X,z,ae=Math.ceil((u.width-d)/h),me=Math.ceil((u.height-p)/v),E=u.width==ae&&u.height==me;for(C=s*ae,M=E?o:new Uint8Array(C*me),A=a.length,N=0,S=0;N<me&&l<A;){switch(a[l++]){case 0:for(w=ce=0;ce<C;w=ce+=1)M[S++]=a[l++];break;case 1:for(w=ee=0;ee<C;w=ee+=1)m=a[l++],x=w<s?0:M[S-s],M[S++]=(m+x)%256;break;case 2:for(w=Q=0;Q<C;w=Q+=1)m=a[l++],y=(w-w%s)/s,U=N&&M[(N-1)*C+y*s+w%s],M[S++]=(U+m)%256;break;case 3:for(w=X=0;X<C;w=X+=1)m=a[l++],y=(w-w%s)/s,x=w<s?0:M[S-s],U=N&&M[(N-1)*C+y*s+w%s],M[S++]=(m+Math.floor((x+U)/2))%256;break;case 4:for(w=z=0;z<C;w=z+=1)m=a[l++],y=(w-w%s)/s,x=w<s?0:M[S-s],N===0?U=Y=0:(U=M[(N-1)*C+y*s+w%s],Y=y&&M[(N-1)*C+(y-1)*s+w%s]),R=x+U-Y,B=Math.abs(R-x),L=Math.abs(R-U),P=Math.abs(R-Y),T=B<=L&&B<=P?x:L<=P?U:Y,M[S++]=(m+T)%256;break;default:throw new Error("Invalid filter algorithm: "+a[l-1])}if(!E){var O=((p+N*v)*u.width+d)*s,F=N*C;for(w=0;w<ae;w+=1){for(var I=0;I<s;I+=1)o[O++]=M[F++];O+=(h-1)*s}}N++}}return a=uO(a),u.interlaceMethod==1?(f(0,0,8,8),f(4,0,8,8),f(0,4,4,8),f(2,0,4,4),f(0,2,2,4),f(1,0,2,2),f(0,1,1,2)):f(0,0,1,1),o},n.prototype.decodePalette=function(){var a,s,o,l,u,f,d,p,h;for(o=this.palette,f=this.transparency.indexed||[],u=new Uint8Array((f.length||0)+o.length),l=0,a=0,s=d=0,p=o.length;d<p;s=d+=3)u[l++]=o[s],u[l++]=o[s+1],u[l++]=o[s+2],u[l++]=(h=f[a++])!=null?h:255;return u},n.prototype.copyToImageData=function(a,s){var o,l,u,f,d,p,h,v,m,S,y;if(l=this.colors,m=null,o=this.hasAlphaChannel,this.palette.length&&(m=(y=this._decodedPalette)!=null?y:this._decodedPalette=this.decodePalette(),l=4,o=!0),v=(u=a.data||a).length,d=m||s,f=p=0,l===1)for(;f<v;)h=m?4*s[f/4]:p,S=d[h++],u[f++]=S,u[f++]=S,u[f++]=S,u[f++]=o?d[h++]:255,p=h;else for(;f<v;)h=m?4*s[f/4]:p,u[f++]=d[h++],u[f++]=d[h++],u[f++]=d[h++],u[f++]=o?d[h++]:255,p=h},n.prototype.decode=function(){var a;return a=new Uint8Array(this.width*this.height*4),this.copyToImageData(a,this.decodePixels()),a};var i=function(){if(Object.prototype.toString.call(xt)==="[object Window]"){try{t=xt.document.createElement("canvas"),r=t.getContext("2d")}catch{return!1}return!0}return!1};return i(),e=function(a){var s;if(i()===!0)return r.width=a.width,r.height=a.height,r.clearRect(0,0,a.width,a.height),r.putImageData(a,0,0),(s=new Image).src=t.toDataURL(),s;throw new Error("This method requires a Browser with Canvas-capability.")},n.prototype.decodeFrames=function(a){var s,o,l,u,f,d,p,h;if(this.animation){for(h=[],o=f=0,d=(p=this.animation.frames).length;f<d;o=++f)s=p[o],l=a.createImageData(s.width,s.height),u=this.decodePixels(new Uint8Array(s.data)),this.copyToImageData(l,u),s.imageData=l,h.push(s.image=e(l));return h}},n.prototype.renderFrame=function(a,s){var o,l,u;return o=(l=this.animation.frames)[s],u=l[s-1],s===0&&a.clearRect(0,0,this.width,this.height),(u!=null?u.disposeOp:void 0)===1?a.clearRect(u.xOffset,u.yOffset,u.width,u.height):(u!=null?u.disposeOp:void 0)===2&&a.putImageData(u.imageData,u.xOffset,u.yOffset),o.blendOp===0&&a.clearRect(o.xOffset,o.yOffset,o.width,o.height),a.drawImage(o.image,o.xOffset,o.yOffset)},n.prototype.animate=function(a){var s,o,l,u,f,d,p=this;return o=0,d=this.animation,u=d.numFrames,l=d.frames,f=d.numPlays,(s=function(){var h,v;if(h=o++%u,v=l[h],p.renderFrame(a,h),u>1&&o/u<f)return p.animation._timeout=setTimeout(s,v.delay)})()},n.prototype.stopAnimation=function(){var a;return clearTimeout((a=this.animation)!=null?a._timeout:void 0)},n.prototype.render=function(a){var s,o;return a._png&&a._png.stopAnimation(),a._png=this,a.width=this.width,a.height=this.height,s=a.getContext("2d"),this.animation?(this.decodeFrames(s),this.animate(s)):(o=s.createImageData(this.width,this.height),this.copyToImageData(o,this.decodePixels()),s.putImageData(o,0,0))},n}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function FO(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,i=e[t++],a=i>>7,s=1<<(7&i)+1;e[t++],e[t++];var o=null,l=null;a&&(o=t,l=s,t+=3*s);var u=!0,f=[],d=0,p=null,h=0,v=null;for(this.width=r,this.height=n;u&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,v=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((N=e[t++])>=0))throw Error("Invalid block size");if(N===0)break;t+=N}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var m=e[t++];d=e[t++]|e[t++]<<8,p=e[t++],!(1&m)&&(p=null),h=m>>2&7,t++;break;case 254:for(;;){if(!((N=e[t++])>=0))throw Error("Invalid block size");if(N===0)break;t+=N}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var S=e[t++]|e[t++]<<8,y=e[t++]|e[t++]<<8,w=e[t++]|e[t++]<<8,x=e[t++]|e[t++]<<8,A=e[t++],R=A>>6&1,B=1<<(7&A)+1,T=o,L=l,P=!1;A>>7&&(P=!0,T=t,L=B,t+=3*B);var M=t;for(t++;;){var N;if(!((N=e[t++])>=0))throw Error("Invalid block size");if(N===0)break;t+=N}f.push({x:S,y,width:w,height:x,has_local_palette:P,palette_offset:T,palette_size:L,data_offset:M,data_length:t-M,transparent_index:p,interlaced:!!R,delay:d,disposal:h});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return f.length},this.loopCount=function(){return v},this.frameInfo=function(C){if(C<0||C>=f.length)throw new Error("Frame index out of range.");return f[C]},this.decodeAndBlitFrameBGRA=function(C,U){var Y=this.frameInfo(C),ce=Y.width*Y.height,ee=new Uint8Array(ce);Ay(e,Y.data_offset,ee,ce);var Q=Y.palette_offset,X=Y.transparent_index;X===null&&(X=256);var z=Y.width,ae=r-z,me=z,E=4*(Y.y*r+Y.x),O=4*((Y.y+Y.height)*r+Y.x),F=E,I=4*ae;Y.interlaced===!0&&(I+=4*r*7);for(var V=8,ue=0,fe=ee.length;ue<fe;++ue){var he=ee[ue];if(me===0&&(me=z,(F+=I)>=O&&(I=4*ae+4*r*(V-1),F=E+(z+ae)*(V<<1),V>>=1)),he===X)F+=4;else{var xe=e[Q+3*he],Oe=e[Q+3*he+1],De=e[Q+3*he+2];U[F++]=De,U[F++]=Oe,U[F++]=xe,U[F++]=255}--me}},this.decodeAndBlitFrameRGBA=function(C,U){var Y=this.frameInfo(C),ce=Y.width*Y.height,ee=new Uint8Array(ce);Ay(e,Y.data_offset,ee,ce);var Q=Y.palette_offset,X=Y.transparent_index;X===null&&(X=256);var z=Y.width,ae=r-z,me=z,E=4*(Y.y*r+Y.x),O=4*((Y.y+Y.height)*r+Y.x),F=E,I=4*ae;Y.interlaced===!0&&(I+=4*r*7);for(var V=8,ue=0,fe=ee.length;ue<fe;++ue){var he=ee[ue];if(me===0&&(me=z,(F+=I)>=O&&(I=4*ae+4*r*(V-1),F=E+(z+ae)*(V<<1),V>>=1)),he===X)F+=4;else{var xe=e[Q+3*he],Oe=e[Q+3*he+1],De=e[Q+3*he+2];U[F++]=xe,U[F++]=Oe,U[F++]=De,U[F++]=255}--me}}}function Ay(e,t,r,n){for(var i=e[t++],a=1<<i,s=a+1,o=s+1,l=i+1,u=(1<<l)-1,f=0,d=0,p=0,h=e[t++],v=new Int32Array(4096),m=null;;){for(;f<16&&h!==0;)d|=e[t++]<<f,f+=8,h===1?h=e[t++]:--h;if(f<l)break;var S=d&u;if(d>>=l,f-=l,S!==a){if(S===s)break;for(var y=S<o?S:m,w=0,x=y;x>a;)x=v[x]>>8,++w;var A=x;if(p+w+(y!==S?1:0)>n)return void sr.log("Warning, gif stream longer than expected.");r[p++]=A;var R=p+=w;for(y!==S&&(r[p++]=A),x=y;w--;)x=v[x],r[--R]=255&x,x>>=8;m!==null&&o<4096&&(v[o++]=m<<8|A,o>=u+1&&l<12&&(++l,u=u<<1|1)),m=S}else o=s+1,u=(1<<(l=i+1))-1,m=null}return p!==n&&sr.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Ap(e){var t,r,n,i,a,s=Math.floor,o=new Array(64),l=new Array(64),u=new Array(64),f=new Array(64),d=new Array(65535),p=new Array(65535),h=new Array(64),v=new Array(64),m=[],S=0,y=7,w=new Array(64),x=new Array(64),A=new Array(64),R=new Array(256),B=new Array(2048),T=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],L=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],P=[0,1,2,3,4,5,6,7,8,9,10,11],M=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],N=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],C=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],U=[0,1,2,3,4,5,6,7,8,9,10,11],Y=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ce=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ee(E,O){for(var F=0,I=0,V=new Array,ue=1;ue<=16;ue++){for(var fe=1;fe<=E[ue];fe++)V[O[I]]=[],V[O[I]][0]=F,V[O[I]][1]=ue,I++,F++;F*=2}return V}function Q(E){for(var O=E[0],F=E[1]-1;F>=0;)O&1<<F&&(S|=1<<y),F--,--y<0&&(S==255?(X(255),X(0)):X(S),y=7,S=0)}function X(E){m.push(E)}function z(E){X(E>>8&255),X(255&E)}function ae(E,O,F,I,V){for(var ue,fe=V[0],he=V[240],xe=function(Ue,Ve){var Je,Ze,ct,ht,St,Nt,Ot,Rt,wt,Lt,tt=0;for(wt=0;wt<8;++wt){Je=Ue[tt],Ze=Ue[tt+1],ct=Ue[tt+2],ht=Ue[tt+3],St=Ue[tt+4],Nt=Ue[tt+5],Ot=Ue[tt+6];var Gr=Je+(Rt=Ue[tt+7]),Dt=Je-Rt,Kn=Ze+Ot,$t=Ze-Ot,or=ct+Nt,Pi=ct-Nt,Mt=ht+St,Ea=ht-St,hr=Gr+Mt,ci=Gr-Mt,Xi=Kn+or,ir=Kn-or;Ue[tt]=hr+Xi,Ue[tt+4]=hr-Xi;var bt=.707106781*(ir+ci);Ue[tt+2]=ci+bt,Ue[tt+6]=ci-bt;var zt=.382683433*((hr=Ea+Pi)-(ir=$t+Dt)),Wa=.5411961*hr+zt,Kr=1.306562965*ir+zt,Oi=.707106781*(Xi=Pi+$t),Fi=Dt+Oi,pt=Dt-Oi;Ue[tt+5]=pt+Wa,Ue[tt+3]=pt-Wa,Ue[tt+1]=Fi+Kr,Ue[tt+7]=Fi-Kr,tt+=8}for(tt=0,wt=0;wt<8;++wt){Je=Ue[tt],Ze=Ue[tt+8],ct=Ue[tt+16],ht=Ue[tt+24],St=Ue[tt+32],Nt=Ue[tt+40],Ot=Ue[tt+48];var fi=Je+(Rt=Ue[tt+56]),Yn=Je-Rt,En=Ze+Ot,Lr=Ze-Ot,Sr=ct+Nt,W=ct-Nt,ie=ht+St,J=ht-St,te=fi+ie,ne=fi-ie,se=En+Sr,Se=En-Sr;Ue[tt]=te+se,Ue[tt+32]=te-se;var Ne=.707106781*(Se+ne);Ue[tt+16]=ne+Ne,Ue[tt+48]=ne-Ne;var _e=.382683433*((te=J+W)-(Se=Lr+Yn)),Ae=.5411961*te+_e,Te=1.306562965*Se+_e,He=.707106781*(se=W+Lr),Ge=Yn+He,nt=Yn-He;Ue[tt+40]=nt+Ae,Ue[tt+24]=nt-Ae,Ue[tt+8]=Ge+Te,Ue[tt+56]=Ge-Te,tt++}for(wt=0;wt<64;++wt)Lt=Ue[wt]*Ve[wt],h[wt]=Lt>0?Lt+.5|0:Lt-.5|0;return h}(E,O),Oe=0;Oe<64;++Oe)v[T[Oe]]=xe[Oe];var De=v[0]-F;F=v[0],De==0?Q(I[0]):(Q(I[p[ue=32767+De]]),Q(d[ue]));for(var qe=63;qe>0&&v[qe]==0;)qe--;if(qe==0)return Q(fe),F;for(var Xe,ke=1;ke<=qe;){for(var le=ke;v[ke]==0&&ke<=qe;)++ke;var je=ke-le;if(je>=16){Xe=je>>4;for(var it=1;it<=Xe;++it)Q(he);je&=15}ue=32767+v[ke],Q(V[(je<<4)+p[ue]]),Q(d[ue]),ke++}return qe!=63&&Q(fe),F}function me(E){E=Math.min(Math.max(E,1),100),a!=E&&(function(O){for(var F=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],I=0;I<64;I++){var V=s((F[I]*O+50)/100);V=Math.min(Math.max(V,1),255),o[T[I]]=V}for(var ue=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],fe=0;fe<64;fe++){var he=s((ue[fe]*O+50)/100);he=Math.min(Math.max(he,1),255),l[T[fe]]=he}for(var xe=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Oe=0,De=0;De<8;De++)for(var qe=0;qe<8;qe++)u[Oe]=1/(o[T[Oe]]*xe[De]*xe[qe]*8),f[Oe]=1/(l[T[Oe]]*xe[De]*xe[qe]*8),Oe++}(E<50?Math.floor(5e3/E):Math.floor(200-2*E)),a=E)}this.encode=function(E,O){O&&me(O),m=new Array,S=0,y=7,z(65496),z(65504),z(16),X(74),X(70),X(73),X(70),X(0),X(1),X(1),X(0),z(1),z(1),X(0),X(0),function(){z(65499),z(132),X(0);for(var Ze=0;Ze<64;Ze++)X(o[Ze]);X(1);for(var ct=0;ct<64;ct++)X(l[ct])}(),function(Ze,ct){z(65472),z(17),X(8),z(ct),z(Ze),X(3),X(1),X(17),X(0),X(2),X(17),X(1),X(3),X(17),X(1)}(E.width,E.height),function(){z(65476),z(418),X(0);for(var Ze=0;Ze<16;Ze++)X(L[Ze+1]);for(var ct=0;ct<=11;ct++)X(P[ct]);X(16);for(var ht=0;ht<16;ht++)X(M[ht+1]);for(var St=0;St<=161;St++)X(N[St]);X(1);for(var Nt=0;Nt<16;Nt++)X(C[Nt+1]);for(var Ot=0;Ot<=11;Ot++)X(U[Ot]);X(17);for(var Rt=0;Rt<16;Rt++)X(Y[Rt+1]);for(var wt=0;wt<=161;wt++)X(ce[wt])}(),z(65498),z(12),X(3),X(1),X(0),X(2),X(17),X(3),X(17),X(0),X(63),X(0);var F=0,I=0,V=0;S=0,y=7,this.encode.displayName="_encode_";for(var ue,fe,he,xe,Oe,De,qe,Xe,ke,le=E.data,je=E.width,it=E.height,Ue=4*je,Ve=0;Ve<it;){for(ue=0;ue<Ue;){for(Oe=Ue*Ve+ue,qe=-1,Xe=0,ke=0;ke<64;ke++)De=Oe+(Xe=ke>>3)*Ue+(qe=4*(7&ke)),Ve+Xe>=it&&(De-=Ue*(Ve+1+Xe-it)),ue+qe>=Ue&&(De-=ue+qe-Ue+4),fe=le[De++],he=le[De++],xe=le[De++],w[ke]=(B[fe]+B[he+256>>0]+B[xe+512>>0]>>16)-128,x[ke]=(B[fe+768>>0]+B[he+1024>>0]+B[xe+1280>>0]>>16)-128,A[ke]=(B[fe+1280>>0]+B[he+1536>>0]+B[xe+1792>>0]>>16)-128;F=ae(w,u,F,t,n),I=ae(x,f,I,r,i),V=ae(A,f,V,r,i),ue+=32}Ve+=8}if(y>=0){var Je=[];Je[1]=y+1,Je[0]=(1<<y+1)-1,Q(Je)}return z(65497),new Uint8Array(m)},e=e||50,function(){for(var E=String.fromCharCode,O=0;O<256;O++)R[O]=E(O)}(),t=ee(L,P),r=ee(C,U),n=ee(M,N),i=ee(Y,ce),function(){for(var E=1,O=2,F=1;F<=15;F++){for(var I=E;I<O;I++)p[32767+I]=F,d[32767+I]=[],d[32767+I][1]=F,d[32767+I][0]=I;for(var V=-(O-1);V<=-E;V++)p[32767+V]=F,d[32767+V]=[],d[32767+V][1]=F,d[32767+V][0]=O-1+V;E<<=1,O<<=1}}(),function(){for(var E=0;E<256;E++)B[E]=19595*E,B[E+256>>0]=38470*E,B[E+512>>0]=7471*E+32768,B[E+768>>0]=-11059*E,B[E+1024>>0]=-21709*E,B[E+1280>>0]=32768*E+8421375,B[E+1536>>0]=-27439*E,B[E+1792>>0]=-5329*E}(),me(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function la(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Ty(e){function t(L){if(!L)throw Error("assert :P")}function r(L,P,M){for(var N=0;4>N;N++)if(L[P+N]!=M.charCodeAt(N))return!0;return!1}function n(L,P,M,N,C){for(var U=0;U<C;U++)L[P+U]=M[N+U]}function i(L,P,M,N){for(var C=0;C<N;C++)L[P+C]=M}function a(L){return new Int32Array(L)}function s(L,P){for(var M=[],N=0;N<L;N++)M.push(new P);return M}function o(L,P){var M=[];return function N(C,U,Y){for(var ce=Y[U],ee=0;ee<ce&&(C.push(Y.length>U+1?[]:new P),!(Y.length<U+1));ee++)N(C[ee],U+1,Y)}(M,0,L),M}var l=function(){var L=this;function P(c,g){for(var b=1<<g-1>>>0;c&b;)b>>>=1;return b?(c&b-1)+b:c}function M(c,g,b,k,D){t(!(k%b));do c[g+(k-=b)]=D;while(0<k)}function N(c,g,b,k,D){if(t(2328>=D),512>=D)var H=a(512);else if((H=a(D))==null)return 0;return function(q,G,K,re,pe,be){var Ee,ye,Ie=G,Ce=1<<K,ge=a(16),ve=a(16);for(t(pe!=0),t(re!=null),t(q!=null),t(0<K),ye=0;ye<pe;++ye){if(15<re[ye])return 0;++ge[re[ye]]}if(ge[0]==pe)return 0;for(ve[1]=0,Ee=1;15>Ee;++Ee){if(ge[Ee]>1<<Ee)return 0;ve[Ee+1]=ve[Ee]+ge[Ee]}for(ye=0;ye<pe;++ye)Ee=re[ye],0<re[ye]&&(be[ve[Ee]++]=ye);if(ve[15]==1)return(re=new C).g=0,re.value=be[0],M(q,Ie,1,Ce,re),Ce;var Fe,Be=-1,Re=Ce-1,st=0,Qe=1,gt=1,et=1<<K;for(ye=0,Ee=1,pe=2;Ee<=K;++Ee,pe<<=1){if(Qe+=gt<<=1,0>(gt-=ge[Ee]))return 0;for(;0<ge[Ee];--ge[Ee])(re=new C).g=Ee,re.value=be[ye++],M(q,Ie+st,pe,et,re),st=P(st,Ee)}for(Ee=K+1,pe=2;15>=Ee;++Ee,pe<<=1){if(Qe+=gt<<=1,0>(gt-=ge[Ee]))return 0;for(;0<ge[Ee];--ge[Ee]){if(re=new C,(st&Re)!=Be){for(Ie+=et,Fe=1<<(Be=Ee)-K;15>Be&&!(0>=(Fe-=ge[Be]));)++Be,Fe<<=1;Ce+=et=1<<(Fe=Be-K),q[G+(Be=st&Re)].g=Fe+K,q[G+Be].value=Ie-G-Be}re.g=Ee-K,re.value=be[ye++],M(q,Ie+(st>>K),pe,et,re),st=P(st,Ee)}}return Qe!=2*ve[15]-1?0:Ce}(c,g,b,k,D,H)}function C(){this.value=this.g=0}function U(){this.value=this.g=0}function Y(){this.G=s(5,C),this.H=a(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(cn,U)}function ce(c,g,b,k){t(c!=null),t(g!=null),t(2147483648>k),c.Ca=254,c.I=0,c.b=-8,c.Ka=0,c.oa=g,c.pa=b,c.Jd=g,c.Yc=b+k,c.Zc=4<=k?b+k-4+1:b,ue(c)}function ee(c,g){for(var b=0;0<g--;)b|=he(c,128)<<g;return b}function Q(c,g){var b=ee(c,g);return fe(c)?-b:b}function X(c,g,b,k){var D,H=0;for(t(c!=null),t(g!=null),t(4294967288>k),c.Sb=k,c.Ra=0,c.u=0,c.h=0,4<k&&(k=4),D=0;D<k;++D)H+=g[b+D]<<8*D;c.Ra=H,c.bb=k,c.oa=g,c.pa=b}function z(c){for(;8<=c.u&&c.bb<c.Sb;)c.Ra>>>=8,c.Ra+=c.oa[c.pa+c.bb]<<_l-8>>>0,++c.bb,c.u-=8;F(c)&&(c.h=1,c.u=0)}function ae(c,g){if(t(0<=g),!c.h&&g<=xl){var b=O(c)&wl[g];return c.u+=g,z(c),b}return c.h=1,c.u=0}function me(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function E(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function O(c){return c.Ra>>>(c.u&_l-1)>>>0}function F(c){return t(c.bb<=c.Sb),c.h||c.bb==c.Sb&&c.u>_l}function I(c,g){c.u=g,c.h=F(c)}function V(c){c.u>=Zu&&(t(c.u>=Zu),z(c))}function ue(c){t(c!=null&&c.oa!=null),c.pa<c.Zc?(c.I=(c.oa[c.pa++]|c.I<<8)>>>0,c.b+=8):(t(c!=null&&c.oa!=null),c.pa<c.Yc?(c.b+=8,c.I=c.oa[c.pa++]|c.I<<8):c.Ka?c.b=0:(c.I<<=8,c.b+=8,c.Ka=1))}function fe(c){return ee(c,1)}function he(c,g){var b=c.Ca;0>c.b&&ue(c);var k=c.b,D=b*g>>>8,H=(c.I>>>k>D)+0;for(H?(b-=D,c.I-=D+1<<k>>>0):b=D+1,k=b,D=0;256<=k;)D+=8,k>>=8;return k=7^D+Jn[k],c.b-=k,c.Ca=(b<<k)-1,H}function xe(c,g,b){c[g+0]=b>>24&255,c[g+1]=b>>16&255,c[g+2]=b>>8&255,c[g+3]=b>>0&255}function Oe(c,g){return c[g+0]<<0|c[g+1]<<8}function De(c,g){return Oe(c,g)|c[g+2]<<16}function qe(c,g){return Oe(c,g)|Oe(c,g+2)<<16}function Xe(c,g){var b=1<<g;return t(c!=null),t(0<g),c.X=a(b),c.X==null?0:(c.Mb=32-g,c.Xa=g,1)}function ke(c,g){t(c!=null),t(g!=null),t(c.Xa==g.Xa),n(g.X,0,c.X,0,1<<g.Xa)}function le(){this.X=[],this.Xa=this.Mb=0}function je(c,g,b,k){t(b!=null),t(k!=null);var D=b[0],H=k[0];return D==0&&(D=(c*H+g/2)/g),H==0&&(H=(g*D+c/2)/c),0>=D||0>=H?0:(b[0]=D,k[0]=H,1)}function it(c,g){return c+(1<<g)-1>>>g}function Ue(c,g){return((4278255360&c)+(4278255360&g)>>>0&4278255360)+((16711935&c)+(16711935&g)>>>0&16711935)>>>0}function Ve(c,g){L[g]=function(b,k,D,H,q,G,K){var re;for(re=0;re<q;++re){var pe=L[c](G[K+re-1],D,H+re);G[K+re]=Ue(b[k+re],pe)}}}function Je(){this.ud=this.hd=this.jd=0}function Ze(c,g){return((4278124286&(c^g))>>>1)+(c&g)>>>0}function ct(c){return 0<=c&&256>c?c:0>c?0:255<c?255:void 0}function ht(c,g){return ct(c+(c-g+.5>>1))}function St(c,g,b){return Math.abs(g-b)-Math.abs(c-b)}function Nt(c,g,b,k,D,H,q){for(k=H[q-1],b=0;b<D;++b)H[q+b]=k=Ue(c[g+b],k)}function Ot(c,g,b,k,D){var H;for(H=0;H<b;++H){var q=c[g+H],G=q>>8&255,K=16711935&(K=(K=16711935&q)+((G<<16)+G));k[D+H]=(4278255360&q)+K>>>0}}function Rt(c,g){g.jd=c>>0&255,g.hd=c>>8&255,g.ud=c>>16&255}function wt(c,g,b,k,D,H){var q;for(q=0;q<k;++q){var G=g[b+q],K=G>>>8,re=G,pe=255&(pe=(pe=G>>>16)+((c.jd<<24>>24)*(K<<24>>24)>>>5));re=255&(re=(re=re+((c.hd<<24>>24)*(K<<24>>24)>>>5))+((c.ud<<24>>24)*(pe<<24>>24)>>>5)),D[H+q]=(4278255360&G)+(pe<<16)+re}}function Lt(c,g,b,k,D){L[g]=function(H,q,G,K,re,pe,be,Ee,ye){for(K=be;K<Ee;++K)for(be=0;be<ye;++be)re[pe++]=D(G[k(H[q++])])},L[c]=function(H,q,G,K,re,pe,be){var Ee=8>>H.b,ye=H.Ea,Ie=H.K[0],Ce=H.w;if(8>Ee)for(H=(1<<H.b)-1,Ce=(1<<Ee)-1;q<G;++q){var ge,ve=0;for(ge=0;ge<ye;++ge)ge&H||(ve=k(K[re++])),pe[be++]=D(Ie[ve&Ce]),ve>>=Ee}else L["VP8LMapColor"+b](K,re,Ie,Ce,pe,be,q,G,ye)}}function tt(c,g,b,k,D){for(b=g+b;g<b;){var H=c[g++];k[D++]=H>>16&255,k[D++]=H>>8&255,k[D++]=H>>0&255}}function Gr(c,g,b,k,D){for(b=g+b;g<b;){var H=c[g++];k[D++]=H>>16&255,k[D++]=H>>8&255,k[D++]=H>>0&255,k[D++]=H>>24&255}}function Dt(c,g,b,k,D){for(b=g+b;g<b;){var H=(q=c[g++])>>16&240|q>>12&15,q=q>>0&240|q>>28&15;k[D++]=H,k[D++]=q}}function Kn(c,g,b,k,D){for(b=g+b;g<b;){var H=(q=c[g++])>>16&248|q>>13&7,q=q>>5&224|q>>3&31;k[D++]=H,k[D++]=q}}function $t(c,g,b,k,D){for(b=g+b;g<b;){var H=c[g++];k[D++]=H>>0&255,k[D++]=H>>8&255,k[D++]=H>>16&255}}function or(c,g,b,k,D,H){if(H==0)for(b=g+b;g<b;)xe(k,((H=c[g++])[0]>>24|H[1]>>8&65280|H[2]<<8&16711680|H[3]<<24)>>>0),D+=32;else n(k,D,c,g,b)}function Pi(c,g){L[g][0]=L[c+"0"],L[g][1]=L[c+"1"],L[g][2]=L[c+"2"],L[g][3]=L[c+"3"],L[g][4]=L[c+"4"],L[g][5]=L[c+"5"],L[g][6]=L[c+"6"],L[g][7]=L[c+"7"],L[g][8]=L[c+"8"],L[g][9]=L[c+"9"],L[g][10]=L[c+"10"],L[g][11]=L[c+"11"],L[g][12]=L[c+"12"],L[g][13]=L[c+"13"],L[g][14]=L[c+"0"],L[g][15]=L[c+"0"]}function Mt(c){return c==h1||c==d1||c==mh||c==p1}function Ea(){this.eb=[],this.size=this.A=this.fb=0}function hr(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function ci(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Ea,this.f.kb=new hr,this.sd=null}function Xi(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function ir(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function bt(c){return alert("todo:WebPSamplerProcessPlane"),c.T}function zt(c,g){var b=c.T,k=g.ba.f.RGBA,D=k.eb,H=k.fb+c.ka*k.A,q=Bi[g.ba.S],G=c.y,K=c.O,re=c.f,pe=c.N,be=c.ea,Ee=c.W,ye=g.cc,Ie=g.dc,Ce=g.Mc,ge=g.Nc,ve=c.ka,Fe=c.ka+c.T,Be=c.U,Re=Be+1>>1;for(ve==0?q(G,K,null,null,re,pe,be,Ee,re,pe,be,Ee,D,H,null,null,Be):(q(g.ec,g.fc,G,K,ye,Ie,Ce,ge,re,pe,be,Ee,D,H-k.A,D,H,Be),++b);ve+2<Fe;ve+=2)ye=re,Ie=pe,Ce=be,ge=Ee,pe+=c.Rc,Ee+=c.Rc,H+=2*k.A,q(G,(K+=2*c.fa)-c.fa,G,K,ye,Ie,Ce,ge,re,pe,be,Ee,D,H-k.A,D,H,Be);return K+=c.fa,c.j+Fe<c.o?(n(g.ec,g.fc,G,K,Be),n(g.cc,g.dc,re,pe,Re),n(g.Mc,g.Nc,be,Ee,Re),b--):1&Fe||q(G,K,null,null,re,pe,be,Ee,re,pe,be,Ee,D,H+k.A,null,null,Be),b}function Wa(c,g,b){var k=c.F,D=[c.J];if(k!=null){var H=c.U,q=g.ba.S,G=q==gh||q==mh;g=g.ba.f.RGBA;var K=[0],re=c.ka;K[0]=c.T,c.Kb&&(re==0?--K[0]:(--re,D[0]-=c.width),c.j+c.ka+c.T==c.o&&(K[0]=c.o-c.j-re));var pe=g.eb;re=g.fb+re*g.A,c=ur(k,D[0],c.width,H,K,pe,re+(G?0:3),g.A),t(b==K),c&&Mt(q)&&ji(pe,re,G,H,K,g.A)}return 0}function Kr(c){var g=c.ma,b=g.ba.S,k=11>b,D=b==dh||b==ph||b==gh||b==f1||b==12||Mt(b);if(g.memory=null,g.Ib=null,g.Jb=null,g.Nd=null,!Ju(g.Oa,c,D?11:12))return 0;if(D&&Mt(b)&&ze(),c.da)alert("todo:use_scaling");else{if(k){if(g.Ib=bt,c.Kb){if(b=c.U+1>>1,g.memory=a(c.U+2*b),g.memory==null)return 0;g.ec=g.memory,g.fc=0,g.cc=g.ec,g.dc=g.fc+c.U,g.Mc=g.cc,g.Nc=g.dc+b,g.Ib=zt,ze()}}else alert("todo:EmitYUV");D&&(g.Jb=Wa,k&&we())}if(k&&!_m){for(c=0;256>c;++c)b3[c]=89858*(c-128)+yh>>vh,T3[c]=-22014*(c-128)+yh,A3[c]=-45773*(c-128),E3[c]=113618*(c-128)+yh>>vh;for(c=sc;c<v1;++c)g=76283*(c-16)+yh>>vh,k3[c-sc]=di(g,255),N3[c-sc]=di(g+8>>4,15);_m=1}return 1}function Oi(c){var g=c.ma,b=c.U,k=c.T;return t(!(1&c.ka)),0>=b||0>=k?0:(b=g.Ib(c,g),g.Jb!=null&&g.Jb(c,g,b),g.Dc+=b,1)}function Fi(c){c.ma.memory=null}function pt(c,g,b,k){return ae(c,8)!=47?0:(g[0]=ae(c,14)+1,b[0]=ae(c,14)+1,k[0]=ae(c,1),ae(c,3)!=0?0:!c.h)}function fi(c,g){if(4>c)return c+1;var b=c-2>>1;return(2+(1&c)<<b)+ae(g,b)+1}function Yn(c,g){return 120<g?g-120:1<=(b=((b=u3[g-1])>>4)*c+(8-(15&b)))?b:1;var b}function En(c,g,b){var k=O(b),D=c[g+=255&k].g-8;return 0<D&&(I(b,b.u+8),k=O(b),g+=c[g].value,g+=k&(1<<D)-1),I(b,b.u+c[g].g),c[g].value}function Lr(c,g,b){return b.g+=c.g,b.value+=c.value<<g>>>0,t(8>=b.g),c.g}function Sr(c,g,b){var k=c.xc;return t((g=k==0?0:c.vc[c.md*(b>>k)+(g>>k)])<c.Wb),c.Ya[g]}function W(c,g,b,k){var D=c.ab,H=c.c*g,q=c.C;g=q+g;var G=b,K=k;for(k=c.Ta,b=c.Ua;0<D--;){var re=c.gc[D],pe=q,be=g,Ee=G,ye=K,Ie=(K=k,G=b,re.Ea);switch(t(pe<be),t(be<=re.nc),re.hc){case 2:sh(Ee,ye,(be-pe)*Ie,K,G);break;case 0:var Ce=pe,ge=be,ve=K,Fe=G,Be=(et=re).Ea;Ce==0&&(u1(Ee,ye,null,null,1,ve,Fe),Nt(Ee,ye+1,0,0,Be-1,ve,Fe+1),ye+=Be,Fe+=Be,++Ce);for(var Re=1<<et.b,st=Re-1,Qe=it(Be,et.b),gt=et.K,et=et.w+(Ce>>et.b)*Qe;Ce<ge;){var Wt=gt,Gt=et,Bt=1;for(ec(Ee,ye,ve,Fe-Be,1,ve,Fe);Bt<Be;){var It=(Bt&~st)+Re;It>Be&&(It=Be),(0,Ss[Wt[Gt++]>>8&15])(Ee,ye+ +Bt,ve,Fe+Bt-Be,It-Bt,ve,Fe+Bt),Bt=It}ye+=Be,Fe+=Be,++Ce&st||(et+=Qe)}be!=re.nc&&n(K,G-Ie,K,G+(be-pe-1)*Ie,Ie);break;case 1:for(Ie=Ee,ge=ye,Be=(Ee=re.Ea)-(Fe=Ee&~(ve=(ye=1<<re.b)-1)),Ce=it(Ee,re.b),Re=re.K,re=re.w+(pe>>re.b)*Ce;pe<be;){for(st=Re,Qe=re,gt=new Je,et=ge+Fe,Wt=ge+Ee;ge<et;)Rt(st[Qe++],gt),xo(gt,Ie,ge,ye,K,G),ge+=ye,G+=ye;ge<Wt&&(Rt(st[Qe++],gt),xo(gt,Ie,ge,Be,K,G),ge+=Be,G+=Be),++pe&ve||(re+=Ce)}break;case 3:if(Ee==K&&ye==G&&0<re.b){for(ge=K,Ee=Ie=G+(be-pe)*Ie-(Fe=(be-pe)*it(re.Ea,re.b)),ye=K,ve=G,Ce=[],Fe=(Be=Fe)-1;0<=Fe;--Fe)Ce[Fe]=ye[ve+Fe];for(Fe=Be-1;0<=Fe;--Fe)ge[Ee+Fe]=Ce[Fe];Ri(re,pe,be,K,Ie,K,G)}else Ri(re,pe,be,Ee,ye,K,G)}G=k,K=b}K!=b&&n(k,b,G,K,H)}function ie(c,g){var b=c.V,k=c.Ba+c.c*c.C,D=g-c.C;if(t(g<=c.l.o),t(16>=D),0<D){var H=c.l,q=c.Ta,G=c.Ua,K=H.width;if(W(c,D,b,k),D=G=[G],t((b=c.C)<(k=g)),t(H.v<H.va),k>H.o&&(k=H.o),b<H.j){var re=H.j-b;b=H.j,D[0]+=re*K}if(b>=k?b=0:(D[0]+=4*H.v,H.ka=b-H.j,H.U=H.va-H.v,H.T=k-b,b=1),b){if(G=G[0],11>(b=c.ca).S){var pe=b.f.RGBA,be=(k=b.S,D=H.U,H=H.T,re=pe.eb,pe.A),Ee=H;for(pe=pe.fb+c.Ma*pe.A;0<Ee--;){var ye=q,Ie=G,Ce=D,ge=re,ve=pe;switch(k){case hh:Qn(ye,Ie,Ce,ge,ve);break;case dh:Mn(ye,Ie,Ce,ge,ve);break;case h1:Mn(ye,Ie,Ce,ge,ve),ji(ge,ve,0,Ce,1,0);break;case hm:Ka(ye,Ie,Ce,ge,ve);break;case ph:or(ye,Ie,Ce,ge,ve,1);break;case d1:or(ye,Ie,Ce,ge,ve,1),ji(ge,ve,0,Ce,1,0);break;case gh:or(ye,Ie,Ce,ge,ve,0);break;case mh:or(ye,Ie,Ce,ge,ve,0),ji(ge,ve,1,Ce,1,0);break;case f1:bs(ye,Ie,Ce,ge,ve);break;case p1:bs(ye,Ie,Ce,ge,ve),lr(ge,ve,Ce,1,0);break;case dm:Ga(ye,Ie,Ce,ge,ve);break;default:t(0)}G+=K,pe+=be}c.Ma+=H}else alert("todo:EmitRescaledRowsYUVA");t(c.Ma<=b.height)}}c.C=g,t(c.C<=c.i)}function J(c){var g;if(0<c.ua)return 0;for(g=0;g<c.Wb;++g){var b=c.Ya[g].G,k=c.Ya[g].H;if(0<b[1][k[1]+0].g||0<b[2][k[2]+0].g||0<b[3][k[3]+0].g)return 0}return 1}function te(c,g,b,k,D,H){if(c.Z!=0){var q=c.qd,G=c.rd;for(t(ks[c.Z]!=null);g<b;++g)ks[c.Z](q,G,k,D,k,D,H),q=k,G=D,D+=H;c.qd=q,c.rd=G}}function ne(c,g){var b=c.l.ma,k=b.Z==0||b.Z==1?c.l.j:c.C;if(k=c.C<k?k:c.C,t(g<=c.l.o),g>k){var D=c.l.width,H=b.ca,q=b.tb+D*k,G=c.V,K=c.Ba+c.c*k,re=c.gc;t(c.ab==1),t(re[0].hc==3),oh(re[0],k,g,G,K,H,q),te(b,k,g,H,q,D)}c.C=c.Ma=g}function se(c,g,b,k,D,H,q){var G=c.$/k,K=c.$%k,re=c.m,pe=c.s,be=b+c.$,Ee=be;D=b+k*D;var ye=b+k*H,Ie=280+pe.ua,Ce=c.Pb?G:16777216,ge=0<pe.ua?pe.Wa:null,ve=pe.wc,Fe=be<ye?Sr(pe,K,G):null;t(c.C<H),t(ye<=D);var Be=!1;e:for(;;){for(;Be||be<ye;){var Re=0;if(G>=Ce){var st=be-b;t((Ce=c).Pb),Ce.wd=Ce.m,Ce.xd=st,0<Ce.s.ua&&ke(Ce.s.Wa,Ce.s.vb),Ce=G+f3}if(K&ve||(Fe=Sr(pe,K,G)),t(Fe!=null),Fe.Qb&&(g[be]=Fe.qb,Be=!0),!Be)if(V(re),Fe.jc){Re=re,st=g;var Qe=be,gt=Fe.pd[O(Re)&cn-1];t(Fe.jc),256>gt.g?(I(Re,Re.u+gt.g),st[Qe]=gt.value,Re=0):(I(Re,Re.u+gt.g-256),t(256<=gt.value),Re=gt.value),Re==0&&(Be=!0)}else Re=En(Fe.G[0],Fe.H[0],re);if(re.h)break;if(Be||256>Re){if(!Be)if(Fe.nd)g[be]=(Fe.qb|Re<<8)>>>0;else{if(V(re),Be=En(Fe.G[1],Fe.H[1],re),V(re),st=En(Fe.G[2],Fe.H[2],re),Qe=En(Fe.G[3],Fe.H[3],re),re.h)break;g[be]=(Qe<<24|Be<<16|Re<<8|st)>>>0}if(Be=!1,++be,++K>=k&&(K=0,++G,q!=null&&G<=H&&!(G%16)&&q(c,G),ge!=null))for(;Ee<be;)Re=g[Ee++],ge.X[(506832829*Re&4294967295)>>>ge.Mb]=Re}else if(280>Re){if(Re=fi(Re-256,re),st=En(Fe.G[4],Fe.H[4],re),V(re),st=Yn(k,st=fi(st,re)),re.h)break;if(be-b<st||D-be<Re)break e;for(Qe=0;Qe<Re;++Qe)g[be+Qe]=g[be+Qe-st];for(be+=Re,K+=Re;K>=k;)K-=k,++G,q!=null&&G<=H&&!(G%16)&&q(c,G);if(t(be<=D),K&ve&&(Fe=Sr(pe,K,G)),ge!=null)for(;Ee<be;)Re=g[Ee++],ge.X[(506832829*Re&4294967295)>>>ge.Mb]=Re}else{if(!(Re<Ie))break e;for(Be=Re-280,t(ge!=null);Ee<be;)Re=g[Ee++],ge.X[(506832829*Re&4294967295)>>>ge.Mb]=Re;Re=be,t(!(Be>>>(st=ge).Xa)),g[Re]=st.X[Be],Be=!0}Be||t(re.h==F(re))}if(c.Pb&&re.h&&be<D)t(c.m.h),c.a=5,c.m=c.wd,c.$=c.xd,0<c.s.ua&&ke(c.s.vb,c.s.Wa);else{if(re.h)break e;q!=null&&q(c,G>H?H:G),c.a=0,c.$=be-b}return 1}return c.a=3,0}function Se(c){t(c!=null),c.vc=null,c.yc=null,c.Ya=null;var g=c.Wa;g!=null&&(g.X=null),c.vb=null,t(c!=null)}function Ne(){var c=new l1;return c==null?null:(c.a=0,c.xb=mm,Pi("Predictor","VP8LPredictors"),Pi("Predictor","VP8LPredictors_C"),Pi("PredictorAdd","VP8LPredictorsAdd"),Pi("PredictorAdd","VP8LPredictorsAdd_C"),sh=Ot,xo=wt,Qn=tt,Mn=Gr,bs=Dt,Ga=Kn,Ka=$t,L.VP8LMapColor32b=Sl,L.VP8LMapColor8b=lh,c)}function _e(c,g,b,k,D){var H=1,q=[c],G=[g],K=k.m,re=k.s,pe=null,be=0;e:for(;;){if(b)for(;H&&ae(K,1);){var Ee=q,ye=G,Ie=k,Ce=1,ge=Ie.m,ve=Ie.gc[Ie.ab],Fe=ae(ge,2);if(Ie.Oc&1<<Fe)H=0;else{switch(Ie.Oc|=1<<Fe,ve.hc=Fe,ve.Ea=Ee[0],ve.nc=ye[0],ve.K=[null],++Ie.ab,t(4>=Ie.ab),Fe){case 0:case 1:ve.b=ae(ge,3)+2,Ce=_e(it(ve.Ea,ve.b),it(ve.nc,ve.b),0,Ie,ve.K),ve.K=ve.K[0];break;case 3:var Be,Re=ae(ge,8)+1,st=16<Re?0:4<Re?1:2<Re?2:3;if(Ee[0]=it(ve.Ea,st),ve.b=st,Be=Ce=_e(Re,1,0,Ie,ve.K)){var Qe,gt=Re,et=ve,Wt=1<<(8>>et.b),Gt=a(Wt);if(Gt==null)Be=0;else{var Bt=et.K[0],It=et.w;for(Gt[0]=et.K[0][0],Qe=1;Qe<1*gt;++Qe)Gt[Qe]=Ue(Bt[It+Qe],Gt[Qe-1]);for(;Qe<4*Wt;++Qe)Gt[Qe]=0;et.K[0]=null,et.K[0]=Gt,Be=1}}Ce=Be;break;case 2:break;default:t(0)}H=Ce}}if(q=q[0],G=G[0],H&&ae(K,1)&&!(H=1<=(be=ae(K,4))&&11>=be)){k.a=3;break e}var ar;if(ar=H)t:{var rr,Ct,Ur,Zn=k,zr=q,ei=G,Kt=be,gi=b,mi=Zn.m,rn=Zn.s,fn=[null],Un=1,Ui=0,La=c3[Kt];r:for(;;){if(gi&&ae(mi,1)){var nn=ae(mi,3)+2,Qa=it(zr,nn),Ao=it(ei,nn),kl=Qa*Ao;if(!_e(Qa,Ao,0,Zn,fn))break r;for(fn=fn[0],rn.xc=nn,rr=0;rr<kl;++rr){var Ns=fn[rr]>>8&65535;fn[rr]=Ns,Ns>=Un&&(Un=Ns+1)}}if(mi.h)break r;for(Ct=0;5>Ct;++Ct){var Er=pm[Ct];!Ct&&0<Kt&&(Er+=1<<Kt),Ui<Er&&(Ui=Er)}var y1=s(Un*La,C),Em=Un,Am=s(Em,Y);if(Am==null)var xh=null;else t(65536>=Em),xh=Am;var oc=a(Ui);if(xh==null||oc==null||y1==null){Zn.a=1;break r}var _h=y1;for(rr=Ur=0;rr<Un;++rr){var na=xh[rr],Nl=na.G,Cl=na.H,Tm=0,Sh=1,km=0;for(Ct=0;5>Ct;++Ct){Er=pm[Ct],Nl[Ct]=_h,Cl[Ct]=Ur,!Ct&&0<Kt&&(Er+=1<<Kt);i:{var bh,w1=Er,Eh=Zn,lc=oc,P3=_h,O3=Ur,x1=0,Cs=Eh.m,F3=ae(Cs,1);if(i(lc,0,0,w1),F3){var R3=ae(Cs,1)+1,I3=ae(Cs,1),Nm=ae(Cs,I3==0?1:8);lc[Nm]=1,R3==2&&(lc[Nm=ae(Cs,8)]=1);var Ah=1}else{var Cm=a(19),Lm=ae(Cs,4)+4;if(19<Lm){Eh.a=3;var Th=0;break i}for(bh=0;bh<Lm;++bh)Cm[l3[bh]]=ae(Cs,3);var _1=void 0,uc=void 0,Pm=Eh,D3=Cm,kh=w1,Om=lc,S1=0,Ls=Pm.m,Fm=8,Rm=s(128,C);n:for(;N(Rm,0,7,D3,19);){if(ae(Ls,1)){var j3=2+2*ae(Ls,3);if((_1=2+ae(Ls,j3))>kh)break n}else _1=kh;for(uc=0;uc<kh&&_1--;){V(Ls);var Im=Rm[0+(127&O(Ls))];I(Ls,Ls.u+Im.g);var Ll=Im.value;if(16>Ll)Om[uc++]=Ll,Ll!=0&&(Fm=Ll);else{var M3=Ll==16,Dm=Ll-16,B3=s3[Dm],jm=ae(Ls,a3[Dm])+B3;if(uc+jm>kh)break n;for(var U3=M3?Fm:0;0<jm--;)Om[uc++]=U3}}S1=1;break n}S1||(Pm.a=3),Ah=S1}(Ah=Ah&&!Cs.h)&&(x1=N(P3,O3,8,lc,w1)),Ah&&x1!=0?Th=x1:(Eh.a=3,Th=0)}if(Th==0)break r;if(Sh&&o3[Ct]==1&&(Sh=_h[Ur].g==0),Tm+=_h[Ur].g,Ur+=Th,3>=Ct){var cc,b1=oc[0];for(cc=1;cc<Er;++cc)oc[cc]>b1&&(b1=oc[cc]);km+=b1}}if(na.nd=Sh,na.Qb=0,Sh&&(na.qb=(Nl[3][Cl[3]+0].value<<24|Nl[1][Cl[1]+0].value<<16|Nl[2][Cl[2]+0].value)>>>0,Tm==0&&256>Nl[0][Cl[0]+0].value&&(na.Qb=1,na.qb+=Nl[0][Cl[0]+0].value<<8)),na.jc=!na.Qb&&6>km,na.jc){var Nh,Za=na;for(Nh=0;Nh<cn;++Nh){var Ps=Nh,Os=Za.pd[Ps],Ch=Za.G[0][Za.H[0]+Ps];256<=Ch.value?(Os.g=Ch.g+256,Os.value=Ch.value):(Os.g=0,Os.value=0,Ps>>=Lr(Ch,8,Os),Ps>>=Lr(Za.G[1][Za.H[1]+Ps],16,Os),Ps>>=Lr(Za.G[2][Za.H[2]+Ps],0,Os),Lr(Za.G[3][Za.H[3]+Ps],24,Os))}}}rn.vc=fn,rn.Wb=Un,rn.Ya=xh,rn.yc=y1,ar=1;break t}ar=0}if(!(H=ar)){k.a=3;break e}if(0<be){if(re.ua=1<<be,!Xe(re.Wa,be)){k.a=1,H=0;break e}}else re.ua=0;var E1=k,Mm=q,z3=G,A1=E1.s,T1=A1.xc;if(E1.c=Mm,E1.i=z3,A1.md=it(Mm,T1),A1.wc=T1==0?-1:(1<<T1)-1,b){k.xb=y3;break e}if((pe=a(q*G))==null){k.a=1,H=0;break e}H=(H=se(k,pe,0,q,G,G,null))&&!K.h;break e}return H?(D!=null?D[0]=pe:(t(pe==null),t(b)),k.$=0,b||Se(re)):Se(re),H}function Ae(c,g){var b=c.c*c.i,k=b+g+16*g;return t(c.c<=g),c.V=a(k),c.V==null?(c.Ta=null,c.Ua=0,c.a=1,0):(c.Ta=c.V,c.Ua=c.Ba+b+g,1)}function Te(c,g){var b=c.C,k=g-b,D=c.V,H=c.Ba+c.c*b;for(t(g<=c.l.o);0<k;){var q=16<k?16:k,G=c.l.ma,K=c.l.width,re=K*q,pe=G.ca,be=G.tb+K*b,Ee=c.Ta,ye=c.Ua;W(c,q,D,H),Fr(Ee,ye,pe,be,re),te(G,b,b+q,pe,be,K),k-=q,D+=q*c.c,b+=q}t(b==g),c.C=c.Ma=g}function He(){this.ub=this.yd=this.td=this.Rb=0}function Ge(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function nt(){this.Fb=this.Bb=this.Cb=0,this.Zb=a(4),this.Lb=a(4)}function $e(){this.Yb=function(){var c=[];return function g(b,k,D){for(var H=D[k],q=0;q<H&&(b.push(D.length>k+1?[]:0),!(D.length<k+1));q++)g(b[q],k+1,D)}(c,0,[3,11]),c}()}function rt(){this.jb=a(3),this.Wc=o([4,8],$e),this.Xc=o([4,17],$e)}function _t(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a(4),this.od=new a(4)}function Vt(){this.ld=this.La=this.dd=this.tc=0}function tr(){this.Na=this.la=0}function Mr(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Ji(){this.ad=a(384),this.Za=0,this.Ob=a(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function qa(){this.uc=this.M=this.Nb=0,this.wa=Array(new Vt),this.Y=0,this.ya=Array(new Ji),this.aa=0,this.l=new Ta}function Aa(){this.y=a(16),this.f=a(8),this.ea=a(8)}function Qi(){this.cb=this.a=0,this.sc="",this.m=new me,this.Od=new He,this.Kc=new Ge,this.ed=new _t,this.Qa=new nt,this.Ic=this.$c=this.Aa=0,this.D=new qa,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,me),this.ia=0,this.pb=s(4,Mr),this.Pa=new rt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Aa),this.Hd=0,this.rb=Array(new tr),this.sb=0,this.wa=Array(new Vt),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Ji),this.L=this.aa=0,this.gd=o([4,2],Vt),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Ta(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function hi(){var c=new Qi;return c!=null&&(c.a=0,c.sc="OK",c.cb=0,c.Xb=0,ac||(ac=$f)),c}function Pr(c,g,b){return c.a==0&&(c.a=g,c.sc=b,c.cb=0),0}function Wf(c,g,b){return 3<=b&&c[g+0]==157&&c[g+1]==1&&c[g+2]==42}function qf(c,g){if(c==null)return 0;if(c.a=0,c.sc="OK",g==null)return Pr(c,2,"null VP8Io passed to VP8GetHeaders()");var b=g.data,k=g.w,D=g.ha;if(4>D)return Pr(c,7,"Truncated header.");var H=b[k+0]|b[k+1]<<8|b[k+2]<<16,q=c.Od;if(q.Rb=!(1&H),q.td=H>>1&7,q.yd=H>>4&1,q.ub=H>>5,3<q.td)return Pr(c,3,"Incorrect keyframe parameters.");if(!q.yd)return Pr(c,4,"Frame not displayable.");k+=3,D-=3;var G=c.Kc;if(q.Rb){if(7>D)return Pr(c,7,"cannot parse picture header");if(!Wf(b,k,D))return Pr(c,3,"Bad code word");G.c=16383&(b[k+4]<<8|b[k+3]),G.Td=b[k+4]>>6,G.i=16383&(b[k+6]<<8|b[k+5]),G.Ud=b[k+6]>>6,k+=7,D-=7,c.za=G.c+15>>4,c.Ub=G.i+15>>4,g.width=G.c,g.height=G.i,g.Da=0,g.j=0,g.v=0,g.va=g.width,g.o=g.height,g.da=0,g.ib=g.width,g.hb=g.height,g.U=g.width,g.T=g.height,i((H=c.Pa).jb,0,255,H.jb.length),t((H=c.Qa)!=null),H.Cb=0,H.Bb=0,H.Fb=1,i(H.Zb,0,0,H.Zb.length),i(H.Lb,0,0,H.Lb)}if(q.ub>D)return Pr(c,7,"bad partition length");ce(H=c.m,b,k,q.ub),k+=q.ub,D-=q.ub,q.Rb&&(G.Ld=fe(H),G.Kd=fe(H)),G=c.Qa;var K,re=c.Pa;if(t(H!=null),t(G!=null),G.Cb=fe(H),G.Cb){if(G.Bb=fe(H),fe(H)){for(G.Fb=fe(H),K=0;4>K;++K)G.Zb[K]=fe(H)?Q(H,7):0;for(K=0;4>K;++K)G.Lb[K]=fe(H)?Q(H,6):0}if(G.Bb)for(K=0;3>K;++K)re.jb[K]=fe(H)?ee(H,8):255}else G.Bb=0;if(H.Ka)return Pr(c,3,"cannot parse segment header");if((G=c.ed).zd=fe(H),G.Tb=ee(H,6),G.wb=ee(H,3),G.Pc=fe(H),G.Pc&&fe(H)){for(re=0;4>re;++re)fe(H)&&(G.vd[re]=Q(H,6));for(re=0;4>re;++re)fe(H)&&(G.od[re]=Q(H,6))}if(c.L=G.Tb==0?0:G.zd?1:2,H.Ka)return Pr(c,3,"cannot parse filter header");var pe=D;if(D=K=k,k=K+pe,G=pe,c.Xb=(1<<ee(c.m,2))-1,pe<3*(re=c.Xb))b=7;else{for(K+=3*re,G-=3*re,pe=0;pe<re;++pe){var be=b[D+0]|b[D+1]<<8|b[D+2]<<16;be>G&&(be=G),ce(c.Jc[+pe],b,K,be),K+=be,G-=be,D+=3}ce(c.Jc[+re],b,K,G),b=K<k?0:5}if(b!=0)return Pr(c,b,"cannot parse partitions");for(b=ee(K=c.m,7),D=fe(K)?Q(K,4):0,k=fe(K)?Q(K,4):0,G=fe(K)?Q(K,4):0,re=fe(K)?Q(K,4):0,K=fe(K)?Q(K,4):0,pe=c.Qa,be=0;4>be;++be){if(pe.Cb){var Ee=pe.Zb[be];pe.Fb||(Ee+=b)}else{if(0<be){c.pb[be]=c.pb[0];continue}Ee=b}var ye=c.pb[be];ye.Sc[0]=g1[di(Ee+D,127)],ye.Sc[1]=m1[di(Ee+0,127)],ye.Eb[0]=2*g1[di(Ee+k,127)],ye.Eb[1]=101581*m1[di(Ee+G,127)]>>16,8>ye.Eb[1]&&(ye.Eb[1]=8),ye.Qc[0]=g1[di(Ee+re,117)],ye.Qc[1]=m1[di(Ee+K,127)],ye.lc=Ee+K}if(!q.Rb)return Pr(c,4,"Not a key frame.");for(fe(H),q=c.Pa,b=0;4>b;++b){for(D=0;8>D;++D)for(k=0;3>k;++k)for(G=0;11>G;++G)re=he(H,m3[b][D][k][G])?ee(H,8):p3[b][D][k][G],q.Wc[b][D].Yb[k][G]=re;for(D=0;17>D;++D)q.Xc[b][D]=q.Wc[b][v3[D]]}return c.kc=fe(H),c.kc&&(c.Bd=ee(H,8)),c.cb=1}function $f(c,g,b,k,D,H,q){var G=g[D].Yb[b];for(b=0;16>D;++D){if(!he(c,G[b+0]))return D;for(;!he(c,G[b+1]);)if(G=g[++D].Yb[0],b=0,D==16)return 16;var K=g[D+1].Yb;if(he(c,G[b+2])){var re=c,pe=0;if(he(re,(Ee=G)[(be=b)+3]))if(he(re,Ee[be+6])){for(G=0,be=2*(pe=he(re,Ee[be+8]))+(Ee=he(re,Ee[be+9+pe])),pe=0,Ee=h3[be];Ee[G];++G)pe+=pe+he(re,Ee[G]);pe+=3+(8<<be)}else he(re,Ee[be+7])?(pe=7+2*he(re,165),pe+=he(re,145)):pe=5+he(re,159);else pe=he(re,Ee[be+4])?3+he(re,Ee[be+5]):2;G=K[2]}else pe=1,G=K[1];K=q+d3[D],0>(re=c).b&&ue(re);var be,Ee=re.b,ye=(be=re.Ca>>1)-(re.I>>Ee)>>31;--re.b,re.Ca+=ye,re.Ca|=1,re.I-=(be+1&ye)<<Ee,H[K]=((pe^ye)-ye)*k[(0<D)+0]}return 16}function Du(c){var g=c.rb[c.sb-1];g.la=0,g.Na=0,i(c.zc,0,0,c.zc.length),c.ja=0}function $d(c,g){if(c==null)return 0;if(g==null)return Pr(c,2,"NULL VP8Io parameter in VP8Decode().");if(!c.cb&&!qf(c,g))return 0;if(t(c.cb),g.ac==null||g.ac(g)){g.ob&&(c.L=0);var b=wh[c.L];if(c.L==2?(c.yb=0,c.zb=0):(c.yb=g.v-b>>4,c.zb=g.j-b>>4,0>c.yb&&(c.yb=0),0>c.zb&&(c.zb=0)),c.Va=g.o+15+b>>4,c.Hb=g.va+15+b>>4,c.Hb>c.za&&(c.Hb=c.za),c.Va>c.Ub&&(c.Va=c.Ub),0<c.L){var k=c.ed;for(b=0;4>b;++b){var D;if(c.Qa.Cb){var H=c.Qa.Lb[b];c.Qa.Fb||(H+=k.Tb)}else H=k.Tb;for(D=0;1>=D;++D){var q=c.gd[b][D],G=H;if(k.Pc&&(G+=k.vd[0],D&&(G+=k.od[0])),0<(G=0>G?0:63<G?63:G)){var K=G;0<k.wb&&(K=4<k.wb?K>>2:K>>1)>9-k.wb&&(K=9-k.wb),1>K&&(K=1),q.dd=K,q.tc=2*G+K,q.ld=40<=G?2:15<=G?1:0}else q.tc=0;q.La=D}}}b=0}else Pr(c,6,"Frame setup failed"),b=c.a;if(b=b==0){if(b){c.$c=0,0<c.Aa||(c.Ic=L3);e:{b=c.Ic,k=4*(K=c.za);var re=32*K,pe=K+1,be=0<c.L?K*(0<c.Aa?2:1):0,Ee=(c.Aa==2?2:1)*K;if((q=k+832+(D=3*(16*b+wh[c.L])/2*re)+(H=c.Fa!=null&&0<c.Fa.length?c.Kc.c*c.Kc.i:0))!=q)b=0;else{if(q>c.Vb){if(c.Vb=0,c.Ec=a(q),c.Fc=0,c.Ec==null){b=Pr(c,1,"no memory during frame initialization.");break e}c.Vb=q}q=c.Ec,G=c.Fc,c.Ac=q,c.Bc=G,G+=k,c.Gd=s(re,Aa),c.Hd=0,c.rb=s(pe+1,tr),c.sb=1,c.wa=be?s(be,Vt):null,c.Y=0,c.D.Nb=0,c.D.wa=c.wa,c.D.Y=c.Y,0<c.Aa&&(c.D.Y+=K),t(!0),c.oc=q,c.pc=G,G+=832,c.ya=s(Ee,Ji),c.aa=0,c.D.ya=c.ya,c.D.aa=c.aa,c.Aa==2&&(c.D.aa+=K),c.R=16*K,c.B=8*K,K=(re=wh[c.L])*c.R,re=re/2*c.B,c.sa=q,c.ta=G+K,c.qa=c.sa,c.ra=c.ta+16*b*c.R+re,c.Ha=c.qa,c.Ia=c.ra+8*b*c.B+re,c.$c=0,G+=D,c.mb=H?q:null,c.nb=H?G:null,t(G+H<=c.Fc+c.Vb),Du(c),i(c.Ac,c.Bc,0,k),b=1}}if(b){if(g.ka=0,g.y=c.sa,g.O=c.ta,g.f=c.qa,g.N=c.ra,g.ea=c.Ha,g.Vd=c.Ia,g.fa=c.R,g.Rc=c.B,g.F=null,g.J=0,!ch){for(b=-255;255>=b;++b)Yr[255+b]=0>b?-b:b;for(b=-1020;1020>=b;++b)Xa[1020+b]=-128>b?-128:127<b?127:b;for(b=-112;112>=b;++b)ic[112+b]=-16>b?-16:15<b?15:b;for(b=-255;510>=b;++b)Tl[255+b]=0>b?0:255<b?255:b;ch=1}bl=Kd,Ya=Vd,tc=Gf,Bn=Gd,Ii=Kf,Or=Vf,El=Hu,uh=yo,rc=o1,_o=Wu,So=s1,Es=pl,bo=qu,Al=nh,Eo=rh,As=Na,nc=Va,Di=a1,ra[0]=ka,ra[1]=Yd,ra[2]=Zd,ra[3]=e1,ra[4]=Jf,ra[5]=hl,ra[6]=Qf,ra[7]=Bu,ra[8]=r1,ra[9]=t1,Ts[0]=Yf,Ts[1]=Jd,Ts[2]=$a,Ts[3]=cl,Ts[4]=An,Ts[5]=Qd,Ts[6]=Xf,Ja[0]=ws,Ja[1]=Xd,Ja[2]=n1,Ja[3]=Uu,Ja[4]=vo,Ja[5]=i1,Ja[6]=zu,b=1}else b=0}b&&(b=function(ye,Ie){for(ye.M=0;ye.M<ye.Va;++ye.M){var Ce,ge=ye.Jc[ye.M&ye.Xb],ve=ye.m,Fe=ye;for(Ce=0;Ce<Fe.za;++Ce){var Be=ve,Re=Fe,st=Re.Ac,Qe=Re.Bc+4*Ce,gt=Re.zc,et=Re.ya[Re.aa+Ce];if(Re.Qa.Bb?et.$b=he(Be,Re.Pa.jb[0])?2+he(Be,Re.Pa.jb[2]):he(Be,Re.Pa.jb[1]):et.$b=0,Re.kc&&(et.Ad=he(Be,Re.Bd)),et.Za=!he(Be,145)+0,et.Za){var Wt=et.Ob,Gt=0;for(Re=0;4>Re;++Re){var Bt,It=gt[0+Re];for(Bt=0;4>Bt;++Bt){It=g3[st[Qe+Bt]][It];for(var ar=gm[he(Be,It[0])];0<ar;)ar=gm[2*ar+he(Be,It[ar])];It=-ar,st[Qe+Bt]=It}n(Wt,Gt,st,Qe,4),Gt+=4,gt[0+Re]=It}}else It=he(Be,156)?he(Be,128)?1:3:he(Be,163)?2:0,et.Ob[0]=It,i(st,Qe,It,4),i(gt,0,It,4);et.Dd=he(Be,142)?he(Be,114)?he(Be,183)?1:3:2:0}if(Fe.m.Ka)return Pr(ye,7,"Premature end-of-partition0 encountered.");for(;ye.ja<ye.za;++ye.ja){if(Fe=ge,Be=(ve=ye).rb[ve.sb-1],st=ve.rb[ve.sb+ve.ja],Ce=ve.ya[ve.aa+ve.ja],Qe=ve.kc?Ce.Ad:0)Be.la=st.la=0,Ce.Za||(Be.Na=st.Na=0),Ce.Hc=0,Ce.Gc=0,Ce.ia=0;else{var rr,Ct;if(Be=st,st=Fe,Qe=ve.Pa.Xc,gt=ve.ya[ve.aa+ve.ja],et=ve.pb[gt.$b],Re=gt.ad,Wt=0,Gt=ve.rb[ve.sb-1],It=Bt=0,i(Re,Wt,0,384),gt.Za)var Ur=0,Zn=Qe[3];else{ar=a(16);var zr=Be.Na+Gt.Na;if(zr=ac(st,Qe[1],zr,et.Eb,0,ar,0),Be.Na=Gt.Na=(0<zr)+0,1<zr)bl(ar,0,Re,Wt);else{var ei=ar[0]+3>>3;for(ar=0;256>ar;ar+=16)Re[Wt+ar]=ei}Ur=1,Zn=Qe[0]}var Kt=15&Be.la,gi=15&Gt.la;for(ar=0;4>ar;++ar){var mi=1&gi;for(ei=Ct=0;4>ei;++ei)Kt=Kt>>1|(mi=(zr=ac(st,Zn,zr=mi+(1&Kt),et.Sc,Ur,Re,Wt))>Ur)<<7,Ct=Ct<<2|(3<zr?3:1<zr?2:Re[Wt+0]!=0),Wt+=16;Kt>>=4,gi=gi>>1|mi<<7,Bt=(Bt<<8|Ct)>>>0}for(Zn=Kt,Ur=gi>>4,rr=0;4>rr;rr+=2){for(Ct=0,Kt=Be.la>>4+rr,gi=Gt.la>>4+rr,ar=0;2>ar;++ar){for(mi=1&gi,ei=0;2>ei;++ei)zr=mi+(1&Kt),Kt=Kt>>1|(mi=0<(zr=ac(st,Qe[2],zr,et.Qc,0,Re,Wt)))<<3,Ct=Ct<<2|(3<zr?3:1<zr?2:Re[Wt+0]!=0),Wt+=16;Kt>>=2,gi=gi>>1|mi<<5}It|=Ct<<4*rr,Zn|=Kt<<4<<rr,Ur|=(240&gi)<<rr}Be.la=Zn,Gt.la=Ur,gt.Hc=Bt,gt.Gc=It,gt.ia=43690&It?0:et.ia,Qe=!(Bt|It)}if(0<ve.L&&(ve.wa[ve.Y+ve.ja]=ve.gd[Ce.$b][Ce.Za],ve.wa[ve.Y+ve.ja].La|=!Qe),Fe.Ka)return Pr(ye,7,"Premature end-of-file encountered.")}if(Du(ye),ve=Ie,Fe=1,Ce=(ge=ye).D,Be=0<ge.L&&ge.M>=ge.zb&&ge.M<=ge.Va,ge.Aa==0)e:{if(Ce.M=ge.M,Ce.uc=Be,Xu(ge,Ce),Fe=1,Ce=(Ct=ge.D).Nb,Be=(It=wh[ge.L])*ge.R,st=It/2*ge.B,ar=16*Ce*ge.R,ei=8*Ce*ge.B,Qe=ge.sa,gt=ge.ta-Be+ar,et=ge.qa,Re=ge.ra-st+ei,Wt=ge.Ha,Gt=ge.Ia-st+ei,gi=(Kt=Ct.M)==0,Bt=Kt>=ge.Va-1,ge.Aa==2&&Xu(ge,Ct),Ct.uc)for(mi=(zr=ge).D.M,t(zr.D.uc),Ct=zr.yb;Ct<zr.Hb;++Ct){Ur=Ct,Zn=mi;var rn=(fn=(Er=zr).D).Nb;rr=Er.R;var fn=fn.wa[fn.Y+Ur],Un=Er.sa,Ui=Er.ta+16*rn*rr+16*Ur,La=fn.dd,nn=fn.tc;if(nn!=0)if(t(3<=nn),Er.L==1)0<Ur&&As(Un,Ui,rr,nn+4),fn.La&&Di(Un,Ui,rr,nn),0<Zn&&Eo(Un,Ui,rr,nn+4),fn.La&&nc(Un,Ui,rr,nn);else{var Qa=Er.B,Ao=Er.qa,kl=Er.ra+8*rn*Qa+8*Ur,Ns=Er.Ha,Er=Er.Ia+8*rn*Qa+8*Ur;rn=fn.ld,0<Ur&&(uh(Un,Ui,rr,nn+4,La,rn),_o(Ao,kl,Ns,Er,Qa,nn+4,La,rn)),fn.La&&(Es(Un,Ui,rr,nn,La,rn),Al(Ao,kl,Ns,Er,Qa,nn,La,rn)),0<Zn&&(El(Un,Ui,rr,nn+4,La,rn),rc(Ao,kl,Ns,Er,Qa,nn+4,La,rn)),fn.La&&(So(Un,Ui,rr,nn,La,rn),bo(Ao,kl,Ns,Er,Qa,nn,La,rn))}}if(ge.ia&&alert("todo:DitherRow"),ve.put!=null){if(Ct=16*Kt,Kt=16*(Kt+1),gi?(ve.y=ge.sa,ve.O=ge.ta+ar,ve.f=ge.qa,ve.N=ge.ra+ei,ve.ea=ge.Ha,ve.W=ge.Ia+ei):(Ct-=It,ve.y=Qe,ve.O=gt,ve.f=et,ve.N=Re,ve.ea=Wt,ve.W=Gt),Bt||(Kt-=It),Kt>ve.o&&(Kt=ve.o),ve.F=null,ve.J=null,ge.Fa!=null&&0<ge.Fa.length&&Ct<Kt&&(ve.J=Ku(ge,ve,Ct,Kt-Ct),ve.F=ge.mb,ve.F==null&&ve.F.length==0)){Fe=Pr(ge,3,"Could not decode alpha data.");break e}Ct<ve.j&&(It=ve.j-Ct,Ct=ve.j,t(!(1&It)),ve.O+=ge.R*It,ve.N+=ge.B*(It>>1),ve.W+=ge.B*(It>>1),ve.F!=null&&(ve.J+=ve.width*It)),Ct<Kt&&(ve.O+=ve.v,ve.N+=ve.v>>1,ve.W+=ve.v>>1,ve.F!=null&&(ve.J+=ve.v),ve.ka=Ct-ve.j,ve.U=ve.va-ve.v,ve.T=Kt-Ct,Fe=ve.put(ve))}Ce+1!=ge.Ic||Bt||(n(ge.sa,ge.ta-Be,Qe,gt+16*ge.R,Be),n(ge.qa,ge.ra-st,et,Re+8*ge.B,st),n(ge.Ha,ge.Ia-st,Wt,Gt+8*ge.B,st))}if(!Fe)return Pr(ye,6,"Output aborted.")}return 1}(c,g)),g.bc!=null&&g.bc(g),b&=1}return b?(c.cb=0,b):0}function Zi(c,g,b,k,D){D=c[g+b+32*k]+(D>>3),c[g+b+32*k]=-256&D?0>D?0:255:D}function ul(c,g,b,k,D,H){Zi(c,g,0,b,k+D),Zi(c,g,1,b,k+H),Zi(c,g,2,b,k-H),Zi(c,g,3,b,k-D)}function Xn(c){return(20091*c>>16)+c}function ju(c,g,b,k){var D,H=0,q=a(16);for(D=0;4>D;++D){var G=c[g+0]+c[g+8],K=c[g+0]-c[g+8],re=(35468*c[g+4]>>16)-Xn(c[g+12]),pe=Xn(c[g+4])+(35468*c[g+12]>>16);q[H+0]=G+pe,q[H+1]=K+re,q[H+2]=K-re,q[H+3]=G-pe,H+=4,g++}for(D=H=0;4>D;++D)G=(c=q[H+0]+4)+q[H+8],K=c-q[H+8],re=(35468*q[H+4]>>16)-Xn(q[H+12]),Zi(b,k,0,0,G+(pe=Xn(q[H+4])+(35468*q[H+12]>>16))),Zi(b,k,1,0,K+re),Zi(b,k,2,0,K-re),Zi(b,k,3,0,G-pe),H++,k+=32}function Vf(c,g,b,k){var D=c[g+0]+4,H=35468*c[g+4]>>16,q=Xn(c[g+4]),G=35468*c[g+1]>>16;ul(b,k,0,D+q,c=Xn(c[g+1]),G),ul(b,k,1,D+H,c,G),ul(b,k,2,D-H,c,G),ul(b,k,3,D-q,c,G)}function Vd(c,g,b,k,D){ju(c,g,b,k),D&&ju(c,g+16,b,k+4)}function Gf(c,g,b,k){Ya(c,g+0,b,k,1),Ya(c,g+32,b,k+128,1)}function Gd(c,g,b,k){var D;for(c=c[g+0]+4,D=0;4>D;++D)for(g=0;4>g;++g)Zi(b,k,g,D,c)}function Kf(c,g,b,k){c[g+0]&&Bn(c,g+0,b,k),c[g+16]&&Bn(c,g+16,b,k+4),c[g+32]&&Bn(c,g+32,b,k+128),c[g+48]&&Bn(c,g+48,b,k+128+4)}function Kd(c,g,b,k){var D,H=a(16);for(D=0;4>D;++D){var q=c[g+0+D]+c[g+12+D],G=c[g+4+D]+c[g+8+D],K=c[g+4+D]-c[g+8+D],re=c[g+0+D]-c[g+12+D];H[0+D]=q+G,H[8+D]=q-G,H[4+D]=re+K,H[12+D]=re-K}for(D=0;4>D;++D)q=(c=H[0+4*D]+3)+H[3+4*D],G=H[1+4*D]+H[2+4*D],K=H[1+4*D]-H[2+4*D],re=c-H[3+4*D],b[k+0]=q+G>>3,b[k+16]=re+K>>3,b[k+32]=q-G>>3,b[k+48]=re-K>>3,k+=64}function Mu(c,g,b){var k,D=g-32,H=pi,q=255-c[D-1];for(k=0;k<b;++k){var G,K=H,re=q+c[g-1];for(G=0;G<b;++G)c[g+G]=K[re+c[D+G]];g+=32}}function Yd(c,g){Mu(c,g,4)}function Xd(c,g){Mu(c,g,8)}function Jd(c,g){Mu(c,g,16)}function $a(c,g){var b;for(b=0;16>b;++b)n(c,g+32*b,c,g-32,16)}function cl(c,g){var b;for(b=16;0<b;--b)i(c,g,c[g-1],16),g+=32}function fl(c,g,b){var k;for(k=0;16>k;++k)i(g,b+32*k,c,16)}function Yf(c,g){var b,k=16;for(b=0;16>b;++b)k+=c[g-1+32*b]+c[g+b-32];fl(k>>5,c,g)}function An(c,g){var b,k=8;for(b=0;16>b;++b)k+=c[g-1+32*b];fl(k>>4,c,g)}function Qd(c,g){var b,k=8;for(b=0;16>b;++b)k+=c[g+b-32];fl(k>>4,c,g)}function Xf(c,g){fl(128,c,g)}function Et(c,g,b){return c+2*g+b+2>>2}function Zd(c,g){var b,k=g-32;for(k=new Uint8Array([Et(c[k-1],c[k+0],c[k+1]),Et(c[k+0],c[k+1],c[k+2]),Et(c[k+1],c[k+2],c[k+3]),Et(c[k+2],c[k+3],c[k+4])]),b=0;4>b;++b)n(c,g+32*b,k,0,k.length)}function e1(c,g){var b=c[g-1],k=c[g-1+32],D=c[g-1+64],H=c[g-1+96];xe(c,g+0,16843009*Et(c[g-1-32],b,k)),xe(c,g+32,16843009*Et(b,k,D)),xe(c,g+64,16843009*Et(k,D,H)),xe(c,g+96,16843009*Et(D,H,H))}function ka(c,g){var b,k=4;for(b=0;4>b;++b)k+=c[g+b-32]+c[g-1+32*b];for(k>>=3,b=0;4>b;++b)i(c,g+32*b,k,4)}function Jf(c,g){var b=c[g-1+0],k=c[g-1+32],D=c[g-1+64],H=c[g-1-32],q=c[g+0-32],G=c[g+1-32],K=c[g+2-32],re=c[g+3-32];c[g+0+96]=Et(k,D,c[g-1+96]),c[g+1+96]=c[g+0+64]=Et(b,k,D),c[g+2+96]=c[g+1+64]=c[g+0+32]=Et(H,b,k),c[g+3+96]=c[g+2+64]=c[g+1+32]=c[g+0+0]=Et(q,H,b),c[g+3+64]=c[g+2+32]=c[g+1+0]=Et(G,q,H),c[g+3+32]=c[g+2+0]=Et(K,G,q),c[g+3+0]=Et(re,K,G)}function Qf(c,g){var b=c[g+1-32],k=c[g+2-32],D=c[g+3-32],H=c[g+4-32],q=c[g+5-32],G=c[g+6-32],K=c[g+7-32];c[g+0+0]=Et(c[g+0-32],b,k),c[g+1+0]=c[g+0+32]=Et(b,k,D),c[g+2+0]=c[g+1+32]=c[g+0+64]=Et(k,D,H),c[g+3+0]=c[g+2+32]=c[g+1+64]=c[g+0+96]=Et(D,H,q),c[g+3+32]=c[g+2+64]=c[g+1+96]=Et(H,q,G),c[g+3+64]=c[g+2+96]=Et(q,G,K),c[g+3+96]=Et(G,K,K)}function hl(c,g){var b=c[g-1+0],k=c[g-1+32],D=c[g-1+64],H=c[g-1-32],q=c[g+0-32],G=c[g+1-32],K=c[g+2-32],re=c[g+3-32];c[g+0+0]=c[g+1+64]=H+q+1>>1,c[g+1+0]=c[g+2+64]=q+G+1>>1,c[g+2+0]=c[g+3+64]=G+K+1>>1,c[g+3+0]=K+re+1>>1,c[g+0+96]=Et(D,k,b),c[g+0+64]=Et(k,b,H),c[g+0+32]=c[g+1+96]=Et(b,H,q),c[g+1+32]=c[g+2+96]=Et(H,q,G),c[g+2+32]=c[g+3+96]=Et(q,G,K),c[g+3+32]=Et(G,K,re)}function Bu(c,g){var b=c[g+0-32],k=c[g+1-32],D=c[g+2-32],H=c[g+3-32],q=c[g+4-32],G=c[g+5-32],K=c[g+6-32],re=c[g+7-32];c[g+0+0]=b+k+1>>1,c[g+1+0]=c[g+0+64]=k+D+1>>1,c[g+2+0]=c[g+1+64]=D+H+1>>1,c[g+3+0]=c[g+2+64]=H+q+1>>1,c[g+0+32]=Et(b,k,D),c[g+1+32]=c[g+0+96]=Et(k,D,H),c[g+2+32]=c[g+1+96]=Et(D,H,q),c[g+3+32]=c[g+2+96]=Et(H,q,G),c[g+3+64]=Et(q,G,K),c[g+3+96]=Et(G,K,re)}function t1(c,g){var b=c[g-1+0],k=c[g-1+32],D=c[g-1+64],H=c[g-1+96];c[g+0+0]=b+k+1>>1,c[g+2+0]=c[g+0+32]=k+D+1>>1,c[g+2+32]=c[g+0+64]=D+H+1>>1,c[g+1+0]=Et(b,k,D),c[g+3+0]=c[g+1+32]=Et(k,D,H),c[g+3+32]=c[g+1+64]=Et(D,H,H),c[g+3+64]=c[g+2+64]=c[g+0+96]=c[g+1+96]=c[g+2+96]=c[g+3+96]=H}function r1(c,g){var b=c[g-1+0],k=c[g-1+32],D=c[g-1+64],H=c[g-1+96],q=c[g-1-32],G=c[g+0-32],K=c[g+1-32],re=c[g+2-32];c[g+0+0]=c[g+2+32]=b+q+1>>1,c[g+0+32]=c[g+2+64]=k+b+1>>1,c[g+0+64]=c[g+2+96]=D+k+1>>1,c[g+0+96]=H+D+1>>1,c[g+3+0]=Et(G,K,re),c[g+2+0]=Et(q,G,K),c[g+1+0]=c[g+3+32]=Et(b,q,G),c[g+1+32]=c[g+3+64]=Et(k,b,q),c[g+1+64]=c[g+3+96]=Et(D,k,b),c[g+1+96]=Et(H,D,k)}function n1(c,g){var b;for(b=0;8>b;++b)n(c,g+32*b,c,g-32,8)}function Uu(c,g){var b;for(b=0;8>b;++b)i(c,g,c[g-1],8),g+=32}function mo(c,g,b){var k;for(k=0;8>k;++k)i(g,b+32*k,c,8)}function ws(c,g){var b,k=8;for(b=0;8>b;++b)k+=c[g+b-32]+c[g-1+32*b];mo(k>>4,c,g)}function i1(c,g){var b,k=4;for(b=0;8>b;++b)k+=c[g+b-32];mo(k>>3,c,g)}function vo(c,g){var b,k=4;for(b=0;8>b;++b)k+=c[g-1+32*b];mo(k>>3,c,g)}function zu(c,g){mo(128,c,g)}function dl(c,g,b){var k=c[g-b],D=c[g+0],H=3*(D-k)+c1[1020+c[g-2*b]-c[g+b]],q=fh[112+(H+4>>3)];c[g-b]=pi[255+k+fh[112+(H+3>>3)]],c[g+0]=pi[255+D-q]}function Zf(c,g,b,k){var D=c[g+0],H=c[g+b];return Mi[255+c[g-2*b]-c[g-b]]>k||Mi[255+H-D]>k}function eh(c,g,b,k){return 4*Mi[255+c[g-b]-c[g+0]]+Mi[255+c[g-2*b]-c[g+b]]<=k}function th(c,g,b,k,D){var H=c[g-3*b],q=c[g-2*b],G=c[g-b],K=c[g+0],re=c[g+b],pe=c[g+2*b],be=c[g+3*b];return 4*Mi[255+G-K]+Mi[255+q-re]>k?0:Mi[255+c[g-4*b]-H]<=D&&Mi[255+H-q]<=D&&Mi[255+q-G]<=D&&Mi[255+be-pe]<=D&&Mi[255+pe-re]<=D&&Mi[255+re-K]<=D}function rh(c,g,b,k){var D=2*k+1;for(k=0;16>k;++k)eh(c,g+k,b,D)&&dl(c,g+k,b)}function Na(c,g,b,k){var D=2*k+1;for(k=0;16>k;++k)eh(c,g+k*b,1,D)&&dl(c,g+k*b,1)}function Va(c,g,b,k){var D;for(D=3;0<D;--D)rh(c,g+=4*b,b,k)}function a1(c,g,b,k){var D;for(D=3;0<D;--D)Na(c,g+=4,b,k)}function xs(c,g,b,k,D,H,q,G){for(H=2*H+1;0<D--;){if(th(c,g,b,H,q))if(Zf(c,g,b,G))dl(c,g,b);else{var K=c,re=g,pe=b,be=K[re-2*pe],Ee=K[re-pe],ye=K[re+0],Ie=K[re+pe],Ce=K[re+2*pe],ge=27*(Fe=c1[1020+3*(ye-Ee)+c1[1020+be-Ie]])+63>>7,ve=18*Fe+63>>7,Fe=9*Fe+63>>7;K[re-3*pe]=pi[255+K[re-3*pe]+Fe],K[re-2*pe]=pi[255+be+ve],K[re-pe]=pi[255+Ee+ge],K[re+0]=pi[255+ye-ge],K[re+pe]=pi[255+Ie-ve],K[re+2*pe]=pi[255+Ce-Fe]}g+=k}}function ea(c,g,b,k,D,H,q,G){for(H=2*H+1;0<D--;){if(th(c,g,b,H,q))if(Zf(c,g,b,G))dl(c,g,b);else{var K=c,re=g,pe=b,be=K[re-pe],Ee=K[re+0],ye=K[re+pe],Ie=fh[112+((Ce=3*(Ee-be))+4>>3)],Ce=fh[112+(Ce+3>>3)],ge=Ie+1>>1;K[re-2*pe]=pi[255+K[re-2*pe]+ge],K[re-pe]=pi[255+be+Ce],K[re+0]=pi[255+Ee-Ie],K[re+pe]=pi[255+ye-ge]}g+=k}}function Hu(c,g,b,k,D,H){xs(c,g,b,1,16,k,D,H)}function yo(c,g,b,k,D,H){xs(c,g,1,b,16,k,D,H)}function s1(c,g,b,k,D,H){var q;for(q=3;0<q;--q)ea(c,g+=4*b,b,1,16,k,D,H)}function pl(c,g,b,k,D,H){var q;for(q=3;0<q;--q)ea(c,g+=4,1,b,16,k,D,H)}function o1(c,g,b,k,D,H,q,G){xs(c,g,D,1,8,H,q,G),xs(b,k,D,1,8,H,q,G)}function Wu(c,g,b,k,D,H,q,G){xs(c,g,1,D,8,H,q,G),xs(b,k,1,D,8,H,q,G)}function qu(c,g,b,k,D,H,q,G){ea(c,g+4*D,D,1,8,H,q,G),ea(b,k+4*D,D,1,8,H,q,G)}function nh(c,g,b,k,D,H,q,G){ea(c,g+4,1,D,8,H,q,G),ea(b,k+4,1,D,8,H,q,G)}function gl(){this.ba=new ci,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new ir,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function $u(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Vu(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function ih(){this.ua=0,this.Wa=new le,this.vb=new le,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new Y,this.yc=new C}function l1(){this.xb=this.a=0,this.l=new Ta,this.ca=new ci,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new E,this.Pb=0,this.wd=new E,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new ih,this.ab=0,this.gc=s(4,Vu),this.Oc=0}function ml(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Ta,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function wo(c,g,b,k,D,H,q){for(c=c==null?0:c[g+0],g=0;g<q;++g)D[H+g]=c+b[k+g]&255,c=D[H+g]}function Gu(c,g,b,k,D,H,q){var G;if(c==null)wo(null,null,b,k,D,H,q);else for(G=0;G<q;++G)D[H+G]=c[g+G]+b[k+G]&255}function _s(c,g,b,k,D,H,q){if(c==null)wo(null,null,b,k,D,H,q);else{var G,K=c[g+0],re=K,pe=K;for(G=0;G<q;++G)re=pe+(K=c[g+G])-re,pe=b[k+G]+(-256&re?0>re?0:255:re)&255,re=K,D[H+G]=pe}}function Ku(c,g,b,k){var D=g.width,H=g.o;if(t(c!=null&&g!=null),0>b||0>=k||b+k>H)return null;if(!c.Cc){if(c.ga==null){var q;if(c.ga=new ml,(q=c.ga==null)||(q=g.width*g.o,t(c.Gb.length==0),c.Gb=a(q),c.Uc=0,c.Gb==null?q=0:(c.mb=c.Gb,c.nb=c.Uc,c.rc=null,q=1),q=!q),!q){q=c.ga;var G=c.Fa,K=c.P,re=c.qc,pe=c.mb,be=c.nb,Ee=K+1,ye=re-1,Ie=q.l;if(t(G!=null&&pe!=null&&g!=null),ks[0]=null,ks[1]=wo,ks[2]=Gu,ks[3]=_s,q.ca=pe,q.tb=be,q.c=g.width,q.i=g.height,t(0<q.c&&0<q.i),1>=re)g=0;else if(q.$a=G[K+0]>>0&3,q.Z=G[K+0]>>2&3,q.Lc=G[K+0]>>4&3,K=G[K+0]>>6&3,0>q.$a||1<q.$a||4<=q.Z||1<q.Lc||K)g=0;else if(Ie.put=Oi,Ie.ac=Kr,Ie.bc=Fi,Ie.ma=q,Ie.width=g.width,Ie.height=g.height,Ie.Da=g.Da,Ie.v=g.v,Ie.va=g.va,Ie.j=g.j,Ie.o=g.o,q.$a)e:{t(q.$a==1),g=Ne();t:for(;;){if(g==null){g=0;break e}if(t(q!=null),q.mc=g,g.c=q.c,g.i=q.i,g.l=q.l,g.l.ma=q,g.l.width=q.c,g.l.height=q.i,g.a=0,X(g.m,G,Ee,ye),!_e(q.c,q.i,1,g,null)||(g.ab==1&&g.gc[0].hc==3&&J(g.s)?(q.ic=1,G=g.c*g.i,g.Ta=null,g.Ua=0,g.V=a(G),g.Ba=0,g.V==null?(g.a=1,g=0):g=1):(q.ic=0,g=Ae(g,q.c)),!g))break t;g=1;break e}q.mc=null,g=0}else g=ye>=q.c*q.i;q=!g}if(q)return null;c.ga.Lc!=1?c.Ga=0:k=H-b}t(c.ga!=null),t(b+k<=H);e:{if(g=(G=c.ga).c,H=G.l.o,G.$a==0){if(Ee=c.rc,ye=c.Vc,Ie=c.Fa,K=c.P+1+b*g,re=c.mb,pe=c.nb+b*g,t(K<=c.P+c.qc),G.Z!=0)for(t(ks[G.Z]!=null),q=0;q<k;++q)ks[G.Z](Ee,ye,Ie,K,re,pe,g),Ee=re,ye=pe,pe+=g,K+=g;else for(q=0;q<k;++q)n(re,pe,Ie,K,g),Ee=re,ye=pe,pe+=g,K+=g;c.rc=Ee,c.Vc=ye}else{if(t(G.mc!=null),g=b+k,t((q=G.mc)!=null),t(g<=q.i),q.C>=g)g=1;else if(G.ic||we(),G.ic){G=q.V,Ee=q.Ba,ye=q.c;var Ce=q.i,ge=(Ie=1,K=q.$/ye,re=q.$%ye,pe=q.m,be=q.s,q.$),ve=ye*Ce,Fe=ye*g,Be=be.wc,Re=ge<Fe?Sr(be,re,K):null;t(ge<=ve),t(g<=Ce),t(J(be));t:for(;;){for(;!pe.h&&ge<Fe;){if(re&Be||(Re=Sr(be,re,K)),t(Re!=null),V(pe),256>(Ce=En(Re.G[0],Re.H[0],pe)))G[Ee+ge]=Ce,++ge,++re>=ye&&(re=0,++K<=g&&!(K%16)&&ne(q,K));else{if(!(280>Ce)){Ie=0;break t}Ce=fi(Ce-256,pe);var st,Qe=En(Re.G[4],Re.H[4],pe);if(V(pe),!(ge>=(Qe=Yn(ye,Qe=fi(Qe,pe)))&&ve-ge>=Ce)){Ie=0;break t}for(st=0;st<Ce;++st)G[Ee+ge+st]=G[Ee+ge+st-Qe];for(ge+=Ce,re+=Ce;re>=ye;)re-=ye,++K<=g&&!(K%16)&&ne(q,K);ge<Fe&&re&Be&&(Re=Sr(be,re,K))}t(pe.h==F(pe))}ne(q,K>g?g:K);break t}!Ie||pe.h&&ge<ve?(Ie=0,q.a=pe.h?5:3):q.$=ge,g=Ie}else g=se(q,q.V,q.Ba,q.c,q.i,g,Te);if(!g){k=0;break e}}b+k>=H&&(c.Cc=1),k=1}if(!k)return null;if(c.Cc&&((k=c.ga)!=null&&(k.mc=null),c.ga=null,0<c.Ga))return alert("todo:WebPDequantizeLevels"),null}return c.nb+b*D}function _(c,g,b,k,D,H){for(;0<D--;){var q,G=c,K=g+(b?1:0),re=c,pe=g+(b?0:3);for(q=0;q<k;++q){var be=re[pe+4*q];be!=255&&(be*=32897,G[K+4*q+0]=G[K+4*q+0]*be>>23,G[K+4*q+1]=G[K+4*q+1]*be>>23,G[K+4*q+2]=G[K+4*q+2]*be>>23)}g+=H}}function j(c,g,b,k,D){for(;0<k--;){var H;for(H=0;H<b;++H){var q=c[g+2*H+0],G=15&(re=c[g+2*H+1]),K=4369*G,re=(240&re|re>>4)*K>>16;c[g+2*H+0]=(240&q|q>>4)*K>>16&240|(15&q|q<<4)*K>>16>>4&15,c[g+2*H+1]=240&re|G}g+=D}}function oe(c,g,b,k,D,H,q,G){var K,re,pe=255;for(re=0;re<D;++re){for(K=0;K<k;++K){var be=c[g+K];H[q+4*K]=be,pe&=be}g+=b,q+=G}return pe!=255}function de(c,g,b,k,D){var H;for(H=0;H<D;++H)b[k+H]=c[g+H]>>8}function we(){ji=_,lr=j,ur=oe,Fr=de}function Le(c,g,b){L[c]=function(k,D,H,q,G,K,re,pe,be,Ee,ye,Ie,Ce,ge,ve,Fe,Be){var Re,st=Be-1>>1,Qe=G[K+0]|re[pe+0]<<16,gt=be[Ee+0]|ye[Ie+0]<<16;t(k!=null);var et=3*Qe+gt+131074>>2;for(g(k[D+0],255&et,et>>16,Ce,ge),H!=null&&(et=3*gt+Qe+131074>>2,g(H[q+0],255&et,et>>16,ve,Fe)),Re=1;Re<=st;++Re){var Wt=G[K+Re]|re[pe+Re]<<16,Gt=be[Ee+Re]|ye[Ie+Re]<<16,Bt=Qe+Wt+gt+Gt+524296,It=Bt+2*(Wt+gt)>>3;et=It+Qe>>1,Qe=(Bt=Bt+2*(Qe+Gt)>>3)+Wt>>1,g(k[D+2*Re-1],255&et,et>>16,Ce,ge+(2*Re-1)*b),g(k[D+2*Re-0],255&Qe,Qe>>16,Ce,ge+(2*Re-0)*b),H!=null&&(et=Bt+gt>>1,Qe=It+Gt>>1,g(H[q+2*Re-1],255&et,et>>16,ve,Fe+(2*Re-1)*b),g(H[q+2*Re+0],255&Qe,Qe>>16,ve,Fe+(2*Re+0)*b)),Qe=Wt,gt=Gt}1&Be||(et=3*Qe+gt+131074>>2,g(k[D+Be-1],255&et,et>>16,Ce,ge+(Be-1)*b),H!=null&&(et=3*gt+Qe+131074>>2,g(H[q+Be-1],255&et,et>>16,ve,Fe+(Be-1)*b)))}}function ze(){Bi[hh]=w3,Bi[dh]=vm,Bi[hm]=x3,Bi[ph]=ym,Bi[gh]=wm,Bi[f1]=xm,Bi[dm]=_3,Bi[h1]=vm,Bi[d1]=ym,Bi[mh]=wm,Bi[p1]=xm}function at(c){return c&-16384?0>c?0:255:c>>S3}function dt(c,g){return at((19077*c>>8)+(26149*g>>8)-14234)}function kt(c,g,b){return at((19077*c>>8)-(6419*g>>8)-(13320*b>>8)+8708)}function At(c,g){return at((19077*c>>8)+(33050*g>>8)-17685)}function jt(c,g,b,k,D){k[D+0]=dt(c,b),k[D+1]=kt(c,g,b),k[D+2]=At(c,g)}function yr(c,g,b,k,D){k[D+0]=At(c,g),k[D+1]=kt(c,g,b),k[D+2]=dt(c,b)}function br(c,g,b,k,D){var H=kt(c,g,b);g=H<<3&224|At(c,g)>>3,k[D+0]=248&dt(c,b)|H>>5,k[D+1]=g}function Br(c,g,b,k,D){var H=240&At(c,g)|15;k[D+0]=240&dt(c,b)|kt(c,g,b)>>4,k[D+1]=H}function Tn(c,g,b,k,D){k[D+0]=255,jt(c,g,b,k,D+1)}function tn(c,g,b,k,D){yr(c,g,b,k,D),k[D+3]=255}function ta(c,g,b,k,D){jt(c,g,b,k,D),k[D+3]=255}function di(c,g){return 0>c?0:c>g?g:c}function Ca(c,g,b){L[c]=function(k,D,H,q,G,K,re,pe,be){for(var Ee=pe+(-2&be)*b;pe!=Ee;)g(k[D+0],H[q+0],G[K+0],re,pe),g(k[D+1],H[q+0],G[K+0],re,pe+b),D+=2,++q,++K,pe+=2*b;1&be&&g(k[D+0],H[q+0],G[K+0],re,pe)}}function ah(c,g,b){return b==0?c==0?g==0?6:5:g==0?4:0:b}function Yu(c,g,b,k,D){switch(c>>>30){case 3:Ya(g,b,k,D,0);break;case 2:Or(g,b,k,D);break;case 1:Bn(g,b,k,D)}}function Xu(c,g){var b,k,D=g.M,H=g.Nb,q=c.oc,G=c.pc+40,K=c.oc,re=c.pc+584,pe=c.oc,be=c.pc+600;for(b=0;16>b;++b)q[G+32*b-1]=129;for(b=0;8>b;++b)K[re+32*b-1]=129,pe[be+32*b-1]=129;for(0<D?q[G-1-32]=K[re-1-32]=pe[be-1-32]=129:(i(q,G-32-1,127,21),i(K,re-32-1,127,9),i(pe,be-32-1,127,9)),k=0;k<c.za;++k){var Ee=g.ya[g.aa+k];if(0<k){for(b=-1;16>b;++b)n(q,G+32*b-4,q,G+32*b+12,4);for(b=-1;8>b;++b)n(K,re+32*b-4,K,re+32*b+4,4),n(pe,be+32*b-4,pe,be+32*b+4,4)}var ye=c.Gd,Ie=c.Hd+k,Ce=Ee.ad,ge=Ee.Hc;if(0<D&&(n(q,G-32,ye[Ie].y,0,16),n(K,re-32,ye[Ie].f,0,8),n(pe,be-32,ye[Ie].ea,0,8)),Ee.Za){var ve=q,Fe=G-32+16;for(0<D&&(k>=c.za-1?i(ve,Fe,ye[Ie].y[15],4):n(ve,Fe,ye[Ie+1].y,0,4)),b=0;4>b;b++)ve[Fe+128+b]=ve[Fe+256+b]=ve[Fe+384+b]=ve[Fe+0+b];for(b=0;16>b;++b,ge<<=2)ve=q,Fe=G+Sm[b],ra[Ee.Ob[b]](ve,Fe),Yu(ge,Ce,16*+b,ve,Fe)}else if(ve=ah(k,D,Ee.Ob[0]),Ts[ve](q,G),ge!=0)for(b=0;16>b;++b,ge<<=2)Yu(ge,Ce,16*+b,q,G+Sm[b]);for(b=Ee.Gc,ve=ah(k,D,Ee.Dd),Ja[ve](K,re),Ja[ve](pe,be),ge=Ce,ve=K,Fe=re,255&(Ee=b>>0)&&(170&Ee?tc(ge,256,ve,Fe):Ii(ge,256,ve,Fe)),Ee=pe,ge=be,255&(b>>=8)&&(170&b?tc(Ce,320,Ee,ge):Ii(Ce,320,Ee,ge)),D<c.Ub-1&&(n(ye[Ie].y,0,q,G+480,16),n(ye[Ie].f,0,K,re+224,8),n(ye[Ie].ea,0,pe,be+224,8)),b=8*H*c.B,ye=c.sa,Ie=c.ta+16*k+16*H*c.R,Ce=c.qa,Ee=c.ra+8*k+b,ge=c.Ha,ve=c.Ia+8*k+b,b=0;16>b;++b)n(ye,Ie+b*c.R,q,G+32*b,16);for(b=0;8>b;++b)n(Ce,Ee+b*c.B,K,re+32*b,8),n(ge,ve+b*c.B,pe,be+32*b,8)}}function vl(c,g,b,k,D,H,q,G,K){var re=[0],pe=[0],be=0,Ee=K!=null?K.kd:0,ye=K??new $u;if(c==null||12>b)return 7;ye.data=c,ye.w=g,ye.ha=b,g=[g],b=[b],ye.gb=[ye.gb];e:{var Ie=g,Ce=b,ge=ye.gb;if(t(c!=null),t(Ce!=null),t(ge!=null),ge[0]=0,12<=Ce[0]&&!r(c,Ie[0],"RIFF")){if(r(c,Ie[0]+8,"WEBP")){ge=3;break e}var ve=qe(c,Ie[0]+4);if(12>ve||4294967286<ve){ge=3;break e}if(Ee&&ve>Ce[0]-8){ge=7;break e}ge[0]=ve,Ie[0]+=12,Ce[0]-=12}ge=0}if(ge!=0)return ge;for(ve=0<ye.gb[0],b=b[0];;){e:{var Fe=c;Ce=g,ge=b;var Be=re,Re=pe,st=Ie=[0];if((et=be=[be])[0]=0,8>ge[0])ge=7;else{if(!r(Fe,Ce[0],"VP8X")){if(qe(Fe,Ce[0]+4)!=10){ge=3;break e}if(18>ge[0]){ge=7;break e}var Qe=qe(Fe,Ce[0]+8),gt=1+De(Fe,Ce[0]+12);if(2147483648<=gt*(Fe=1+De(Fe,Ce[0]+15))){ge=3;break e}st!=null&&(st[0]=Qe),Be!=null&&(Be[0]=gt),Re!=null&&(Re[0]=Fe),Ce[0]+=18,ge[0]-=18,et[0]=1}ge=0}}if(be=be[0],Ie=Ie[0],ge!=0)return ge;if(Ce=!!(2&Ie),!ve&&be)return 3;if(H!=null&&(H[0]=!!(16&Ie)),q!=null&&(q[0]=Ce),G!=null&&(G[0]=0),q=re[0],Ie=pe[0],be&&Ce&&K==null){ge=0;break}if(4>b){ge=7;break}if(ve&&be||!ve&&!be&&!r(c,g[0],"ALPH")){b=[b],ye.na=[ye.na],ye.P=[ye.P],ye.Sa=[ye.Sa];e:{Qe=c,ge=g,ve=b;var et=ye.gb;Be=ye.na,Re=ye.P,st=ye.Sa,gt=22,t(Qe!=null),t(ve!=null),Fe=ge[0];var Wt=ve[0];for(t(Be!=null),t(st!=null),Be[0]=null,Re[0]=null,st[0]=0;;){if(ge[0]=Fe,ve[0]=Wt,8>Wt){ge=7;break e}var Gt=qe(Qe,Fe+4);if(4294967286<Gt){ge=3;break e}var Bt=8+Gt+1&-2;if(gt+=Bt,0<et&&gt>et){ge=3;break e}if(!r(Qe,Fe,"VP8 ")||!r(Qe,Fe,"VP8L")){ge=0;break e}if(Wt[0]<Bt){ge=7;break e}r(Qe,Fe,"ALPH")||(Be[0]=Qe,Re[0]=Fe+8,st[0]=Gt),Fe+=Bt,Wt-=Bt}}if(b=b[0],ye.na=ye.na[0],ye.P=ye.P[0],ye.Sa=ye.Sa[0],ge!=0)break}b=[b],ye.Ja=[ye.Ja],ye.xa=[ye.xa];e:if(et=c,ge=g,ve=b,Be=ye.gb[0],Re=ye.Ja,st=ye.xa,Qe=ge[0],Fe=!r(et,Qe,"VP8 "),gt=!r(et,Qe,"VP8L"),t(et!=null),t(ve!=null),t(Re!=null),t(st!=null),8>ve[0])ge=7;else{if(Fe||gt){if(et=qe(et,Qe+4),12<=Be&&et>Be-12){ge=3;break e}if(Ee&&et>ve[0]-8){ge=7;break e}Re[0]=et,ge[0]+=8,ve[0]-=8,st[0]=gt}else st[0]=5<=ve[0]&&et[Qe+0]==47&&!(et[Qe+4]>>5),Re[0]=ve[0];ge=0}if(b=b[0],ye.Ja=ye.Ja[0],ye.xa=ye.xa[0],g=g[0],ge!=0)break;if(4294967286<ye.Ja)return 3;if(G==null||Ce||(G[0]=ye.xa?2:1),q=[q],Ie=[Ie],ye.xa){if(5>b){ge=7;break}G=q,Ee=Ie,Ce=H,c==null||5>b?c=0:5<=b&&c[g+0]==47&&!(c[g+4]>>5)?(ve=[0],et=[0],Be=[0],X(Re=new E,c,g,b),pt(Re,ve,et,Be)?(G!=null&&(G[0]=ve[0]),Ee!=null&&(Ee[0]=et[0]),Ce!=null&&(Ce[0]=Be[0]),c=1):c=0):c=0}else{if(10>b){ge=7;break}G=Ie,c==null||10>b||!Wf(c,g+3,b-3)?c=0:(Ee=c[g+0]|c[g+1]<<8|c[g+2]<<16,Ce=16383&(c[g+7]<<8|c[g+6]),c=16383&(c[g+9]<<8|c[g+8]),1&Ee||3<(Ee>>1&7)||!(Ee>>4&1)||Ee>>5>=ye.Ja||!Ce||!c?c=0:(q&&(q[0]=Ce),G&&(G[0]=c),c=1))}if(!c||(q=q[0],Ie=Ie[0],be&&(re[0]!=q||pe[0]!=Ie)))return 3;K!=null&&(K[0]=ye,K.offset=g-K.w,t(4294967286>g-K.w),t(K.offset==K.ha-b));break}return ge==0||ge==7&&be&&K==null?(H!=null&&(H[0]|=ye.na!=null&&0<ye.na.length),k!=null&&(k[0]=q),D!=null&&(D[0]=Ie),0):ge}function Ju(c,g,b){var k=g.width,D=g.height,H=0,q=0,G=k,K=D;if(g.Da=c!=null&&0<c.Da,g.Da&&(G=c.cd,K=c.bd,H=c.v,q=c.j,11>b||(H&=-2,q&=-2),0>H||0>q||0>=G||0>=K||H+G>k||q+K>D))return 0;if(g.v=H,g.j=q,g.va=H+G,g.o=q+K,g.U=G,g.T=K,g.da=c!=null&&0<c.da,g.da){if(!je(G,K,b=[c.ib],H=[c.hb]))return 0;g.ib=b[0],g.hb=H[0]}return g.ob=c!=null&&c.ob,g.Kb=c==null||!c.Sd,g.da&&(g.ob=g.ib<3*k/4&&g.hb<3*D/4,g.Kb=0),1}function Qu(c){if(c==null)return 2;if(11>c.S){var g=c.f.RGBA;g.fb+=(c.height-1)*g.A,g.A=-g.A}else g=c.f.kb,c=c.height,g.O+=(c-1)*g.fa,g.fa=-g.fa,g.N+=(c-1>>1)*g.Ab,g.Ab=-g.Ab,g.W+=(c-1>>1)*g.Db,g.Db=-g.Db,g.F!=null&&(g.J+=(c-1)*g.lb,g.lb=-g.lb);return 0}function yl(c,g,b,k){if(k==null||0>=c||0>=g)return 2;if(b!=null){if(b.Da){var D=b.cd,H=b.bd,q=-2&b.v,G=-2&b.j;if(0>q||0>G||0>=D||0>=H||q+D>c||G+H>g)return 2;c=D,g=H}if(b.da){if(!je(c,g,D=[b.ib],H=[b.hb]))return 2;c=D[0],g=H[0]}}k.width=c,k.height=g;e:{var K=k.width,re=k.height;if(c=k.S,0>=K||0>=re||!(c>=hh&&13>c))c=2;else{if(0>=k.Rd&&k.sd==null){q=H=D=g=0;var pe=(G=K*bm[c])*re;if(11>c||(H=(re+1)/2*(g=(K+1)/2),c==12&&(q=(D=K)*re)),(re=a(pe+2*H+q))==null){c=1;break e}k.sd=re,11>c?((K=k.f.RGBA).eb=re,K.fb=0,K.A=G,K.size=pe):((K=k.f.kb).y=re,K.O=0,K.fa=G,K.Fd=pe,K.f=re,K.N=0+pe,K.Ab=g,K.Cd=H,K.ea=re,K.W=0+pe+H,K.Db=g,K.Ed=H,c==12&&(K.F=re,K.J=0+pe+2*H),K.Tc=q,K.lb=D)}if(g=1,D=k.S,H=k.width,q=k.height,D>=hh&&13>D)if(11>D)c=k.f.RGBA,g&=(G=Math.abs(c.A))*(q-1)+H<=c.size,g&=G>=H*bm[D],g&=c.eb!=null;else{c=k.f.kb,G=(H+1)/2,pe=(q+1)/2,K=Math.abs(c.fa),re=Math.abs(c.Ab);var be=Math.abs(c.Db),Ee=Math.abs(c.lb),ye=Ee*(q-1)+H;g&=K*(q-1)+H<=c.Fd,g&=re*(pe-1)+G<=c.Cd,g=(g&=be*(pe-1)+G<=c.Ed)&K>=H&re>=G&be>=G,g&=c.y!=null,g&=c.f!=null,g&=c.ea!=null,D==12&&(g&=Ee>=H,g&=ye<=c.Tc,g&=c.F!=null)}else g=0;c=g?0:2}}return c!=0||b!=null&&b.fd&&(c=Qu(k)),c}var cn=64,wl=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],xl=24,_l=32,Zu=8,Jn=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ve("Predictor0","PredictorAdd0"),L.Predictor0=function(){return 4278190080},L.Predictor1=function(c){return c},L.Predictor2=function(c,g,b){return g[b+0]},L.Predictor3=function(c,g,b){return g[b+1]},L.Predictor4=function(c,g,b){return g[b-1]},L.Predictor5=function(c,g,b){return Ze(Ze(c,g[b+1]),g[b+0])},L.Predictor6=function(c,g,b){return Ze(c,g[b-1])},L.Predictor7=function(c,g,b){return Ze(c,g[b+0])},L.Predictor8=function(c,g,b){return Ze(g[b-1],g[b+0])},L.Predictor9=function(c,g,b){return Ze(g[b+0],g[b+1])},L.Predictor10=function(c,g,b){return Ze(Ze(c,g[b-1]),Ze(g[b+0],g[b+1]))},L.Predictor11=function(c,g,b){var k=g[b+0];return 0>=St(k>>24&255,c>>24&255,(g=g[b-1])>>24&255)+St(k>>16&255,c>>16&255,g>>16&255)+St(k>>8&255,c>>8&255,g>>8&255)+St(255&k,255&c,255&g)?k:c},L.Predictor12=function(c,g,b){var k=g[b+0];return(ct((c>>24&255)+(k>>24&255)-((g=g[b-1])>>24&255))<<24|ct((c>>16&255)+(k>>16&255)-(g>>16&255))<<16|ct((c>>8&255)+(k>>8&255)-(g>>8&255))<<8|ct((255&c)+(255&k)-(255&g)))>>>0},L.Predictor13=function(c,g,b){var k=g[b-1];return(ht((c=Ze(c,g[b+0]))>>24&255,k>>24&255)<<24|ht(c>>16&255,k>>16&255)<<16|ht(c>>8&255,k>>8&255)<<8|ht(c>>0&255,k>>0&255))>>>0};var u1=L.PredictorAdd0;L.PredictorAdd1=Nt,Ve("Predictor2","PredictorAdd2"),Ve("Predictor3","PredictorAdd3"),Ve("Predictor4","PredictorAdd4"),Ve("Predictor5","PredictorAdd5"),Ve("Predictor6","PredictorAdd6"),Ve("Predictor7","PredictorAdd7"),Ve("Predictor8","PredictorAdd8"),Ve("Predictor9","PredictorAdd9"),Ve("Predictor10","PredictorAdd10"),Ve("Predictor11","PredictorAdd11"),Ve("Predictor12","PredictorAdd12"),Ve("Predictor13","PredictorAdd13");var ec=L.PredictorAdd2;Lt("ColorIndexInverseTransform","MapARGB","32b",function(c){return c>>8&255},function(c){return c}),Lt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(c){return c},function(c){return c>>8&255});var sh,Ri=L.ColorIndexInverseTransform,Sl=L.MapARGB,oh=L.VP8LColorIndexInverseTransformAlpha,lh=L.MapAlpha,Ss=L.VP8LPredictorsAdd=[];Ss.length=16,(L.VP8LPredictors=[]).length=16,(L.VP8LPredictorsAdd_C=[]).length=16,(L.VP8LPredictors_C=[]).length=16;var xo,Qn,Mn,bs,Ga,Ka,bl,Ya,Or,tc,Bn,Ii,El,uh,rc,_o,So,Es,bo,Al,Eo,As,nc,Di,ji,lr,ur,Fr,Yr=a(511),Xa=a(2041),ic=a(225),Tl=a(767),ch=0,c1=Xa,fh=ic,pi=Tl,Mi=Yr,hh=0,dh=1,hm=2,ph=3,gh=4,f1=5,dm=6,h1=7,d1=8,mh=9,p1=10,a3=[2,3,7],s3=[3,3,11],pm=[280,256,256,256,40],o3=[0,1,1,1,0],l3=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],u3=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],c3=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],f3=8,g1=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],m1=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],ac=null,h3=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],d3=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],gm=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],p3=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],g3=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],m3=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],v3=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Ts=[],ra=[],Ja=[],y3=1,mm=2,ks=[],Bi=[];Le("UpsampleRgbLinePair",jt,3),Le("UpsampleBgrLinePair",yr,3),Le("UpsampleRgbaLinePair",ta,4),Le("UpsampleBgraLinePair",tn,4),Le("UpsampleArgbLinePair",Tn,4),Le("UpsampleRgba4444LinePair",Br,2),Le("UpsampleRgb565LinePair",br,2);var w3=L.UpsampleRgbLinePair,x3=L.UpsampleBgrLinePair,vm=L.UpsampleRgbaLinePair,ym=L.UpsampleBgraLinePair,wm=L.UpsampleArgbLinePair,xm=L.UpsampleRgba4444LinePair,_3=L.UpsampleRgb565LinePair,vh=16,yh=1<<vh-1,sc=-227,v1=482,S3=6,_m=0,b3=a(256),E3=a(256),A3=a(256),T3=a(256),k3=a(v1-sc),N3=a(v1-sc);Ca("YuvToRgbRow",jt,3),Ca("YuvToBgrRow",yr,3),Ca("YuvToRgbaRow",ta,4),Ca("YuvToBgraRow",tn,4),Ca("YuvToArgbRow",Tn,4),Ca("YuvToRgba4444Row",Br,2),Ca("YuvToRgb565Row",br,2);var Sm=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],wh=[0,2,8],C3=[8,7,6,4,4,2,2,2,1,1,1,1],L3=1;this.WebPDecodeRGBA=function(c,g,b,k,D){var H=dh,q=new gl,G=new ci;q.ba=G,G.S=H,G.width=[G.width],G.height=[G.height];var K=G.width,re=G.height,pe=new Xi;if(pe==null||c==null)var be=2;else t(pe!=null),be=vl(c,g,b,pe.width,pe.height,pe.Pd,pe.Qd,pe.format,null);if(be!=0?K=0:(K!=null&&(K[0]=pe.width[0]),re!=null&&(re[0]=pe.height[0]),K=1),K){G.width=G.width[0],G.height=G.height[0],k!=null&&(k[0]=G.width),D!=null&&(D[0]=G.height);e:{if(k=new Ta,(D=new $u).data=c,D.w=g,D.ha=b,D.kd=1,g=[0],t(D!=null),((c=vl(D.data,D.w,D.ha,null,null,null,g,null,D))==0||c==7)&&g[0]&&(c=4),(g=c)==0){if(t(q!=null),k.data=D.data,k.w=D.w+D.offset,k.ha=D.ha-D.offset,k.put=Oi,k.ac=Kr,k.bc=Fi,k.ma=q,D.xa){if((c=Ne())==null){q=1;break e}if(function(Ee,ye){var Ie=[0],Ce=[0],ge=[0];t:for(;;){if(Ee==null)return 0;if(ye==null)return Ee.a=2,0;if(Ee.l=ye,Ee.a=0,X(Ee.m,ye.data,ye.w,ye.ha),!pt(Ee.m,Ie,Ce,ge)){Ee.a=3;break t}if(Ee.xb=mm,ye.width=Ie[0],ye.height=Ce[0],!_e(Ie[0],Ce[0],1,Ee,null))break t;return 1}return t(Ee.a!=0),0}(c,k)){if(k=(g=yl(k.width,k.height,q.Oa,q.ba))==0){t:{k=c;r:for(;;){if(k==null){k=0;break t}if(t(k.s.yc!=null),t(k.s.Ya!=null),t(0<k.s.Wb),t((b=k.l)!=null),t((D=b.ma)!=null),k.xb!=0){if(k.ca=D.ba,k.tb=D.tb,t(k.ca!=null),!Ju(D.Oa,b,ph)){k.a=2;break r}if(!Ae(k,b.width)||b.da)break r;if((b.da||Mt(k.ca.S))&&we(),11>k.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),k.ca.f.kb.F!=null&&we()),k.Pb&&0<k.s.ua&&k.s.vb.X==null&&!Xe(k.s.vb,k.s.Wa.Xa)){k.a=1;break r}k.xb=0}if(!se(k,k.V,k.Ba,k.c,k.i,b.o,ie))break r;D.Dc=k.Ma,k=1;break t}t(k.a!=0),k=0}k=!k}k&&(g=c.a)}else g=c.a}else{if((c=new hi)==null){q=1;break e}if(c.Fa=D.na,c.P=D.P,c.qc=D.Sa,qf(c,k)){if((g=yl(k.width,k.height,q.Oa,q.ba))==0){if(c.Aa=0,b=q.Oa,t((D=c)!=null),b!=null){if(0<(K=0>(K=b.Md)?0:100<K?255:255*K/100)){for(re=pe=0;4>re;++re)12>(be=D.pb[re]).lc&&(be.ia=K*C3[0>be.lc?0:be.lc]>>3),pe|=be.ia;pe&&(alert("todo:VP8InitRandom"),D.ia=1)}D.Ga=b.Id,100<D.Ga?D.Ga=100:0>D.Ga&&(D.Ga=0)}$d(c,k)||(g=c.a)}}else g=c.a}g==0&&q.Oa!=null&&q.Oa.fd&&(g=Qu(q.ba))}q=g}H=q!=0?null:11>H?G.f.RGBA.eb:G.f.kb.y}else H=null;return H};var bm=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(L,P){for(var M="",N=0;N<4;N++)M+=String.fromCharCode(L[P++]);return M}function f(L,P){return(L[P+0]<<0|L[P+1]<<8|L[P+2]<<16)>>>0}function d(L,P){return(L[P+0]<<0|L[P+1]<<8|L[P+2]<<16|L[P+3]<<24)>>>0}new l;var p=[0],h=[0],v=[],m=new l,S=e,y=function(L,P){var M={},N=0,C=!1,U=0,Y=0;if(M.frames=[],!function(O,F,I,V){for(var ue=0;ue<V;ue++)if(O[F+ue]!=I.charCodeAt(ue))return!0;return!1}(L,P,"RIFF",4)){var ce,ee;for(d(L,P+=4),P+=8;P<L.length;){var Q=u(L,P),X=d(L,P+=4);P+=4;var z=X+(1&X);switch(Q){case"VP8 ":case"VP8L":M.frames[N]===void 0&&(M.frames[N]={}),(E=M.frames[N]).src_off=C?Y:P-8,E.src_size=U+X+8,N++,C&&(C=!1,U=0,Y=0);break;case"VP8X":(E=M.header={}).feature_flags=L[P];var ae=P+4;E.canvas_width=1+f(L,ae),ae+=3,E.canvas_height=1+f(L,ae),ae+=3;break;case"ALPH":C=!0,U=z+8,Y=P-8;break;case"ANIM":(E=M.header).bgcolor=d(L,P),ae=P+4,E.loop_count=(ce=L)[(ee=ae)+0]<<0|ce[ee+1]<<8,ae+=2;break;case"ANMF":var me,E;(E=M.frames[N]={}).offset_x=2*f(L,P),P+=3,E.offset_y=2*f(L,P),P+=3,E.width=1+f(L,P),P+=3,E.height=1+f(L,P),P+=3,E.duration=f(L,P),P+=3,me=L[P++],E.dispose=1&me,E.blend=me>>1&1}Q!="ANMF"&&(P+=z)}return M}}(S,0);y.response=S,y.rgbaoutput=!0,y.dataurl=!1;var w=y.header?y.header:null,x=y.frames?y.frames:null;if(w){w.loop_counter=w.loop_count,p=[w.canvas_height],h=[w.canvas_width];for(var A=0;A<x.length&&x[A].blend!=0;A++);}var R=x[0],B=m.WebPDecodeRGBA(S,R.src_off,R.src_size,h,p);R.rgba=B,R.imgwidth=h[0],R.imgheight=p[0];for(var T=0;T<h[0]*p[0]*4;T++)v[T]=B[T];return this.width=h,this.height=p,this.data=v,this}(function(e){var t=function(){return typeof Mg=="function"},r=function(p,h,v,m){var S=4,y=s;switch(m){case e.image_compression.FAST:S=1,y=a;break;case e.image_compression.MEDIUM:S=6,y=o;break;case e.image_compression.SLOW:S=9,y=l}p=n(p,h,v,y);var w=Mg(p,{level:S});return e.__addimage__.arrayBufferToBinaryString(w)},n=function(p,h,v,m){for(var S,y,w,x=p.length/h,A=new Uint8Array(p.length+x),R=f(),B=0;B<x;B+=1){if(w=B*h,S=p.subarray(w,w+h),m)A.set(m(S,v,y),w+B);else{for(var T,L=R.length,P=[];T<L;T+=1)P[T]=R[T](S,v,y);var M=d(P.concat());A.set(P[M],w+B)}y=S}return A},i=function(p){var h=Array.apply([],p);return h.unshift(0),h},a=function(p,h){var v,m=[],S=p.length;m[0]=1;for(var y=0;y<S;y+=1)v=p[y-h]||0,m[y+1]=p[y]-v+256&255;return m},s=function(p,h,v){var m,S=[],y=p.length;S[0]=2;for(var w=0;w<y;w+=1)m=v&&v[w]||0,S[w+1]=p[w]-m+256&255;return S},o=function(p,h,v){var m,S,y=[],w=p.length;y[0]=3;for(var x=0;x<w;x+=1)m=p[x-h]||0,S=v&&v[x]||0,y[x+1]=p[x]+256-(m+S>>>1)&255;return y},l=function(p,h,v){var m,S,y,w,x=[],A=p.length;x[0]=4;for(var R=0;R<A;R+=1)m=p[R-h]||0,S=v&&v[R]||0,y=v&&v[R-h]||0,w=u(m,S,y),x[R+1]=p[R]-w+256&255;return x},u=function(p,h,v){if(p===h&&h===v)return p;var m=Math.abs(h-v),S=Math.abs(p-v),y=Math.abs(p+h-v-v);return m<=S&&m<=y?p:S<=y?h:v},f=function(){return[i,a,s,o,l]},d=function(p){var h=p.map(function(v){return v.reduce(function(m,S){return m+Math.abs(S)},0)});return h.indexOf(Math.min.apply(null,h))};e.processPNG=function(p,h,v,m){var S,y,w,x,A,R,B,T,L,P,M,N,C,U,Y,ce=this.decode.FLATE_DECODE,ee="";if(this.__addimage__.isArrayBuffer(p)&&(p=new Uint8Array(p)),this.__addimage__.isArrayBufferView(p)){if(p=(w=new OO(p)).imgData,y=w.bits,S=w.colorSpace,A=w.colors,[4,6].indexOf(w.colorType)!==-1){if(w.bits===8){L=(T=w.pixelBitlength==32?new Uint32Array(w.decodePixels().buffer):w.pixelBitlength==16?new Uint16Array(w.decodePixels().buffer):new Uint8Array(w.decodePixels().buffer)).length,M=new Uint8Array(L*w.colors),P=new Uint8Array(L);var Q,X=w.pixelBitlength-w.bits;for(U=0,Y=0;U<L;U++){for(C=T[U],Q=0;Q<X;)M[Y++]=C>>>Q&255,Q+=w.bits;P[U]=C>>>Q&255}}if(w.bits===16){L=(T=new Uint32Array(w.decodePixels().buffer)).length,M=new Uint8Array(L*(32/w.pixelBitlength)*w.colors),P=new Uint8Array(L*(32/w.pixelBitlength)),N=w.colors>1,U=0,Y=0;for(var z=0;U<L;)C=T[U++],M[Y++]=C>>>0&255,N&&(M[Y++]=C>>>16&255,C=T[U++],M[Y++]=C>>>0&255),P[z++]=C>>>16&255;y=8}m!==e.image_compression.NONE&&t()?(p=r(M,w.width*w.colors,w.colors,m),B=r(P,w.width,1,m)):(p=M,B=P,ce=void 0)}if(w.colorType===3&&(S=this.color_spaces.INDEXED,R=w.palette,w.transparency.indexed)){var ae=w.transparency.indexed,me=0;for(U=0,L=ae.length;U<L;++U)me+=ae[U];if((me/=255)===L-1&&ae.indexOf(0)!==-1)x=[ae.indexOf(0)];else if(me!==L){for(T=w.decodePixels(),P=new Uint8Array(T.length),U=0,L=T.length;U<L;U++)P[U]=ae[T[U]];B=r(P,w.width,1)}}var E=function(O){var F;switch(O){case e.image_compression.FAST:F=11;break;case e.image_compression.MEDIUM:F=13;break;case e.image_compression.SLOW:F=14;break;default:F=12}return F}(m);return ce===this.decode.FLATE_DECODE&&(ee="/Predictor "+E+" "),ee+="/Colors "+A+" /BitsPerComponent "+y+" /Columns "+w.width,(this.__addimage__.isArrayBuffer(p)||this.__addimage__.isArrayBufferView(p))&&(p=this.__addimage__.arrayBufferToBinaryString(p)),(B&&this.__addimage__.isArrayBuffer(B)||this.__addimage__.isArrayBufferView(B))&&(B=this.__addimage__.arrayBufferToBinaryString(B)),{alias:v,data:p,index:h,filter:ce,decodeParameters:ee,transparency:x,palette:R,sMask:B,predictor:E,width:w.width,height:w.height,bitsPerComponent:y,colorSpace:S}}}})(mt.API),function(e){e.processGIF89A=function(t,r,n,i){var a=new FO(t),s=a.width,o=a.height,l=[];a.decodeAndBlitFrameRGBA(0,l);var u={data:l,width:s,height:o},f=new Ap(100).encode(u,100);return e.processJPEG.call(this,f,r,n,i)},e.processGIF87A=e.processGIF89A}(mt.API),la.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:i,green:n,blue:r,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},la.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){sr.log("bit decode error:"+r)}},la.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,i=0;i<t;i++)for(var a=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+8*i*4,o=0;o<8&&8*i+o<this.width;o++){var l=this.palette[a>>7-o&1];this.data[s+4*o]=l.blue,this.data[s+4*o+1]=l.green,this.data[s+4*o+2]=l.red,this.data[s+4*o+3]=255}r!==0&&(this.pos+=4-r)}},la.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<e;i++){var a=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+2*i*4,o=a>>4,l=15&a,u=this.palette[o];if(this.data[s]=u.blue,this.data[s+1]=u.green,this.data[s+2]=u.red,this.data[s+3]=255,2*i+1>=this.width)break;u=this.palette[l],this.data[s+4]=u.blue,this.data[s+4+1]=u.green,this.data[s+4+2]=u.red,this.data[s+4+3]=255}t!==0&&(this.pos+=4-t)}},la.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),a=r*this.width*4+4*n;if(i<this.palette.length){var s=this.palette[i];this.data[a]=s.red,this.data[a+1]=s.green,this.data[a+2]=s.blue,this.data[a+3]=255}else this.data[a]=255,this.data[a+1]=255,this.data[a+2]=255,this.data[a+3]=255}e!==0&&(this.pos+=4-e)}},la.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(a&t)/t*255|0,o=(a>>5&t)/t*255|0,l=(a>>10&t)/t*255|0,u=a>>15?255:0,f=n*this.width*4+4*i;this.data[f]=l,this.data[f+1]=o,this.data[f+2]=s,this.data[f+3]=u}this.pos+=e}},la.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,a=0;a<this.width;a++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&t)/t*255|0,l=(s>>5&r)/r*255|0,u=(s>>11)/t*255|0,f=i*this.width*4+4*a;this.data[f]=u,this.data[f+1]=l,this.data[f+2]=o,this.data[f+3]=255}this.pos+=e}},la.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*r;this.data[s]=a,this.data[s+1]=i,this.data[s+2]=n,this.data[s+3]=255}this.pos+=this.width%4}},la.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=a,this.data[o+1]=i,this.data[o+2]=n,this.data[o+3]=s}},la.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,i){var a=new la(t,!1),s=a.width,o=a.height,l={data:a.getData(),width:s,height:o},u=new Ap(100).encode(l,100);return e.processJPEG.call(this,u,r,n,i)}}(mt.API),Ty.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,i){var a=new Ty(t),s=a.width,o=a.height,l={data:a.getData(),width:s,height:o},u=new Ap(100).encode(l,100);return e.processJPEG.call(this,u,r,n,i)}}(mt.API),mt.API.processRGBA=function(e,t,r){for(var n=e.data,i=n.length,a=new Uint8Array(i/4*3),s=new Uint8Array(i/4),o=0,l=0,u=0;u<i;u+=4){var f=n[u],d=n[u+1],p=n[u+2],h=n[u+3];a[o++]=f,a[o++]=d,a[o++]=p,s[l++]=h}var v=this.__addimage__.arrayBufferToBinaryString(a);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:v,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},mt.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Hl=mt.API,h0=Hl.getCharWidthsArray=function(e,t){var r,n,i=(t=t||{}).font||this.internal.getFont(),a=t.fontSize||this.internal.getFontSize(),s=t.charSpace||this.internal.getCharSpace(),o=t.widths?t.widths:i.metadata.Unicode.widths,l=o.fof?o.fof:1,u=t.kerning?t.kerning:i.metadata.Unicode.kerning,f=u.fof?u.fof:1,d=t.doKerning!==!1,p=0,h=e.length,v=0,m=o[0]||l,S=[];for(r=0;r<h;r++)n=e.charCodeAt(r),typeof i.metadata.widthOfString=="function"?S.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(n))+s*(1e3/a)||0)/1e3):(p=d&&Qt(u[n])==="object"&&!isNaN(parseInt(u[n][v],10))?u[n][v]/f:0,S.push((o[n]||m)/l+p)),v=n;return S},Sy=Hl.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),i=t.charSpace||this.internal.getCharSpace();return Hl.processArabic&&(e=Hl.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,i)/r:h0.apply(this,arguments).reduce(function(a,s){return a+s},0)},by=function(e,t,r,n){for(var i=[],a=0,s=e.length,o=0;a!==s&&o+t[a]<r;)o+=t[a],a++;i.push(e.slice(0,a));var l=a;for(o=0;a!==s;)o+t[a]>n&&(i.push(e.slice(l,a)),o=0,l=a),o+=t[a],a++;return l!==a&&i.push(e.slice(l,a)),i},Ey=function(e,t,r){r||(r={});var n,i,a,s,o,l,u,f=[],d=[f],p=r.textIndent||0,h=0,v=0,m=e.split(" "),S=h0.apply(this,[" ",r])[0];if(l=r.lineIndent===-1?m[0].length+2:r.lineIndent||0){var y=Array(l).join(" "),w=[];m.map(function(A){(A=A.split(/\s*\n/)).length>1?w=w.concat(A.map(function(R,B){return(B&&R.length?`
`:"")+R})):w.push(A[0])}),m=w,l=Sy.apply(this,[y,r])}for(a=0,s=m.length;a<s;a++){var x=0;if(n=m[a],l&&n[0]==`
`&&(n=n.substr(1),x=1),p+h+(v=(i=h0.apply(this,[n,r])).reduce(function(A,R){return A+R},0))>t||x){if(v>t){for(o=by.apply(this,[n,i,t-(p+h),t]),f.push(o.shift()),f=[o.pop()];o.length;)d.push([o.shift()]);v=i.slice(n.length-(f[0]?f[0].length:0)).reduce(function(A,R){return A+R},0)}else f=[n];d.push(f),p=v+l,h=S}else f.push(n),p+=h+v,h=S}return u=l?function(A,R){return(R?y:"")+A.join(" ")}:function(A){return A.join(" ")},d.map(u)},Hl.splitTextToSize=function(e,t,r){var n,i=(r=r||{}).fontSize||this.internal.getFontSize(),a=(function(f){if(f.widths&&f.kerning)return{widths:f.widths,kerning:f.kerning};var d=this.internal.getFont(f.fontName,f.fontStyle);return d.metadata.Unicode?{widths:d.metadata.Unicode.widths||{0:1},kerning:d.metadata.Unicode.kerning||{}}:{font:d.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var s=1*this.internal.scaleFactor*t/i;a.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/i:0,a.lineIndent=r.lineIndent;var o,l,u=[];for(o=0,l=n.length;o<l;o++)u=u.concat(Ey.apply(this,[n[o],s,a]));return u},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",r={},n={},i=0;i<t.length;i++)r[t[i]]="0123456789abcdef"[i],n["0123456789abcdef"[i]]=t[i];var a=function(d){return"0x"+parseInt(d,10).toString(16)},s=e.__fontmetrics__.compress=function(d){var p,h,v,m,S=["{"];for(var y in d){if(p=d[y],isNaN(parseInt(y,10))?h="'"+y+"'":(y=parseInt(y,10),h=(h=a(y).slice(2)).slice(0,-1)+n[h.slice(-1)]),typeof p=="number")p<0?(v=a(p).slice(3),m="-"):(v=a(p).slice(2),m=""),v=m+v.slice(0,-1)+n[v.slice(-1)];else{if(Qt(p)!=="object")throw new Error("Don't know what to do with value type "+Qt(p)+".");v=s(p)}S.push(h+v)}return S.push("}"),S.join("")},o=e.__fontmetrics__.uncompress=function(d){if(typeof d!="string")throw new Error("Invalid argument passed to uncompress.");for(var p,h,v,m,S={},y=1,w=S,x=[],A="",R="",B=d.length-1,T=1;T<B;T+=1)(m=d[T])=="'"?p?(v=p.join(""),p=void 0):p=[]:p?p.push(m):m=="{"?(x.push([w,v]),w={},v=void 0):m=="}"?((h=x.pop())[0][h[1]]=w,v=void 0,w=h[0]):m=="-"?y=-1:v===void 0?r.hasOwnProperty(m)?(A+=r[m],v=parseInt(A,16)*y,y=1,A=""):A+=m:r.hasOwnProperty(m)?(R+=r[m],w[v]=parseInt(R,16)*y,y=1,v=void 0,R=""):R+=m;return S},l={codePages:["WinAnsiEncoding"],WinAnsiEncoding:o("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:l,"Courier-Bold":l,"Courier-BoldOblique":l,"Courier-Oblique":l,Helvetica:l,"Helvetica-Bold":l,"Helvetica-BoldOblique":l,"Helvetica-Oblique":l,"Times-Roman":l,"Times-Bold":l,"Times-BoldItalic":l,"Times-Italic":l}},f={Unicode:{"Courier-Oblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":o("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":o("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:o("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":o("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:o("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":o("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":o("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":o("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":o("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(d){var p=d.font,h=f.Unicode[p.postScriptName];h&&(p.metadata.Unicode={},p.metadata.Unicode.widths=h.widths,p.metadata.Unicode.kerning=h.kerning);var v=u.Unicode[p.postScriptName];v&&(p.metadata.Unicode.encoding=v,p.encoding=v.codePages[0])}])}(mt.API),function(e){var t=function(r){for(var n=r.length,i=new Uint8Array(n),a=0;a<n;a++)i[a]=r.charCodeAt(a);return i};e.API.events.push(["addFont",function(r){var n=void 0,i=r.font,a=r.instance;if(!i.isStandardFont){if(a===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(n=a.existsFileInVFS(i.postScriptName)===!1?a.loadFile(i.postScriptName):a.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(s,o){o=/^\x00\x01\x00\x00/.test(o)?t(o):t(Vc(o)),s.metadata=e.API.TTFFont.open(o),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(i,n)}}])}(mt),function(e){function t(){return(xt.canvg?Promise.resolve(xt.canvg):Fg(()=>import("./index.es-Fov_3ZUL.js"),[])).catch(function(r){return Promise.reject(new Error("Could not load canvg: "+r))}).then(function(r){return r.default?r.default:r})}mt.API.addSvgAsImage=function(r,n,i,a,s,o,l,u){if(isNaN(n)||isNaN(i))throw sr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(a)||isNaN(s))throw sr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var f=document.createElement("canvas");f.width=a,f.height=s;var d=f.getContext("2d");d.fillStyle="#fff",d.fillRect(0,0,f.width,f.height);var p={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},h=this;return t().then(function(v){return v.fromString(d,r,p)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(v){return v.render(p)}).then(function(){h.addImage(f.toDataURL("image/jpeg",1),n,i,a,s,l,u)})}}(),mt.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var i=0;i<this.internal.pages[n].length;i++)this.internal.pages[n][i]=this.internal.pages[n][i].replace(t,r);return this},mt.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,i,a,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(s),l=[],u=0,f=0,d=0;function p(v,m){var S,y=!1;for(S=0;S<v.length;S+=1)v[S]===m&&(y=!0);return y}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var h=o.length;for(d=0;d<h;d+=1)r[o[d]].value=r[o[d]].defaultValue,r[o[d]].explicitSet=!1}if(Qt(e)==="object"){for(i in e)if(a=e[i],p(o,i)&&a!==void 0){if(r[i].type==="boolean"&&typeof a=="boolean")r[i].value=a;else if(r[i].type==="name"&&p(r[i].valueSet,a))r[i].value=a;else if(r[i].type==="integer"&&Number.isInteger(a))r[i].value=a;else if(r[i].type==="array"){for(u=0;u<a.length;u+=1)if(n=!0,a[u].length===1&&typeof a[u][0]=="number")l.push(String(a[u]-1));else if(a[u].length>1){for(f=0;f<a[u].length;f+=1)typeof a[u][f]!="number"&&(n=!1);n===!0&&l.push([a[u][0]-1,a[u][1]-1].join(" "))}r[i].value="["+l.join(" ")+"]"}else r[i].value=r[i].defaultValue;r[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var v,m=[];for(v in r)r[v].explicitSet===!0&&(r[v].type==="name"?m.push("/"+v+" /"+r[v].value):m.push("/"+v+" "+r[v].value));m.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+m.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),a=unescape(encodeURIComponent(n)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),l=unescape(encodeURIComponent("</x:xmpmeta>")),u=a.length+s.length+o.length+i.length+l.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(i+a+s+o+l),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(mt.API),function(e){var t=e.API,r=t.pdfEscape16=function(a,s){for(var o,l=s.metadata.Unicode.widths,u=["","0","00","000","0000"],f=[""],d=0,p=a.length;d<p;++d){if(o=s.metadata.characterToGlyph(a.charCodeAt(d)),s.metadata.glyIdsUsed.push(o),s.metadata.toUnicode[o]=a.charCodeAt(d),l.indexOf(o)==-1&&(l.push(o),l.push([parseInt(s.metadata.widthOfGlyph(o),10)])),o=="0")return f.join("");o=o.toString(16),f.push(u[4-o.length],o)}return f.join("")},n=function(a){var s,o,l,u,f,d,p;for(f=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,l=[],d=0,p=(o=Object.keys(a).sort(function(h,v){return h-v})).length;d<p;d++)s=o[d],l.length>=100&&(f+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar`,l=[]),a[s]!==void 0&&a[s]!==null&&typeof a[s].toString=="function"&&(u=("0000"+a[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),l.push("<"+s+"><"+u+">"));return l.length&&(f+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar
`),f+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(a){(function(s){var o=s.font,l=s.out,u=s.newObject,f=s.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="Identity-H"){for(var d=o.metadata.Unicode.widths,p=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),h="",v=0;v<p.length;v++)h+=String.fromCharCode(p[v]);var m=u();f({data:h,addLength1:!0,objectId:m}),l("endobj");var S=u();f({data:n(o.metadata.toUnicode),addLength1:!0,objectId:S}),l("endobj");var y=u();l("<<"),l("/Type /FontDescriptor"),l("/FontName /"+Kl(o.fontName)),l("/FontFile2 "+m+" 0 R"),l("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),l("/Flags "+o.metadata.flags),l("/StemV "+o.metadata.stemV),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l(">>"),l("endobj");var w=u();l("<<"),l("/Type /Font"),l("/BaseFont /"+Kl(o.fontName)),l("/FontDescriptor "+y+" 0 R"),l("/W "+e.API.PDFObject.convert(d)),l("/CIDToGIDMap /Identity"),l("/DW 1000"),l("/Subtype /CIDFontType2"),l("/CIDSystemInfo"),l("<<"),l("/Supplement 0"),l("/Registry (Adobe)"),l("/Ordering ("+o.encoding+")"),l(">>"),l(">>"),l("endobj"),o.objectNumber=u(),l("<<"),l("/Type /Font"),l("/Subtype /Type0"),l("/ToUnicode "+S+" 0 R"),l("/BaseFont /"+Kl(o.fontName)),l("/Encoding /"+o.encoding),l("/DescendantFonts ["+w+" 0 R]"),l(">>"),l("endobj"),o.isAlreadyPutted=!0}})(a)}]),t.events.push(["putFont",function(a){(function(s){var o=s.font,l=s.out,u=s.newObject,f=s.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var d=o.metadata.rawData,p="",h=0;h<d.length;h++)p+=String.fromCharCode(d[h]);var v=u();f({data:p,addLength1:!0,objectId:v}),l("endobj");var m=u();f({data:n(o.metadata.toUnicode),addLength1:!0,objectId:m}),l("endobj");var S=u();l("<<"),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l("/StemV "+o.metadata.stemV),l("/Type /FontDescriptor"),l("/FontFile2 "+v+" 0 R"),l("/Flags 96"),l("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),l("/FontName /"+Kl(o.fontName)),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l(">>"),l("endobj"),o.objectNumber=u();for(var y=0;y<o.metadata.hmtx.widths.length;y++)o.metadata.hmtx.widths[y]=parseInt(o.metadata.hmtx.widths[y]*(1e3/o.metadata.head.unitsPerEm));l("<</Subtype/TrueType/Type/Font/ToUnicode "+m+" 0 R/BaseFont/"+Kl(o.fontName)+"/FontDescriptor "+S+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),l("endobj"),o.isAlreadyPutted=!0}})(a)}]);var i=function(a){var s,o=a.text||"",l=a.x,u=a.y,f=a.options||{},d=a.mutex||{},p=d.pdfEscape,h=d.activeFontKey,v=d.fonts,m=h,S="",y=0,w="",x=v[m].encoding;if(v[m].encoding!=="Identity-H")return{text:o,x:l,y:u,options:f,mutex:d};for(w=o,m=h,Array.isArray(o)&&(w=o[0]),y=0;y<w.length;y+=1)v[m].metadata.hasOwnProperty("cmap")&&(s=v[m].metadata.cmap.unicode.codeMap[w[y].charCodeAt(0)]),s||w[y].charCodeAt(0)<256&&v[m].metadata.hasOwnProperty("Unicode")?S+=w[y]:S+="";var A="";return parseInt(m.slice(1))<14||x==="WinAnsiEncoding"?A=p(S,m).split("").map(function(R){return R.charCodeAt(0).toString(16)}).join(""):x==="Identity-H"&&(A=r(S,v[m])),d.isHex=!0,{text:A,x:l,y:u,options:f,mutex:d}};t.events.push(["postProcessText",function(a){var s=a.text||"",o=[],l={text:s,x:a.x,y:a.y,options:a.options,mutex:a.mutex};if(Array.isArray(s)){var u=0;for(u=0;u<s.length;u+=1)Array.isArray(s[u])&&s[u].length===3?o.push([i(Object.assign({},l,{text:s[u][0]})).text,s[u][1],s[u][2]]):o.push(i(Object.assign({},l,{text:s[u]})).text);a.text=o}else a.text=i(Object.assign({},l,{text:s})).text}])}(mt),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(mt.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var i,a,s,o,l,u,f,d=t,p=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],v={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},m={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},S=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],y=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),w=!1,x=0;this.__bidiEngine__={};var A=function(N){var C=N.charCodeAt(),U=C>>8,Y=m[U];return Y!==void 0?d[256*Y+(255&C)]:U===252||U===253?"AL":y.test(U)?"L":U===8?"R":"N"},R=function(N){for(var C,U=0;U<N.length;U++){if((C=A(N.charAt(U)))==="L")return!1;if(C==="R")return!0}return!1},B=function(N,C,U,Y){var ce,ee,Q,X,z=C[Y];switch(z){case"L":case"R":w=!1;break;case"N":case"AN":break;case"EN":w&&(z="AN");break;case"AL":w=!0,z="R";break;case"WS":z="N";break;case"CS":Y<1||Y+1>=C.length||(ce=U[Y-1])!=="EN"&&ce!=="AN"||(ee=C[Y+1])!=="EN"&&ee!=="AN"?z="N":w&&(ee="AN"),z=ee===ce?ee:"N";break;case"ES":z=(ce=Y>0?U[Y-1]:"B")==="EN"&&Y+1<C.length&&C[Y+1]==="EN"?"EN":"N";break;case"ET":if(Y>0&&U[Y-1]==="EN"){z="EN";break}if(w){z="N";break}for(Q=Y+1,X=C.length;Q<X&&C[Q]==="ET";)Q++;z=Q<X&&C[Q]==="EN"?"EN":"N";break;case"NSM":if(s&&!o){for(X=C.length,Q=Y+1;Q<X&&C[Q]==="NSM";)Q++;if(Q<X){var ae=N[Y],me=ae>=1425&&ae<=2303||ae===64286;if(ce=C[Q],me&&(ce==="R"||ce==="AL")){z="R";break}}}z=Y<1||(ce=C[Y-1])==="B"?"N":U[Y-1];break;case"B":w=!1,i=!0,z=x;break;case"S":a=!0,z="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":w=!1;break;case"BN":z="N"}return z},T=function(N,C,U){var Y=N.split("");return U&&L(Y,U,{hiLevel:x}),Y.reverse(),C&&C.reverse(),Y.join("")},L=function(N,C,U){var Y,ce,ee,Q,X,z=-1,ae=N.length,me=0,E=[],O=x?h:p,F=[];for(w=!1,i=!1,a=!1,ce=0;ce<ae;ce++)F[ce]=A(N[ce]);for(ee=0;ee<ae;ee++){if(X=me,E[ee]=B(N,F,E,ee),Y=240&(me=O[X][v[E[ee]]]),me&=15,C[ee]=Q=O[me][5],Y>0)if(Y===16){for(ce=z;ce<ee;ce++)C[ce]=1;z=-1}else z=-1;if(O[me][6])z===-1&&(z=ee);else if(z>-1){for(ce=z;ce<ee;ce++)C[ce]=Q;z=-1}F[ee]==="B"&&(C[ee]=0),U.hiLevel|=Q}a&&function(I,V,ue){for(var fe=0;fe<ue;fe++)if(I[fe]==="S"){V[fe]=x;for(var he=fe-1;he>=0&&I[he]==="WS";he--)V[he]=x}}(F,C,ae)},P=function(N,C,U,Y,ce){if(!(ce.hiLevel<N)){if(N===1&&x===1&&!i)return C.reverse(),void(U&&U.reverse());for(var ee,Q,X,z,ae=C.length,me=0;me<ae;){if(Y[me]>=N){for(X=me+1;X<ae&&Y[X]>=N;)X++;for(z=me,Q=X-1;z<Q;z++,Q--)ee=C[z],C[z]=C[Q],C[Q]=ee,U&&(ee=U[z],U[z]=U[Q],U[Q]=ee);me=X}me++}}},M=function(N,C,U){var Y=N.split(""),ce={hiLevel:x};return U||(U=[]),L(Y,U,ce),function(ee,Q,X){if(X.hiLevel!==0&&f)for(var z,ae=0;ae<ee.length;ae++)Q[ae]===1&&(z=S.indexOf(ee[ae]))>=0&&(ee[ae]=S[z+1])}(Y,U,ce),P(2,Y,C,U,ce),P(1,Y,C,U,ce),Y.join("")};return this.__bidiEngine__.doBidiReorder=function(N,C,U){if(function(ce,ee){if(ee)for(var Q=0;Q<ce.length;Q++)ee[Q]=Q;o===void 0&&(o=R(ce)),u===void 0&&(u=R(ce))}(N,C),s||!l||u)if(s&&l&&o^u)x=o?1:0,N=T(N,C,U);else if(!s&&l&&u)x=o?1:0,N=M(N,C,U),N=T(N,C);else if(!s||o||l||u){if(s&&!l&&o^u)N=T(N,C),o?(x=0,N=M(N,C,U)):(x=1,N=M(N,C,U),N=T(N,C));else if(s&&o&&!l&&u)x=1,N=M(N,C,U),N=T(N,C);else if(!s&&!l&&o^u){var Y=f;o?(x=1,N=M(N,C,U),x=0,f=!1,N=M(N,C,U),f=Y):(x=0,N=M(N,C,U),N=T(N,C),x=1,f=!1,N=M(N,C,U),f=Y,N=T(N,C))}}else x=0,N=M(N,C,U);else x=o?1:0,N=M(N,C,U);return N},this.__bidiEngine__.setOptions=function(N){N&&(s=N.isInputVisual,l=N.isOutputVisual,o=N.isInputRtl,u=N.isOutputRtl,f=N.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var i=n.text,a=(n.x,n.y,n.options||{}),s=(n.mutex,a.lang,[]);if(a.isInputVisual=typeof a.isInputVisual!="boolean"||a.isInputVisual,r.setOptions(a),Object.prototype.toString.call(i)==="[object Array]"){var o=0;for(s=[],o=0;o<i.length;o+=1)Object.prototype.toString.call(i[o])==="[object Array]"?s.push([r.doBidiReorder(i[o][0]),i[o][1],i[o][2]]):s.push([r.doBidiReorder(i[o])]);n.text=s}else n.text=r.doBidiReorder(i);r.setOptions({isInputVisual:!0})}])}(mt),mt.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new co(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new KO(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new RO(this.contents),this.head=new DO(this),this.name=new zO(this),this.cmap=new n3(this),this.toUnicode={},this.hhea=new jO(this),this.maxp=new HO(this),this.hmtx=new WO(this),this.post=new BO(this),this.os2=new MO(this),this.loca=new GO(this),this.glyf=new qO(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,i,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var s,o,l,u;for(u=[],s=0,o=(l=this.bbox).length;s<o;s++)t=l[s],u.push(Math.round(t*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(n=255&(i=this.post.italic_angle),32768&(r=i>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(a=this.familyClass)===1||a===2||a===3||a===4||a===5||a===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var i,a,s,o;for(s=0,a=0,o=(t=""+t).length;0<=o?a<o:a>o;a=0<=o?++a:--a)i=t.charCodeAt(a),s+=this.widthOfGlyph(this.characterToGlyph(i))+n*(1e3/r)||0;return s*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var ba,co=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,i;for(i=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)i.push(this.writeByte(t.charCodeAt(r)));return i},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,i,a,s,o,l;return t=this.readByte(),r=this.readByte(),n=this.readByte(),i=this.readByte(),a=this.readByte(),s=this.readByte(),o=this.readByte(),l=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^i)+16777216*(255^a)+65536*(255^s)+256*(255^o)+(255^l)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*i+16777216*a+65536*s+256*o+l},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,i,a;for(a=[],n=0,i=t.length;n<i;n++)r=t[n],a.push(this.writeByte(r));return a},e}(),RO=function(){var e;function t(r){var n,i,a;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},i=0,a=this.tableCount;0<=a?i<a:i>a;i=0<=a?++i:--i)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,i,a,s,o,l,u,f,d,p,h,v,m;for(m in h=Object.keys(r).length,l=Math.log(2),d=16*Math.floor(Math.log(h)/l),s=Math.floor(d/l),f=16*h-d,(i=new co).writeInt(this.scalarType),i.writeShort(h),i.writeShort(d),i.writeShort(s),i.writeShort(f),a=16*h,u=i.pos+a,o=null,v=[],r)for(p=r[m],i.writeString(m),i.writeInt(e(p)),i.writeInt(u),i.writeInt(p.length),v=v.concat(p),m==="head"&&(o=u),u+=p.length;u%4;)v.push(0),u++;return i.write(v),n=2981146554-e(i.data),i.pos=o+8,i.writeUInt32(n),i.data},e=function(r){var n,i,a,s;for(r=i3.call(r);r.length%4;)r.push(0);for(a=new co(r),i=0,n=0,s=r.length;n<s;n=n+=4)i+=a.readUInt32();return 4294967295&i},t}(),IO={}.hasOwnProperty,Ha=function(e,t){for(var r in t)IO.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};ba=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var DO=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Ha(t,ba),t.prototype.tag="head",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},t.prototype.encode=function(r){var n;return(n=new co).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(r),n.writeShort(this.glyphDataFormat),n.data},t}(),ky=function(){function e(t,r){var n,i,a,s,o,l,u,f,d,p,h,v,m,S,y,w,x;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),d=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=t.readByte();break;case 4:for(h=t.readUInt16(),p=h/2,t.pos+=6,a=function(){var A,R;for(R=[],l=A=0;0<=p?A<p:A>p;l=0<=p?++A:--A)R.push(t.readUInt16());return R}(),t.pos+=2,m=function(){var A,R;for(R=[],l=A=0;0<=p?A<p:A>p;l=0<=p?++A:--A)R.push(t.readUInt16());return R}(),u=function(){var A,R;for(R=[],l=A=0;0<=p?A<p:A>p;l=0<=p?++A:--A)R.push(t.readUInt16());return R}(),f=function(){var A,R;for(R=[],l=A=0;0<=p?A<p:A>p;l=0<=p?++A:--A)R.push(t.readUInt16());return R}(),i=(this.length-t.pos+this.offset)/2,o=function(){var A,R;for(R=[],l=A=0;0<=i?A<i:A>i;l=0<=i?++A:--A)R.push(t.readUInt16());return R}(),l=y=0,x=a.length;y<x;l=++y)for(S=a[l],n=w=v=m[l];v<=S?w<=S:w>=S;n=v<=S?++w:--w)f[l]===0?s=n+u[l]:(s=o[f[l]/2+(n-v)-(p-l)]||0)!==0&&(s+=u[l]),this.codeMap[n]=65535&s}t.pos=d}return e.encode=function(t,r){var n,i,a,s,o,l,u,f,d,p,h,v,m,S,y,w,x,A,R,B,T,L,P,M,N,C,U,Y,ce,ee,Q,X,z,ae,me,E,O,F,I,V,ue,fe,he,xe,Oe,De;switch(Y=new co,s=Object.keys(t).sort(function(qe,Xe){return qe-Xe}),r){case"macroman":for(m=0,S=function(){var qe=[];for(v=0;v<256;++v)qe.push(0);return qe}(),w={0:0},a={},ce=0,z=s.length;ce<z;ce++)w[he=t[i=s[ce]]]==null&&(w[he]=++m),a[i]={old:t[i],new:w[t[i]]},S[i]=w[t[i]];return Y.writeUInt16(1),Y.writeUInt16(0),Y.writeUInt32(12),Y.writeUInt16(0),Y.writeUInt16(262),Y.writeUInt16(0),Y.write(S),{charMap:a,subtable:Y.data,maxGlyphID:m+1};case"unicode":for(C=[],d=[],x=0,w={},n={},y=u=null,ee=0,ae=s.length;ee<ae;ee++)w[R=t[i=s[ee]]]==null&&(w[R]=++x),n[i]={old:R,new:w[R]},o=w[R]-i,y!=null&&o===u||(y&&d.push(y),C.push(i),u=o),y=i;for(y&&d.push(y),d.push(65535),C.push(65535),M=2*(P=C.length),L=2*Math.pow(Math.log(P)/Math.LN2,2),p=Math.log(L/2)/Math.LN2,T=2*P-L,l=[],B=[],h=[],v=Q=0,me=C.length;Q<me;v=++Q){if(N=C[v],f=d[v],N===65535){l.push(0),B.push(0);break}if(N-(U=n[N].new)>=32768)for(l.push(0),B.push(2*(h.length+P-v)),i=X=N;N<=f?X<=f:X>=f;i=N<=f?++X:--X)h.push(n[i].new);else l.push(U-N),B.push(0)}for(Y.writeUInt16(3),Y.writeUInt16(1),Y.writeUInt32(12),Y.writeUInt16(4),Y.writeUInt16(16+8*P+2*h.length),Y.writeUInt16(0),Y.writeUInt16(M),Y.writeUInt16(L),Y.writeUInt16(p),Y.writeUInt16(T),ue=0,E=d.length;ue<E;ue++)i=d[ue],Y.writeUInt16(i);for(Y.writeUInt16(0),fe=0,O=C.length;fe<O;fe++)i=C[fe],Y.writeUInt16(i);for(xe=0,F=l.length;xe<F;xe++)o=l[xe],Y.writeUInt16(o);for(Oe=0,I=B.length;Oe<I;Oe++)A=B[Oe],Y.writeUInt16(A);for(De=0,V=h.length;De<V;De++)m=h[De],Y.writeUInt16(m);return{charMap:n,subtable:Y.data,maxGlyphID:x+1}}},e}(),n3=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Ha(t,ba),t.prototype.tag="cmap",t.prototype.parse=function(r){var n,i,a;for(r.pos=this.offset,this.version=r.readUInt16(),a=r.readUInt16(),this.tables=[],this.unicode=null,i=0;0<=a?i<a:i>a;i=0<=a?++i:--i)n=new ky(r,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},t.encode=function(r,n){var i,a;return n==null&&(n="macroman"),i=ky.encode(r,n),(a=new co).writeUInt16(0),a.writeUInt16(1),i.table=a.data.concat(i.subtable),i},t}(),jO=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Ha(t,ba),t.prototype.tag="hhea",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},t}(),MO=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Ha(t,ba),t.prototype.tag="OS/2",t.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=function(){var n,i;for(i=[],n=0;n<10;++n)i.push(r.readByte());return i}(),this.charRange=function(){var n,i;for(i=[],n=0;n<4;++n)i.push(r.readInt());return i}(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=function(){var n,i;for(i=[],n=0;n<2;n=++n)i.push(r.readInt());return i}(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},t}(),BO=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Ha(t,ba),t.prototype.tag="post",t.prototype.parse=function(r){var n,i,a;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var s;for(i=r.readUInt16(),this.glyphNameIndex=[],s=0;0<=i?s<i:s>i;s=0<=i?++s:--s)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],a=[];r.pos<this.offset+this.length;)n=r.readByte(),a.push(this.names.push(r.readString(n)));return a;case 151552:return i=r.readUInt16(),this.offsets=r.read(i);case 196608:break;case 262144:return this.map=(function(){var o,l,u;for(u=[],s=o=0,l=this.file.maxp.numGlyphs;0<=l?o<l:o>l;s=0<=l?++o:--o)u.push(r.readUInt32());return u}).call(this)}},t}(),UO=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},zO=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Ha(t,ba),t.prototype.tag="name",t.prototype.parse=function(r){var n,i,a,s,o,l,u,f,d,p,h;for(r.pos=this.offset,r.readShort(),n=r.readShort(),l=r.readShort(),i=[],s=0;0<=n?s<n:s>n;s=0<=n?++s:--s)i.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+l+r.readShort()});for(u={},s=d=0,p=i.length;d<p;s=++d)a=i[s],r.pos=a.offset,f=r.readString(a.length),o=new UO(f,a),u[h=a.nameID]==null&&(u[h]=[]),u[a.nameID].push(o);this.strings=u,this.copyright=u[0],this.fontFamily=u[1],this.fontSubfamily=u[2],this.uniqueSubfamily=u[3],this.fontName=u[4],this.version=u[5];try{this.postscriptName=u[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=u[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=u[7],this.manufacturer=u[8],this.designer=u[9],this.description=u[10],this.vendorUrl=u[11],this.designerUrl=u[12],this.license=u[13],this.licenseUrl=u[14],this.preferredFamily=u[15],this.preferredSubfamily=u[17],this.compatibleFull=u[18],this.sampleText=u[19]},t}(),HO=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Ha(t,ba),t.prototype.tag="maxp",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},t}(),WO=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Ha(t,ba),t.prototype.tag="hmtx",t.prototype.parse=function(r){var n,i,a,s,o,l,u;for(r.pos=this.offset,this.metrics=[],n=0,l=this.file.hhea.numberOfMetrics;0<=l?n<l:n>l;n=0<=l?++n:--n)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(a=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var f,d;for(d=[],n=f=0;0<=a?f<a:f>a;n=0<=a?++f:--f)d.push(r.readInt16());return d}(),this.widths=(function(){var f,d,p,h;for(h=[],f=0,d=(p=this.metrics).length;f<d;f++)s=p[f],h.push(s.advance);return h}).call(this),i=this.widths[this.widths.length-1],u=[],n=o=0;0<=a?o<a:o>a;n=0<=a?++o:--o)u.push(this.widths.push(i));return u},t.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},t}(),i3=[].slice,qO=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Ha(t,ba),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(r){var n,i,a,s,o,l,u,f,d,p;return r in this.cache?this.cache[r]:(s=this.file.loca,n=this.file.contents,i=s.indexOf(r),(a=s.lengthOf(r))===0?this.cache[r]=null:(n.pos=this.offset+i,o=(l=new co(n.read(a))).readShort(),f=l.readShort(),p=l.readShort(),u=l.readShort(),d=l.readShort(),this.cache[r]=o===-1?new VO(l,f,p,u,d):new $O(l,o,f,p,u,d),this.cache[r]))},t.prototype.encode=function(r,n,i){var a,s,o,l,u;for(o=[],s=[],l=0,u=n.length;l<u;l++)a=r[n[l]],s.push(o.length),a&&(o=o.concat(a.encode(i)));return s.push(o.length),{table:o,offsets:s}},t}(),$O=function(){function e(t,r,n,i,a,s){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=i,this.xMax=a,this.yMax=s,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),VO=function(){function e(t,r,n,i,a){var s,o;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=i,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;o=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&o;)s.pos+=1&o?4:2,128&o?s.pos+=8:64&o?s.pos+=4:8&o&&(s.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new co(i3.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),GO=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Ha(t,ba),t.prototype.tag="loca",t.prototype.parse=function(r){var n,i;return r.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var a,s;for(s=[],i=0,a=this.length;i<a;i+=2)s.push(2*r.readUInt16());return s}).call(this):(function(){var a,s;for(s=[],i=0,a=this.length;i<a;i+=4)s.push(r.readUInt32());return s}).call(this)},t.prototype.indexOf=function(r){return this.offsets[r]},t.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},t.prototype.encode=function(r,n){for(var i=new Uint32Array(this.offsets.length),a=0,s=0,o=0;o<i.length;++o)if(i[o]=a,s<n.length&&n[s]==o){++s,i[o]=a;var l=this.offsets[o],u=this.offsets[o+1]-l;u>0&&(a+=u)}for(var f=new Array(4*i.length),d=0;d<i.length;++d)f[4*d+3]=255&i[d],f[4*d+2]=(65280&i[d])>>8,f[4*d+1]=(16711680&i[d])>>16,f[4*d]=(4278190080&i[d])>>24;return f},t}(),KO=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,i,a;for(r in i=this.font.cmap.tables[0].codeMap,t={},a=this.subset)n=a[r],t[r]=i[n];return t},e.prototype.glyphsFor=function(t){var r,n,i,a,s,o,l;for(i={},s=0,o=t.length;s<o;s++)i[a=t[s]]=this.font.glyf.glyphFor(a);for(a in r=[],i)(n=i[a])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(a in l=this.glyphsFor(r))n=l[a],i[a]=n;return i},e.prototype.encode=function(t,r){var n,i,a,s,o,l,u,f,d,p,h,v,m,S,y;for(i in n=n3.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(t),h={0:0},y=n.charMap)h[(l=y[i]).old]=l.new;for(v in p=n.maxGlyphID,s)v in h||(h[v]=p++);return f=function(w){var x,A;for(x in A={},w)A[w[x]]=x;return A}(h),d=Object.keys(f).sort(function(w,x){return w-x}),m=function(){var w,x,A;for(A=[],w=0,x=d.length;w<x;w++)o=d[w],A.push(f[o]);return A}(),a=this.font.glyf.encode(s,m,h),u=this.font.loca.encode(a.offsets,m),S={cmap:this.font.cmap.raw(),glyf:a.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(S["OS/2"]=this.font.os2.raw()),this.font.directory.encode(S)},e}();mt.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,i,a,s;if(Array.isArray(r))return"["+function(){var o,l,u;for(u=[],o=0,l=r.length;o<l;o++)n=r[o],u.push(t.convert(n));return u}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(i in a=["<<"],r)s=r[i],a.push("/"+i+" "+t.convert(s));return a.push(">>"),a.join(`
`)}return""+r},t}();const YO=Object.freeze(Object.defineProperty({__proto__:null,AcroForm:TO,AcroFormAppearance:lt,AcroFormButton:Zr,AcroFormCheckBox:Yc,AcroFormChoiceField:Wo,AcroFormComboBox:$o,AcroFormEditBox:Gc,AcroFormListBox:qo,AcroFormPasswordField:Xc,AcroFormPushButton:Kc,AcroFormRadioButton:Vo,AcroFormTextField:no,GState:Lf,ShadingPattern:Ws,TilingPattern:Bo,default:mt,jsPDF:mt},Symbol.toStringTag,{value:"Module"}));var XO={exports:{}};const JO=W3(YO);/*!
 * 
 *               jsPDF AutoTable plugin v3.8.4
 *
 *               Copyright (c) 2024 Simon Bengtsson, https://github.com/simonbengtsson/jsPDF-AutoTable
 *               Licensed under the MIT License.
 *               http://opensource.org/licenses/mit-license
 *
 */(function(e,t){(function(n,i){e.exports=i(function(){try{return JO}catch{}}())})(typeof globalThis<"u"?globalThis:typeof k1<"u"?k1:typeof window<"u"?window:typeof self<"u"?self:k1,function(r){return function(){var n={172:function(o,l){var u=this&&this.__extends||function(){var p=function(h,v){return p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,S){m.__proto__=S}||function(m,S){for(var y in S)Object.prototype.hasOwnProperty.call(S,y)&&(m[y]=S[y])},p(h,v)};return function(h,v){if(typeof v!="function"&&v!==null)throw new TypeError("Class extends value "+String(v)+" is not a constructor or null");p(h,v);function m(){this.constructor=h}h.prototype=v===null?Object.create(v):(m.prototype=v.prototype,new m)}}();Object.defineProperty(l,"__esModule",{value:!0}),l.CellHookData=l.HookData=void 0;var f=function(){function p(h,v,m){this.table=v,this.pageNumber=v.pageNumber,this.pageCount=this.pageNumber,this.settings=v.settings,this.cursor=m,this.doc=h.getDocument()}return p}();l.HookData=f;var d=function(p){u(h,p);function h(v,m,S,y,w,x){var A=p.call(this,v,m,x)||this;return A.cell=S,A.row=y,A.column=w,A.section=y.section,A}return h}(f);l.CellHookData=d},340:function(o,l,u){Object.defineProperty(l,"__esModule",{value:!0});var f=u(4),d=u(136),p=u(744),h=u(776),v=u(664),m=u(972);function S(y){y.API.autoTable=function(){for(var w=[],x=0;x<arguments.length;x++)w[x]=arguments[x];var A;w.length===1?A=w[0]:(console.error("Use of deprecated autoTable initiation"),A=w[2]||{},A.columns=w[0],A.body=w[1]);var R=(0,h.parseInput)(this,A),B=(0,m.createTable)(this,R);return(0,v.drawTable)(this,B),this},y.API.lastAutoTable=!1,y.API.previousAutoTable=!1,y.API.autoTable.previous=!1,y.API.autoTableText=function(w,x,A,R){(0,d.default)(w,x,A,R,this)},y.API.autoTableSetDefaults=function(w){return p.DocHandler.setDefaults(w,this),this},y.autoTableSetDefaults=function(w,x){p.DocHandler.setDefaults(w,x)},y.API.autoTableHtmlToJson=function(w,x){var A;if(x===void 0&&(x=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var R=new p.DocHandler(this),B=(0,f.parseHtml)(R,w,window,x,!1),T=B.head,L=B.body,P=((A=T[0])===null||A===void 0?void 0:A.map(function(M){return M.content}))||[];return{columns:P,rows:L,data:L}},y.API.autoTableEndPosY=function(){console.error("Use of deprecated function: autoTableEndPosY. Use doc.lastAutoTable.finalY instead.");var w=this.lastAutoTable;return w&&w.finalY?w.finalY:0},y.API.autoTableAddPageContent=function(w){return console.error("Use of deprecated function: autoTableAddPageContent. Use jsPDF.autoTableSetDefaults({didDrawPage: () => {}}) instead."),y.API.autoTable.globalDefaults||(y.API.autoTable.globalDefaults={}),y.API.autoTable.globalDefaults.addPageContent=w,this},y.API.autoTableAddPage=function(){return console.error("Use of deprecated function: autoTableAddPage. Use doc.addPage()"),this.addPage(),this}}l.default=S},136:function(o,l){Object.defineProperty(l,"__esModule",{value:!0});function u(f,d,p,h,v){h=h||{};var m=1.15,S=v.internal.scaleFactor,y=v.internal.getFontSize()/S,w=v.getLineHeightFactor?v.getLineHeightFactor():m,x=y*w,A=/\r\n|\r|\n/g,R="",B=1;if((h.valign==="middle"||h.valign==="bottom"||h.halign==="center"||h.halign==="right")&&(R=typeof f=="string"?f.split(A):f,B=R.length||1),p+=y*(2-m),h.valign==="middle"?p-=B/2*x:h.valign==="bottom"&&(p-=B*x),h.halign==="center"||h.halign==="right"){var T=y;if(h.halign==="center"&&(T*=.5),R&&B>=1){for(var L=0;L<R.length;L++)v.text(R[L],d-v.getStringUnitWidth(R[L])*T,p),p+=x;return v}d-=v.getStringUnitWidth(f)*T}return h.halign==="justify"?v.text(f,d,p,{maxWidth:h.maxWidth||100,align:"justify"}):v.text(f,d,p),v}l.default=u},420:function(o,l){Object.defineProperty(l,"__esModule",{value:!0}),l.getPageAvailableWidth=l.parseSpacing=l.getFillStyle=l.addTableBorder=l.getStringWidth=void 0;function u(v,m,S){S.applyStyles(m,!0);var y=Array.isArray(v)?v:[v],w=y.map(function(x){return S.getTextWidth(x)}).reduce(function(x,A){return Math.max(x,A)},0);return w}l.getStringWidth=u;function f(v,m,S,y){var w=m.settings.tableLineWidth,x=m.settings.tableLineColor;v.applyStyles({lineWidth:w,lineColor:x});var A=d(w,!1);A&&v.rect(S.x,S.y,m.getWidth(v.pageSize().width),y.y-S.y,A)}l.addTableBorder=f;function d(v,m){var S=v>0,y=m||m===0;return S&&y?"DF":S?"S":y?"F":null}l.getFillStyle=d;function p(v,m){var S,y,w,x;if(v=v||m,Array.isArray(v)){if(v.length>=4)return{top:v[0],right:v[1],bottom:v[2],left:v[3]};if(v.length===3)return{top:v[0],right:v[1],bottom:v[2],left:v[1]};if(v.length===2)return{top:v[0],right:v[1],bottom:v[0],left:v[1]};v.length===1?v=v[0]:v=m}return typeof v=="object"?(typeof v.vertical=="number"&&(v.top=v.vertical,v.bottom=v.vertical),typeof v.horizontal=="number"&&(v.right=v.horizontal,v.left=v.horizontal),{left:(S=v.left)!==null&&S!==void 0?S:m,top:(y=v.top)!==null&&y!==void 0?y:m,right:(w=v.right)!==null&&w!==void 0?w:m,bottom:(x=v.bottom)!==null&&x!==void 0?x:m}):(typeof v!="number"&&(v=m),{top:v,right:v,bottom:v,left:v})}l.parseSpacing=p;function h(v,m){var S=p(m.settings.margin,0);return v.pageSize().width-(S.left+S.right)}l.getPageAvailableWidth=h},796:function(o,l){var u=this&&this.__extends||function(){var h=function(v,m){return h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(S,y){S.__proto__=y}||function(S,y){for(var w in y)Object.prototype.hasOwnProperty.call(y,w)&&(S[w]=y[w])},h(v,m)};return function(v,m){if(typeof m!="function"&&m!==null)throw new TypeError("Class extends value "+String(m)+" is not a constructor or null");h(v,m);function S(){this.constructor=v}v.prototype=m===null?Object.create(m):(S.prototype=m.prototype,new S)}}();Object.defineProperty(l,"__esModule",{value:!0}),l.getTheme=l.defaultStyles=l.HtmlRowInput=void 0;var f=function(h){u(v,h);function v(m){var S=h.call(this)||this;return S._element=m,S}return v}(Array);l.HtmlRowInput=f;function d(h){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/h,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}l.defaultStyles=d;function p(h){var v={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return v[h]}l.getTheme=p},903:function(o,l,u){Object.defineProperty(l,"__esModule",{value:!0}),l.parseCss=void 0;var f=u(420);function d(S,y,w,x,A){var R={},B=1.3333333333333333,T=h(y,function(z){return A.getComputedStyle(z).backgroundColor});T!=null&&(R.fillColor=T);var L=h(y,function(z){return A.getComputedStyle(z).color});L!=null&&(R.textColor=L);var P=m(x,w);P&&(R.cellPadding=P);var M="borderTopColor",N=B*w,C=x.borderTopWidth;if(x.borderBottomWidth===C&&x.borderRightWidth===C&&x.borderLeftWidth===C){var U=(parseFloat(C)||0)/N;U&&(R.lineWidth=U)}else R.lineWidth={top:(parseFloat(x.borderTopWidth)||0)/N,right:(parseFloat(x.borderRightWidth)||0)/N,bottom:(parseFloat(x.borderBottomWidth)||0)/N,left:(parseFloat(x.borderLeftWidth)||0)/N},R.lineWidth.top||(R.lineWidth.right?M="borderRightColor":R.lineWidth.bottom?M="borderBottomColor":R.lineWidth.left&&(M="borderLeftColor"));var Y=h(y,function(z){return A.getComputedStyle(z)[M]});Y!=null&&(R.lineColor=Y);var ce=["left","right","center","justify"];ce.indexOf(x.textAlign)!==-1&&(R.halign=x.textAlign),ce=["middle","bottom","top"],ce.indexOf(x.verticalAlign)!==-1&&(R.valign=x.verticalAlign);var ee=parseInt(x.fontSize||"");isNaN(ee)||(R.fontSize=ee/B);var Q=p(x);Q&&(R.fontStyle=Q);var X=(x.fontFamily||"").toLowerCase();return S.indexOf(X)!==-1&&(R.font=X),R}l.parseCss=d;function p(S){var y="";return(S.fontWeight==="bold"||S.fontWeight==="bolder"||parseInt(S.fontWeight)>=700)&&(y="bold"),(S.fontStyle==="italic"||S.fontStyle==="oblique")&&(y+="italic"),y}function h(S,y){var w=v(S,y);if(!w)return null;var x=w.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!x||!Array.isArray(x))return null;var A=[parseInt(x[1]),parseInt(x[2]),parseInt(x[3])],R=parseInt(x[4]);return R===0||isNaN(A[0])||isNaN(A[1])||isNaN(A[2])?null:A}function v(S,y){var w=y(S);return w==="rgba(0, 0, 0, 0)"||w==="transparent"||w==="initial"||w==="inherit"?S.parentElement==null?null:v(S.parentElement,y):w}function m(S,y){var w=[S.paddingTop,S.paddingRight,S.paddingBottom,S.paddingLeft],x=96/(72/y),A=(parseInt(S.lineHeight)-parseInt(S.fontSize))/y/2,R=w.map(function(T){return parseInt(T||"0")/x}),B=(0,f.parseSpacing)(R,0);return A>B.top&&(B.top=A),A>B.bottom&&(B.bottom=A),B}},744:function(o,l){Object.defineProperty(l,"__esModule",{value:!0}),l.DocHandler=void 0;var u={},f=function(){function d(p){this.jsPDFDocument=p,this.userStyles={textColor:p.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:p.internal.getFontSize(),fontStyle:p.internal.getFont().fontStyle,font:p.internal.getFont().fontName,lineWidth:p.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:p.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return d.setDefaults=function(p,h){h===void 0&&(h=null),h?h.__autoTableDocumentDefaults=p:u=p},d.unifyColor=function(p){return Array.isArray(p)?p:typeof p=="number"?[p,p,p]:typeof p=="string"?[p]:null},d.prototype.applyStyles=function(p,h){var v,m,S;h===void 0&&(h=!1),p.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(p.fontStyle);var y=this.jsPDFDocument.internal.getFont(),w=y.fontStyle,x=y.fontName;if(p.font&&(x=p.font),p.fontStyle){w=p.fontStyle;var A=this.getFontList()[x];A&&A.indexOf(w)===-1&&(this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(A[0]),w=A[0])}if(this.jsPDFDocument.setFont(x,w),p.fontSize&&this.jsPDFDocument.setFontSize(p.fontSize),!h){var R=d.unifyColor(p.fillColor);R&&(v=this.jsPDFDocument).setFillColor.apply(v,R),R=d.unifyColor(p.textColor),R&&(m=this.jsPDFDocument).setTextColor.apply(m,R),R=d.unifyColor(p.lineColor),R&&(S=this.jsPDFDocument).setDrawColor.apply(S,R),typeof p.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(p.lineWidth)}},d.prototype.splitTextToSize=function(p,h,v){return this.jsPDFDocument.splitTextToSize(p,h,v)},d.prototype.rect=function(p,h,v,m,S){return this.jsPDFDocument.rect(p,h,v,m,S)},d.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},d.prototype.getTextWidth=function(p){return this.jsPDFDocument.getTextWidth(p)},d.prototype.getDocument=function(){return this.jsPDFDocument},d.prototype.setPage=function(p){this.jsPDFDocument.setPage(p)},d.prototype.addPage=function(){return this.jsPDFDocument.addPage()},d.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},d.prototype.getGlobalOptions=function(){return u||{}},d.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},d.prototype.pageSize=function(){var p=this.jsPDFDocument.internal.pageSize;return p.width==null&&(p={width:p.getWidth(),height:p.getHeight()}),p},d.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},d.prototype.getLineHeightFactor=function(){var p=this.jsPDFDocument;return p.getLineHeightFactor?p.getLineHeightFactor():1.15},d.prototype.getLineHeight=function(p){return p/this.scaleFactor()*this.getLineHeightFactor()},d.prototype.pageNumber=function(){var p=this.jsPDFDocument.internal.getCurrentPageInfo();return p?p.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},d}();l.DocHandler=f},4:function(o,l,u){Object.defineProperty(l,"__esModule",{value:!0}),l.parseHtml=void 0;var f=u(903),d=u(796);function p(m,S,y,w,x){var A,R;w===void 0&&(w=!1),x===void 0&&(x=!1);var B;typeof S=="string"?B=y.document.querySelector(S):B=S;var T=Object.keys(m.getFontList()),L=m.scaleFactor(),P=[],M=[],N=[];if(!B)return console.error("Html table could not be found with input: ",S),{head:P,body:M,foot:N};for(var C=0;C<B.rows.length;C++){var U=B.rows[C],Y=(R=(A=U==null?void 0:U.parentElement)===null||A===void 0?void 0:A.tagName)===null||R===void 0?void 0:R.toLowerCase(),ce=h(T,L,y,U,w,x);ce&&(Y==="thead"?P.push(ce):Y==="tfoot"?N.push(ce):M.push(ce))}return{head:P,body:M,foot:N}}l.parseHtml=p;function h(m,S,y,w,x,A){for(var R=new d.HtmlRowInput(w),B=0;B<w.cells.length;B++){var T=w.cells[B],L=y.getComputedStyle(T);if(x||L.display!=="none"){var P=void 0;A&&(P=(0,f.parseCss)(m,T,S,L,y)),R.push({rowSpan:T.rowSpan,colSpan:T.colSpan,styles:P,_element:T,content:v(T)})}}var M=y.getComputedStyle(w);if(R.length>0&&(x||M.display!=="none"))return R}function v(m){var S=m.cloneNode(!0);return S.innerHTML=S.innerHTML.replace(/\n/g,"").replace(/ +/g," "),S.innerHTML=S.innerHTML.split(/<br.*?>/).map(function(y){return y.trim()}).join(`
`),S.innerText||S.textContent||""}},776:function(o,l,u){Object.defineProperty(l,"__esModule",{value:!0}),l.parseInput=void 0;var f=u(4),d=u(356),p=u(420),h=u(744),v=u(792);function m(B,T){var L=new h.DocHandler(B),P=L.getDocumentOptions(),M=L.getGlobalOptions();(0,v.default)(L,M,P,T);var N=(0,d.assign)({},M,P,T),C;typeof window<"u"&&(C=window);var U=S(M,P,T),Y=y(M,P,T),ce=w(L,N),ee=A(L,N,C);return{id:T.tableId,content:ee,hooks:Y,styles:U,settings:ce}}l.parseInput=m;function S(B,T,L){for(var P={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},M=function(Y){if(Y==="columnStyles"){var ce=B[Y],ee=T[Y],Q=L[Y];P.columnStyles=(0,d.assign)({},ce,ee,Q)}else{var X=[B,T,L],z=X.map(function(ae){return ae[Y]||{}});P[Y]=(0,d.assign)({},z[0],z[1],z[2])}},N=0,C=Object.keys(P);N<C.length;N++){var U=C[N];M(U)}return P}function y(B,T,L){for(var P=[B,T,L],M={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},N=0,C=P;N<C.length;N++){var U=C[N];U.didParseCell&&M.didParseCell.push(U.didParseCell),U.willDrawCell&&M.willDrawCell.push(U.willDrawCell),U.didDrawCell&&M.didDrawCell.push(U.didDrawCell),U.willDrawPage&&M.willDrawPage.push(U.willDrawPage),U.didDrawPage&&M.didDrawPage.push(U.didDrawPage)}return M}function w(B,T){var L,P,M,N,C,U,Y,ce,ee,Q,X,z,ae=(0,p.parseSpacing)(T.margin,40/B.scaleFactor()),me=(L=x(B,T.startY))!==null&&L!==void 0?L:ae.top,E;T.showFoot===!0?E="everyPage":T.showFoot===!1?E="never":E=(P=T.showFoot)!==null&&P!==void 0?P:"everyPage";var O;T.showHead===!0?O="everyPage":T.showHead===!1?O="never":O=(M=T.showHead)!==null&&M!==void 0?M:"everyPage";var F=(N=T.useCss)!==null&&N!==void 0?N:!1,I=T.theme||(F?"plain":"striped"),V=!!T.horizontalPageBreak,ue=(C=T.horizontalPageBreakRepeat)!==null&&C!==void 0?C:null;return{includeHiddenHtml:(U=T.includeHiddenHtml)!==null&&U!==void 0?U:!1,useCss:F,theme:I,startY:me,margin:ae,pageBreak:(Y=T.pageBreak)!==null&&Y!==void 0?Y:"auto",rowPageBreak:(ce=T.rowPageBreak)!==null&&ce!==void 0?ce:"auto",tableWidth:(ee=T.tableWidth)!==null&&ee!==void 0?ee:"auto",showHead:O,showFoot:E,tableLineWidth:(Q=T.tableLineWidth)!==null&&Q!==void 0?Q:0,tableLineColor:(X=T.tableLineColor)!==null&&X!==void 0?X:200,horizontalPageBreak:V,horizontalPageBreakRepeat:ue,horizontalPageBreakBehaviour:(z=T.horizontalPageBreakBehaviour)!==null&&z!==void 0?z:"afterAllRows"}}function x(B,T){var L=B.getLastAutoTable(),P=B.scaleFactor(),M=B.pageNumber(),N=!1;if(L&&L.startPageNumber){var C=L.startPageNumber+L.pageNumber-1;N=C===M}return typeof T=="number"?T:(T==null||T===!1)&&N&&(L==null?void 0:L.finalY)!=null?L.finalY+20/P:null}function A(B,T,L){var P=T.head||[],M=T.body||[],N=T.foot||[];if(T.html){var C=T.includeHiddenHtml;if(L){var U=(0,f.parseHtml)(B,T.html,L,C,T.useCss)||{};P=U.head||P,M=U.body||P,N=U.foot||P}else console.error("Cannot parse html in non browser environment")}var Y=T.columns||R(P,M,N);return{columns:Y,head:P,body:M,foot:N}}function R(B,T,L){var P=B[0]||T[0]||L[0]||[],M=[];return Object.keys(P).filter(function(N){return N!=="_element"}).forEach(function(N){var C=1,U;Array.isArray(P)?U=P[parseInt(N)]:U=P[N],typeof U=="object"&&!Array.isArray(U)&&(C=(U==null?void 0:U.colSpan)||1);for(var Y=0;Y<C;Y++){var ce=void 0;Array.isArray(P)?ce=M.length:ce=N+(Y>0?"_".concat(Y):"");var ee={dataKey:ce};M.push(ee)}}),M}},792:function(o,l){Object.defineProperty(l,"__esModule",{value:!0});function u(d,p,h,v){for(var m=function(x){x&&typeof x!="object"&&console.error("The options parameter should be of type object, is: "+typeof x),typeof x.extendWidth<"u"&&(x.tableWidth=x.extendWidth?"auto":"wrap",console.error("Use of deprecated option: extendWidth, use tableWidth instead.")),typeof x.margins<"u"&&(typeof x.margin>"u"&&(x.margin=x.margins),console.error("Use of deprecated option: margins, use margin instead.")),x.startY&&typeof x.startY!="number"&&(console.error("Invalid value for startY option",x.startY),delete x.startY),!x.didDrawPage&&(x.afterPageContent||x.beforePageContent||x.afterPageAdd)&&(console.error("The afterPageContent, beforePageContent and afterPageAdd hooks are deprecated. Use didDrawPage instead"),x.didDrawPage=function(N){d.applyStyles(d.userStyles),x.beforePageContent&&x.beforePageContent(N),d.applyStyles(d.userStyles),x.afterPageContent&&x.afterPageContent(N),d.applyStyles(d.userStyles),x.afterPageAdd&&N.pageNumber>1&&N.afterPageAdd(N),d.applyStyles(d.userStyles)}),["createdHeaderCell","drawHeaderRow","drawRow","drawHeaderCell"].forEach(function(N){x[N]&&console.error('The "'.concat(N,'" hook has changed in version 3.0, check the changelog for how to migrate.'))}),[["showFoot","showFooter"],["showHead","showHeader"],["didDrawPage","addPageContent"],["didParseCell","createdCell"],["headStyles","headerStyles"]].forEach(function(N){var C=N[0],U=N[1];x[U]&&(console.error("Use of deprecated option ".concat(U,". Use ").concat(C," instead")),x[C]=x[U])}),[["padding","cellPadding"],["lineHeight","rowHeight"],"fontSize","overflow"].forEach(function(N){var C=typeof N=="string"?N:N[0],U=typeof N=="string"?N:N[1];typeof x[C]<"u"&&(typeof x.styles[U]>"u"&&(x.styles[U]=x[C]),console.error("Use of deprecated option: "+C+", use the style "+U+" instead."))});for(var A=0,R=["styles","bodyStyles","headStyles","footStyles"];A<R.length;A++){var B=R[A];f(x[B]||{})}for(var T=x.columnStyles||{},L=0,P=Object.keys(T);L<P.length;L++){var M=P[L];f(T[M]||{})}},S=0,y=[p,h,v];S<y.length;S++){var w=y[S];m(w)}}l.default=u;function f(d){d.rowHeight?(console.error("Use of deprecated style rowHeight. It is renamed to minCellHeight."),d.minCellHeight||(d.minCellHeight=d.rowHeight)):d.columnWidth&&(console.error("Use of deprecated style columnWidth. It is renamed to cellWidth."),d.cellWidth||(d.cellWidth=d.columnWidth))}},260:function(o,l,u){Object.defineProperty(l,"__esModule",{value:!0}),l.Column=l.Cell=l.Row=l.Table=void 0;var f=u(796),d=u(172),p=u(420),h=function(){function y(w,x){this.pageNumber=1,this.pageCount=1,this.id=w.id,this.settings=w.settings,this.styles=w.styles,this.hooks=w.hooks,this.columns=x.columns,this.head=x.head,this.body=x.body,this.foot=x.foot}return y.prototype.getHeadHeight=function(w){return this.head.reduce(function(x,A){return x+A.getMaxCellHeight(w)},0)},y.prototype.getFootHeight=function(w){return this.foot.reduce(function(x,A){return x+A.getMaxCellHeight(w)},0)},y.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},y.prototype.callCellHooks=function(w,x,A,R,B,T){for(var L=0,P=x;L<P.length;L++){var M=P[L],N=new d.CellHookData(w,this,A,R,B,T),C=M(N)===!1;if(A.text=Array.isArray(A.text)?A.text:[A.text],C)return!1}return!0},y.prototype.callEndPageHooks=function(w,x){w.applyStyles(w.userStyles);for(var A=0,R=this.hooks.didDrawPage;A<R.length;A++){var B=R[A];B(new d.HookData(w,this,x))}},y.prototype.callWillDrawPageHooks=function(w,x){for(var A=0,R=this.hooks.willDrawPage;A<R.length;A++){var B=R[A];B(new d.HookData(w,this,x))}},y.prototype.getWidth=function(w){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var x=this.columns.reduce(function(R,B){return R+B.wrappedWidth},0);return x}else{var A=this.settings.margin;return w-A.left-A.right}},y}();l.Table=h;var v=function(){function y(w,x,A,R,B){B===void 0&&(B=!1),this.height=0,this.raw=w,w instanceof f.HtmlRowInput&&(this.raw=w._element,this.element=w._element),this.index=x,this.section=A,this.cells=R,this.spansMultiplePages=B}return y.prototype.getMaxCellHeight=function(w){var x=this;return w.reduce(function(A,R){var B;return Math.max(A,((B=x.cells[R.index])===null||B===void 0?void 0:B.height)||0)},0)},y.prototype.hasRowSpan=function(w){var x=this;return w.filter(function(A){var R=x.cells[A.index];return R?R.rowSpan>1:!1}).length>0},y.prototype.canEntireRowFit=function(w,x){return this.getMaxCellHeight(x)<=w},y.prototype.getMinimumRowHeight=function(w,x){var A=this;return w.reduce(function(R,B){var T=A.cells[B.index];if(!T)return 0;var L=x.getLineHeight(T.styles.fontSize),P=T.padding("vertical"),M=P+L;return M>R?M:R},0)},y}();l.Row=v;var m=function(){function y(w,x,A){var R,B;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=x,this.section=A,this.raw=w;var T=w;w!=null&&typeof w=="object"&&!Array.isArray(w)?(this.rowSpan=w.rowSpan||1,this.colSpan=w.colSpan||1,T=(B=(R=w.content)!==null&&R!==void 0?R:w.title)!==null&&B!==void 0?B:w,w._element&&(this.raw=w._element)):(this.rowSpan=1,this.colSpan=1);var L=T!=null?""+T:"",P=/\r\n|\r|\n/g;this.text=L.split(P)}return y.prototype.getTextPos=function(){var w;if(this.styles.valign==="top")w=this.y+this.padding("top");else if(this.styles.valign==="bottom")w=this.y+this.height-this.padding("bottom");else{var x=this.height-this.padding("vertical");w=this.y+x/2+this.padding("top")}var A;if(this.styles.halign==="right")A=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var R=this.width-this.padding("horizontal");A=this.x+R/2+this.padding("left")}else A=this.x+this.padding("left");return{x:A,y:w}},y.prototype.getContentHeight=function(w,x){x===void 0&&(x=1.15);var A=Array.isArray(this.text)?this.text.length:1,R=this.styles.fontSize/w*x,B=A*R+this.padding("vertical");return Math.max(B,this.styles.minCellHeight)},y.prototype.padding=function(w){var x=(0,p.parseSpacing)(this.styles.cellPadding,0);return w==="vertical"?x.top+x.bottom:w==="horizontal"?x.left+x.right:x[w]},y}();l.Cell=m;var S=function(){function y(w,x,A){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=w,this.raw=x,this.index=A}return y.prototype.getMaxCustomCellWidth=function(w){for(var x=0,A=0,R=w.allRows();A<R.length;A++){var B=R[A],T=B.cells[this.index];T&&typeof T.styles.cellWidth=="number"&&(x=Math.max(x,T.styles.cellWidth))}return x},y}();l.Column=S},356:function(o,l){Object.defineProperty(l,"__esModule",{value:!0}),l.assign=void 0;function u(f,d,p,h,v){if(f==null)throw new TypeError("Cannot convert undefined or null to object");for(var m=Object(f),S=1;S<arguments.length;S++){var y=arguments[S];if(y!=null)for(var w in y)Object.prototype.hasOwnProperty.call(y,w)&&(m[w]=y[w])}return m}l.assign=u},972:function(o,l,u){Object.defineProperty(l,"__esModule",{value:!0}),l.createTable=void 0;var f=u(744),d=u(260),p=u(324),h=u(796),v=u(356);function m(B,T){var L=new f.DocHandler(B),P=S(T,L.scaleFactor()),M=new d.Table(T,P);return(0,p.calculateWidths)(L,M),L.applyStyles(L.userStyles),M}l.createTable=m;function S(B,T){var L=B.content,P=A(L.columns);if(L.head.length===0){var M=w(P,"head");M&&L.head.push(M)}if(L.foot.length===0){var M=w(P,"foot");M&&L.foot.push(M)}var N=B.settings.theme,C=B.styles;return{columns:P,head:y("head",L.head,P,C,N,T),body:y("body",L.body,P,C,N,T),foot:y("foot",L.foot,P,C,N,T)}}function y(B,T,L,P,M,N){var C={},U=T.map(function(Y,ce){for(var ee=0,Q={},X=0,z=0,ae=0,me=L;ae<me.length;ae++){var E=me[ae];if(C[E.index]==null||C[E.index].left===0)if(z===0){var O=void 0;Array.isArray(Y)?O=Y[E.index-X-ee]:O=Y[E.dataKey];var F={};typeof O=="object"&&!Array.isArray(O)&&(F=(O==null?void 0:O.styles)||{});var I=R(B,E,ce,M,P,N,F),V=new d.Cell(O,I,B);Q[E.dataKey]=V,Q[E.index]=V,z=V.colSpan-1,C[E.index]={left:V.rowSpan-1,times:z}}else z--,X++;else C[E.index].left--,z=C[E.index].times,ee++}return new d.Row(Y,ce,B,Q)});return U}function w(B,T){var L={};return B.forEach(function(P){if(P.raw!=null){var M=x(T,P.raw);M!=null&&(L[P.dataKey]=M)}}),Object.keys(L).length>0?L:null}function x(B,T){if(B==="head"){if(typeof T=="object")return T.header||T.title||null;if(typeof T=="string"||typeof T=="number")return T}else if(B==="foot"&&typeof T=="object")return T.footer;return null}function A(B){return B.map(function(T,L){var P,M,N;return typeof T=="object"?N=(M=(P=T.dataKey)!==null&&P!==void 0?P:T.key)!==null&&M!==void 0?M:L:N=L,new d.Column(N,T,L)})}function R(B,T,L,P,M,N,C){var U=(0,h.getTheme)(P),Y;B==="head"?Y=M.headStyles:B==="body"?Y=M.bodyStyles:B==="foot"&&(Y=M.footStyles);var ce=(0,v.assign)({},U.table,U[B],M.styles,Y),ee=M.columnStyles[T.dataKey]||M.columnStyles[T.index]||{},Q=B==="body"?ee:{},X=B==="body"&&L%2===0?(0,v.assign)({},U.alternateRow,M.alternateRowStyles):{},z=(0,h.defaultStyles)(N),ae=(0,v.assign)({},z,ce,X,Q);return(0,v.assign)(ae,C)}},664:function(o,l,u){Object.defineProperty(l,"__esModule",{value:!0}),l.addPage=l.drawTable=void 0;var f=u(420),d=u(260),p=u(744),h=u(356),v=u(136),m=u(224);function S(ee,Q){var X=Q.settings,z=X.startY,ae=X.margin,me={x:ae.left,y:z},E=Q.getHeadHeight(Q.columns)+Q.getFootHeight(Q.columns),O=z+ae.bottom+E;if(X.pageBreak==="avoid"){var F=Q.body,I=F.reduce(function(fe,he){return fe+he.height},0);O+=I}var V=new p.DocHandler(ee);(X.pageBreak==="always"||X.startY!=null&&O>V.pageSize().height)&&(ce(V),me.y=ae.top),Q.callWillDrawPageHooks(V,me);var ue=(0,h.assign)({},me);Q.startPageNumber=V.pageNumber(),X.horizontalPageBreak?y(V,Q,ue,me):(V.applyStyles(V.userStyles),(X.showHead==="firstPage"||X.showHead==="everyPage")&&Q.head.forEach(function(fe){return M(V,Q,fe,me,Q.columns)}),V.applyStyles(V.userStyles),Q.body.forEach(function(fe,he){var xe=he===Q.body.length-1;P(V,Q,fe,xe,ue,me,Q.columns)}),V.applyStyles(V.userStyles),(X.showFoot==="lastPage"||X.showFoot==="everyPage")&&Q.foot.forEach(function(fe){return M(V,Q,fe,me,Q.columns)})),(0,f.addTableBorder)(V,Q,ue,me),Q.callEndPageHooks(V,me),Q.finalY=me.y,ee.lastAutoTable=Q,ee.previousAutoTable=Q,ee.autoTable&&(ee.autoTable.previous=Q),V.applyStyles(V.userStyles)}l.drawTable=S;function y(ee,Q,X,z){var ae=(0,m.calculateAllColumnsCanFitInPage)(ee,Q),me=Q.settings;if(me.horizontalPageBreakBehaviour==="afterAllRows")ae.forEach(function(I,V){ee.applyStyles(ee.userStyles),V>0?Y(ee,Q,X,z,I.columns,!0):w(ee,Q,z,I.columns),x(ee,Q,X,z,I.columns),R(ee,Q,z,I.columns)});else for(var E=-1,O=ae[0],F=function(){var I=E;if(O){ee.applyStyles(ee.userStyles);var V=O.columns;E>=0?Y(ee,Q,X,z,V,!0):w(ee,Q,z,V),I=A(ee,Q,E+1,z,V),R(ee,Q,z,V)}var ue=I-E;ae.slice(1).forEach(function(fe){ee.applyStyles(ee.userStyles),Y(ee,Q,X,z,fe.columns,!0),A(ee,Q,E+1,z,fe.columns,ue),R(ee,Q,z,fe.columns)}),E=I};E<Q.body.length-1;)F()}function w(ee,Q,X,z){var ae=Q.settings;ee.applyStyles(ee.userStyles),(ae.showHead==="firstPage"||ae.showHead==="everyPage")&&Q.head.forEach(function(me){return M(ee,Q,me,X,z)})}function x(ee,Q,X,z,ae){ee.applyStyles(ee.userStyles),Q.body.forEach(function(me,E){var O=E===Q.body.length-1;P(ee,Q,me,O,X,z,ae)})}function A(ee,Q,X,z,ae,me){ee.applyStyles(ee.userStyles),me=me??Q.body.length;var E=Math.min(X+me,Q.body.length),O=-1;return Q.body.slice(X,E).forEach(function(F,I){var V=X+I===Q.body.length-1,ue=U(ee,Q,V,z);F.canEntireRowFit(ue,ae)&&(M(ee,Q,F,z,ae),O=X+I)}),O}function R(ee,Q,X,z){var ae=Q.settings;ee.applyStyles(ee.userStyles),(ae.showFoot==="lastPage"||ae.showFoot==="everyPage")&&Q.foot.forEach(function(me){return M(ee,Q,me,X,z)})}function B(ee,Q,X){var z=X.getLineHeight(ee.styles.fontSize),ae=ee.padding("vertical"),me=Math.floor((Q-ae)/z);return Math.max(0,me)}function T(ee,Q,X,z){var ae={};ee.spansMultiplePages=!0,ee.height=0;for(var me=0,E=0,O=X.columns;E<O.length;E++){var F=O[E],I=ee.cells[F.index];if(I){Array.isArray(I.text)||(I.text=[I.text]);var V=new d.Cell(I.raw,I.styles,I.section);V=(0,h.assign)(V,I),V.text=[];var ue=B(I,Q,z);I.text.length>ue&&(V.text=I.text.splice(ue,I.text.length));var fe=z.scaleFactor(),he=z.getLineHeightFactor();I.contentHeight=I.getContentHeight(fe,he),I.contentHeight>=Q&&(I.contentHeight=Q,V.styles.minCellHeight-=Q),I.contentHeight>ee.height&&(ee.height=I.contentHeight),V.contentHeight=V.getContentHeight(fe,he),V.contentHeight>me&&(me=V.contentHeight),ae[F.index]=V}}var xe=new d.Row(ee.raw,-1,ee.section,ae,!0);xe.height=me;for(var Oe=0,De=X.columns;Oe<De.length;Oe++){var F=De[Oe],V=xe.cells[F.index];V&&(V.height=xe.height);var I=ee.cells[F.index];I&&(I.height=ee.height)}return xe}function L(ee,Q,X,z){var ae=ee.pageSize().height,me=z.settings.margin,E=me.top+me.bottom,O=ae-E;Q.section==="body"&&(O-=z.getHeadHeight(z.columns)+z.getFootHeight(z.columns));var F=Q.getMinimumRowHeight(z.columns,ee),I=F<X;if(F>O)return console.error("Will not be able to print row ".concat(Q.index," correctly since it's minimum height is larger than page height")),!0;if(!I)return!1;var V=Q.hasRowSpan(z.columns),ue=Q.getMaxCellHeight(z.columns)>O;return ue?(V&&console.error("The content of row ".concat(Q.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(V||z.settings.rowPageBreak==="avoid")}function P(ee,Q,X,z,ae,me,E){var O=U(ee,Q,z,me);if(X.canEntireRowFit(O,E))M(ee,Q,X,me,E);else if(L(ee,X,O,Q)){var F=T(X,O,Q,ee);M(ee,Q,X,me,E),Y(ee,Q,ae,me,E),P(ee,Q,F,z,ae,me,E)}else Y(ee,Q,ae,me,E),P(ee,Q,X,z,ae,me,E)}function M(ee,Q,X,z,ae){z.x=Q.settings.margin.left;for(var me=0,E=ae;me<E.length;me++){var O=E[me],F=X.cells[O.index];if(!F){z.x+=O.width;continue}ee.applyStyles(F.styles),F.x=z.x,F.y=z.y;var I=Q.callCellHooks(ee,Q.hooks.willDrawCell,F,X,O,z);if(I===!1){z.x+=O.width;continue}N(ee,F,z);var V=F.getTextPos();(0,v.default)(F.text,V.x,V.y,{halign:F.styles.halign,valign:F.styles.valign,maxWidth:Math.ceil(F.width-F.padding("left")-F.padding("right"))},ee.getDocument()),Q.callCellHooks(ee,Q.hooks.didDrawCell,F,X,O,z),z.x+=O.width}z.y+=X.height}function N(ee,Q,X){var z=Q.styles;if(ee.getDocument().setFillColor(ee.getDocument().getFillColor()),typeof z.lineWidth=="number"){var ae=(0,f.getFillStyle)(z.lineWidth,z.fillColor);ae&&ee.rect(Q.x,X.y,Q.width,Q.height,ae)}else typeof z.lineWidth=="object"&&(z.fillColor&&ee.rect(Q.x,X.y,Q.width,Q.height,"F"),C(ee,Q,X,z.lineWidth))}function C(ee,Q,X,z){var ae,me,E,O;z.top&&(ae=X.x,me=X.y,E=X.x+Q.width,O=X.y,z.right&&(E+=.5*z.right),z.left&&(ae-=.5*z.left),F(z.top,ae,me,E,O)),z.bottom&&(ae=X.x,me=X.y+Q.height,E=X.x+Q.width,O=X.y+Q.height,z.right&&(E+=.5*z.right),z.left&&(ae-=.5*z.left),F(z.bottom,ae,me,E,O)),z.left&&(ae=X.x,me=X.y,E=X.x,O=X.y+Q.height,z.top&&(me-=.5*z.top),z.bottom&&(O+=.5*z.bottom),F(z.left,ae,me,E,O)),z.right&&(ae=X.x+Q.width,me=X.y,E=X.x+Q.width,O=X.y+Q.height,z.top&&(me-=.5*z.top),z.bottom&&(O+=.5*z.bottom),F(z.right,ae,me,E,O));function F(I,V,ue,fe,he){ee.getDocument().setLineWidth(I),ee.getDocument().line(V,ue,fe,he,"S")}}function U(ee,Q,X,z){var ae=Q.settings.margin.bottom,me=Q.settings.showFoot;return(me==="everyPage"||me==="lastPage"&&X)&&(ae+=Q.getFootHeight(Q.columns)),ee.pageSize().height-z.y-ae}function Y(ee,Q,X,z,ae,me){ae===void 0&&(ae=[]),me===void 0&&(me=!1),ee.applyStyles(ee.userStyles),Q.settings.showFoot==="everyPage"&&!me&&Q.foot.forEach(function(O){return M(ee,Q,O,z,ae)}),Q.callEndPageHooks(ee,z);var E=Q.settings.margin;(0,f.addTableBorder)(ee,Q,X,z),ce(ee),Q.pageNumber++,Q.pageCount++,z.x=E.left,z.y=E.top,X.y=E.top,Q.callWillDrawPageHooks(ee,z),Q.settings.showHead==="everyPage"&&(Q.head.forEach(function(O){return M(ee,Q,O,z,ae)}),ee.applyStyles(ee.userStyles))}l.addPage=Y;function ce(ee){var Q=ee.pageNumber();ee.setPage(Q+1);var X=ee.pageNumber();return X===Q?(ee.addPage(),!0):!1}},224:function(o,l,u){Object.defineProperty(l,"__esModule",{value:!0}),l.calculateAllColumnsCanFitInPage=void 0;var f=u(420);function d(h,v,m){var S;m===void 0&&(m={});var y=(0,f.getPageAvailableWidth)(h,v),w=new Map,x=[],A=[],R=[];v.settings.horizontalPageBreakRepeat,Array.isArray(v.settings.horizontalPageBreakRepeat)?R=v.settings.horizontalPageBreakRepeat:(typeof v.settings.horizontalPageBreakRepeat=="string"||typeof v.settings.horizontalPageBreakRepeat=="number")&&(R=[v.settings.horizontalPageBreakRepeat]),R.forEach(function(P){var M=v.columns.find(function(N){return N.dataKey===P||N.index===P});M&&!w.has(M.index)&&(w.set(M.index,!0),x.push(M.index),A.push(v.columns[M.index]),y-=M.wrappedWidth)});for(var B=!0,T=(S=m==null?void 0:m.start)!==null&&S!==void 0?S:0;T<v.columns.length;){if(w.has(T)){T++;continue}var L=v.columns[T].wrappedWidth;if(B||y>=L)B=!1,x.push(T),A.push(v.columns[T]),y-=L;else break;T++}return{colIndexes:x,columns:A,lastIndex:T-1}}function p(h,v){for(var m=[],S=0;S<v.columns.length;S++){var y=d(h,v,{start:S});y.columns.length&&(m.push(y),S=y.lastIndex)}return m}l.calculateAllColumnsCanFitInPage=p},324:function(o,l,u){Object.defineProperty(l,"__esModule",{value:!0}),l.ellipsize=l.resizeColumns=l.calculateWidths=void 0;var f=u(420);function d(x,A){p(x,A);var R=[],B=0;A.columns.forEach(function(L){var P=L.getMaxCustomCellWidth(A);P?L.width=P:(L.width=L.wrappedWidth,R.push(L)),B+=L.width});var T=A.getWidth(x.pageSize().width)-B;T&&(T=h(R,T,function(L){return Math.max(L.minReadableWidth,L.minWidth)})),T&&(T=h(R,T,function(L){return L.minWidth})),T=Math.abs(T),!A.settings.horizontalPageBreak&&T>.1/x.scaleFactor()&&(T=T<1?T:Math.round(T),console.warn("Of the table content, ".concat(T," units width could not fit page"))),m(A),S(A,x),v(A)}l.calculateWidths=d;function p(x,A){var R=x.scaleFactor(),B=A.settings.horizontalPageBreak,T=(0,f.getPageAvailableWidth)(x,A);A.allRows().forEach(function(L){for(var P=0,M=A.columns;P<M.length;P++){var N=M[P],C=L.cells[N.index];if(C){var U=A.hooks.didParseCell;A.callCellHooks(x,U,C,L,N,null);var Y=C.padding("horizontal");C.contentWidth=(0,f.getStringWidth)(C.text,C.styles,x)+Y;var ce=(0,f.getStringWidth)(C.text.join(" ").split(/[^\S\u00A0]+/),C.styles,x);if(C.minReadableWidth=ce+C.padding("horizontal"),typeof C.styles.cellWidth=="number")C.minWidth=C.styles.cellWidth,C.wrappedWidth=C.styles.cellWidth;else if(C.styles.cellWidth==="wrap"||B===!0)C.contentWidth>T?(C.minWidth=T,C.wrappedWidth=T):(C.minWidth=C.contentWidth,C.wrappedWidth=C.contentWidth);else{var ee=10/R;C.minWidth=C.styles.minCellWidth||ee,C.wrappedWidth=C.contentWidth,C.minWidth>C.wrappedWidth&&(C.wrappedWidth=C.minWidth)}}}}),A.allRows().forEach(function(L){for(var P=0,M=A.columns;P<M.length;P++){var N=M[P],C=L.cells[N.index];if(C&&C.colSpan===1)N.wrappedWidth=Math.max(N.wrappedWidth,C.wrappedWidth),N.minWidth=Math.max(N.minWidth,C.minWidth),N.minReadableWidth=Math.max(N.minReadableWidth,C.minReadableWidth);else{var U=A.styles.columnStyles[N.dataKey]||A.styles.columnStyles[N.index]||{},Y=U.cellWidth||U.minCellWidth;Y&&typeof Y=="number"&&(N.minWidth=Y,N.wrappedWidth=Y)}C&&(C.colSpan>1&&!N.minWidth&&(N.minWidth=C.minWidth),C.colSpan>1&&!N.wrappedWidth&&(N.wrappedWidth=C.minWidth))}})}function h(x,A,R){for(var B=A,T=x.reduce(function(ee,Q){return ee+Q.wrappedWidth},0),L=0;L<x.length;L++){var P=x[L],M=P.wrappedWidth/T,N=B*M,C=P.width+N,U=R(P),Y=C<U?U:C;A-=Y-P.width,P.width=Y}if(A=Math.round(A*1e10)/1e10,A){var ce=x.filter(function(ee){return A<0?ee.width>R(ee):!0});ce.length&&(A=h(ce,A,R))}return A}l.resizeColumns=h;function v(x){for(var A={},R=1,B=x.allRows(),T=0;T<B.length;T++)for(var L=B[T],P=0,M=x.columns;P<M.length;P++){var N=M[P],C=A[N.index];if(R>1)R--,delete L.cells[N.index];else if(C)C.cell.height+=L.height,R=C.cell.colSpan,delete L.cells[N.index],C.left--,C.left<=1&&delete A[N.index];else{var U=L.cells[N.index];if(!U)continue;if(U.height=L.height,U.rowSpan>1){var Y=B.length-T,ce=U.rowSpan>Y?Y:U.rowSpan;A[N.index]={cell:U,left:ce,row:L}}}}}function m(x){for(var A=x.allRows(),R=0;R<A.length;R++)for(var B=A[R],T=null,L=0,P=0,M=0;M<x.columns.length;M++){var N=x.columns[M];if(P-=1,P>1&&x.columns[M+1])L+=N.width,delete B.cells[N.index];else if(T){var C=T;delete B.cells[N.index],T=null,C.width=N.width+L}else{var C=B.cells[N.index];if(!C)continue;if(P=C.colSpan,L=0,C.colSpan>1){T=C,L+=N.width;continue}C.width=N.width+L}}}function S(x,A){for(var R={count:0,height:0},B=0,T=x.allRows();B<T.length;B++){for(var L=T[B],P=0,M=x.columns;P<M.length;P++){var N=M[P],C=L.cells[N.index];if(C){A.applyStyles(C.styles,!0);var U=C.width-C.padding("horizontal");if(C.styles.overflow==="linebreak")C.text=A.splitTextToSize(C.text,U+1/A.scaleFactor(),{fontSize:C.styles.fontSize});else if(C.styles.overflow==="ellipsize")C.text=y(C.text,U,C.styles,A,"...");else if(C.styles.overflow==="hidden")C.text=y(C.text,U,C.styles,A,"");else if(typeof C.styles.overflow=="function"){var Y=C.styles.overflow(C.text,U);typeof Y=="string"?C.text=[Y]:C.text=Y}C.contentHeight=C.getContentHeight(A.scaleFactor(),A.getLineHeightFactor());var ce=C.contentHeight/C.rowSpan;C.rowSpan>1&&R.count*R.height<ce*C.rowSpan?R={height:ce,count:C.rowSpan}:R&&R.count>0&&R.height>ce&&(ce=R.height),ce>L.height&&(L.height=ce)}}R.count--}}function y(x,A,R,B,T){return x.map(function(L){return w(L,A,R,B,T)})}l.ellipsize=y;function w(x,A,R,B,T){var L=1e4*B.scaleFactor();if(A=Math.ceil(A*L)/L,A>=(0,f.getStringWidth)(x,R,B))return x;for(;A<(0,f.getStringWidth)(x+T,R,B)&&!(x.length<=1);)x=x.substring(0,x.length-1);return x.trim()+T}},964:function(o){if(typeof r>"u"){var l=new Error("Cannot find module 'undefined'");throw l.code="MODULE_NOT_FOUND",l}o.exports=r}},i={};function a(o){var l=i[o];if(l!==void 0)return l.exports;var u=i[o]={exports:{}};return n[o].call(u.exports,u,u.exports,a),u.exports}var s={};return function(){var o=s;Object.defineProperty(o,"__esModule",{value:!0}),o.Cell=o.Column=o.Row=o.Table=o.CellHookData=o.__drawTable=o.__createTable=o.applyPlugin=void 0;var l=a(340),u=a(776),f=a(664),d=a(972),p=a(260);Object.defineProperty(o,"Table",{enumerable:!0,get:function(){return p.Table}});var h=a(172);Object.defineProperty(o,"CellHookData",{enumerable:!0,get:function(){return h.CellHookData}});var v=a(260);Object.defineProperty(o,"Cell",{enumerable:!0,get:function(){return v.Cell}}),Object.defineProperty(o,"Column",{enumerable:!0,get:function(){return v.Column}}),Object.defineProperty(o,"Row",{enumerable:!0,get:function(){return v.Row}});function m(A){(0,l.default)(A)}o.applyPlugin=m;function S(A,R){var B=(0,u.parseInput)(A,R),T=(0,d.createTable)(A,B);(0,f.drawTable)(A,T)}function y(A,R){var B=(0,u.parseInput)(A,R);return(0,d.createTable)(A,B)}o.__createTable=y;function w(A,R){(0,f.drawTable)(A,R)}o.__drawTable=w;try{var x=a(964);x.jsPDF&&(x=x.jsPDF),m(x)}catch{}o.default=S}(),s}()})})(XO);function QO(e,t="reporte",r="Datos"){try{const n=mp.book_new(),i=mp.json_to_sheet(e),a=[];return e.length>0&&(Object.keys(e[0]).forEach(s=>{const o=Math.max(s.length,...e.map(l=>String(l[s]||"").length));a.push({wch:Math.min(o+2,50)})}),i["!cols"]=a),mp.book_append_sheet(n,i,r),D7(n,`${t}.xlsx`),{success:!0}}catch(n){return console.error("Error al exportar a Excel:",n),{success:!1,error:n.message}}}function ZO(e,t="reporte",r="Reporte de Horas",n={}){try{if(!e||e.length===0)return console.error("No hay datos para exportar a PDF"),{success:!1,error:"No hay datos para exportar"};const i=n.orientation||"landscape",a=new mt({orientation:i,unit:"mm",format:"a4"});a.setFontSize(16),a.setFont(void 0,"bold"),a.text(r,14,15),a.setFontSize(10),a.setFont(void 0,"normal");const s=new Date().toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});if(a.text(`Generado: ${s}`,14,22),e.length===0)a.text("No hay datos para mostrar",14,30);else{const o=Object.keys(e[0]).map(l=>({header:l,dataKey:l}));if(a.autoTable({startY:28,columns:o,body:e,theme:"striped",headStyles:{fillColor:[59,130,246],textColor:255,fontStyle:"bold",halign:"center"},styles:{fontSize:9,cellPadding:3,overflow:"linebreak",cellWidth:"auto"},alternateRowStyles:{fillColor:[245,247,250]},columnStyles:{...Object.keys(e[0]).reduce((l,u,f)=>(typeof e[0][u]=="number"&&(l[u]={halign:"right"}),l),{})},margin:{top:30,left:14,right:14},didDrawPage:l=>{const u=a.internal.getNumberOfPages();a.setFontSize(8),a.text(`Pgina ${l.pageNumber} de ${u}`,a.internal.pageSize.width/2,a.internal.pageSize.height-10,{align:"center"})}}),n.totals){const l=a.lastAutoTable.finalY+5;a.setFontSize(11),a.setFont(void 0,"bold"),Object.entries(n.totals).forEach(([u,f],d)=>{a.text(`${u}: ${f}`,14,l+d*7)})}}return a.save(`${t}.pdf`),{success:!0}}catch(i){return console.error("Error al exportar a PDF:",i),{success:!1,error:i.message}}}function eF(e,t="reporte",r=";"){try{if(e.length===0)throw new Error("No hay datos para exportar");const n=Object.keys(e[0]);let i="\uFEFF";i+=n.join(r)+`
`,e.forEach(l=>{const u=n.map(f=>{const d=l[f];if(d==null)return"";const p=String(d);return p.includes(r)||p.includes(`
`)||p.includes('"')?`"${p.replace(/"/g,'""')}"`:p});i+=u.join(r)+`
`});const a=new Blob([i],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a"),o=URL.createObjectURL(a);return s.setAttribute("href",o),s.setAttribute("download",`${t}.csv`),s.style.visibility="hidden",document.body.appendChild(s),s.click(),document.body.removeChild(s),{success:!0}}catch(n){return console.error("Error al exportar a CSV:",n),{success:!1,error:n.message}}}function tF(e,t){const r={};return e.forEach(n=>{var s,o;const i=((s=n.employee)==null?void 0:s.name)||"Sin asignar";r[i]||(r[i]={Empleado:i,"Total Horas":0},t.forEach(l=>{r[i][l.name]=0}));const a=((o=n.task)==null?void 0:o.name)||"Otra";r[i][a]!==void 0&&(r[i][a]+=parseFloat(n.hours)),r[i]["Total Horas"]+=parseFloat(n.hours)}),Object.values(r).map(n=>{const i={...n};return Object.keys(i).forEach(a=>{typeof i[a]=="number"&&(i[a]=parseFloat(i[a].toFixed(2)))}),i})}function rF(e,t){const r={};return e.forEach(n=>{var a;const i=((a=n.task)==null?void 0:a.name)||"Sin asignar";r[i]||(r[i]={Tarea:i,"Total Horas":0}),r[i]["Total Horas"]+=parseFloat(n.hours)}),Object.values(r).map(n=>{const i={...n};return Object.keys(i).forEach(a=>{typeof i[a]=="number"&&(i[a]=parseFloat(i[a].toFixed(2)))}),i})}function nF(e){const t={};return e.forEach(r=>{const n=new Date(r.date),i=n.toISOString().split("T")[0],a=n.toLocaleDateString("es-ES");t[i]||(t[i]={Fecha:a,"Total Horas":0,"Nmero de Entradas":0}),t[i]["Total Horas"]+=parseFloat(r.hours),t[i]["Nmero de Entradas"]+=1}),Object.entries(t).map(([r,n])=>({...n,_dateKey:r})).map(r=>({...r,"Total Horas":parseFloat(r["Total Horas"].toFixed(2))})).sort((r,n)=>r._dateKey.localeCompare(n._dateKey)).map(({_dateKey:r,...n})=>n)}function iF({user:e,isResponsible:t,isAdmin:r}){const{entries:n,loading:i}=r_(null,e),{employees:a,loading:s}=z2(),{tasks:o,loading:l}=n_(),[u,f]=ut.useState("employee"),[d,p]=ut.useState({start:"",end:""}),[h,v]=ut.useState([]),[m,S]=ut.useState([]),[y,w]=ut.useState(null);ut.useEffect(()=>{const P=new Date,M=new Date(P.getFullYear(),P.getMonth(),1),N=new Date(P.getFullYear(),P.getMonth()+1,0);p({start:M.toISOString().split("T")[0],end:N.toISOString().split("T")[0]})},[]);const x=ut.useMemo(()=>{let P=n;return e&&!t&&!r&&(P=P.filter(M=>M.employee_id===e.id)),d.start&&(P=P.filter(M=>M.date>=d.start)),d.end&&(P=P.filter(M=>M.date<=d.end)),h.length>0&&(P=P.filter(M=>h.includes(M.employee_id))),m.length>0&&(P=P.filter(M=>m.includes(M.task_id))),P},[n,d,h,m,e,t,r]),A=ut.useMemo(()=>x.map(P=>({...P,employee:a.find(M=>M.id===P.employee_id),task:o.find(M=>M.id===P.task_id)})),[x,a,o]),R=ut.useMemo(()=>u==="employee"?tF(A,o):u==="task"?rF(A):nF(A),[A,u,a,o]),B=P=>{try{w(null);const N=`reporte_horas_${new Date().toISOString().split("T")[0]}`;let C;const U={employee:"Reporte de Horas por Empleado",task:"Reporte de Horas por Tarea",period:"Reporte de Horas por Perodo"};if(P==="excel")C=QO(R,N,U[u]);else if(P==="pdf"){const Y=R.reduce((ce,ee)=>ce+(ee["Total Horas"]||0),0);C=ZO(R,N,U[u],{orientation:"landscape",totals:{"Total General de Horas":Y.toFixed(2)}})}else P==="csv"&&(C=eF(R,N));C.success?(w({type:"success",text:`Reporte exportado correctamente a ${P.toUpperCase()}`}),setTimeout(()=>w(null),3e3)):w({type:"error",text:C.error||"Error al exportar"})}catch(M){console.error("Error al exportar:",M),w({type:"error",text:"Error al exportar el reporte"})}},T=ut.useMemo(()=>R.reduce((P,M)=>P+(M["Total Horas"]||0),0),[R]);return i||s||l?Z.jsx("div",{className:"flex justify-center items-center p-8",children:Z.jsx("div",{className:"text-gray-600",children:"Cargando datos..."})}):Z.jsxs("div",{className:"p-6",children:[Z.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-6",children:" Reportes y Resumen"}),y&&Z.jsx("div",{className:`mb-4 p-4 rounded-lg ${y.type==="success"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:y.text}),Z.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[Z.jsx("h3",{className:"font-semibold text-gray-800 mb-3",children:"Filtros"}),Z.jsxs("div",{className:`grid grid-cols-1 md:grid-cols-2 gap-4 ${t||r?"lg:grid-cols-4":"lg:grid-cols-3"}`,children:[Z.jsxs("div",{children:[Z.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha Inicio"}),Z.jsx("input",{type:"date",value:d.start,onChange:P=>p(M=>({...M,start:P.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),Z.jsxs("div",{children:[Z.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha Fin"}),Z.jsx("input",{type:"date",value:d.end,onChange:P=>p(M=>({...M,end:P.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),(t||r)&&Z.jsxs("div",{children:[Z.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Empleados (",h.length>0?h.length:"Todos",")"]}),Z.jsx("select",{multiple:!0,value:h,onChange:P=>{const M=Array.from(P.target.selectedOptions,N=>parseInt(N.value));v(M)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",size:"1",children:a.map(P=>Z.jsx("option",{value:P.id,children:P.name},P.id))})]}),Z.jsxs("div",{children:[Z.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Tareas (",m.length>0?m.length:"Todas",")"]}),Z.jsx("select",{multiple:!0,value:m,onChange:P=>{const M=Array.from(P.target.selectedOptions,N=>parseInt(N.value));S(M)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",size:"5",children:o.map(P=>Z.jsx("option",{value:P.id,children:P.name},P.id))})]})]}),Z.jsxs("div",{className:"mt-3 flex gap-2",children:[(t||r)&&h.length>0&&Z.jsx("button",{onClick:()=>v([]),className:"text-sm text-blue-600 hover:underline",children:"Limpiar empleados"}),m.length>0&&Z.jsx("button",{onClick:()=>S([]),className:"text-sm text-blue-600 hover:underline",children:"Limpiar tareas"})]})]}),Z.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:Z.jsxs("div",{className:"flex justify-between items-center",children:[Z.jsxs("div",{className:"flex gap-2",children:[Z.jsx("button",{onClick:()=>f("employee"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${u==="employee"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"Por Empleado"}),Z.jsx("button",{onClick:()=>f("task"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${u==="task"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"Por Tarea"}),Z.jsx("button",{onClick:()=>f("period"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${u==="period"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"Por Perodo"})]}),Z.jsxs("div",{className:"flex gap-2",children:[Z.jsxs("button",{onClick:()=>B("excel"),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors",title:"Exportar a Excel",children:[Z.jsx("span",{children:""}),Z.jsx("span",{children:"Excel"})]}),Z.jsxs("button",{onClick:()=>B("pdf"),className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors",title:"Exportar a PDF",children:[Z.jsx("span",{children:""}),Z.jsx("span",{children:"PDF"})]}),Z.jsxs("button",{onClick:()=>B("csv"),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors",title:"Exportar a CSV",children:[Z.jsx("span",{children:""}),Z.jsx("span",{children:"CSV"})]})]})]})}),Z.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:R.length===0?Z.jsx("div",{className:"p-8 text-center text-gray-500",children:"No hay datos para mostrar con los filtros seleccionados"}):Z.jsxs(Z.Fragment,{children:[Z.jsx("div",{className:"overflow-x-auto",children:Z.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[Z.jsx("thead",{className:"bg-gray-50",children:Z.jsx("tr",{children:Object.keys(R[0]).map((P,M)=>Z.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider ${P.includes("Total")?"bg-gray-100":""}`,children:P},M))})}),Z.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:R.map((P,M)=>Z.jsx("tr",{className:"hover:bg-gray-50",children:Object.values(P).map((N,C)=>Z.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm ${typeof N=="number"?"text-right font-medium":"text-gray-900"}`,children:typeof N=="number"?N.toFixed(2):N},C))},M))}),Z.jsx("tfoot",{className:"bg-gray-100 font-bold",children:Z.jsxs("tr",{children:[Z.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:"TOTAL GENERAL"}),Z.jsxs("td",{colSpan:Object.keys(R[0]).length-1,className:"px-6 py-4 text-right text-sm text-gray-900",children:[T.toFixed(2)," horas"]})]})})]})}),Z.jsx("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200",children:Z.jsxs("div",{className:"text-sm text-gray-600",children:[Z.jsx("span",{className:"font-medium",children:x.length})," registros encontrados",d.start&&d.end&&Z.jsxs("span",{className:"ml-4",children:["del ",new Date(d.start).toLocaleDateString("es-ES")," al ",new Date(d.end).toLocaleDateString("es-ES")]})]})})]})})]})}function aF(){const[e,t]=ut.useState(!1),[r,n]=ut.useState(null),i=async(f,d,p)=>{t(!0),n(null);try{if(!f||f.trim().length<2)throw new Error("El nombre debe tener al menos 2 caracteres");if(!p||p.length<4)throw new Error("La contrasea debe tener al menos 4 caracteres");if(!["employee","responsible","admin"].includes(d))throw new Error("Rol invlido");const{data:h,error:v}=await mn.from("employees").select("id").eq("name",f.trim()).limit(1);if(v)throw v;if(h&&h.length>0)throw new Error("Ya existe un empleado con ese nombre");const{data:m,error:S}=await mn.from("employees").insert([{name:f.trim(),role:d,password:p,active:!0}]).select();if(S)throw S;return{success:!0,data:m[0]}}catch(h){return console.error("Error al agregar empleado:",h),n(h.message),{success:!1,error:h.message}}finally{t(!1)}},a=async(f,d)=>{t(!0),n(null);try{if(d.name&&d.name.trim().length<2)throw new Error("El nombre debe tener al menos 2 caracteres");if(d.password&&d.password.length<4)throw new Error("La contrasea debe tener al menos 4 caracteres");if(d.role&&!["employee","responsible","admin"].includes(d.role))throw new Error("Rol invlido");if(d.name){const{data:v,error:m}=await mn.from("employees").select("id").eq("name",d.name.trim()).neq("id",f).limit(1);if(m)throw m;if(v&&v.length>0)throw new Error("Ya existe un empleado con ese nombre");d.name=d.name.trim()}const{data:p,error:h}=await mn.from("employees").update(d).eq("id",f).select();if(h)throw h;return{success:!0,data:p[0]}}catch(p){return console.error("Error al actualizar empleado:",p),n(p.message),{success:!1,error:p.message}}finally{t(!1)}},s=async f=>{t(!0),n(null);try{const{data:d,error:p}=await mn.from("employees").select("active").eq("id",f).single();if(p)throw p;if(!d)throw new Error("Empleado no encontrado");const{data:h,error:v}=await mn.from("employees").update({active:!d.active}).eq("id",f).select();if(v)throw v;return{success:!0,data:h[0]}}catch(d){return console.error("Error al cambiar estado del empleado:",d),n(d.message),{success:!1,error:d.message}}finally{t(!1)}},o=async f=>await s(f),l=async f=>{t(!0),n(null);try{const{data:d,error:p}=await mn.from("time_entries").select("id").eq("employee_id",f).limit(1);if(p)throw p;if(d&&d.length>0)throw new Error("No se puede eliminar un empleado con registros de horas. Desactvalo en su lugar.");const{error:h}=await mn.from("employees").delete().eq("id",f);if(h)throw h;return{success:!0}}catch(d){return console.error("Error al eliminar empleado:",d),n(d.message),{success:!1,error:d.message}}finally{t(!1)}},u=ut.useCallback(async(f={})=>{t(!0),n(null);try{let d=mn.from("employees").select("*").order("name");f.role&&(d=d.eq("role",f.role)),f.active!==void 0&&(d=d.eq("active",f.active));const{data:p,error:h}=await d;if(h)throw h;return{success:!0,data:p||[]}}catch(d){return console.error("Error al obtener empleados:",d),n(d.message),{success:!1,error:d.message,data:[]}}finally{t(!1)}},[]);return{loading:e,error:r,addEmployee:i,updateEmployee:a,toggleEmployeeActive:s,deleteEmployee:o,hardDeleteEmployee:l,fetchEmployees:u}}function sF(e){if(!e)return null;const t=/[a-z]/.test(e),r=/[A-Z]/.test(e),n=/\d/.test(e),i=/[^a-zA-Z0-9]/.test(e),a=[t,r,n,i].filter(Boolean).length;return e.length<4?{label:"Muy dbil",barColor:"bg-red-500",textColor:"text-red-500",width:"w-1/4"}:e.length<8||a<2?{label:"Dbil",barColor:"bg-orange-400",textColor:"text-orange-400",width:"w-2/4"}:e.length<12||a<3?{label:"Media",barColor:"bg-yellow-400",textColor:"text-yellow-500",width:"w-3/4"}:{label:"Fuerte",barColor:"bg-green-500",textColor:"text-green-600",width:"w-full"}}function oF({password:e}){const t=sF(e);return t?Z.jsxs("div",{className:"mt-1",children:[Z.jsx("div",{className:"h-1.5 w-full bg-gray-200 rounded-full overflow-hidden",children:Z.jsx("div",{className:`h-full rounded-full transition-all ${t.barColor} ${t.width}`})}),Z.jsx("p",{className:`text-xs mt-0.5 ${t.textColor}`,children:t.label})]}):null}function lF(){const{loading:e,error:t,addEmployee:r,updateEmployee:n,toggleEmployeeActive:i,fetchEmployees:a}=aF(),[s,o]=ut.useState([]),[l,u]=ut.useState(!1),[f,d]=ut.useState(null),[p,h]=ut.useState({name:"",role:"employee",password:""}),[v,m]=ut.useState(!1),[S,y]=ut.useState(null),[w,x]=ut.useState({role:"",active:""});ut.useEffect(()=>{A()},[]);const A=async()=>{const U=await a();U.success&&o(U.data)},R=(U=null)=>{d(U),h({name:(U==null?void 0:U.name)||"",role:(U==null?void 0:U.role)||"employee",password:""}),u(!0),y(null)},B=()=>{u(!1),d(null),h({name:"",role:"employee",password:""}),y(null)},T=U=>{const{name:Y,value:ce}=U.target;h(ee=>({...ee,[Y]:ce}))},L=async U=>{if(U.preventDefault(),!p.name.trim()){y({type:"error",text:"El nombre es requerido"});return}if(!f&&!p.password){y({type:"error",text:"La contrasea es requerida para nuevos empleados"});return}m(!0),y(null);try{let Y;if(f){const ce={name:p.name.trim(),role:p.role};p.password&&(ce.password=p.password),Y=await n(f.id,ce)}else Y=await r(p.name.trim(),p.role,p.password);Y.success?(y({type:"success",text:f?"Empleado actualizado correctamente":"Empleado creado correctamente"}),await A(),setTimeout(()=>{B()},1500)):y({type:"error",text:Y.error||"Error al guardar el empleado"})}catch{y({type:"error",text:"Error al guardar el empleado"})}finally{m(!1)}},P=async U=>{const Y=await i(U.id);Y.success?(y({type:"success",text:U.active?"Empleado desactivado":"Empleado activado"}),await A(),setTimeout(()=>y(null),3e3)):y({type:"error",text:Y.error||"Error al cambiar el estado"})},M=async U=>{const{name:Y,value:ce}=U.target,ee={...w,[Y]:ce};x(ee);const Q={};ee.role&&(Q.role=ee.role),ee.active!==""&&(Q.active=ee.active==="true");const X=await a(Q);X.success&&o(X.data)},N=U=>{switch(U){case"admin":return"bg-red-100 text-red-800";case"responsible":return"bg-yellow-100 text-yellow-800";default:return"bg-blue-100 text-blue-800"}},C=U=>{switch(U){case"admin":return"Administrador";case"responsible":return"Responsable";default:return"Empleado"}};return Z.jsxs("div",{className:"p-6",children:[Z.jsxs("div",{className:"flex justify-between items-center mb-6",children:[Z.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Gestin de Empleados"}),Z.jsxs("button",{onClick:()=>R(),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors",children:[Z.jsx("span",{children:""}),Z.jsx("span",{children:"Nuevo Empleado"})]})]}),S&&Z.jsx("div",{className:`mb-4 p-4 rounded-lg ${S.type==="success"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:S.text}),t&&Z.jsxs("div",{className:"mb-4 p-4 rounded-lg bg-red-100 text-red-800",children:["Error: ",t]}),Z.jsxs("div",{className:"mb-4 flex gap-4",children:[Z.jsxs("div",{children:[Z.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Rol"}),Z.jsxs("select",{name:"role",value:w.role,onChange:M,className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[Z.jsx("option",{value:"",children:"Todos"}),Z.jsx("option",{value:"admin",children:"Administrador"}),Z.jsx("option",{value:"responsible",children:"Responsable"}),Z.jsx("option",{value:"employee",children:"Empleado"})]})]}),Z.jsxs("div",{children:[Z.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estado"}),Z.jsxs("select",{name:"active",value:w.active,onChange:M,className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[Z.jsx("option",{value:"",children:"Todos"}),Z.jsx("option",{value:"true",children:"Activos"}),Z.jsx("option",{value:"false",children:"Inactivos"})]})]})]}),Z.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:Z.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[Z.jsx("thead",{className:"bg-gray-50",children:Z.jsxs("tr",{children:[Z.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nombre"}),Z.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rol"}),Z.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estado"}),Z.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),Z.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e&&s.length===0?Z.jsx("tr",{children:Z.jsx("td",{colSpan:"4",className:"px-6 py-4 text-center text-gray-500",children:"Cargando empleados..."})}):s.length===0?Z.jsx("tr",{children:Z.jsx("td",{colSpan:"4",className:"px-6 py-4 text-center text-gray-500",children:"No hay empleados para mostrar"})}):s.map(U=>Z.jsxs("tr",{className:"hover:bg-gray-50",children:[Z.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Z.jsx("div",{className:"text-sm font-medium text-gray-900",children:U.name})}),Z.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Z.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${N(U.role)}`,children:C(U.role)})}),Z.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Z.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${U.active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:U.active?"Activo":"Inactivo"})}),Z.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[Z.jsx("button",{onClick:()=>R(U),className:"text-blue-600 hover:text-blue-900 mr-4",title:"Editar",children:""}),Z.jsx("button",{onClick:()=>P(U),className:"text-yellow-600 hover:text-yellow-900",title:U.active?"Desactivar":"Activar",children:""})]})]},U.id))})]})}),l&&Z.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:Z.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[Z.jsx("h3",{className:"text-xl font-bold mb-4",children:f?"Editar Empleado":"Nuevo Empleado"}),S&&Z.jsx("div",{className:`mb-4 p-3 rounded ${S.type==="success"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:S.text}),Z.jsxs("form",{onSubmit:L,children:[Z.jsxs("div",{className:"mb-4",children:[Z.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre Completo"}),Z.jsx("input",{type:"text",name:"name",value:p.name,onChange:T,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ej: Juan Prez Garca",disabled:v,autoFocus:!0})]}),Z.jsxs("div",{className:"mb-4",children:[Z.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Rol"}),Z.jsxs("select",{name:"role",value:p.role,onChange:T,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:v,children:[Z.jsx("option",{value:"employee",children:"Empleado"}),Z.jsx("option",{value:"responsible",children:"Responsable"}),Z.jsx("option",{value:"admin",children:"Administrador"})]})]}),Z.jsxs("div",{className:"mb-4",children:[Z.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Contrasea ",f&&"(dejar en blanco para no cambiar)"]}),Z.jsx("input",{type:"password",name:"password",value:p.password,onChange:T,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:f?"Nueva contrasea (opcional)":"Contrasea",disabled:v,autoComplete:"new-password"}),p.password&&Z.jsx(oF,{password:p.password}),!f&&!p.password&&Z.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Mnimo 4 caracteres"})]}),Z.jsxs("div",{className:"flex justify-end gap-3",children:[Z.jsx("button",{type:"button",onClick:B,className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300",disabled:v,children:"Cancelar"}),Z.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400",disabled:v,children:v?"Guardando...":"Guardar"})]})]})]})})]})}function uF(){const{tasks:e,loading:t,error:r,fetchTasks:n,addTask:i,updateTask:a,toggleTaskActive:s}=n_(),[o,l]=ut.useState(!1),[u,f]=ut.useState(null),[d,p]=ut.useState(""),[h,v]=ut.useState(!1),[m,S]=ut.useState(null),[y,w]=ut.useState(!0);ut.useEffect(()=>{n(!0)},[n]);const x=(L=null)=>{f(L),p((L==null?void 0:L.name)||""),l(!0),S(null)},A=()=>{l(!1),f(null),p(""),S(null)},R=async L=>{if(L.preventDefault(),!d.trim()){S({type:"error",text:"El nombre de la tarea es requerido"});return}v(!0),S(null);try{let P;u?P=await a(u.id,{name:d.trim()}):P=await i(d.trim()),P.success?(S({type:"success",text:u?"Tarea actualizada correctamente":"Tarea creada correctamente"}),setTimeout(()=>{A()},1500)):S({type:"error",text:P.error||"Error al guardar la tarea"})}catch{S({type:"error",text:"Error al guardar la tarea"})}finally{v(!1)}},B=async L=>{const P=await s(L.id);P.success?(S({type:"success",text:L.active?"Tarea desactivada":"Tarea activada"}),setTimeout(()=>S(null),3e3)):S({type:"error",text:P.error||"Error al cambiar el estado"})},T=y?e:e.filter(L=>L.active);return t&&e.length===0?Z.jsx("div",{className:"flex justify-center items-center p-8",children:Z.jsx("div",{className:"text-gray-600",children:"Cargando tareas..."})}):Z.jsxs("div",{className:"p-6",children:[Z.jsxs("div",{className:"flex justify-between items-center mb-6",children:[Z.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Gestin de Tareas"}),Z.jsxs("button",{onClick:()=>x(),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 transition-colors",children:[Z.jsx("span",{children:""}),Z.jsx("span",{children:"Nueva Tarea"})]})]}),m&&Z.jsx("div",{className:`mb-4 p-4 rounded-lg ${m.type==="success"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:m.text}),r&&Z.jsxs("div",{className:"mb-4 p-4 rounded-lg bg-red-100 text-red-800",children:["Error: ",r]}),Z.jsx("div",{className:"mb-4",children:Z.jsxs("label",{className:"flex items-center gap-2 text-sm text-gray-700",children:[Z.jsx("input",{type:"checkbox",checked:y,onChange:L=>w(L.target.checked),className:"rounded"}),"Mostrar tareas inactivas"]})}),Z.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:Z.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[Z.jsx("thead",{className:"bg-gray-50",children:Z.jsxs("tr",{children:[Z.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nombre"}),Z.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estado"}),Z.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),Z.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:T.length===0?Z.jsx("tr",{children:Z.jsx("td",{colSpan:"3",className:"px-6 py-4 text-center text-gray-500",children:"No hay tareas para mostrar"})}):T.map(L=>Z.jsxs("tr",{className:"hover:bg-gray-50",children:[Z.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Z.jsx("div",{className:"text-sm font-medium text-gray-900",children:L.name})}),Z.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:Z.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${L.active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:L.active?"Activa":"Inactiva"})}),Z.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[Z.jsx("button",{onClick:()=>x(L),className:"text-blue-600 hover:text-blue-900 mr-4",title:"Editar",children:""}),Z.jsx("button",{onClick:()=>B(L),className:"text-yellow-600 hover:text-yellow-900 mr-4",title:L.active?"Desactivar":"Activar",children:""})]})]},L.id))})]})}),o&&Z.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:Z.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[Z.jsx("h3",{className:"text-xl font-bold mb-4",children:u?"Editar Tarea":"Nueva Tarea"}),m&&Z.jsx("div",{className:`mb-4 p-3 rounded ${m.type==="success"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:m.text}),Z.jsxs("form",{onSubmit:R,children:[Z.jsxs("div",{className:"mb-4",children:[Z.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre de la Tarea"}),Z.jsx("input",{type:"text",value:d,onChange:L=>p(L.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ej: Clasificacin de materiales",disabled:h,autoFocus:!0})]}),Z.jsxs("div",{className:"flex justify-end gap-3",children:[Z.jsx("button",{type:"button",onClick:A,className:"px-4 py-2 text-gray-700 bg-gray-200 rounded-lg hover:bg-gray-300",disabled:h,children:"Cancelar"}),Z.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400",disabled:h,children:h?"Guardando...":"Guardar"})]})]})]})})]})}function cF(){const[e,t]=ut.useState("employees"),r=[{id:"employees",label:" Empleados",icon:""},{id:"tasks",label:" Tareas",icon:""}];return Z.jsx("div",{className:"min-h-screen bg-gray-100",children:Z.jsxs("div",{className:"max-w-7xl mx-auto",children:[Z.jsxs("div",{className:"bg-white shadow-md mb-6",children:[Z.jsx("div",{className:"px-6 py-4",children:Z.jsxs("h1",{className:"text-3xl font-bold text-gray-800 flex items-center gap-2",children:[Z.jsx("span",{children:""}),Z.jsx("span",{children:"Panel de Administracin"})]})}),Z.jsx("div",{className:"border-t border-gray-200",children:Z.jsx("nav",{className:"flex",children:r.map(n=>Z.jsx("button",{onClick:()=>t(n.id),className:`
                    px-6 py-3 text-sm font-medium border-b-2 transition-colors
                    ${e===n.id?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-800 hover:border-gray-300"}
                  `,children:Z.jsxs("span",{className:"flex items-center gap-2",children:[Z.jsx("span",{children:n.icon}),Z.jsx("span",{children:n.label})]})},n.id))})})]}),Z.jsxs("div",{className:"bg-white shadow-md rounded-lg",children:[e==="employees"&&Z.jsx(lF,{}),e==="tasks"&&Z.jsx(uF,{})]})]})})}function fF(){const[e,t]=ut.useState(null),[r,n]=ut.useState("calendar"),{entries:i,addEntry:a,updateEntry:s,deleteEntry:o}=r_(null,e),l=(e==null?void 0:e.role)==="responsible",u=(e==null?void 0:e.role)==="admin",f=u||l,d=v=>{t(v),n("calendar")},p=()=>{t(null),n("calendar")},h=()=>e?Z.jsxs("div",{className:"min-h-screen bg-gray-100",children:[Z.jsx("div",{className:"bg-white shadow-md",children:Z.jsx("div",{className:"max-w-7xl mx-auto px-4",children:Z.jsxs("nav",{className:"flex overflow-x-auto",children:[Z.jsx("button",{onClick:()=>n("calendar"),className:`
                  px-6 py-4 text-sm font-medium border-b-2 transition-colors whitespace-nowrap
                  ${r==="calendar"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-800 hover:border-gray-300"}
                `,children:Z.jsxs("span",{className:"flex items-center gap-2",children:[Z.jsx("span",{children:""}),Z.jsx("span",{children:"Calendario"})]})}),Z.jsx("button",{onClick:()=>n("summary"),className:`
                  px-6 py-4 text-sm font-medium border-b-2 transition-colors whitespace-nowrap
                  ${r==="summary"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-800 hover:border-gray-300"}
                `,children:Z.jsxs("span",{className:"flex items-center gap-2",children:[Z.jsx("span",{children:""}),Z.jsx("span",{children:"Resumen"})]})}),f&&Z.jsx("button",{onClick:()=>n("admin"),className:`
                    px-6 py-4 text-sm font-medium border-b-2 transition-colors whitespace-nowrap
                    ${r==="admin"?"border-blue-600 text-blue-600":"border-transparent text-gray-600 hover:text-gray-800 hover:border-gray-300"}
                  `,children:Z.jsxs("span",{className:"flex items-center gap-2",children:[Z.jsx("span",{children:""}),Z.jsx("span",{children:"Administracin"})]})})]})})}),Z.jsxs("div",{className:"max-w-7xl mx-auto",children:[r==="calendar"&&Z.jsx(aT,{entries:i,onAdd:a,onUpdate:s,onDelete:o,user:e,isResponsible:l}),r==="summary"&&Z.jsx(iF,{user:e,isResponsible:l,isAdmin:u}),r==="admin"&&f&&Z.jsx(cF,{})]})]}):Z.jsx(iT,{onLogin:d});return Z.jsx(y6,{user:e,onLogout:p,children:h()})}Tp.createRoot(document.getElementById("root")).render(Z.jsx(aS.StrictMode,{children:Z.jsx(fF,{})}));export{Qt as _,k1 as c,H3 as g};
